# KooDTX ê°œë°œ ì§„í–‰ ìƒí™©

> React Native Local-First ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ ì•± (ì˜¤ë””ì˜¤ í¬í•¨)

## í”„ë¡œì íŠ¸ ì •ë³´

- **í”„ë¡œì íŠ¸ëª…**: KooDTX
- **ì‹œì‘ì¼**: 2025-11-11
- **í˜„ì¬ ë²„ì „**: v0.1.0-dev
- **ì´ Phase**: 300ê°œ
- **ì˜ˆìƒ ê¸°ê°„**: 47ì£¼ (ì•½ 12ê°œì›”)

## ë²„ì „ íˆìŠ¤í† ë¦¬

### v0.1.0-dev (2025-11-11)

- í”„ë¡œì íŠ¸ ê³„íš ìˆ˜ë¦½ ì™„ë£Œ
- 300 Phase ìƒì„¸ ê³„íš ì‘ì„± ì™„ë£Œ (`detailed_phases_plan.json`)
- Git ì €ì¥ì†Œ ì´ˆê¸°í™”

---

## Phase ì§„í–‰ í˜„í™©

### âœ… ì™„ë£Œëœ Phase: 88/300

### ğŸ”„ ì§„í–‰ ì¤‘: Phase 89

### â³ ëŒ€ê¸° ì¤‘: Phase 89-300

---

## Phase 1: ê°œë°œ í™˜ê²½ ì¤€ë¹„ - Git ì„¤ì • âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì‹œì‘ì¼**: 2025-11-11
**ì™„ë£Œì¼**: 2025-11-11
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: critical

### ì‘ì—… ë‚´ìš©

- [x] Git ì„¤ì¹˜ í™•ì¸ ë° ìµœì‹  ë²„ì „ í™•ì¸ (v2.43.0)
- [x] GitHub ì €ì¥ì†Œ ìƒì„± (KooDTX)
- [x] .gitignore íŒŒì¼ ìƒì„± (React Native + Python)
- [x] README.md ì‘ì„±
- [x] Git ë¸Œëœì¹˜ ì „ëµ ë¬¸ì„œí™” (GIT_WORKFLOW.md)

### ì§„í–‰ ë¡œê·¸

**2025-11-11 22:43**

- Git ì €ì¥ì†Œ ì´ë¯¸ ì´ˆê¸°í™”ë¨
- ë¸Œëœì¹˜: `claude/react-native-architecture-phases-011CV1xEc4avXyTZ4Qb4ryxK`
- ìƒì„¸ ê³„íš íŒŒì¼ ì»¤ë°‹ ì™„ë£Œ (`detailed_phases_plan.json`)

**2025-11-11 22:45**

- PROGRESS.md íŒŒì¼ ìƒì„± ì‹œì‘
- ì§„í–‰ ìƒí™© ì¶”ì  ì‹œìŠ¤í…œ êµ¬ì¶•

**2025-11-11 22:50**

- .gitignore íŒŒì¼ ìƒì„± (React Native + Node.js + Python/Flask)
- README.md ì‘ì„± ì™„ë£Œ (í”„ë¡œì íŠ¸ ê°œìš”, ê¸°ìˆ  ìŠ¤íƒ, ë¬¸ì„œ)
- GIT_WORKFLOW.md ì‘ì„± ì™„ë£Œ (ë¸Œëœì¹˜ ì „ëµ, ì»¤ë°‹ ê·œì¹™, PR í…œí”Œë¦¿)

### ì‚°ì¶œë¬¼

- `.gitignore` - Git ë¬´ì‹œ íŒŒì¼ ëª©ë¡
- `README.md` - í”„ë¡œì íŠ¸ ì†Œê°œ ë¬¸ì„œ
- `GIT_WORKFLOW.md` - Git ì›Œí¬í”Œë¡œìš° ê°€ì´ë“œ
- `PROGRESS.md` - ì§„í–‰ ìƒí™© ì¶”ì  ë¬¸ì„œ

### ë‹¤ìŒ Phase

â†’ Phase 2: Node.js ë° ê°œë°œ ë„êµ¬ ì„¤ì¹˜

---

## Phase 2: Node.js ë° ê°œë°œ ë„êµ¬ ì„¤ì¹˜ âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì‹œì‘ì¼**: 2025-11-11
**ì™„ë£Œì¼**: 2025-11-11
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: critical

### ì‘ì—… ë‚´ìš©

- [x] Node.js ë²„ì „ í™•ì¸ (v22.21.1 - LTS v20.x ì´ìƒ)
- [x] npm íŒ¨í‚¤ì§€ ë§¤ë‹ˆì € í™•ì¸ (v10.9.4)
- [x] yarn íŒ¨í‚¤ì§€ ë§¤ë‹ˆì € í™•ì¸ (v1.22.22)
- [x] Java JDK í™•ì¸ (OpenJDK 21 - ìš”êµ¬ì‚¬í•­ JDK 17 ì´ìƒ)
- [x] JAVA_HOME í™˜ê²½ ë³€ìˆ˜ í™•ì¸
- [x] Android Studio ì„¤ì¹˜ ê°€ì´ë“œ ë¬¸ì„œ ì‘ì„±
- [x] React Native CLI ì‚¬ìš©ë²• í™•ì¸ (npx ì‚¬ìš©)

### ì§„í–‰ ë¡œê·¸

**2025-11-11 22:55**

- ê°œë°œ í™˜ê²½ í˜„í™© í™•ì¸ ì‹œì‘
- Node.js v22.21.1 ì„¤ì¹˜ í™•ì¸ (LTS ìš”êµ¬ì‚¬í•­ ì¶©ì¡±)
- npm v10.9.4, yarn v1.22.22 í™•ì¸

**2025-11-11 22:57**

- Java OpenJDK 21 í™•ì¸ (JDK 17 ìš”êµ¬ì‚¬í•­ ì´ˆê³¼ ë‹¬ì„±)
- JAVA_HOME í™˜ê²½ ë³€ìˆ˜ ì„¤ì • í™•ì¸: `/usr/lib/jvm/java-21-openjdk-amd64`

**2025-11-11 23:00**

- Android Studio ì„¤ì¹˜ ê°€ì´ë“œ ì‘ì„± ì‹œì‘
- `docs/ANDROID_SETUP_GUIDE.md` ìƒì„±
- SDK Manager, AVD ì„¤ì •, í™˜ê²½ ë³€ìˆ˜, ë¬¸ì œ í•´ê²° ê°€ì´ë“œ í¬í•¨

### í™˜ê²½ í™•ì¸ ê²°ê³¼

| ë„êµ¬           | ìš”êµ¬ ë²„ì „ | ì„¤ì¹˜ëœ ë²„ì „ | ìƒíƒœ |
| -------------- | --------- | ----------- | ---- |
| Node.js        | v20.x LTS | v22.21.1    | âœ…   |
| npm            | ìµœì‹       | v10.9.4     | âœ…   |
| yarn           | ì„ íƒ      | v1.22.22    | âœ…   |
| Java JDK       | 17+       | OpenJDK 21  | âœ…   |
| JAVA_HOME      | ì„¤ì • í•„ìš” | ì„¤ì •ë¨      | âœ…   |
| Android Studio | ì„¤ì¹˜ í•„ìš” | ë¬¸ì„œí™”      | ğŸ“   |
| ANDROID_HOME   | ì„¤ì • í•„ìš” | ê°€ì´ë“œ ì œê³µ | ğŸ“   |

### ì‚°ì¶œë¬¼

- `docs/ANDROID_SETUP_GUIDE.md` - Android ê°œë°œ í™˜ê²½ ì„¤ì • ê°€ì´ë“œ (240ì¤„)
  - Android Studio ì„¤ì¹˜ ë°©ë²•
  - SDK ë° Tools ì„¤ì •
  - í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (Windows/macOS/Linux)
  - AVD (ì—ë®¬ë ˆì´í„°) ìƒì„±
  - ë¬¼ë¦¬ ê¸°ê¸° ì—°ê²°
  - ë¬¸ì œ í•´ê²° ê°€ì´ë“œ

### ì°¸ê³ ì‚¬í•­

- CLI í™˜ê²½ì—ì„œ Android Studio ì§ì ‘ ì„¤ì¹˜ëŠ” ë¶ˆê°€ëŠ¥í•˜ë¯€ë¡œ ìƒì„¸ ê°€ì´ë“œ ë¬¸ì„œë¡œ ëŒ€ì²´
- React NativeëŠ” npxë¥¼ í†µí•´ ì‚¬ìš© ê°€ëŠ¥í•˜ë¯€ë¡œ ê¸€ë¡œë²Œ CLI ì„¤ì¹˜ ë¶ˆí•„ìš”
- í˜„ì¬ í™˜ê²½ì€ ê°œë°œ ì‹œì‘ì— í•„ìš”í•œ ëª¨ë“  ë„êµ¬ê°€ ì¤€ë¹„ë¨

### ë‹¤ìŒ Phase

â†’ Phase 3: React Native í”„ë¡œì íŠ¸ ì´ˆê¸°í™”

---

## Phase 3: React Native í”„ë¡œì íŠ¸ ì´ˆê¸°í™” âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì‹œì‘ì¼**: 2025-11-12
**ì™„ë£Œì¼**: 2025-11-12
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: critical

### ì‘ì—… ë‚´ìš©

- [x] React Native í”„ë¡œì íŠ¸ ìƒì„± (v0.73.0)
- [x] TypeScript í…œí”Œë¦¿ ì ìš© (ê¸°ë³¸ê°’)
- [x] í”„ë¡œì íŠ¸ íŒŒì¼ ë³µì‚¬ ë° êµ¬ì„±
- [x] í”„ë¡œì íŠ¸ ì´ë¦„ ë³€ê²½ (KooDTX)
- [x] npm ì˜ì¡´ì„± ì„¤ì¹˜ (904 packages)
- [x] í”„ë¡œì íŠ¸ êµ¬ì¡° í™•ì¸

### ì§„í–‰ ë¡œê·¸

**2025-11-12 00:00**

- `/tmp`ì— ì„ì‹œ í”„ë¡œì íŠ¸ ìƒì„± ì‹œì‘
- React Native CLI v20.0.2 ì‚¬ìš©
- React Native v0.73.0ìœ¼ë¡œ í”„ë¡œì íŠ¸ ìƒì„±

**2025-11-12 00:01**

- í”„ë¡œì íŠ¸ ìƒì„± ì™„ë£Œ (í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ, ì˜ì¡´ì„± ì„¤ì¹˜ í¬í•¨)
- í•µì‹¬ íŒŒì¼ ë³µì‚¬: package.json, tsconfig.json, babel.config.js ë“±

**2025-11-12 00:02**

- ë””ë ‰í† ë¦¬ ë³µì‚¬: android/, ios/, **tests**/, .bundle/
- í”„ë¡œì íŠ¸ ì´ë¦„ ìˆ˜ì •: package.json, app.json
- npm install ì‹¤í–‰ (904 íŒ¨í‚¤ì§€ ì„¤ì¹˜)

### ìƒì„±ëœ êµ¬ì¡°

```
KooDTX/
â”œâ”€â”€ android/                # Android ë„¤ì´í‹°ë¸Œ ì½”ë“œ
â”‚   â”œâ”€â”€ app/
â”‚   â””â”€â”€ gradle/
â”œâ”€â”€ ios/                    # iOS ë„¤ì´í‹°ë¸Œ ì½”ë“œ
â”œâ”€â”€ __tests__/              # Jest í…ŒìŠ¤íŠ¸
â”œâ”€â”€ docs/                   # ë¬¸ì„œ
â”œâ”€â”€ .bundle/                # ë²ˆë“¤ ì„¤ì •
â”œâ”€â”€ App.tsx                 # ë©”ì¸ ì•± ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ index.js                # ì§„ì…ì 
â”œâ”€â”€ package.json            # ì˜ì¡´ì„± ê´€ë¦¬
â”œâ”€â”€ tsconfig.json           # TypeScript ì„¤ì •
â”œâ”€â”€ babel.config.js         # Babel ì„¤ì •
â”œâ”€â”€ metro.config.js         # Metro ë²ˆë“¤ëŸ¬ ì„¤ì •
â”œâ”€â”€ jest.config.js          # Jest í…ŒìŠ¤íŠ¸ ì„¤ì •
â”œâ”€â”€ .eslintrc.js            # ESLint ì„¤ì •
â”œâ”€â”€ .prettierrc.js          # Prettier ì„¤ì •
â””â”€â”€ app.json                # ì•± ë©”íƒ€ë°ì´í„°
```

### ê¸°ìˆ  ìŠ¤íƒ í™•ì¸

| íŒ¨í‚¤ì§€       | ë²„ì „   |
| ------------ | ------ |
| React Native | 0.73.0 |
| React        | 18.2.0 |
| TypeScript   | 5.0.4  |
| Jest         | 29.6.3 |
| ESLint       | 8.57.1 |
| Prettier     | 2.8.8  |

### ì‚°ì¶œë¬¼

- **React Native í”„ë¡œì íŠ¸**: TypeScript ê¸°ë°˜ í”„ë¡œì íŠ¸ êµ¬ì¡°
- **Android í”„ë¡œì íŠ¸**: ë„¤ì´í‹°ë¸Œ Android ì½”ë“œ ë° Gradle ì„¤ì •
- **iOS í”„ë¡œì íŠ¸**: ë„¤ì´í‹°ë¸Œ iOS ì½”ë“œ (ì¶”í›„ ì„¤ì • í•„ìš”)
- **í…ŒìŠ¤íŠ¸ í™˜ê²½**: Jest ì„¤ì • ì™„ë£Œ
- **ë¦°íŠ¸/í¬ë§·**: ESLint + Prettier ì„¤ì • ì™„ë£Œ

### ì°¸ê³ ì‚¬í•­

- React Native 0.73ë¶€í„° TypeScriptê°€ ê¸°ë³¸ í…œí”Œë¦¿
- ì´ 904ê°œ íŒ¨í‚¤ì§€ ì„¤ì¹˜ (node_modules)
- 5ê°œ ë³´ì•ˆ ì·¨ì•½ì  ë°œê²¬ (ì¶”í›„ Phaseì—ì„œ í•´ê²°)
- iOS ë””ë ‰í† ë¦¬ ì´ë¦„ì´ ì—¬ì „íˆ "KooDTXTemp" (Android ìš°ì„  ê°œë°œ)

### ë‹¤ìŒ Phase

â†’ Phase 4: TypeScript ì„¤ì • ê°•í™”

---

## Phase 4: TypeScript ì„¤ì • ê°•í™” âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì‹œì‘ì¼**: 2025-11-12
**ì™„ë£Œì¼**: 2025-11-12
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

- [x] TypeScript strict mode í™œì„±í™”
- [x] ê°•ë ¥í•œ íƒ€ì… ì²´í‚¹ ê·œì¹™ ì¶”ê°€
- [x] Path aliases ì„¤ì • (13ê°œ ê²½ë¡œ)
- [x] Babel module resolver ì„¤ì •
- [x] Type definition íŒŒì¼ êµ¬ì¡° ìƒì„±
- [x] TypeScript ì»´íŒŒì¼ í…ŒìŠ¤íŠ¸

### ì§„í–‰ ë¡œê·¸

**2025-11-12 00:10**

- tsconfig.json ê°•í™” ì‹œì‘
- strict mode í™œì„±í™” ë° ì¶”ê°€ íƒ€ì… ì²´í‚¹ ê·œì¹™ ì„¤ì •
- Path aliases ì„¤ì •: @components, @screens, @navigation, @services ë“±

**2025-11-12 00:12**

- babel-plugin-module-resolver ì„¤ì¹˜ (16 packages)
- babel.config.jsì— path aliases ì„¤ì • ì¶”ê°€
- TypeScriptì™€ Babelì´ ë™ì¼í•œ ê²½ë¡œ í•´ì„ ì‚¬ìš©

**2025-11-12 00:15**

- src/types/ ë””ë ‰í† ë¦¬ ìƒì„±
- íƒ€ì… ì •ì˜ íŒŒì¼ 4ê°œ ì‘ì„±:
  - common.types.ts: ê³µí†µ íƒ€ì… (API, Pagination, Sync ë“±)
  - sensor.types.ts: ì„¼ì„œ ë°ì´í„° íƒ€ì… (Accelerometer, Gyroscope, GPS, Audio)
  - database.types.ts: ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ íƒ€ì… (WatermelonDBìš©)
  - navigation.types.ts: ë„¤ë¹„ê²Œì´ì…˜ íƒ€ì… (React Navigationìš©)
  - index.ts: ì¤‘ì•™ export íŒŒì¼

**2025-11-12 00:18**

- TypeScript ì»´íŒŒì¼ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
- moduleResolutionì„ "bundler"ë¡œ ìˆ˜ì • (React Native 0.73 í˜¸í™˜)
- ì»´íŒŒì¼ ì„±ê³µ í™•ì¸ âœ…

### TypeScript ì„¤ì • ê°•í™” ë‚´ìš©

#### Strict Mode ì˜µì…˜

```typescript
"strict": true,
"noImplicitAny": true,
"strictNullChecks": true,
"strictFunctionTypes": true,
"strictBindCallApply": true,
"strictPropertyInitialization": true,
"noImplicitThis": true,
"alwaysStrict": true
```

#### ì¶”ê°€ ì²´í¬

```typescript
"noUnusedLocals": true,
"noUnusedParameters": true,
"noImplicitReturns": true,
"noFallthroughCasesInSwitch": true,
"noUncheckedIndexedAccess": true,
"noImplicitOverride": true,
"noPropertyAccessFromIndexSignature": true
```

#### Path Aliases (13ê°œ)

- `@components/*` â†’ `src/components/*`
- `@screens/*` â†’ `src/screens/*`
- `@navigation/*` â†’ `src/navigation/*`
- `@services/*` â†’ `src/services/*`
- `@utils/*` â†’ `src/utils/*`
- `@hooks/*` â†’ `src/hooks/*`
- `@store/*` â†’ `src/store/*`
- `@types/*` â†’ `src/types/*`
- `@assets/*` â†’ `src/assets/*`
- `@config/*` â†’ `src/config/*`
- `@constants/*` â†’ `src/constants/*`
- `@models/*` â†’ `src/models/*`
- `@database/*` â†’ `src/database/*`

### ìƒì„±ëœ íƒ€ì… íŒŒì¼

#### 1. common.types.ts (75ì¤„)

- ApiResponse: API ì‘ë‹µ ë˜í¼
- PaginationParams: í˜ì´ì§€ë„¤ì´ì…˜ íŒŒë¼ë¯¸í„°
- SyncableRecord: ë™ê¸°í™” ê°€ëŠ¥í•œ ë ˆì½”ë“œ
- Coordinates: GPS ì¢Œí‘œ
- DateRange: ë‚ ì§œ ë²”ìœ„ í•„í„°

#### 2. sensor.types.ts (125ì¤„)

- SensorType: ì„¼ì„œ íƒ€ì… enum (5ì¢…)
- AccelerometerData: ê°€ì†ë„ê³„ ë°ì´í„°
- GyroscopeData: ìì´ë¡œìŠ¤ì½”í”„ ë°ì´í„°
- MagnetometerData: ìê¸°ê³„ ë°ì´í„°
- GPSData: GPS ë°ì´í„°
- AudioData: ì˜¤ë””ì˜¤ ë…¹ìŒ ë©”íƒ€ë°ì´í„°
- RecordingSession: ë…¹í™” ì„¸ì…˜
- SensorSettings: ì„¼ì„œ ì„¤ì •

#### 3. database.types.ts (75ì¤„)

- TableName: ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ëª… enum
- SyncQueueEntry: ë™ê¸°í™” í í•­ëª©
- UserSettings: ì‚¬ìš©ì ì„¤ì •
- DatabaseStats: ë°ì´í„°ë² ì´ìŠ¤ í†µê³„
- QueryFilter: ì¿¼ë¦¬ í•„í„° ì˜µì…˜

#### 4. navigation.types.ts (75ì¤„)

- RootStackParamList: ë£¨íŠ¸ ìŠ¤íƒ ë„¤ë¹„ê²Œì´í„°
- MainTabParamList: ë©”ì¸ íƒ­ ë„¤ë¹„ê²Œì´í„°
- RecordingStackParamList: ë…¹í™” ìŠ¤íƒ ë„¤ë¹„ê²Œì´í„°
- HistoryStackParamList: íˆìŠ¤í† ë¦¬ ìŠ¤íƒ ë„¤ë¹„ê²Œì´í„°
- SettingsStackParamList: ì„¤ì • ìŠ¤íƒ ë„¤ë¹„ê²Œì´í„°

### ì‚°ì¶œë¬¼

- **tsconfig.json**: ê°•í™”ëœ TypeScript ì„¤ì • (64ì¤„)
- **babel.config.js**: Path aliases ì„¤ì • (26ì¤„)
- **src/types/**: íƒ€ì… ì •ì˜ ë””ë ‰í† ë¦¬ (5ê°œ íŒŒì¼, ì´ 350ì¤„)
- **package.json**: babel-plugin-module-resolver ì¶”ê°€

### ì°¸ê³ ì‚¬í•­

- TypeScript strict modeë¡œ ëŸ°íƒ€ì„ ì—ëŸ¬ë¥¼ ì»´íŒŒì¼ íƒ€ì„ì— ê°ì§€
- Path aliasesë¡œ import ê²½ë¡œ ê°„ì†Œí™” (`../../utils/helper` â†’ `@utils/helper`)
- ëª¨ë“  ì£¼ìš” ë„ë©”ì¸ íƒ€ì… ì •ì˜ ì™„ë£Œ (ì„¼ì„œ, DB, ë„¤ë¹„ê²Œì´ì…˜)
- íƒ€ì… ì•ˆì •ì„± ëŒ€í­ í–¥ìƒ

### ë‹¤ìŒ Phase

â†’ Phase 5: ESLint ë° Prettier ì„¤ì •

---

## Phase 5: ESLint ë° Prettier ì„¤ì • âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì‹œì‘ì¼**: 2025-11-12
**ì™„ë£Œì¼**: 2025-11-12
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

- [x] ESLint ê·œì¹™ ê°•í™” ë° í™•ì¥
- [x] TypeScript ESLint í”ŒëŸ¬ê·¸ì¸ ì„¤ì •
- [x] React Hooks ê·œì¹™ ì¶”ê°€
- [x] Import ìˆœì„œ ìë™ ì •ë ¬ ê·œì¹™
- [x] Prettier ì„¤ì • í™•ì¥ ë° í‘œì¤€í™”
- [x] ESLint-Prettier í†µí•©
- [x] npm scripts ì¶”ê°€ (lint:fix, format, validate)
- [x] ì „ì²´ ì½”ë“œë² ì´ìŠ¤ í¬ë§·íŒ… ë° ê²€ì¦

### ì§„í–‰ ë¡œê·¸

**2025-11-12 00:25**

- ESLint ì„¤ì • ê°•í™” ì‹œì‘
- @typescript-eslint, react-hooks í”ŒëŸ¬ê·¸ì¸ í™œì„±í™”
- Path aliases resolver ì„¤ì • (babel-module)

**2025-11-12 00:28**

- ESLint ê·œì¹™ ì¶”ê°€:
  - TypeScript: no-unused-vars, no-explicit-any, consistent-type-imports
  - React: hooks rules, prop-types off
  - Import: ìë™ ì •ë ¬ ë° ê·¸ë£¹í™”
  - Code quality: no-console (warn), no-debugger, prefer-const

**2025-11-12 00:30**

- Prettier ì„¤ì • í™•ì¥:
  - printWidth: 80
  - tabWidth: 2
  - singleQuote: true
  - trailingComma: 'all'
  - arrowParens: 'avoid'
  - endOfLine: 'lf'

**2025-11-12 00:32**

- ESLint í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ (16 packages):
  - eslint-config-prettier
  - eslint-plugin-import
  - eslint-import-resolver-babel-module

**2025-11-12 00:35**

- npm scripts ì¶”ê°€:
  - `lint`: ESLint ê²€ì‚¬
  - `lint:fix`: ESLint ìë™ ìˆ˜ì •
  - `format`: Prettier ìë™ í¬ë§·íŒ…
  - `format:check`: Prettier ê²€ì‚¬
  - `typecheck`: TypeScript ì»´íŒŒì¼ ê²€ì‚¬
  - `validate`: ì „ì²´ ê²€ì¦ (typecheck + lint + format:check)

**2025-11-12 00:37**

- ì´ˆê¸° lint ì‹¤í–‰: 11ê°œ ì´ìŠˆ ë°œê²¬
- lint:fix ì‹¤í–‰: 9ê°œ ìë™ ìˆ˜ì •
- ìˆ˜ë™ ìˆ˜ì •: import ìˆœì„œ, require ë¬¸ ì²˜ë¦¬

**2025-11-12 00:40**

- Prettier í¬ë§·íŒ… ì‹¤í–‰ (26 files)
- jsxBracketSameLine ì˜µì…˜ ì œê±° (deprecated)
- ì „ì²´ ê²€ì¦ í†µê³¼ âœ…

### ESLint ê°•í™” ë‚´ìš©

#### í™•ì¥ ì„¤ì •

```javascript
extends: [
  '@react-native',
  'plugin:@typescript-eslint/recommended',
  'plugin:react-hooks/recommended',
  'prettier',
];
```

#### TypeScript ê·œì¹™

- `no-unused-vars`: ë¯¸ì‚¬ìš© ë³€ìˆ˜ ì—ëŸ¬ (\_ë¡œ ì‹œì‘í•˜ëŠ” ë³€ìˆ˜ ì œì™¸)
- `no-explicit-any`: any íƒ€ì… ê²½ê³ 
- `consistent-type-imports`: type import ê°•ì œ

#### Import ì •ë ¬ ê·œì¹™

- ê·¸ë£¹: builtin â†’ external â†’ internal â†’ parent/sibling â†’ index â†’ type
- React/React Native ìš°ì„  ë°°ì¹˜
- ì•ŒíŒŒë²³ ìˆœ ì •ë ¬
- ê·¸ë£¹ ê°„ ë¹ˆ ì¤„ ê°•ì œ

### npm Scripts

| ìŠ¤í¬ë¦½íŠ¸     | ì„¤ëª…                             | ìš©ë„                  |
| ------------ | -------------------------------- | --------------------- |
| lint         | ESLint ê²€ì‚¬                      | CI/CD, ê°œë°œ ì¤‘ ê²€ì‚¬   |
| lint:fix     | ESLint ìë™ ìˆ˜ì •                 | ì½”ë“œ ì •ë¦¬             |
| format       | Prettier í¬ë§·íŒ…                  | ì „ì²´ ì½”ë“œ í¬ë§·íŒ…      |
| format:check | Prettier ê²€ì‚¬                    | CI/CD ê²€ì¦            |
| typecheck    | TypeScript ì»´íŒŒì¼ ê²€ì‚¬           | íƒ€ì… ì—ëŸ¬ í™•ì¸        |
| validate     | ì „ì²´ ê²€ì¦ (type + lint + format) | PR ì „ ìµœì¢… ê²€ì¦       |

### ì‚°ì¶œë¬¼

- **.eslintrc.js**: ê°•í™”ëœ ESLint ì„¤ì • (108ì¤„)
  - 15ê°œ ì»¤ìŠ¤í…€ ê·œì¹™
  - 4ê°œ í”ŒëŸ¬ê·¸ì¸ í†µí•©
  - Path aliases resolver ì„¤ì •
- **.prettierrc.js**: í‘œì¤€ Prettier ì„¤ì • (30ì¤„)
- **package.json**: 6ê°œ ìƒˆë¡œìš´ scripts ì¶”ê°€
- **í¬ë§·íŒ…ëœ ì½”ë“œ**: 26ê°œ íŒŒì¼ ìë™ í¬ë§·íŒ…

### ê²€ì¦ ê²°ê³¼

âœ… **TypeScript ì»´íŒŒì¼**: ì—ëŸ¬ ì—†ìŒ
âœ… **ESLint**: ì—ëŸ¬ ì—†ìŒ
âœ… **Prettier**: ëª¨ë“  íŒŒì¼ í¬ë§· ì¤€ìˆ˜

### ì°¸ê³ ì‚¬í•­

- ESLintì™€ Prettierê°€ ì™„ë²½íˆ í†µí•©ë˜ì–´ ì¶©ëŒ ì—†ìŒ
- Import ìˆœì„œê°€ ìë™ìœ¼ë¡œ ì •ë ¬ë˜ì–´ ì¼ê´€ì„± ìœ ì§€
- validate ìŠ¤í¬ë¦½íŠ¸ë¡œ PR ì „ ìë™ ê²€ì¦ ê°€ëŠ¥
- ì½”ë“œ í’ˆì§ˆê³¼ ì¼ê´€ì„±ì´ í¬ê²Œ í–¥ìƒë¨

### ë‹¤ìŒ Phase

â†’ Phase 6: í”„ë¡œì íŠ¸ í´ë” êµ¬ì¡° ìƒì„±

---

## Phase 6: í”„ë¡œì íŠ¸ í´ë” êµ¬ì¡° ìƒì„± âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì‹œì‘ì¼**: 2025-11-12
**ì™„ë£Œì¼**: 2025-11-12
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: critical

### ì‘ì—… ë‚´ìš©

- [x] src/ ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„± (13ê°œ ë””ë ‰í† ë¦¬)
- [x] ê° ë””ë ‰í† ë¦¬ì— README.md ì¶”ê°€ (12ê°œ)
- [x] í”„ë¡œì íŠ¸ êµ¬ì¡° ë¬¸ì„œ ì‘ì„±
- [x] Path aliasesì™€ ë§¤í•‘ í™•ì¸

### ì§„í–‰ ë¡œê·¸

**2025-11-12 00:50**

- src/ ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„± ì‹œì‘
- 13ê°œ ì£¼ìš” ë””ë ‰í† ë¦¬ ìƒì„±: components, screens, navigation, services, utils, hooks, store, assets, config, constants, models, database, types

**2025-11-12 00:55**

- ê° ë””ë ‰í† ë¦¬ì— README.md íŒŒì¼ ìƒì„± (12ê°œ)
- ë””ë ‰í† ë¦¬ë³„ ëª©ì , êµ¬ì¡°, ê°€ì´ë“œë¼ì¸, ì˜ˆì œ ì½”ë“œ ì‘ì„±
- ì´ ë¬¸ì„œ ë¶„ëŸ‰: ì•½ 1,500ì¤„

**2025-11-12 01:00**

- í”„ë¡œì íŠ¸ êµ¬ì¡° í†µí•© ë¬¸ì„œ ì‘ì„±
- docs/PROJECT_STRUCTURE.md ìƒì„± (400ì¤„)
- ì „ì²´ í´ë” êµ¬ì¡°, ëª…ëª… ê·œì¹™, ëª¨ë²” ì‚¬ë¡€ ë¬¸ì„œí™”

### ìƒì„±ëœ í´ë” êµ¬ì¡°

```
src/
â”œâ”€â”€ components/      # ì¬ì‚¬ìš© ê°€ëŠ¥í•œ UI ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ screens/         # ì „ì²´ í™”ë©´ ë·°
â”œâ”€â”€ navigation/      # React Navigation ì„¤ì •
â”œâ”€â”€ services/        # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë° API
â”œâ”€â”€ hooks/           # ì»¤ìŠ¤í…€ React hooks
â”œâ”€â”€ store/           # Zustand ì „ì—­ ìƒíƒœ
â”œâ”€â”€ types/           # TypeScript íƒ€ì… ì •ì˜ (Phase 4ì—ì„œ ìƒì„±)
â”œâ”€â”€ utils/           # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â”œâ”€â”€ config/          # ì„¤ì • íŒŒì¼
â”œâ”€â”€ constants/       # ìƒìˆ˜ ë° enum
â”œâ”€â”€ models/          # ë¹„ì¦ˆë‹ˆìŠ¤ ì—”í‹°í‹° ëª¨ë¸
â”œâ”€â”€ database/        # WatermelonDB ì„¤ì •
â””â”€â”€ assets/          # ì •ì  ìì‚° (ì´ë¯¸ì§€, í°íŠ¸)
```

### ì‚°ì¶œë¬¼

- **13ê°œ ë””ë ‰í† ë¦¬**: ì™„ì „í•œ í”„ë¡œì íŠ¸ êµ¬ì¡°
- **12ê°œ README íŒŒì¼**: ê° ë””ë ‰í† ë¦¬ ë¬¸ì„œí™” (ì´ ~865ì¤„)
- **docs/PROJECT_STRUCTURE.md**: í†µí•© í”„ë¡œì íŠ¸ êµ¬ì¡° ë¬¸ì„œ (400ì¤„)
- **ì´ ë¬¸ì„œ**: ~1,265ì¤„

### ì°¸ê³ ì‚¬í•­

- ëª¨ë“  ë””ë ‰í† ë¦¬ê°€ tsconfig.jsonì˜ path aliasesì™€ ë§¤í•‘ë¨
- babel.config.jsì˜ module-resolverì™€ ë™ê¸°í™”ë¨
- ê° ë””ë ‰í† ë¦¬ì— ëª©ì , êµ¬ì¡°, ê°€ì´ë“œë¼ì¸, ì˜ˆì œ í¬í•¨
- í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°ë¡œ ì„¤ê³„ (ìƒˆ ê¸°ëŠ¥ ì¶”ê°€ ìš©ì´)

### ë‹¤ìŒ Phase

â†’ Phase 7: Jest ë° í…ŒìŠ¤íŠ¸ í™˜ê²½ ì„¤ì •

---

## Phase 7: Jest ë° í…ŒìŠ¤íŠ¸ í™˜ê²½ ì„¤ì • âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì‹œì‘ì¼**: 2025-11-12
**ì™„ë£Œì¼**: 2025-11-12
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

- [x] Jest ì„¤ì • ê°•í™” (path aliases, coverage)
- [x] jest.setup.js ìƒì„±
- [x] React Native Testing Library ì„¤ì¹˜
- [x] í…ŒìŠ¤íŠ¸ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ì‘ì„±
- [x] date utils ë° í…ŒìŠ¤íŠ¸ ì‘ì„±
- [x] 19ê°œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„± ë° í†µê³¼
- [x] npm scripts ì¶”ê°€ (test:watch, test:coverage)

### ì§„í–‰ ë¡œê·¸

**2025-11-12 01:10**

- Jest ì„¤ì • íŒŒì¼ ê°•í™”
- Path aliases ë§¤í•‘ (13ê°œ)
- Coverage threshold ì„¤ì • (70%)
- Test match patterns ì„¤ì •

**2025-11-12 01:15**

- jest.setup.js ìƒì„±
- LogBox warnings ì–µì œ
- Console methods mock
- Test timeout ì„¤ì • (10ì´ˆ)

**2025-11-12 01:18**

- React Native Testing Library ì„¤ì¹˜ (14 packages)
- @testing-library/react-native v13.3.3
- @testing-library/jest-native v5.4.3 (deprecated, ë‚˜ì¤‘ì— ì œê±°)

**2025-11-12 01:20**

- í…ŒìŠ¤íŠ¸ ìœ í‹¸ë¦¬í‹° ì‘ì„± (__tests__/utils/testUtils.tsx)
- renderWithProviders í•¨ìˆ˜
- Mock navigation/route generators
- Mock sensor data generators
- Async test helpers

**2025-11-12 01:25**

- date utils êµ¬í˜„ (src/utils/date.ts)
- 6ê°œ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜:
  - formatTimestamp: íƒ€ì„ìŠ¤íƒ¬í”„ í¬ë§·íŒ…
  - calculateDuration: ì‹œê°„ ê³„ì‚°
  - formatDuration: ì‹œê°„ í¬ë§·íŒ…
  - getCurrentTimestamp: í˜„ì¬ ì‹œê°„
  - isToday: ì˜¤ëŠ˜ ë‚ ì§œ í™•ì¸
  - getRelativeTime: ìƒëŒ€ ì‹œê°„ ë¬¸ìì—´

**2025-11-12 01:30**

- 19ê°œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„±
- ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼ âœ… (19/19)
- Coverage ë‹¬ì„±:
  - Statements: 100%
  - Branch: 86.66%
  - Functions: 100%
  - Lines: 100%

**2025-11-12 01:35**

- npm scripts ì¶”ê°€:
  - test:watch: Watch mode
  - test:coverage: Coverage ë¦¬í¬íŠ¸
  - test:clearCache: Jest ìºì‹œ í´ë¦¬ì–´
- validate ìŠ¤í¬ë¦½íŠ¸ì— test ì¶”ê°€

### Jest ì„¤ì • ê°•í™” ë‚´ìš©

#### Path Aliases ë§¤í•‘

```javascript
moduleNameMapper: {
  '^@components/(.*)$': '<rootDir>/src/components/$1',
  '^@screens/(.*)$': '<rootDir>/src/screens/$1',
  // ... 13ê°œ ê²½ë¡œ ë§¤í•‘
}
```

#### Coverage ì„¤ì •

```javascript
coverageThreshold: {
  global: {
    branches: 70,
    functions: 70,
    lines: 70,
    statements: 70,
  }
}
```

#### Transform ì„¤ì •

- React Native ëª¨ë“ˆ ë³€í™˜
- React Navigation ë³€í™˜
- Community íŒ¨í‚¤ì§€ ë³€í™˜

### í…ŒìŠ¤íŠ¸ ìœ í‹¸ë¦¬í‹°

#### renderWithProviders

- Provider wrapper ì§€ì›
- í–¥í›„ Redux, Navigation ì¶”ê°€ ì˜ˆì •

#### Mock Generators

- `createMockNavigation()`: Navigation mock
- `createMockRoute()`: Route mock
- `generateMockSensorData()`: ì„¼ì„œ ë°ì´í„° ìƒì„±
- `generateMockRecordingSession()`: ì„¸ì…˜ ë°ì´í„° ìƒì„±

#### Test Helpers

- `waitForCondition()`: ì¡°ê±´ ëŒ€ê¸°
- `delay()`: ë¹„ë™ê¸° ì§€ì—°
- `mockFetchSuccess()`: Fetch ì„±ê³µ mock
- `mockFetchError()`: Fetch ì—ëŸ¬ mock

### Date Utils í•¨ìˆ˜

| í•¨ìˆ˜                 | ì„¤ëª…                         | í…ŒìŠ¤íŠ¸ ìˆ˜ |
| -------------------- | ---------------------------- | --------- |
| formatTimestamp      | íƒ€ì„ìŠ¤íƒ¬í”„ â†’ ë¬¸ìì—´          | 2         |
| calculateDuration    | ë‘ ì‹œê°„ ì°¨ì´ ê³„ì‚°            | 3         |
| formatDuration       | Duration ê°ì²´ â†’ ë¬¸ìì—´       | 3         |
| getCurrentTimestamp  | í˜„ì¬ íƒ€ì„ìŠ¤íƒ¬í”„ ë°˜í™˜         | 2         |
| isToday              | ì˜¤ëŠ˜ ë‚ ì§œ ì—¬ë¶€ í™•ì¸          | 3         |
| getRelativeTime      | ìƒëŒ€ ì‹œê°„ ë¬¸ìì—´ (X ago)     | 6         |

### npm Scripts

| ìŠ¤í¬ë¦½íŠ¸        | ì„¤ëª…                  | ìš©ë„                |
| --------------- | --------------------- | ------------------- |
| test            | ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰      | CI/CD, ê°œë°œ         |
| test:watch      | Watch mode            | ê°œë°œ ì¤‘ ìë™ ì‹¤í–‰   |
| test:coverage   | Coverage ë¦¬í¬íŠ¸       | í’ˆì§ˆ í™•ì¸           |
| test:clearCache | Jest ìºì‹œ í´ë¦¬ì–´      | ë¬¸ì œ í•´ê²°           |
| validate        | ì „ì²´ ê²€ì¦ (test í¬í•¨) | PR ì „ ìµœì¢… ê²€ì¦     |

### ì‚°ì¶œë¬¼

- **jest.config.js**: ê°•í™”ëœ Jest ì„¤ì • (61ì¤„)
- **jest.setup.js**: Jest ì…‹ì—… íŒŒì¼ (43ì¤„)
- **__tests__/utils/testUtils.tsx**: í…ŒìŠ¤íŠ¸ ìœ í‹¸ë¦¬í‹° (130ì¤„)
- **src/utils/date.ts**: Date ìœ í‹¸ë¦¬í‹° (94ì¤„)
- **src/utils/__tests__/date.test.ts**: Date í…ŒìŠ¤íŠ¸ (138ì¤„)

### í…ŒìŠ¤íŠ¸ ê²°ê³¼

âœ… **19/19 í…ŒìŠ¤íŠ¸ í†µê³¼**

```
Test Suites: 1 passed, 1 total
Tests:       19 passed, 19 total
Snapshots:   0 total
Time:        3.312 s
```

âœ… **Coverage ë‹¬ì„±**

```
File      | % Stmts | % Branch | % Funcs | % Lines |
----------|---------|----------|---------|---------|
All files |     100 |    86.66 |     100 |     100 |
date.ts   |     100 |    86.66 |     100 |     100 |
```

### ì°¸ê³ ì‚¬í•­

- ëª¨ë“  path aliasesê°€ Jestì—ì„œ ì •ìƒ ì‘ë™
- Coverage threshold 70% ì„¤ì • (ë†’ì€ í’ˆì§ˆ ìœ ì§€)
- React Native Testing Libraryë¡œ ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ì™„ë£Œ
- í…ŒìŠ¤íŠ¸ ìœ í‹¸ë¦¬í‹°ë¡œ ë°˜ë³µ ì½”ë“œ ìµœì†Œí™”

### ë‹¤ìŒ Phase

â†’ Phase 8: Zustand ìƒíƒœ ê´€ë¦¬ ì„¤ì •

---

## Phase 8: ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ (Zustand) âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì‹œì‘ì¼**: 2025-11-12
**ì™„ë£Œì¼**: 2025-11-12
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

- [x] Zustand ì„¤ì¹˜
- [x] 3ê°œ í•µì‹¬ ìŠ¤í† ì–´ ìƒì„±
- [x] ìŠ¤í† ì–´ íƒ€ì… ì •ì˜
- [x] 23ê°œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„± ë° í†µê³¼
- [x] ìŠ¤í† ì–´ export ì„¤ì •

### ì§„í–‰ ë¡œê·¸

**2025-11-12 01:45**

- Zustand v4.5.0 ì„¤ì¹˜ (1 package)
- ê²½ëŸ‰ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬
- Reduxë³´ë‹¤ ê°„ë‹¨í•˜ê³  ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ì ìŒ

**2025-11-12 01:50**

- useAppStore ìƒì„± (110ì¤„)
  - ë„¤íŠ¸ì›Œí¬ ìƒíƒœ ê´€ë¦¬ (online, server connection)
  - ë¡œë”© ìƒíƒœ (initializing, loading)
  - ì—ëŸ¬ í•¸ë“¤ë§
  - ì•± ì´ˆê¸°í™” ë¡œì§

**2025-11-12 01:55**

- useRecordingStore ìƒì„± (120ì¤„)
  - ë…¹í™” ì„¸ì…˜ ê´€ë¦¬
  - ë…¹í™” ì œì–´ (start, stop, pause, resume)
  - ì„¼ì„œ ì„¤ì •
  - ë°ì´í„° ì¹´ìš´íŠ¸ ë° duration ì¶”ì 

**2025-11-12 02:00**

- useSensorStore ìƒì„± (90ì¤„)
  - ì„¼ì„œ ì„¤ì • ê´€ë¦¬ (5ê°œ ì„¼ì„œ)
  - ì„¼ì„œ í™œì„±í™”/ë¹„í™œì„±í™”
  - ìƒ˜í”Œë§ ë ˆì´íŠ¸ ì„¤ì •
  - ê¸°ë³¸ ì„¤ì • ë³µì›

**2025-11-12 02:05**

- ìŠ¤í† ì–´ í…ŒìŠ¤íŠ¸ ì‘ì„±:
  - useAppStore: 11ê°œ í…ŒìŠ¤íŠ¸
  - useRecordingStore: 12ê°œ í…ŒìŠ¤íŠ¸
  - ì´ 23ê°œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

**2025-11-12 02:10**

- ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼ âœ… (23/23)
- Test execution time: 5.611s

### ìƒì„±ëœ ìŠ¤í† ì–´

#### 1. useAppStore (110ì¤„)

**ìƒíƒœ**:
- `isOnline`: ë„¤íŠ¸ì›Œí¬ ì—°ê²° ìƒíƒœ
- `isConnectedToServer`: ì„œë²„ ì—°ê²° ìƒíƒœ
- `isInitializing`: ì•± ì´ˆê¸°í™” ì¤‘
- `isLoading`: ë¡œë”© ìƒíƒœ
- `error`: í˜„ì¬ ì—ëŸ¬
- `lastError`: ë§ˆì§€ë§‰ ì—ëŸ¬ ë° íƒ€ì„ìŠ¤íƒ¬í”„

**ì•¡ì…˜**:
- `setOnline()`: ì˜¨ë¼ì¸ ìƒíƒœ ì—…ë°ì´íŠ¸
- `setConnectedToServer()`: ì„œë²„ ì—°ê²° ìƒíƒœ
- `setError()`: ì—ëŸ¬ ì„¤ì •
- `clearError()`: ì—ëŸ¬ ì œê±°
- `initialize()`: ì•± ì´ˆê¸°í™”
- `reset()`: ìƒíƒœ ì´ˆê¸°í™”

#### 2. useRecordingStore (120ì¤„)

**ìƒíƒœ**:
- `currentSession`: í˜„ì¬ ë…¹í™” ì„¸ì…˜
- `isRecording`: ë…¹í™” ì¤‘ ì—¬ë¶€
- `isPaused`: ì¼ì‹œì •ì§€ ìƒíƒœ
- `enabledSensors`: í™œì„±í™”ëœ ì„¼ì„œ ëª©ë¡
- `sampleRate`: ìƒ˜í”Œë§ ë ˆì´íŠ¸
- `dataCount`: ìˆ˜ì§‘ëœ ë°ì´í„° ìˆ˜
- `duration`: ë…¹í™” ì‹œê°„

**ì•¡ì…˜**:
- `startRecording()`: ë…¹í™” ì‹œì‘
- `stopRecording()`: ë…¹í™” ì¢…ë£Œ
- `pauseRecording()`: ì¼ì‹œì •ì§€
- `resumeRecording()`: ì¬ê°œ
- `updateDataCount()`: ë°ì´í„° ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
- `updateDuration()`: ì‹œê°„ ì—…ë°ì´íŠ¸

#### 3. useSensorStore (90ì¤„)

**ìƒíƒœ**:
- `settings`: ì„¼ì„œë³„ ì„¤ì •
  - accelerometer, gyroscope, magnetometer
  - gps, audio
- `availableSensors`: ì‚¬ìš© ê°€ëŠ¥í•œ ì„¼ì„œ ëª©ë¡

**ì•¡ì…˜**:
- `updateSensorConfig()`: ì„¼ì„œ ì„¤ì • ì—…ë°ì´íŠ¸
- `toggleSensor()`: ì„¼ì„œ í™œì„±í™”/ë¹„í™œì„±í™”
- `setAvailableSensors()`: ì‚¬ìš© ê°€ëŠ¥ ì„¼ì„œ ì„¤ì •
- `resetToDefaults()`: ê¸°ë³¸ê°’ìœ¼ë¡œ ë³µì›

### í…ŒìŠ¤íŠ¸ ê²°ê³¼

âœ… **23/23 í…ŒìŠ¤íŠ¸ í†µê³¼**

```
Test Suites: 2 passed, 2 total
Tests:       23 passed, 23 total
Time:        5.611 s
```

#### useAppStore í…ŒìŠ¤íŠ¸ (11ê°œ)

- âœ“ Initial state verification
- âœ“ Network status updates
- âœ“ Server disconnection on offline
- âœ“ Loading states management
- âœ“ Error handling and clearing
- âœ“ LastError tracking with timestamp
- âœ“ App initialization
- âœ“ State reset

#### useRecordingStore í…ŒìŠ¤íŠ¸ (12ê°œ)

- âœ“ Initial state verification
- âœ“ Recording start with configuration
- âœ“ Session timestamps validation
- âœ“ Recording stop and session update
- âœ“ Stop without active session
- âœ“ Pause and resume functionality
- âœ“ Data count updates
- âœ“ Duration updates
- âœ“ Sensor configuration changes
- âœ“ Sample rate updates
- âœ“ State reset

### Zustand ì¥ì 

1. **ê°„ë‹¨í•œ API**: Reduxë³´ë‹¤ í›¨ì”¬ ê°„ë‹¨
2. **íƒ€ì… ì•ˆì „**: TypeScript ì™„ë²½ ì§€ì›
3. **ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ìµœì†Œí™”**: Actions, reducers ë¶ˆí•„ìš”
4. **React Hooks ê¸°ë°˜**: ìì—°ìŠ¤ëŸ¬ìš´ ì‚¬ìš©
5. **ë²ˆë“¤ í¬ê¸°**: ë§¤ìš° ì‘ìŒ (~1KB)
6. **DevTools ì§€ì›**: Redux DevTools í˜¸í™˜

### ì‚°ì¶œë¬¼

- **src/store/useAppStore.ts**: ì•± ìƒíƒœ ìŠ¤í† ì–´ (110ì¤„)
- **src/store/useRecordingStore.ts**: ë…¹í™” ìŠ¤í† ì–´ (120ì¤„)
- **src/store/useSensorStore.ts**: ì„¼ì„œ ìŠ¤í† ì–´ (90ì¤„)
- **src/store/index.ts**: ìŠ¤í† ì–´ exports (7ì¤„)
- **src/store/__tests__/useAppStore.test.ts**: í…ŒìŠ¤íŠ¸ (155ì¤„)
- **src/store/__tests__/useRecordingStore.test.ts**: í…ŒìŠ¤íŠ¸ (178ì¤„)
- **ì´ ì½”ë“œ**: ~660ì¤„

### ì°¸ê³ ì‚¬í•­

- ëª¨ë“  ìŠ¤í† ì–´ëŠ” íƒ€ì… ì•ˆì „
- Reset ê¸°ëŠ¥ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê²©ë¦¬ ë³´ì¥
- ì´ˆê¸° ìƒíƒœ ëª…í™•íˆ ì •ì˜
- ActionsëŠ” immutable updates ì‚¬ìš©
- í–¥í›„ persist middleware ì¶”ê°€ ê°€ëŠ¥ (AsyncStorage)

### ë‹¤ìŒ Phase

â†’ Phase 9: React Navigation ì„¤ì¹˜

---

## Phase 9: UI ì»´í¬ë„ŒíŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ (React Native Paper) âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì‹œì‘ì¼**: 2025-11-12
**ì™„ë£Œì¼**: 2025-11-12
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: medium

### ì‘ì—… ë‚´ìš©

- [x] React Native Paper ì„¤ì¹˜
- [x] React Native Vector Icons ì„¤ì¹˜
- [x] Material Design 3 í…Œë§ˆ ì„¤ì •
- [x] App.tsxì— PaperProvider ì„¤ì •
- [x] ë°ëª¨ HomeScreen ì‘ì„±
- [x] 8ê°œ ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸ ì‘ì„± ë° í†µê³¼

### ì§„í–‰ ë¡œê·¸

**2025-11-12 02:20**

- React Native Paper ì„¤ì¹˜ (17 packages)
- React Native Vector Icons ì„¤ì¹˜
- Material Design 3 UI ë¼ì´ë¸ŒëŸ¬ë¦¬

**2025-11-12 02:25**

- ì»¤ìŠ¤í…€ í…Œë§ˆ ì„¤ì • (src/config/theme.ts)
- Light & Dark í…Œë§ˆ ëª¨ë‘ ì§€ì›
- Material Design 3 ì»¬ëŸ¬ ì‹œìŠ¤í…œ ì ìš©

**2025-11-12 02:30**

- App.tsx ì—…ë°ì´íŠ¸
- PaperProvider ì¶”ê°€
- í…Œë§ˆ ìë™ ì „í™˜ (ë¼ì´íŠ¸/ë‹¤í¬ ëª¨ë“œ)

**2025-11-12 02:35**

- HomeScreen ë°ëª¨ ì‘ì„±
- ë‹¤ì–‘í•œ Paper ì»´í¬ë„ŒíŠ¸ showcasing:
  - Button (contained, outlined, text)
  - Card
  - TextInput
  - Chip
  - Surface
  - Divider

**2025-11-12 02:40**

- 8ê°œ ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸ ì‘ì„±
- ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼ âœ… (8/8)

### í…Œë§ˆ ì„¤ì •

#### ì»¬ëŸ¬ íŒ”ë ˆíŠ¸

**Light Theme**:
- Primary: #007AFF (iOS Blue)
- Secondary: #5856D6 (iOS Purple)
- Tertiary: #34C759 (iOS Green)
- Error: #FF3B30 (iOS Red)
- Background: #FFFFFF
- Surface: #F2F2F7

**Dark Theme**:
- Primary: #9ECAFF
- Secondary: #BDB3FF
- Tertiary: #90FF9C
- Error: #FFB4AB
- Background: #1A1C1E
- Surface: #1A1C1E

#### ì¶”ê°€ ë””ìì¸ í† í°

- **Spacing**: xs(4), sm(8), md(16), lg(24), xl(32), xxl(48)
- **Border Radius**: sm(4), md(8), lg(12), xl(16), full(9999)
- **Font Sizes**: xs(12) ~ xxxl(32)
- **Font Weights**: normal, medium, semibold, bold

### HomeScreen ì»´í¬ë„ŒíŠ¸

#### êµ¬í˜„ëœ ì„¹ì…˜

1. **í—¤ë”**
   - ì•± íƒ€ì´í‹€ (Display Small)
   - ì„œë¸Œíƒ€ì´í‹€

2. **Welcome ì¹´ë“œ**
   - ì†Œê°œ í…ìŠ¤íŠ¸
   - TextInput ë°ëª¨
   - Button variants (Contained, Outlined, Text)
   - Chip ì»´í¬ë„ŒíŠ¸ (Info, Success, Warning)

3. **Features ì¹´ë“œ**
   - ì•± ì£¼ìš” ê¸°ëŠ¥ ëª©ë¡
   - í–¥í›„ êµ¬í˜„ ì˜ˆì • ê¸°ëŠ¥ í‘œì‹œ

### í…ŒìŠ¤íŠ¸ ê²°ê³¼

âœ… **8/8 í…ŒìŠ¤íŠ¸ í†µê³¼**

```
Test Suites: 1 passed, 1 total
Tests:       8 passed, 8 total
Time:        6.032 s
```

#### HomeScreen í…ŒìŠ¤íŠ¸ (8ê°œ)

- âœ“ Render without crashing
- âœ“ Render app title
- âœ“ Render subtitle
- âœ“ Render Welcome card
- âœ“ Render text input section
- âœ“ Render buttons section
- âœ“ Render chips section
- âœ“ Render features card

### ì‚°ì¶œë¬¼

- **react-native-paper**: Material Design 3 ì»´í¬ë„ŒíŠ¸
- **react-native-vector-icons**: ì•„ì´ì½˜ ë¼ì´ë¸ŒëŸ¬ë¦¬
- **src/config/theme.ts**: ì»¤ìŠ¤í…€ í…Œë§ˆ ì„¤ì • (140ì¤„)
- **App.tsx**: PaperProvider ì ìš© (37ì¤„)
- **src/screens/HomeScreen.tsx**: ë°ëª¨ í™”ë©´ (140ì¤„)
- **__tests__/App.test.tsx**: App í…ŒìŠ¤íŠ¸ (25ì¤„)
- **src/screens/__tests__/HomeScreen.test.tsx**: HomeScreen í…ŒìŠ¤íŠ¸ (60ì¤„)

### React Native Paper ì¥ì 

1. **Material Design 3**: ìµœì‹  ë””ìì¸ ì‹œìŠ¤í…œ
2. **í’ë¶€í•œ ì»´í¬ë„ŒíŠ¸**: 30+ ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥
3. **í…Œë§ˆ ì§€ì›**: ë¼ì´íŠ¸/ë‹¤í¬ ëª¨ë“œ ìë™ ì „í™˜
4. **ì ‘ê·¼ì„±**: WCAG ê°€ì´ë“œë¼ì¸ ì¤€ìˆ˜
5. **TypeScript ì§€ì›**: ì™„ë²½í•œ íƒ€ì… ì•ˆì „ì„±
6. **ë°˜ì‘í˜•**: ë‹¤ì–‘í•œ í™”ë©´ í¬ê¸° ì§€ì›

### ì°¸ê³ ì‚¬í•­

- Vector Icons deprecation ê²½ê³ ëŠ” í–¥í›„ ë§ˆì´ê·¸ë ˆì´ì…˜ ì˜ˆì •
- í…Œë§ˆëŠ” useColorSchemeìœ¼ë¡œ ìë™ ì „í™˜
- Material Design 3 ê°€ì´ë“œë¼ì¸ ì¤€ìˆ˜
- ëª¨ë“  ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

### ë‹¤ìŒ Phase

â†’ Phase 10: í”„ë¡œì íŠ¸ ë¬¸ì„œí™” ì™„ì„±

---

## Phase 10: ìœ í‹¸ë¦¬í‹° ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ âœ…
## Phase 11: React Native ì„¼ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ âœ…
## Phase 12: ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ ë° ë²„í¼ë§ ì‹œìŠ¤í…œ âœ…
## Phase 13: WatermelonDB ë¡œì»¬ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • âœ…
## Phase 14: ì„¼ì„œ ë°ì´í„° ì €ì¥ í†µí•© âœ…
## Phase 15: Recording UI í™”ë©´ êµ¬í˜„ âœ…
## Phase 16: ê¶Œí•œ ì²˜ë¦¬ ë° ì‚¬ìš©ì ê²½í—˜ ê°œì„  âœ…

**ì™„ë£Œ ì‹œê°„**: 2025-11-12 07:30  
**ì†Œìš” ì‹œê°„**: 0.5ì‹œê°„

### ì£¼ìš” ì„±ê³¼

**1. TypeScript ë°ì½”ë ˆì´í„° ì„¤ì •** (tsconfig.json)

WatermelonDB ëª¨ë¸ ë°ì½”ë ˆì´í„° ì§€ì›ì„ ìœ„í•œ ì„¤ì • ì¶”ê°€

```json
{
  "experimentalDecorators": true,
  "emitDecoratorMetadata": true,
  "strictPropertyInitialization": false
}
```

**2. usePermissions Hook êµ¬í˜„** (150ì¤„)

Android/iOS ì„¼ì„œ ê¶Œí•œ ê´€ë¦¬ Hook

```typescript
export function usePermissions(): UsePermissionsResult {
  permissions: PermissionsState;
  isLoading: boolean;
  requestPermissions(): Promise<boolean>;
  openSettings(): void;
}
```

**ê¸°ëŠ¥**:
- âœ… ìœ„ì¹˜ ê¶Œí•œ í™•ì¸ (Android)
- ğŸ¤ ë§ˆì´í¬ ê¶Œí•œ í™•ì¸ (Android)
- ğŸ”„ ê¶Œí•œ ìš”ì²­ (PermissionsAndroid.requestMultiple)
- âš™ï¸ ì•± ì„¤ì • ì—´ê¸° (Linking.openSettings)
- ğŸ“± í”Œë«í¼ë³„ ì²˜ë¦¬ (Android/iOS)

**ê¶Œí•œ ìƒíƒœ**:
- `granted`: í—ˆìš©ë¨
- `denied`: ê±°ë¶€ë¨
- `blocked`: ì°¨ë‹¨ë¨
- `unavailable`: í™•ì¸ ë¶ˆê°€

**3. RecordingScreen ê°œì„ ** (430ì¤„)

**ì¶”ê°€ëœ ê¸°ëŠ¥**:

**ê¶Œí•œ ë°°ë„ˆ** (Banner):
```
âš ï¸ GPS ì„¼ì„œë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ìœ„ì¹˜ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.
[ê¶Œí•œ ìš”ì²­]
```

**ë¡œë”© ìƒíƒœ**:
- `isStarting`: ë…¹ìŒ ì‹œì‘ ì¤‘
- `permissionsLoading`: ê¶Œí•œ ìš”ì²­ ì¤‘
- ë²„íŠ¼ì— ë¡œë”© ì¸ë””ì¼€ì´í„° í‘œì‹œ
- "ì‹œì‘ ì¤‘..." í…ìŠ¤íŠ¸ í‘œì‹œ

**ì„¼ì„œ ì´ˆê¸°í™” í‘œì‹œ**:
```
ğŸ”„ ì„¼ì„œ ì´ˆê¸°í™” ì¤‘...
(ActivityIndicator)
```

**ë°ì´í„° ëŒ€ê¸° í‘œì‹œ**:
```
accelerometer
ë°ì´í„° ëŒ€ê¸° ì¤‘...
```

**ê¶Œí•œ í”Œë¡œìš°**:
1. GPS ì²´í¬ë°•ìŠ¤ ì„ íƒ
2. ê¶Œí•œ ë°°ë„ˆ í‘œì‹œ
3. "ê¶Œí•œ ìš”ì²­" ë²„íŠ¼ í´ë¦­
4. Android ê¶Œí•œ ë‹¤ì´ì–¼ë¡œê·¸
5. í—ˆìš©/ê±°ë¶€ ì²˜ë¦¬
6. ê±°ë¶€ ì‹œ ì„¤ì • ì—´ê¸° ì œì•ˆ

**4. ê°œì„ ëœ ì‚¬ìš©ì ê²½í—˜**

**ë…¹ìŒ ì‹œì‘**:
```
1. ì„¼ì„œ ì„ íƒ
2. GPS ì„ íƒ ì‹œ â†’ ê¶Œí•œ ë°°ë„ˆ í‘œì‹œ
3. "ë…¹ìŒ ì‹œì‘" í´ë¦­
4. ê¶Œí•œ í™•ì¸ â†’ í•„ìš” ì‹œ ìš”ì²­
5. ë²„íŠ¼ ë¡œë”© ìƒíƒœ: "ì‹œì‘ ì¤‘..."
6. ì„¼ì„œ ì´ˆê¸°í™” í‘œì‹œ
7. ì‹¤ì‹œê°„ ë°ì´í„° í‘œì‹œ ì‹œì‘
```

**ì—ëŸ¬ ì²˜ë¦¬**:
- ê¶Œí•œ ê±°ë¶€ â†’ ì„¤ì • ì—´ê¸° ì œì•ˆ
- ì„¼ì„œ ì´ˆê¸°í™” ì‹¤íŒ¨ â†’ ì—ëŸ¬ ë©”ì‹œì§€
- ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¥˜ â†’ ì½˜ì†” ë¡œê·¸

**ë¡œë”© í”¼ë“œë°±**:
- ê¶Œí•œ ìš”ì²­ ì¤‘: ë²„íŠ¼ ë¡œë”© (ë°°ë„ˆ)
- ë…¹ìŒ ì‹œì‘ ì¤‘: ë²„íŠ¼ ë¡œë”© + í…ìŠ¤íŠ¸ ë³€ê²½
- ì„¼ì„œ ì´ˆê¸°í™” ì¤‘: ActivityIndicator
- ë°ì´í„° ëŒ€ê¸° ì¤‘: "ë°ì´í„° ëŒ€ê¸° ì¤‘..." í…ìŠ¤íŠ¸

### ì—…ë°ì´íŠ¸ëœ íŒŒì¼

- **tsconfig.json**: ë°ì½”ë ˆì´í„° ì„¤ì • ì¶”ê°€
- **usePermissions.ts** (150ì¤„): ê¶Œí•œ ê´€ë¦¬ Hook
- **hooks/index.ts**: usePermissions export ì¶”ê°€
- **RecordingScreen.tsx** (430ì¤„): ê¶Œí•œ/ë¡œë”© í†µí•©

### ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤

**ì‹œë‚˜ë¦¬ì˜¤ 1: GPS ì—†ì´ ë…¹ìŒ**
1. ê°€ì†ë„ê³„, ìì´ë¡œìŠ¤ì½”í”„ ì„ íƒ
2. "ë…¹ìŒ ì‹œì‘" â†’ ì¦‰ì‹œ ì‹œì‘
3. ê¶Œí•œ ìš”ì²­ ì—†ìŒ

**ì‹œë‚˜ë¦¬ì˜¤ 2: GPS í¬í•¨ ë…¹ìŒ (ê¶Œí•œ ì—†ìŒ)**
1. GPS ì²´í¬ â†’ ë°°ë„ˆ í‘œì‹œ
2. "ê¶Œí•œ ìš”ì²­" í´ë¦­
3. Android ê¶Œí•œ ë‹¤ì´ì–¼ë¡œê·¸
4. í—ˆìš© â†’ "ë…¹ìŒ ì‹œì‘" í™œì„±í™”
5. "ë…¹ìŒ ì‹œì‘" â†’ GPS ë°ì´í„° ìˆ˜ì§‘

**ì‹œë‚˜ë¦¬ì˜¤ 3: GPS í¬í•¨ ë…¹ìŒ (ê¶Œí•œ ê±°ë¶€)**
1. GPS ì²´í¬ â†’ ë°°ë„ˆ í‘œì‹œ
2. "ê¶Œí•œ ìš”ì²­" í´ë¦­
3. ê±°ë¶€ â†’ "ì„¤ì • ì—´ê¸°" ì•Œë¦¼
4. ì„¤ì •ì—ì„œ ê¶Œí•œ í—ˆìš©
5. ì•± ë³µê·€ â†’ ë…¹ìŒ ê°€ëŠ¥

### ë‹¤ìŒ ë‹¨ê³„ (Phase 17)
- ë…¹ìŒ íˆìŠ¤í† ë¦¬ í™”ë©´ êµ¬í˜„ âœ…
- ì„¸ì…˜ ëª©ë¡ í‘œì‹œ âœ…
- React Navigation ì„¤ì • âœ…
- Bottom Tabs ë„¤ë¹„ê²Œì´ì…˜ âœ…

---

## Phase 17: History Screen ë° ë„¤ë¹„ê²Œì´ì…˜ êµ¬í˜„ âœ…

**ì™„ë£Œ ì‹œê°„**: 2025-11-12 08:00
**ì†Œìš” ì‹œê°„**: 0.8ì‹œê°„

### ì£¼ìš” ì„±ê³¼

**1. React Navigation ì„¤ì¹˜**

Bottom Tabs ë„¤ë¹„ê²Œì´ì…˜ì„ ìœ„í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜:

```bash
npm install @react-navigation/native @react-navigation/bottom-tabs
npm install react-native-safe-area-context react-native-screens
npm install --save-dev @types/react-native-vector-icons
```

**2. HistoryScreen êµ¬í˜„** (279ì¤„)

ë…¹ìŒëœ ì„¸ì…˜ ëª©ë¡ì„ í‘œì‹œí•˜ëŠ” í™”ë©´

```typescript
export function HistoryScreen() {
  const [sessions, setSessions] = useState<RecordingSession[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  const [isRefreshing, setIsRefreshing] = useState(false);

  const loadSessions = useCallback(async () => {
    const allSessions = await sessionRepo.findAll();
    setSessions(allSessions);
  }, [sessionRepo]);
}
```

**ì£¼ìš” ê¸°ëŠ¥**:
- ğŸ“‹ ì„¸ì…˜ ëª©ë¡ í‘œì‹œ (FlatList)
- ğŸ”„ Pull-to-refresh ìƒˆë¡œê³ ì¹¨
- ğŸ“Š ì„¸ì…˜ í†µê³„ (ì†Œìš” ì‹œê°„, ë°ì´í„° ìˆ˜, ìƒ˜í”Œ ë ˆì´íŠ¸)
- ğŸ·ï¸ í™œì„± ì„¸ì…˜ í‘œì‹œ (ğŸ”´ ë…¹ìŒ ì¤‘)
- ğŸ“ ì„¸ì…˜ ë©”ëª¨ í‘œì‹œ
- â˜ï¸ ì—…ë¡œë“œ ìƒíƒœ í‘œì‹œ
- âš¡ FAB ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼

**ì„¸ì…˜ ì¹´ë“œ ì •ë³´**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì„¸ì…˜ ABC123XY   [ğŸ”´ ë…¹ìŒ ì¤‘] â”‚
â”‚ 2025-11-12 08:00:00         â”‚
â”‚                             â”‚
â”‚ ì†Œìš” ì‹œê°„    ë°ì´í„° ìˆ˜   ìƒ˜í”Œ  â”‚
â”‚  00:15:30    1,250     100Hz â”‚
â”‚                             â”‚
â”‚ ì„¼ì„œ: [ACC] [GYR] [MAG]     â”‚
â”‚                             â”‚
â”‚ ë©”ëª¨: ê±·ê¸° í…ŒìŠ¤íŠ¸             â”‚
â”‚ [â˜ï¸ ì—…ë¡œë“œ ì™„ë£Œ]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**3. App.tsx ë„¤ë¹„ê²Œì´ì…˜ êµ¬ì¡° ì—…ë°ì´íŠ¸** (73ì¤„)

Bottom Tabs ë„¤ë¹„ê²Œì´ì…˜ ì„¤ì •:

```typescript
<NavigationContainer>
  <Tab.Navigator>
    <Tab.Screen
      name="Recording"
      component={RecordingScreen}
      options={{
        title: 'ë…¹ìŒ',
        tabBarIcon: ({color, size}) => (
          <MaterialCommunityIcons name="record-circle" color={color} size={size} />
        ),
      }}
    />
    <Tab.Screen
      name="History"
      component={HistoryScreen}
      options={{
        title: 'ê¸°ë¡',
        tabBarIcon: ({color, size}) => (
          <MaterialCommunityIcons name="history" color={color} size={size} />
        ),
      }}
    />
  </Tab.Navigator>
</NavigationContainer>
```

**ë„¤ë¹„ê²Œì´ì…˜ ê¸°ëŠ¥**:
- ğŸ”„ Bottom Tabs: ë…¹ìŒ â†”ï¸ ê¸°ë¡ í™”ë©´ ì „í™˜
- ğŸ¨ Material Design 3 í…Œë§ˆ ì ìš©
- ğŸ  Header ìŠ¤íƒ€ì¼ë§ (Primary ìƒ‰ìƒ)
- ğŸ“± Tab Bar ì•„ì´ì½˜ (Material Community Icons)

**4. Android MainActivity ì—…ë°ì´íŠ¸**

react-native-screens ì§€ì› ì¶”ê°€:

```kotlin
override fun onCreate(savedInstanceState: Bundle?) {
  super.onCreate(null)
}
```

**5. TypeScript ê²½ë¡œ ë³„ì¹­ ê°œì„ **

tsconfig.json ë° babel.config.jsì— @screens ë³„ì¹­ ì¶”ê°€:

```json
{
  "paths": {
    "@screens": ["src/screens"],
    "@screens/*": ["src/screens/*"]
  }
}
```

**6. usePermissions íƒ€ì… ì•ˆì „ì„± ê°œì„ **

PermissionsAndroid ì¸ë±ìŠ¤ ì„œëª… ì²˜ë¦¬:

```typescript
// Before:
PermissionsAndroid.PERMISSIONS.ACCESS_FINE_LOCATION

// After:
PermissionsAndroid.PERMISSIONS['ACCESS_FINE_LOCATION']
```

### í™”ë©´ êµ¬ì¡°

```
KooDTX App
â”œâ”€â”€ ğŸ“± Tab Navigator (Bottom)
â”‚   â”œâ”€â”€ ğŸ”´ Recording (RecordingScreen)
â”‚   â”‚   â”œâ”€â”€ ì„¼ì„œ ì„ íƒ
â”‚   â”‚   â”œâ”€â”€ ë…¹ìŒ ì‹œì‘/ì¤‘ì§€
â”‚   â”‚   â”œâ”€â”€ ì‹¤ì‹œê°„ ë°ì´í„° í‘œì‹œ
â”‚   â”‚   â””â”€â”€ ê¶Œí•œ ê´€ë¦¬
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“‹ History (HistoryScreen)
â”‚       â”œâ”€â”€ ì„¸ì…˜ ëª©ë¡
â”‚       â”œâ”€â”€ Pull-to-refresh
â”‚       â”œâ”€â”€ ì„¸ì…˜ í†µê³„
â”‚       â””â”€â”€ FAB ìƒˆë¡œê³ ì¹¨
```

### ì—…ë°ì´íŠ¸ëœ íŒŒì¼

- **App.tsx** (73ì¤„): Bottom Tabs ë„¤ë¹„ê²Œì´ì…˜
- **src/screens/HistoryScreen.tsx** (279ì¤„): íˆìŠ¤í† ë¦¬ í™”ë©´
- **src/screens/index.ts**: í™”ë©´ barrel export
- **android/MainActivity.kt**: react-native-screens ì§€ì›
- **tsconfig.json**: @screens ê²½ë¡œ ë³„ì¹­ ì¶”ê°€
- **src/hooks/usePermissions.ts**: ì¸ë±ìŠ¤ ì„œëª… ì²˜ë¦¬
- **package.json**: React Navigation ì˜ì¡´ì„± ì¶”ê°€

### ì‚¬ìš©ì í”Œë¡œìš°

**í”Œë¡œìš° 1: ë…¹ìŒ â†’ ê¸°ë¡ í™•ì¸**
1. Recording íƒ­ì—ì„œ ì„¼ì„œ ë°ì´í„° ë…¹ìŒ
2. "ë…¹ìŒ ì¤‘ì§€" í´ë¦­
3. History íƒ­ìœ¼ë¡œ ì „í™˜
4. ë°©ê¸ˆ ë…¹ìŒí•œ ì„¸ì…˜ í™•ì¸

**í”Œë¡œìš° 2: íˆìŠ¤í† ë¦¬ ìƒˆë¡œê³ ì¹¨**
1. History íƒ­ ì„ íƒ
2. ì•„ë˜ë¡œ ë‹¹ê²¨ì„œ ìƒˆë¡œê³ ì¹¨ (Pull-to-refresh)
3. ë˜ëŠ” FAB "ìƒˆë¡œê³ ì¹¨" ë²„íŠ¼ í´ë¦­
4. ìµœì‹  ì„¸ì…˜ ëª©ë¡ ë¡œë“œ

**í”Œë¡œìš° 3: ë¹ˆ íˆìŠ¤í† ë¦¬**
1. History íƒ­ ì„ íƒ
2. ë…¹ìŒëœ ì„¸ì…˜ ì—†ìŒ
3. "ë…¹ìŒëœ ì„¸ì…˜ì´ ì—†ìŠµë‹ˆë‹¤" ë©”ì‹œì§€
4. "ìƒˆë¡œìš´ ì„¼ì„œ ë°ì´í„° ë…¹ìŒì„ ì‹œì‘í•˜ì„¸ìš”" ì•ˆë‚´

### ë‹¤ìŒ ë‹¨ê³„ (Phase 18)
- ì„¸ì…˜ ìƒì„¸ ì •ë³´ í™”ë©´ âœ…
- ì„¼ì„œ ë°ì´í„° í†µê³„ í‘œì‹œ âœ…
- ë°ì´í„° ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥ (CSV, JSON) âœ…
- ì„¸ì…˜ ì‚­ì œ ê¸°ëŠ¥ âœ…

---

## Phase 18: ì„¸ì…˜ ìƒì„¸ í™”ë©´ ë° ë°ì´í„° ë‚´ë³´ë‚´ê¸° âœ…

**ì™„ë£Œ ì‹œê°„**: 2025-11-12 09:00
**ì†Œìš” ì‹œê°„**: 1.2ì‹œê°„

### ì£¼ìš” ì„±ê³¼

**1. SessionDetailScreen êµ¬í˜„** (580ì¤„)

ì„¸ì…˜ì˜ ìƒì„¸ ì •ë³´ì™€ ì„¼ì„œ ë°ì´í„° í†µê³„ë¥¼ í‘œì‹œí•˜ëŠ” í™”ë©´

```typescript
export function SessionDetailScreen({route, navigation}: Props) {
  const {sessionId} = route.params;
  const [session, setSession] = useState<RecordingSession | null>(null);
  const [sensorData, setSensorData] = useState<SensorDataRecord[]>([]);
  const [sensorStats, setSensorStats] = useState<Record<SensorType, SensorStats>>({});

  // Load session data and calculate statistics
  // Export to CSV/JSON
  // Delete session
}
```

**ì£¼ìš” ê¸°ëŠ¥**:
- ğŸ“Š ì„¸ì…˜ ì •ë³´ í‘œì‹œ (ID, ì‹œê°„, ì„¼ì„œ, ë©”ëª¨)
- ğŸ“ˆ ì„¼ì„œë³„ ë°ì´í„° í†µê³„ (ë°ì´í„° ìˆ˜, í‰ê· ê°’)
- ğŸ“¤ CSV ë‚´ë³´ë‚´ê¸°
- ğŸ“¤ JSON ë‚´ë³´ë‚´ê¸°
- ğŸ—‘ï¸ ì„¸ì…˜ ì‚­ì œ (í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸)
- ğŸ”„ Loading ìƒíƒœ í‘œì‹œ

**ì„¸ì…˜ ì •ë³´ ì¹´ë“œ**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì„¸ì…˜ ì •ë³´          [ğŸ”´ ë…¹ìŒ ì¤‘]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì„¸ì…˜ ID: abc123...               â”‚
â”‚ ì‹œì‘ ì‹œê°„: 2025-11-12 08:00:00  â”‚
â”‚ ì¢…ë£Œ ì‹œê°„: 2025-11-12 08:15:30  â”‚
â”‚ ì†Œìš” ì‹œê°„: 00:15:30             â”‚
â”‚ ìƒ˜í”Œ ë ˆì´íŠ¸: 100Hz              â”‚
â”‚ í™œì„± ì„¼ì„œ: [ACC] [GYR] [MAG]    â”‚
â”‚ ë©”ëª¨: ê±·ê¸° í…ŒìŠ¤íŠ¸                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì„¼ì„œ í†µê³„ ì¹´ë“œ** (ê° ì„¼ì„œë³„):
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ê°€ì†ë„ê³„                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ë°ì´í„° ìˆ˜: 1,250                 â”‚
â”‚ í‰ê·  X: 0.1234                  â”‚
â”‚ í‰ê·  Y: -0.4567                 â”‚
â”‚ í‰ê·  Z: 9.7890                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GPS                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ë°ì´í„° ìˆ˜: 125                   â”‚
â”‚ í‰ê·  ìœ„ë„: 37.123456Â°           â”‚
â”‚ í‰ê·  ê²½ë„: 127.123456Â°          â”‚
â”‚ í‰ê·  ê³ ë„: 123.45m              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**2. CSV ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥**

react-native-fsì™€ react-native-shareë¥¼ ì‚¬ìš©í•œ íŒŒì¼ ë‚´ë³´ë‚´ê¸°

```typescript
const exportToCSV = useCallback(async () => {
  // Create CSV content
  const headers = ['timestamp', 'sensorType', 'x', 'y', 'z', ...];
  const csvContent = headers.join(',') + '\n' +
    sensorData.map(record => [...].join(',')).join('\n');

  // Write to file
  const fileName = `session_${sessionId}_${Date.now()}.csv`;
  const filePath = `${RNFS.DocumentDirectoryPath}/${fileName}`;
  await RNFS.writeFile(filePath, csvContent, 'utf8');

  // Share file
  await Share.open({
    url: `file://${filePath}`,
    type: 'text/csv',
  });
}, [session, sensorData, sessionId]);
```

**CSV í˜•ì‹**:
```csv
timestamp,sensorType,x,y,z,latitude,longitude,altitude,accuracy
1731394800000,accelerometer,0.123,-0.456,9.789,,,,
1731394800100,accelerometer,0.124,-0.455,9.788,,,,
1731394800000,gps,,,37.123456,127.123456,123.45,10.5
```

**3. JSON ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥**

ì„¸ì…˜ ì •ë³´, ì„¼ì„œ ë°ì´í„°, í†µê³„ë¥¼ í¬í•¨í•œ JSON íŒŒì¼

```typescript
const exportToJSON = useCallback(async () => {
  const exportData = {
    session: {
      sessionId: session.sessionId,
      startTime: session.startTime,
      endTime: session.endTime,
      enabledSensors: session.enabledSensors,
      // ...
    },
    data: sensorData.map(record => ({
      timestamp: record.timestamp,
      sensorType: record.sensorType,
      x: record.x,
      // ...
    })),
    statistics: sensorStats,
  };

  await RNFS.writeFile(filePath, JSON.stringify(exportData, null, 2), 'utf8');
  await Share.open({url: `file://${filePath}`, type: 'application/json'});
}, [session, sensorData, sensorStats]);
```

**JSON í˜•ì‹**:
```json
{
  "session": {
    "sessionId": "session-1731394800000-abc123",
    "startTime": 1731394800000,
    "endTime": 1731395730000,
    "enabledSensors": ["accelerometer", "gyroscope", "magnetometer"]
  },
  "data": [
    {
      "timestamp": 1731394800000,
      "sensorType": "accelerometer",
      "x": 0.123,
      "y": -0.456,
      "z": 9.789
    }
  ],
  "statistics": {
    "accelerometer": {
      "count": 1250,
      "avgX": 0.1234,
      "avgY": -0.4567,
      "avgZ": 9.7890
    }
  }
}
```

**4. ì„¸ì…˜ ì‚­ì œ ê¸°ëŠ¥**

í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ì™€ í•¨ê»˜ ì„¸ì…˜ ë° ì„¼ì„œ ë°ì´í„° ì‚­ì œ

```typescript
const handleDelete = useCallback(async () => {
  setDeleteDialogVisible(false);
  try {
    // Delete sensor data first
    await dataRepo.deleteBySession(sessionId);
    // Delete session
    await sessionRepo.delete(sessionId);

    Alert.alert('ì™„ë£Œ', 'ì„¸ì…˜ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', [
      {text: 'í™•ì¸', onPress: () => navigation.goBack()}
    ]);
  } catch (error) {
    Alert.alert('ì˜¤ë¥˜', 'ì„¸ì…˜ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
  }
}, [sessionId, dataRepo, sessionRepo, navigation]);
```

**ì‚­ì œ í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì„¸ì…˜ ì‚­ì œ                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì´ ì„¸ì…˜ê³¼ ëª¨ë“  ì„¼ì„œ ë°ì´í„°ë¥¼    â”‚
â”‚ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?              â”‚
â”‚ ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.  â”‚
â”‚                                â”‚
â”‚         [ì·¨ì†Œ]    [ì‚­ì œ]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**5. HistoryStack Navigator êµ¬í˜„** (53ì¤„)

History íƒ­ ë‚´ì˜ Stack Navigator

```typescript
export function HistoryStack() {
  return (
    <Stack.Navigator>
      <Stack.Screen
        name="HistoryList"
        component={HistoryScreen}
        options={{title: 'ê¸°ë¡', headerShown: false}}
      />
      <Stack.Screen
        name="SessionDetail"
        component={SessionDetailScreen}
        options={{title: 'ì„¸ì…˜ ìƒì„¸'}}
      />
    </Stack.Navigator>
  );
}
```

**ë„¤ë¹„ê²Œì´ì…˜ í”Œë¡œìš°**:
```
History Tab
â”œâ”€â”€ HistoryList (HistoryScreen)
â”‚   â””â”€â”€ [ì„¸ì…˜ ì¹´ë“œ í´ë¦­]
â”‚       â†“
â””â”€â”€ SessionDetail (SessionDetailScreen)
    â”œâ”€â”€ CSV ë‚´ë³´ë‚´ê¸°
    â”œâ”€â”€ JSON ë‚´ë³´ë‚´ê¸°
    â”œâ”€â”€ ì„¸ì…˜ ì‚­ì œ
    â””â”€â”€ [ë’¤ë¡œê°€ê¸°] â†’ HistoryList
```

**6. HistoryScreen ì—…ë°ì´íŠ¸**

ì„¸ì…˜ ì¹´ë“œ í´ë¦­ ì‹œ ìƒì„¸ í™”ë©´ ì´ë™

```typescript
export function HistoryScreen({navigation}: Props) {
  const renderSessionItem = useCallback(
    ({item}: {item: RecordingSession}) => {
      return (
        <TouchableOpacity
          onPress={() =>
            navigation.navigate('SessionDetail', {sessionId: item.sessionId})
          }>
          <Card style={styles.sessionCard}>
            {/* ... */}
          </Card>
        </TouchableOpacity>
      );
    },
    [navigation],
  );
}
```

**7. ì˜ì¡´ì„± ì„¤ì¹˜**

```bash
npm install @react-navigation/native-stack
npm install react-native-fs react-native-share
```

- **@react-navigation/native-stack**: Native Stack Navigator
- **react-native-fs**: íŒŒì¼ ì‹œìŠ¤í…œ ì ‘ê·¼
- **react-native-share**: íŒŒì¼ ê³µìœ  ê¸°ëŠ¥

### í™”ë©´ êµ¬ì¡° ì—…ë°ì´íŠ¸

```
KooDTX App
â”œâ”€â”€ ğŸ“± Tab Navigator (Bottom)
â”‚   â”œâ”€â”€ ğŸ”´ Recording (RecordingScreen)
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“‹ History (HistoryStack)
â”‚       â”œâ”€â”€ HistoryList (HistoryScreen)
â”‚       â”‚   â””â”€â”€ [ì„¸ì…˜ ì¹´ë“œ í´ë¦­]
â”‚       â”‚       â†“
â”‚       â””â”€â”€ SessionDetail (SessionDetailScreen)
â”‚           â”œâ”€â”€ ì„¸ì…˜ ì •ë³´
â”‚           â”œâ”€â”€ ì„¼ì„œ í†µê³„
â”‚           â”œâ”€â”€ CSV ë‚´ë³´ë‚´ê¸°
â”‚           â”œâ”€â”€ JSON ë‚´ë³´ë‚´ê¸°
â”‚           â””â”€â”€ ì„¸ì…˜ ì‚­ì œ
```

### ì—…ë°ì´íŠ¸ëœ íŒŒì¼

- **src/screens/SessionDetailScreen.tsx** (580ì¤„): ì„¸ì…˜ ìƒì„¸ í™”ë©´
- **src/navigation/HistoryStack.tsx** (53ì¤„): History Stack Navigator
- **src/navigation/index.ts**: Navigation barrel export
- **src/screens/HistoryScreen.tsx**: ë„¤ë¹„ê²Œì´ì…˜ ì—°ê²°
- **src/screens/index.ts**: SessionDetailScreen export
- **App.tsx**: HistoryStack ì‚¬ìš©
- **package.json**: ìƒˆ ì˜ì¡´ì„± ì¶”ê°€

### ì‚¬ìš©ì í”Œë¡œìš°

**í”Œë¡œìš° 1: ì„¸ì…˜ ìƒì„¸ ì •ë³´ ë³´ê¸°**
1. History íƒ­ ì„ íƒ
2. ì„¸ì…˜ ì¹´ë“œ í´ë¦­
3. ì„¸ì…˜ ìƒì„¸ í™”ë©´ í‘œì‹œ
4. ì„¸ì…˜ ì •ë³´ ë° ì„¼ì„œ í†µê³„ í™•ì¸

**í”Œë¡œìš° 2: ë°ì´í„° ë‚´ë³´ë‚´ê¸° (CSV)**
1. ì„¸ì…˜ ìƒì„¸ í™”ë©´
2. "CSVë¡œ ë‚´ë³´ë‚´ê¸°" ë²„íŠ¼ í´ë¦­
3. íŒŒì¼ ìƒì„± ë° ê³µìœ  ì‹œíŠ¸ í‘œì‹œ
4. ê³µìœ  ëŒ€ìƒ ì„ íƒ (ì´ë©”ì¼, ë“œë¼ì´ë¸Œ ë“±)

**í”Œë¡œìš° 3: ë°ì´í„° ë‚´ë³´ë‚´ê¸° (JSON)**
1. ì„¸ì…˜ ìƒì„¸ í™”ë©´
2. "JSONìœ¼ë¡œ ë‚´ë³´ë‚´ê¸°" ë²„íŠ¼ í´ë¦­
3. íŒŒì¼ ìƒì„± ë° ê³µìœ  ì‹œíŠ¸ í‘œì‹œ
4. ê³µìœ  ëŒ€ìƒ ì„ íƒ

**í”Œë¡œìš° 4: ì„¸ì…˜ ì‚­ì œ**
1. ì„¸ì…˜ ìƒì„¸ í™”ë©´
2. "ì„¸ì…˜ ì‚­ì œ" ë²„íŠ¼ í´ë¦­
3. í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ
4. "ì‚­ì œ" ì„ íƒ
5. ì„¸ì…˜ ë° ë°ì´í„° ì‚­ì œ
6. HistoryListë¡œ ìë™ ì´ë™

### ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

**ì„¼ì„œ í†µê³„ ê³„ì‚°**:
```typescript
// 3-axis sensors (Accelerometer, Gyroscope, Magnetometer)
const sumX = records.reduce((sum, r) => sum + (r.x || 0), 0);
const avgX = sumX / count;

// GPS
const sumLat = records.reduce((sum, r) => sum + (r.latitude || 0), 0);
const avgLatitude = sumLat / count;
```

**íŒŒì¼ ê²½ë¡œ**:
- Android: `/data/data/com.koodtxtemp/files/session_*.csv`
- iOS: `~/Library/Application Support/session_*.json`

**ì—ëŸ¬ ì²˜ë¦¬**:
- ì„¸ì…˜ ì—†ìŒ: ë’¤ë¡œ ì´ë™
- ë‚´ë³´ë‚´ê¸° ì‹¤íŒ¨: Alert í‘œì‹œ
- ì‚­ì œ ì‹¤íŒ¨: Alert í‘œì‹œ
- ì‚¬ìš©ì ì·¨ì†Œ: ì¡°ìš©íˆ ë¬´ì‹œ

### ë‹¤ìŒ ë‹¨ê³„ (Phase 19)
- ì„¼ì„œ ë°ì´í„° ì°¨íŠ¸ ì‹œê°í™” (Line Chart) âœ…
- ì„¼ì„œë³„ ì°¨íŠ¸ í† ê¸€ âœ…
- ì°¨íŠ¸ ê°€ë¡œ ìŠ¤í¬ë¡¤ âœ…
- ë°ì´í„° ìƒ˜í”Œë§ (ì„±ëŠ¥ ìµœì í™”) âœ…

---

## Phase 19: ì„¼ì„œ ë°ì´í„° ì°¨íŠ¸ ì‹œê°í™” âœ…

**ì™„ë£Œ ì‹œê°„**: 2025-11-12 10:00
**ì†Œìš” ì‹œê°„**: 1.0ì‹œê°„

### ì£¼ìš” ì„±ê³¼

**1. ChartScreen êµ¬í˜„** (415ì¤„)

ì„¼ì„œ ë°ì´í„°ë¥¼ Line Chartë¡œ ì‹œê°í™”í•˜ëŠ” í™”ë©´

```typescript
export function ChartScreen({route}: Props) {
  const {sessionId} = route.params;
  const [sensorData, setSensorData] = useState<SensorDataRecord[]>([]);
  const [selectedSensor, setSelectedSensor] = useState<SensorType>(SensorType.ACCELEROMETER);
  const [availableSensors, setAvailableSensors] = useState<SensorType[]>([]);

  // Load sensor data, sample data, render charts
}
```

**ì£¼ìš” ê¸°ëŠ¥**:
- ğŸ“Š Line Chartë¡œ ì„¼ì„œ ë°ì´í„° ì‹œê°í™”
- ğŸ”„ ì„¼ì„œë³„ í† ê¸€ (SegmentedButtons)
- ğŸ“ ë°ì´í„° ìƒ˜í”Œë§ (ìµœëŒ€ 100 í¬ì¸íŠ¸)
- â†”ï¸ ê°€ë¡œ ìŠ¤í¬ë¡¤ (ê¸´ ë°ì´í„°)
- ğŸ¨ ìƒ‰ìƒ êµ¬ë¶„ (X: ë¹¨ê°•, Y: ì´ˆë¡, Z: íŒŒë‘)
- ğŸ“‘ ë²”ë¡€ í‘œì‹œ
- ğŸ“ˆ 3ì¶• ì„¼ì„œ (ê°€ì†ë„ê³„, ìì´ë¡œìŠ¤ì½”í”„, ìê¸°ê³„)
- ğŸŒ GPS (ìœ„ë„, ê²½ë„, ê³ ë„ ë³„ë„ ì°¨íŠ¸)

**2. ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜**

```bash
npm install react-native-svg react-native-chart-kit
```

- **react-native-svg**: SVG ë Œë”ë§
- **react-native-chart-kit**: Line Chart ì»´í¬ë„ŒíŠ¸

**3. ì„¼ì„œë³„ ì°¨íŠ¸ êµ¬ì„±**

**3ì¶• ì„¼ì„œ (Accelerometer, Gyroscope, Magnetometer)**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ê°€ì†ë„ê³„ - 3ì¶• ë°ì´í„°           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Xì¶•] [Yì¶•] [Zì¶•]              â”‚
â”‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  ğŸ“ˆ Line Chart  â”‚           â”‚
â”‚  â”‚  (X, Y, Z)      â”‚           â”‚
â”‚  â”‚  Time â†’         â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                â”‚
â”‚ 100ê°œ ë°ì´í„° í¬ì¸íŠ¸ í‘œì‹œ        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**GPS ì„¼ì„œ**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GPS - ìœ„ë„                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ˆ Line Chart (latitude)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GPS - ê²½ë„                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ˆ Line Chart (longitude)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GPS - ê³ ë„                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ˆ Line Chart (altitude)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**4. ì„¼ì„œ ì„ íƒ UI**

SegmentedButtonsë¡œ ì„¼ì„œ ì „í™˜:

```typescript
<SegmentedButtons
  value={selectedSensor}
  onValueChange={value => setSelectedSensor(value as SensorType)}
  buttons={[
    {value: SensorType.ACCELEROMETER, label: 'ê°€ì†ë„ê³„'},
    {value: SensorType.GYROSCOPE, label: 'ìì´ë¡œìŠ¤ì½”í”„'},
    {value: SensorType.MAGNETOMETER, label: 'ìê¸°ê³„'},
    {value: SensorType.GPS, label: 'GPS'},
  ]}
/>
```

**5. ë°ì´í„° ìƒ˜í”Œë§**

ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•œ ë°ì´í„° ìƒ˜í”Œë§:

```typescript
const sampleData = useCallback((data: SensorDataRecord[]): SensorDataRecord[] => {
  if (data.length <= MAX_DATA_POINTS) {
    return data;
  }

  const step = Math.ceil(data.length / MAX_DATA_POINTS);
  return data.filter((_, index) => index % step === 0);
}, []);
```

- **MAX_DATA_POINTS**: 100ê°œ
- **ìƒ˜í”Œë§ ë°©ì‹**: ê· ë“± ê°„ê²© ìƒ˜í”Œë§
- **ì˜ˆì‹œ**: 1000ê°œ ë°ì´í„° â†’ 10ê°œë§ˆë‹¤ 1ê°œ ì„ íƒ â†’ 100ê°œ

**6. ì°¨íŠ¸ ë°ì´í„° ì¤€ë¹„**

**3ì¶• ì„¼ì„œ**:
```typescript
const prepare3AxisChartData = useCallback((data: SensorDataRecord[]): ChartData => {
  const sampledData = sampleData(data);

  const xData = sampledData.map(d => d.x || 0);
  const yData = sampledData.map(d => d.y || 0);
  const zData = sampledData.map(d => d.z || 0);

  return {
    labels: sampledData.map((d, i) => {
      if (i % 10 === 0) {
        const date = new Date(d.timestamp);
        return `${date.getHours()}:${date.getMinutes()}:${date.getSeconds()}`;
      }
      return '';
    }),
    datasets: [
      {data: xData, color: () => 'rgba(255, 0, 0, 1)'},  // Red
      {data: yData, color: () => 'rgba(0, 255, 0, 1)'},  // Green
      {data: zData, color: () => 'rgba(0, 0, 255, 1)'},  // Blue
    ],
    legend: ['Xì¶•', 'Yì¶•', 'Zì¶•'],
  };
}, [sampleData]);
```

**GPS**:
```typescript
const prepareGPSChartData = useCallback(
  (data: SensorDataRecord[], field: 'latitude' | 'longitude' | 'altitude') => {
    const sampledData = sampleData(data);
    const values = sampledData.map(d => {
      if (field === 'latitude') return d.latitude || 0;
      if (field === 'longitude') return d.longitude || 0;
      return d.altitude || 0;
    });

    return {
      labels: /* time labels */,
      datasets: [{data: values, color: () => 'rgba(75, 192, 192, 1)'}],
      legend: [fieldNames[field]],
    };
  },
  [sampleData],
);
```

**7. ì°¨íŠ¸ ë Œë”ë§**

react-native-chart-kitì˜ LineChart ì‚¬ìš©:

```typescript
<LineChart
  data={chartData}
  width={Math.max(screenWidth - 60, chartData.labels.length * 20)}
  height={220}
  chartConfig={{
    backgroundColor: '#ffffff',
    backgroundGradientFrom: '#ffffff',
    backgroundGradientTo: '#ffffff',
    decimalPlaces: 2,
    color: (opacity = 1) => `rgba(0, 0, 0, ${opacity})`,
    propsForDots: {r: '2', strokeWidth: '1'},
  }}
  bezier
  withInnerLines
  withOuterLines
  withVerticalLines
  withHorizontalLines
/>
```

**ì°¨íŠ¸ ì„¤ì •**:
- **Width**: ë™ì  (ë°ì´í„° ì–‘ì— ë”°ë¼)
- **Height**: 220px
- **Bezier**: ë¶€ë“œëŸ¬ìš´ ê³¡ì„ 
- **Grid Lines**: ë‚´ë¶€/ì™¸ë¶€/ìˆ˜ì§/ìˆ˜í‰
- **Dots**: ì‘ì€ ì  (ë°˜ì§€ë¦„ 2px)
- **ë°°ê²½**: í°ìƒ‰

**8. ê°€ë¡œ ìŠ¤í¬ë¡¤**

ê¸´ ë°ì´í„°ë¥¼ ìœ„í•œ ìˆ˜í‰ ìŠ¤í¬ë¡¤:

```typescript
<ScrollView horizontal showsHorizontalScrollIndicator>
  <LineChart
    data={chartData}
    width={Math.max(screenWidth - 60, chartData.labels.length * 20)}
    // ì°¨íŠ¸ widthê°€ í™”ë©´ë³´ë‹¤ í¬ë©´ ìŠ¤í¬ë¡¤ ê°€ëŠ¥
  />
</ScrollView>
```

**9. SessionDetail í†µí•©**

ì„¸ì…˜ ìƒì„¸ í™”ë©´ì— "ì°¨íŠ¸ ë³´ê¸°" ë²„íŠ¼ ì¶”ê°€:

```typescript
<Button
  mode="contained"
  icon="chart-line"
  onPress={() => navigation.navigate('Chart', {sessionId})}
  disabled={sensorData.length === 0}
  style={styles.button}>
  ì°¨íŠ¸ ë³´ê¸°
</Button>
```

**10. ë„¤ë¹„ê²Œì´ì…˜ êµ¬ì¡° ì—…ë°ì´íŠ¸**

```
History Tab
â”œâ”€â”€ HistoryList (ì„¸ì…˜ ëª©ë¡)
â”‚   â””â”€â”€ [ì„¸ì…˜ í´ë¦­]
â”‚       â†“
â”œâ”€â”€ SessionDetail (ì„¸ì…˜ ìƒì„¸)
â”‚   â”œâ”€â”€ [ì°¨íŠ¸ ë³´ê¸°]
â”‚   â”‚   â†“
â”‚   â”œâ”€â”€ Chart (ì°¨íŠ¸ í™”ë©´)
â”‚   â”œâ”€â”€ CSV ë‚´ë³´ë‚´ê¸°
â”‚   â”œâ”€â”€ JSON ë‚´ë³´ë‚´ê¸°
â”‚   â””â”€â”€ ì„¸ì…˜ ì‚­ì œ
```

### í™”ë©´ êµ¬ì¡° ì—…ë°ì´íŠ¸

```
KooDTX App
â”œâ”€â”€ ğŸ“± Tab Navigator (Bottom)
â”‚   â”œâ”€â”€ ğŸ”´ Recording (RecordingScreen)
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“‹ History (HistoryStack)
â”‚       â”œâ”€â”€ HistoryList
â”‚       â”œâ”€â”€ SessionDetail
â”‚       â”‚   â””â”€â”€ [ì°¨íŠ¸ ë³´ê¸°]
â”‚       â”‚       â†“
â”‚       â””â”€â”€ Chart (ChartScreen) â­ NEW
â”‚           â”œâ”€â”€ ì„¼ì„œ ì„ íƒ (SegmentedButtons)
â”‚           â”œâ”€â”€ Line Chart (3ì¶• or GPS)
â”‚           â”œâ”€â”€ ë²”ë¡€ (Legend)
â”‚           â””â”€â”€ ê°€ë¡œ ìŠ¤í¬ë¡¤
```

### ì—…ë°ì´íŠ¸ëœ íŒŒì¼

- **src/screens/ChartScreen.tsx** (415ì¤„): ì°¨íŠ¸ í™”ë©´
- **src/screens/index.ts**: ChartScreen export
- **src/navigation/HistoryStack.tsx**: Chart í™”ë©´ ì¶”ê°€
- **src/screens/SessionDetailScreen.tsx**: "ì°¨íŠ¸ ë³´ê¸°" ë²„íŠ¼ ì¶”ê°€
- **package.json**: react-native-svg, react-native-chart-kit ì¶”ê°€

### ì‚¬ìš©ì í”Œë¡œìš°

**í”Œë¡œìš° 1: ì„¼ì„œ ë°ì´í„° ì°¨íŠ¸ ë³´ê¸°**
1. History íƒ­ â†’ ì„¸ì…˜ ì„ íƒ
2. ì„¸ì…˜ ìƒì„¸ í™”ë©´
3. "ì°¨íŠ¸ ë³´ê¸°" ë²„íŠ¼ í´ë¦­
4. ì°¨íŠ¸ í™”ë©´ í‘œì‹œ (ê¸°ë³¸: ê°€ì†ë„ê³„)
5. ì„¼ì„œë³„ ë°ì´í„° ì‹œê°í™”

**í”Œë¡œìš° 2: ì„¼ì„œ ì „í™˜**
1. ì°¨íŠ¸ í™”ë©´
2. ì„¼ì„œ ì„ íƒ ë²„íŠ¼ (ê°€ì†ë„ê³„/ìì´ë¡œìŠ¤ì½”í”„/ìê¸°ê³„/GPS)
3. ì„ íƒí•œ ì„¼ì„œì˜ ì°¨íŠ¸ í‘œì‹œ
4. X/Y/Z (ë˜ëŠ” ìœ„ë„/ê²½ë„/ê³ ë„) í™•ì¸

**í”Œë¡œìš° 3: ì°¨íŠ¸ ìŠ¤í¬ë¡¤**
1. ì°¨íŠ¸ í™”ë©´
2. ê°€ë¡œë¡œ ìŠ¤í¬ë¡¤
3. ì „ì²´ ë°ì´í„° í¬ì¸íŠ¸ íƒìƒ‰

### ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

**ì°¨íŠ¸ ìƒ‰ìƒ**:
- **Xì¶•**: rgba(255, 0, 0, 1) - ë¹¨ê°•
- **Yì¶•**: rgba(0, 255, 0, 1) - ì´ˆë¡
- **Zì¶•**: rgba(0, 0, 255, 1) - íŒŒë‘
- **GPS**: rgba(75, 192, 192, 1) - ì²­ë¡ìƒ‰

**ë°ì´í„° í¬ì¸íŠ¸ ê³„ì‚°**:
```typescript
// ì˜ˆ: 1000ê°œ ë°ì´í„°
const step = Math.ceil(1000 / 100); // 10
// 0, 10, 20, 30, ... 990 ì¸ë±ìŠ¤ ì„ íƒ â†’ 100ê°œ
```

**íƒ€ì„ìŠ¤íƒ¬í”„ í¬ë§·**:
```typescript
const date = new Date(timestamp);
const label = `${date.getHours()}:${date.getMinutes()}:${date.getSeconds()}`;
// ì˜ˆ: "14:32:45"
```

**ì„±ëŠ¥ ìµœì í™”**:
- ìµœëŒ€ 100ê°œ ë°ì´í„° í¬ì¸íŠ¸ë¡œ ì œí•œ
- ê· ë“± ê°„ê²© ìƒ˜í”Œë§
- useCallbackìœ¼ë¡œ í•¨ìˆ˜ ë©”ëª¨ì´ì œì´ì…˜
- ScrollViewì˜ showsHorizontalScrollIndicator={true}

### ë‹¤ìŒ ë‹¨ê³„ (Phase 20)
- ì˜¤ë””ì˜¤ ë…¹ìŒ ì¤€ë¹„ âœ…
- AudioRecorderService êµ¬í˜„ âœ…
- AudioRecordingRepository êµ¬í˜„ âœ…
- useAudioRecording Hook êµ¬í˜„ âœ…

---

## Phase 20: ì˜¤ë””ì˜¤ ë…¹ìŒ ì¸í”„ë¼ êµ¬ì¶• âœ…

**ì™„ë£Œ ì‹œê°„**: 2025-11-12 11:00
**ì†Œìš” ì‹œê°„**: 1.0ì‹œê°„

### ì£¼ìš” ì„±ê³¼

**1. react-native-audio-recorder-player ì„¤ì¹˜**

```bash
npm install react-native-audio-recorder-player
```

- **ê¸°ëŠ¥**: ì˜¤ë””ì˜¤ ë…¹ìŒ ë° ì¬ìƒ
- **ì§€ì›**: Android & iOS
- **í¬ë§·**: m4a (AAC ì¸ì½”ë”©)

**2. AudioRecorderService êµ¬í˜„** (270ì¤„)

ì˜¤ë””ì˜¤ ë…¹ìŒ ê´€ë¦¬ ì„œë¹„ìŠ¤ (Singleton Pattern)

```typescript
export class AudioRecorderService {
  async startRecording(options: AudioRecordingOptions, onProgress?, onError?): Promise<string>;
  async stopRecording(): Promise<AudioRecordingResult | null>;
  async startPlayer(filePath: string, onProgress?): Promise<void>;
  async stopPlayer(): Promise<void>;
  async pausePlayer(): Promise<void>;
  async resumePlayer(): Promise<void>;
  async cleanup(): Promise<void>;
}
```

**ì£¼ìš” ê¸°ëŠ¥**:
- ğŸ¤ ì˜¤ë””ì˜¤ ë…¹ìŒ (m4a í˜•ì‹)
- ğŸµ ì˜¤ë””ì˜¤ ì¬ìƒ
- â¸ï¸ ì¼ì‹œì •ì§€/ì¬ê°œ
- ğŸ“Š ë…¹ìŒ ì§„í–‰ë¥  ì½œë°±
- ğŸ“ íŒŒì¼ ê²½ë¡œ ê´€ë¦¬
- ğŸ§¹ ë¦¬ì†ŒìŠ¤ ì •ë¦¬

**ì˜¤ë””ì˜¤ ì„¤ì •**:
```typescript
const audioSet = {
  AudioEncoderAndroid: AudioEncoderAndroidType.AAC,
  AudioSourceAndroid: AudioSourceAndroidType.MIC,
  AVEncoderAudioQualityKeyIOS: AVEncoderAudioQualityIOSType.high,
  AVNumberOfChannelsKeyIOS: 2,  // Stereo
  AVFormatIDKeyIOS: AVEncodingOption.aac,
  AudioSamplingRate: 44100,  // 44.1 kHz
};
```

**íŒŒì¼ ê²½ë¡œ ìƒì„±**:
```typescript
const timestamp = Date.now();
const fileName = `audio_${sessionId}_${timestamp}.m4a`;
const directory = Platform.OS === 'ios'
  ? RNFS.DocumentDirectoryPath
  : RNFS.ExternalDirectoryPath;
const filePath = `${directory}/${fileName}`;
```

**3. AudioRecordingRepository êµ¬í˜„** (240ì¤„)

ì˜¤ë””ì˜¤ ë…¹ìŒ ë©”íƒ€ë°ì´í„° ê´€ë¦¬ ë ˆí¬ì§€í† ë¦¬

```typescript
export class AudioRecordingRepository {
  async create(input: CreateAudioRecordingInput): Promise<AudioRecording>;
  async findById(id: string): Promise<AudioRecording | null>;
  async findBySession(sessionId: string): Promise<AudioRecording[]>;
  async findAll(): Promise<AudioRecording[]>;
  async findNotUploaded(): Promise<AudioRecording[]>;
  async update(id: string, input: UpdateAudioRecordingInput): Promise<AudioRecording>;
  async markAsUploaded(ids: string[]): Promise<void>;
  async delete(id: string): Promise<void>;
  async deleteBySession(sessionId: string): Promise<void>;
  async count(): Promise<number>;
  async countBySession(sessionId: string): Promise<number>;
}
```

**ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ** (audio_recordings í…Œì´ë¸”):
- `session_id`: ì„¸ì…˜ ID (ì™¸ë˜ í‚¤)
- `timestamp`: ë…¹ìŒ ì‹œì‘ íƒ€ì„ìŠ¤íƒ¬í”„
- `file_path`: ì˜¤ë””ì˜¤ íŒŒì¼ ê²½ë¡œ
- `file_size`: íŒŒì¼ í¬ê¸° (bytes)
- `duration`: ë…¹ìŒ ê¸¸ì´ (seconds)
- `sample_rate`: ìƒ˜í”Œ ë ˆì´íŠ¸ (Hz)
- `channels`: ì±„ë„ ìˆ˜ (1: mono, 2: stereo)
- `format`: íŒŒì¼ í¬ë§· (m4a)
- `is_uploaded`: ì—…ë¡œë“œ ì—¬ë¶€
- `uploaded_url`: ì—…ë¡œë“œëœ URL

**4. useAudioRecording Hook êµ¬í˜„** (130ì¤„)

React Hookìœ¼ë¡œ ì˜¤ë””ì˜¤ ë…¹ìŒ ê¸°ëŠ¥ ì œê³µ

```typescript
export function useAudioRecording(options: UseAudioRecordingOptions): UseAudioRecordingResult {
  const {sessionId, sampleRate, channels, onProgress, onError} = options;

  return {
    isRecording: boolean;
    recordingDuration: number;
    filePath: string | null;
    start: () => Promise<void>;
    stop: () => Promise<AudioRecordingResult | null>;
    error: Error | null;
  };
}
```

**ì‚¬ìš© ì˜ˆì œ**:
```typescript
const {isRecording, recordingDuration, start, stop, error} = useAudioRecording({
  sessionId: 'session-123',
  sampleRate: 44100,
  channels: 2,
  onProgress: (progress) => {
    console.log(`Duration: ${progress.currentPosition}ms`);
  },
  onError: (err) => {
    console.error('Recording error:', err);
  },
});

// Start recording
await start();

// Stop recording
const result = await stop();
// result: {filePath, duration, fileSize}
```

**Hook ê¸°ëŠ¥**:
- âœ… ìë™ ì„¸ì…˜ ID ê²€ì¦
- âœ… ë…¹ìŒ ìƒíƒœ ê´€ë¦¬
- âœ… ì§„í–‰ë¥  ì¶”ì 
- âœ… ì—ëŸ¬ ì²˜ë¦¬
- âœ… ìë™ ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥
- âœ… ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ì •ë¦¬

**5. íŒŒì¼ ì €ì¥ êµ¬ì¡°**

**Android**:
```
/storage/emulated/0/Android/data/com.koodtxtemp/files/
â”œâ”€â”€ audio_session-123_1731394800000.m4a
â”œâ”€â”€ audio_session-123_1731394900000.m4a
â””â”€â”€ audio_session-456_1731395000000.m4a
```

**iOS**:
```
~/Library/Application Support/
â”œâ”€â”€ audio_session-123_1731394800000.m4a
â”œâ”€â”€ audio_session-123_1731394900000.m4a
â””â”€â”€ audio_session-456_1731395000000.m4a
```

**íŒŒì¼ ë„¤ì´ë° ê·œì¹™**:
```
audio_{sessionId}_{timestamp}.m4a
```

### ì˜¤ë””ì˜¤ ë…¹ìŒ í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ useAudioRecording Hook           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. start() í˜¸ì¶œ                  â”‚
â”‚    â†“                             â”‚
â”‚ 2. AudioRecorderService          â”‚
â”‚    - startRecording()            â”‚
â”‚    - íŒŒì¼ ê²½ë¡œ ìƒì„±               â”‚
â”‚    - ë…¹ìŒ ì‹œì‘                   â”‚
â”‚    â†“                             â”‚
â”‚ 3. ì§„í–‰ë¥  ì½œë°±                   â”‚
â”‚    - onProgress(progress)        â”‚
â”‚    - ë…¹ìŒ ì‹œê°„ ì—…ë°ì´íŠ¸           â”‚
â”‚    â†“                             â”‚
â”‚ 4. stop() í˜¸ì¶œ                   â”‚
â”‚    â†“                             â”‚
â”‚ 5. AudioRecorderService          â”‚
â”‚    - stopRecording()             â”‚
â”‚    - íŒŒì¼ ì •ë³´ ë°˜í™˜               â”‚
â”‚    â†“                             â”‚
â”‚ 6. AudioRecordingRepository      â”‚
â”‚    - create()                    â”‚
â”‚    - ë©”íƒ€ë°ì´í„° ì €ì¥              â”‚
â”‚    â†“                             â”‚
â”‚ 7. ì™„ë£Œ                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì˜¤ë””ì˜¤ ì¬ìƒ í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AudioRecorderService             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. startPlayer(filePath)         â”‚
â”‚    â†“                             â”‚
â”‚ 2. ì˜¤ë””ì˜¤ íŒŒì¼ ë¡œë“œ               â”‚
â”‚    â†“                             â”‚
â”‚ 3. ì¬ìƒ ì‹œì‘                     â”‚
â”‚    â†“                             â”‚
â”‚ 4. ì§„í–‰ë¥  ì½œë°±                   â”‚
â”‚    - onProgress(progress)        â”‚
â”‚    â†“                             â”‚
â”‚ 5. pausePlayer() / resumePlayer()â”‚
â”‚    â†“                             â”‚
â”‚ 6. stopPlayer()                  â”‚
â”‚    â†“                             â”‚
â”‚ 7. ì™„ë£Œ                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì—…ë°ì´íŠ¸ëœ íŒŒì¼

- **src/services/audio/AudioRecorderService.ts** (270ì¤„): ì˜¤ë””ì˜¤ ë…¹ìŒ ì„œë¹„ìŠ¤
- **src/database/repositories/AudioRecordingRepository.ts** (240ì¤„): ì˜¤ë””ì˜¤ ë ˆí¬ì§€í† ë¦¬
- **src/database/repositories/index.ts**: AudioRecordingRepository export
- **src/hooks/useAudioRecording.ts** (130ì¤„): ì˜¤ë””ì˜¤ ë…¹ìŒ Hook
- **src/hooks/index.ts**: useAudioRecording export
- **package.json**: react-native-audio-recorder-player ì¶”ê°€

### í†µí•© ì¤€ë¹„ ì™„ë£Œ

RecordingScreenì— ì˜¤ë””ì˜¤ ë…¹ìŒì„ í†µí•©í•˜ë ¤ë©´:

```typescript
import {useAudioRecording} from '@hooks';

// Inside RecordingScreen component:
const audioRecording = useAudioRecording({
  sessionId,
  sampleRate: 44100,
  channels: 2,
  onProgress: (progress) => {
    // Update UI with recording duration
  },
  onError: (error) => {
    console.error('Audio recording error:', error);
  },
});

// Start recording (í•¨ê»˜ ì„¼ì„œ ë°ì´í„°ì™€)
const handleStartRecording = async () => {
  // ... start sensor collection
  if (enabledSensors[SensorType.AUDIO]) {
    await audioRecording.start();
  }
};

// Stop recording
const handleStopRecording = async () => {
  // ... stop sensor collection
  if (audioRecording.isRecording) {
    const result = await audioRecording.stop();
    console.log('Audio saved:', result);
  }
};
```

### ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

**ì˜¤ë””ì˜¤ í’ˆì§ˆ**:
- **ìƒ˜í”Œ ë ˆì´íŠ¸**: 44.1 kHz (CD í’ˆì§ˆ)
- **ì±„ë„**: 2 (ìŠ¤í…Œë ˆì˜¤)
- **ì¸ì½”ë”©**: AAC (ê³ íš¨ìœ¨ ì••ì¶•)
- **ì»¨í…Œì´ë„ˆ**: m4a

**íŒŒì¼ í¬ê¸° ì˜ˆìƒ**:
- 1ë¶„ ë…¹ìŒ: ~1-2 MB
- 10ë¶„ ë…¹ìŒ: ~10-20 MB
- 60ë¶„ ë…¹ìŒ: ~60-120 MB

**ê¶Œí•œ**:
- Android: `RECORD_AUDIO` (ì´ë¯¸ AndroidManifest.xmlì— ì¶”ê°€ë¨)
- iOS: `NSMicrophoneUsageDescription` (Info.plistì— ì¶”ê°€ í•„ìš”)

**ì—ëŸ¬ ì²˜ë¦¬**:
- ê¶Œí•œ ê±°ë¶€: Error throw
- ë””ìŠ¤í¬ ê³µê°„ ë¶€ì¡±: Error throw
- ì´ë¯¸ ë…¹ìŒ ì¤‘: Error throw
- ì„¸ì…˜ ID ì—†ìŒ: Error throw

### ë‹¤ìŒ ë‹¨ê³„ (Phase 21)
- RecordingScreenì— ì˜¤ë””ì˜¤ í†µí•©
- ì˜¤ë””ì˜¤ ì¬ìƒ UI ì¶”ê°€
- SessionDetailì— ì˜¤ë””ì˜¤ í‘œì‹œ
- ì˜¤ë””ì˜¤ íŒŒì¼ ë‚´ë³´ë‚´ê¸°

---


**ì™„ë£Œ ì‹œê°„**: 2025-11-12 07:00  
**ì†Œìš” ì‹œê°„**: 0.7ì‹œê°„

### ì£¼ìš” ì„±ê³¼

**1. RecordingScreen êµ¬í˜„** (320ì¤„)

ì™„ì „í•œ ê¸°ëŠ¥ì˜ ì„¼ì„œ ë…¹ìŒ í™”ë©´

**ì£¼ìš” ê¸°ëŠ¥**:
- âœ… **ì„¼ì„œ ì„ íƒ**: 4ê°œ ì„¼ì„œ (ê°€ì†ë„ê³„, ìì´ë¡œìŠ¤ì½”í”„, ìê¸°ê³„, GPS)
- ğŸ›ï¸ **ì„¤ì •**: ìƒ˜í”Œë§ ë ˆì´íŠ¸ í‘œì‹œ
- ğŸ“ **ë©”ëª¨**: ì„¸ì…˜ ë…¸íŠ¸ ì…ë ¥
- â–¶ï¸ **ì œì–´**: ë…¹ìŒ ì‹œì‘/ì¤‘ì§€ ë²„íŠ¼
- ğŸ“Š **ì‹¤ì‹œê°„ ë°ì´í„°**: ì„¼ì„œë³„ ìµœì‹  ê°’ í‘œì‹œ
- ğŸ“ˆ **í†µê³„**: ë²„í¼/ì €ì¥ í†µê³„ ì‹¤ì‹œê°„ í‘œì‹œ
- âš ï¸ **ì—ëŸ¬ ì²˜ë¦¬**: ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ

**2. UI ì»´í¬ë„ŒíŠ¸**

**ìƒíƒœ í‘œì‹œ**:
```typescript
ìƒíƒœ: ğŸ”´ ë…¹ìŒ ì¤‘ / âšª ëŒ€ê¸° ì¤‘
ì„¸ì…˜: session-1731393600000-a1b2c3d4
```

**ì„¼ì„œ ì„ íƒ (Checkbox)**:
- âœ“ ê°€ì†ë„ê³„ (Accelerometer)
- âœ“ ìì´ë¡œìŠ¤ì½”í”„ (Gyroscope)
- âœ“ ìê¸°ê³„ (Magnetometer)
- â˜ GPS

**ì‹¤ì‹œê°„ ë°ì´í„°**:
```
accelerometer
X: 0.123, Y: -0.456, Z: 9.789

gyroscope
X: 0.001, Y: 0.002, Z: -0.001

gps
Lat: 37.123456, Lng: 127.654321
```

**í†µê³„**:
```
ë²„í¼: 45 / 1250
ì €ì¥: 1200 (ì‹¤íŒ¨: 5)
ë°°ì¹˜: 12
```

**3. í†µí•© ê¸°ëŠ¥**

**ì„¸ì…˜ ìƒì„±**:
```typescript
await sessionRepo.create({
  sessionId: newSessionId,
  startTime: Date.now(),
  enabledSensors: [SensorType.ACCELEROMETER, SensorType.GYROSCOPE],
  sampleRate: 100,
  notes: sessionNotes,
});
```

**ì„¼ì„œ ì‹œì‘**:
```typescript
await start([
  SensorType.ACCELEROMETER,
  SensorType.GYROSCOPE,
  SensorType.MAGNETOMETER,
]);
```

**ë°ì´í„° ìˆ˜ì§‘ â†’ ì €ì¥**:
```
useSensorCollectionWithDB Hook
  â†’ ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì‹ 
  â†’ í™”ë©´ì— ìµœì‹  ê°’ í‘œì‹œ
  â†’ ìë™ìœ¼ë¡œ DB ì €ì¥
  â†’ í†µê³„ ì—…ë°ì´íŠ¸
```

**ì„¸ì…˜ ì¢…ë£Œ**:
```typescript
await stop();
await sessionRepo.updateBySessionId(sessionId, {
  endTime: Date.now(),
  isActive: false,
});
```

**4. ì‚¬ìš©ì ê²½í—˜**

**ë…¹ìŒ ì „**:
1. ì›í•˜ëŠ” ì„¼ì„œ ì„ íƒ (ì²´í¬ë°•ìŠ¤)
2. ë©”ëª¨ ì…ë ¥ (ì„ íƒì‚¬í•­)
3. "ë…¹ìŒ ì‹œì‘" ë²„íŠ¼ í´ë¦­

**ë…¹ìŒ ì¤‘**:
1. ğŸ”´ ë…¹ìŒ ì¤‘ í‘œì‹œ
2. ì‹¤ì‹œê°„ ì„¼ì„œ ë°ì´í„° í‘œì‹œ
3. ë²„í¼/ì €ì¥ í†µê³„ í‘œì‹œ
4. "ë…¹ìŒ ì¤‘ì§€" ë²„íŠ¼ (ë¹¨ê°„ìƒ‰)

**ë…¹ìŒ í›„**:
1. ë°ì´í„°ë² ì´ìŠ¤ì— ìë™ ì €ì¥
2. ì„¸ì…˜ ì¢…ë£Œ ì²˜ë¦¬
3. ëŒ€ê¸° ìƒíƒœë¡œ ë³µê·€

**5. ì—…ë°ì´íŠ¸ëœ íŒŒì¼**

- **RecordingScreen.tsx** (320ì¤„): ë©”ì¸ ë…¹ìŒ í™”ë©´
- **App.tsx**: RecordingScreen ì‚¬ìš©
- **src/screens/README.md**: ìŠ¤í¬ë¦° ë¬¸ì„œ ì—…ë°ì´íŠ¸

### í™”ë©´ êµ¬ì¡°

```
RecordingScreen
â”œâ”€â”€ Card: ì„¼ì„œ ë…¹ìŒ
â”‚   â”œâ”€â”€ ìƒíƒœ í‘œì‹œ
â”‚   â”œâ”€â”€ ì„¼ì„œ ì„ íƒ (Checkbox)
â”‚   â”œâ”€â”€ ì„¤ì • í‘œì‹œ
â”‚   â”œâ”€â”€ ë©”ëª¨ ë²„íŠ¼
â”‚   â””â”€â”€ ë…¹ìŒ ì‹œì‘/ì¤‘ì§€ ë²„íŠ¼
â”œâ”€â”€ Card: ì‹¤ì‹œê°„ ë°ì´í„° (ë…¹ìŒ ì¤‘)
â”‚   â””â”€â”€ ì„¼ì„œë³„ ìµœì‹  ê°’
â””â”€â”€ Card: í†µê³„ (ë…¹ìŒ ì¤‘)
    â”œâ”€â”€ ë²„í¼ í†µê³„
    â””â”€â”€ ì €ì¥ í†µê³„
```

### Material Design 3 ìŠ¤íƒ€ì¼

- **Card**: ì •ë³´ ê·¸ë£¹í™”
- **Checkbox**: ì„¼ì„œ ì„ íƒ
- **Button**: contained (ê°•ì¡°), outlined (ì¼ë°˜)
- **Dialog**: ë©”ëª¨ ì…ë ¥
- **Text**: variantë¡œ ê³„ì¸µ êµ¬ì¡°
- **Divider**: ì„¹ì…˜ êµ¬ë¶„

### ì™„ì „í•œ ë°ì´í„° íë¦„

```
ì‚¬ìš©ì UI ì¡°ì‘
    â†“
RecordingScreen
    â†“
RecordingSessionRepository.create() â†’ DB
    â†“
useSensorCollectionWithDB.start()
    â†“
SensorManager â†’ SensorService â†’ ì„¼ì„œ í•˜ë“œì›¨ì–´
    â†“
ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì‹ 
    â”œâ”€â†’ í™”ë©´ ì—…ë°ì´íŠ¸ (latestData)
    â””â”€â†’ SensorDataService
          â”œâ”€â†’ SensorDataBuffer
          â””â”€â†’ SensorDataBatchSaver
                â””â”€â†’ SensorDataRepository.createBatch() â†’ DB
                      â””â”€â†’ RecordingSessionRepository.incrementDataCount()
```

### ë‹¤ìŒ ë‹¨ê³„ (Phase 16)
- TypeScript ë°ì½”ë ˆì´í„° ì„¤ì • ìˆ˜ì •
- ê¶Œí•œ ìš”ì²­ ì²˜ë¦¬ (Android/iOS)
- ì—ëŸ¬ í•¸ë“¤ë§ ê°œì„ 
- ë¡œë”© ìƒíƒœ í‘œì‹œ

---


**ì™„ë£Œ ì‹œê°„**: 2025-11-12 06:30  
**ì†Œìš” ì‹œê°„**: 0.5ì‹œê°„

### ì£¼ìš” ì„±ê³¼

**1. SensorDataService êµ¬í˜„** (230ì¤„)

ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ë¶€í„° ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ê¹Œì§€ ì „ì²´ íŒŒì´í”„ë¼ì¸ì„ í†µí•©í•˜ëŠ” ì„œë¹„ìŠ¤

```typescript
export class SensorDataService {
  private buffer: SensorDataBuffer;
  private batchSaver: SensorDataBatchSaver;
  private sensorDataRepo: SensorDataRepository;
  private sessionRepo: RecordingSessionRepository;
  
  async start(): void;
  async stop(): Promise<void>;
  addData(data: SensorData): void;
  addBatch(data: SensorData[]): void;
  async flush(): Promise<void>;
}
```

**ì£¼ìš” ê¸°ëŠ¥**:
- ğŸ”„ **ë²„í¼ë§**: SensorDataBufferë¥¼ í†µí•œ ë©”ëª¨ë¦¬ ë²„í¼ë§
- ğŸ’¾ **ë°°ì¹˜ ì €ì¥**: SensorDataBatchSaverë¥¼ í†µí•œ ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥
- ğŸ” **ì¬ì‹œë„**: ì‹¤íŒ¨í•œ ë°°ì¹˜ ìë™ ì¬ì‹œë„
- ğŸ“Š **í†µê³„**: ë²„í¼ ë° ì €ì¥ í†µê³„ ì¶”ì 
- ğŸ“ˆ **ì„¸ì…˜ ì—…ë°ì´íŠ¸**: ìë™ ì„¸ì…˜ ë°ì´í„° ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
- ğŸ¯ **ì‹±ê¸€í†¤**: ì „ì—­ ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬

**2. useSensorCollectionWithDB Hook** (200ì¤„)

ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ê¸°ëŠ¥ì´ í†µí•©ëœ ì„¼ì„œ ìˆ˜ì§‘ Hook

```typescript
export function useSensorCollectionWithDB(
  sessionId: string | null,
  options: UseSensorCollectionWithDBOptions = {},
): UseSensorCollectionWithDBResult
```

**ì˜µì…˜**:
- `enabled`: ìë™ ì‹œì‘/ì¤‘ì§€
- `sensors`: ì„¼ì„œë³„ ì„¤ì •
- `onData`: ë°ì´í„° ì½œë°±
- `onError`: ì—ëŸ¬ ì½œë°±
- `bufferSize`: ë²„í¼ í¬ê¸° (ê¸°ë³¸: 100)
- `flushInterval`: í”ŒëŸ¬ì‹œ ê°„ê²© (ê¸°ë³¸: 5000ms)
- `retryAttempts`: ì¬ì‹œë„ íšŸìˆ˜ (ê¸°ë³¸: 3)

**ë°˜í™˜ê°’**:
- `isRunning`: ì‹¤í–‰ ìƒíƒœ
- `runningSensors`: ì‹¤í–‰ ì¤‘ì¸ ì„¼ì„œ ëª©ë¡
- `error`: ì—ëŸ¬ ìƒíƒœ
- `start()`: ì„¼ì„œ ì‹œì‘
- `stop()`: ì„¼ì„œ ì¤‘ì§€
- `getBufferStats()`: ë²„í¼ í†µê³„
- `getSaverStats()`: ì €ì¥ í†µê³„
- `getFailedBatchesCount()`: ì‹¤íŒ¨ ë°°ì¹˜ ìˆ˜
- `flush()`: ìˆ˜ë™ í”ŒëŸ¬ì‹œ

**3. í†µí•© í…ŒìŠ¤íŠ¸** (163ì¤„)

SensorDataServiceì˜ ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

```typescript
describe('SensorDataService', () => {
  // ì´ˆê¸°í™”, ì‹œì‘/ì¤‘ì§€
  // ë°ì´í„° ì¶”ê°€ (ë‹¨ì¼/ë°°ì¹˜)
  // í†µê³„ ì¡°íšŒ
  // ìˆ˜ë™ í”ŒëŸ¬ì‹œ
  // ì‹±ê¸€í†¤ íŒ¨í„´
  // ì—ëŸ¬ ì²˜ë¦¬
});
```

### ë°ì´í„° íë¦„ (ì™„ì „í•œ íŒŒì´í”„ë¼ì¸)

```
ì„¼ì„œ í•˜ë“œì›¨ì–´
    â†“
SensorService (AccelerometerService, GyroscopeService, etc.)
    â†“
SensorManager.startCollection()
    â†“
useSensorCollectionWithDB Hook
    â†“
SensorDataService
    â”œâ”€â†’ SensorDataBuffer (ë©”ëª¨ë¦¬ ë²„í¼ë§)
    â”‚     â””â”€â†’ ìë™ í”ŒëŸ¬ì‹œ (í¬ê¸°/ì‹œê°„ ê¸°ë°˜)
    â””â”€â†’ SensorDataBatchSaver (ë°°ì¹˜ ì €ì¥)
          â””â”€â†’ SensorDataRepository.createBatch()
                â””â”€â†’ WatermelonDB
                      â””â”€â†’ SQLite Database
```

### ì‚¬ìš© ì˜ˆì‹œ

**ê¸°ë³¸ ì‚¬ìš©**:
```typescript
const {isRunning, start, stop} = useSensorCollectionWithDB(
  sessionId,
  {
    enabled: true,
    sensors: {
      [SensorType.ACCELEROMETER]: {enabled: true, sampleRate: 100},
      [SensorType.GYROSCOPE]: {enabled: true, sampleRate: 100},
      [SensorType.GPS]: {enabled: true, sampleRate: 1},
    },
    bufferSize: 100,
    flushInterval: 5000,
    retryAttempts: 3,
    onData: (data) => {
      console.log('Received data:', data);
    },
    onError: (error) => {
      console.error('Sensor error:', error);
    },
  }
);

// ë°ì´í„°ëŠ” ìë™ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ë¨
```

**í†µê³„ ëª¨ë‹ˆí„°ë§**:
```typescript
const {getBufferStats, getSaverStats, getFailedBatchesCount} = 
  useSensorCollectionWithDB(sessionId, options);

// ë²„í¼ í†µê³„
const bufferStats = getBufferStats();
console.log('Buffer:', bufferStats.currentSize, '/', bufferStats.totalReceived);

// ì €ì¥ í†µê³„
const saverStats = getSaverStats();
console.log('Saved:', saverStats.totalSaved, 'Failed:', saverStats.totalFailed);

// ì‹¤íŒ¨ ë°°ì¹˜ ìˆ˜
const failedCount = getFailedBatchesCount();
console.log('Failed batches:', failedCount);
```

**ìˆ˜ë™ ì œì–´**:
```typescript
const {start, stop, flush} = useSensorCollectionWithDB(
  sessionId,
  {enabled: false} // ìë™ ì‹œì‘ ë¹„í™œì„±í™”
);

// ìˆ˜ë™ ì‹œì‘
await start([SensorType.ACCELEROMETER, SensorType.GYROSCOPE]);

// ìˆ˜ë™ í”ŒëŸ¬ì‹œ
await flush();

// ìˆ˜ë™ ì¤‘ì§€
await stop();
```

### íŒŒì¼ êµ¬ì¡°
```
src/
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ SensorDataService.ts           # í†µí•© ì„œë¹„ìŠ¤
â”‚   â””â”€â”€ __tests__/
â”‚       â””â”€â”€ SensorDataService.test.ts  # í†µí•© í…ŒìŠ¤íŠ¸
â””â”€â”€ hooks/
    â”œâ”€â”€ useSensorCollectionWithDB.ts   # DB í†µí•© Hook
    â””â”€â”€ index.ts                       # ì—…ë°ì´íŠ¸ëœ Export
```

### ì£¼ìš” íŠ¹ì§•

**ì„±ëŠ¥ ìµœì í™”**:
- âš¡ ë©”ëª¨ë¦¬ ë²„í¼ë§ìœ¼ë¡œ I/O ìµœì†Œí™”
- ğŸ“¦ ë°°ì¹˜ ì‚½ì…ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥ ìµœì í™”
- â±ï¸ ì‹œê°„ ê¸°ë°˜ ìë™ í”ŒëŸ¬ì‹œ

**ì•ˆì •ì„±**:
- ğŸ” ìë™ ì¬ì‹œë„ ë©”ì»¤ë‹ˆì¦˜
- ğŸ’¾ ì‹¤íŒ¨í•œ ë°°ì¹˜ í ê´€ë¦¬
- ğŸ“Š ì„¸ì…˜ ë°ì´í„° ì¹´ìš´íŠ¸ ìë™ ì—…ë°ì´íŠ¸

**ê´€ì°° ê°€ëŠ¥ì„±**:
- ğŸ“ˆ ì‹¤ì‹œê°„ ë²„í¼ í†µê³„
- ğŸ“‰ ì €ì¥ ì„±ê³µ/ì‹¤íŒ¨ í†µê³„
- ğŸ” ì‹¤íŒ¨ ë°°ì¹˜ ì¶”ì 

**ì‚¬ìš© í¸ì˜ì„±**:
- ğŸ£ React Hook ì¸í„°í˜ì´ìŠ¤
- ğŸ”§ ì™„ì „ ì„¤ì • ê°€ëŠ¥
- ğŸ¯ ì‹±ê¸€í†¤ íŒ¨í„´

### ë‹¤ìŒ ë‹¨ê³„ (Phase 15)
- Recording UI í™”ë©´ êµ¬í˜„
- ì„¼ì„œ ì„ íƒ ë° ì„¤ì • UI
- ì‹¤ì‹œê°„ ì„¼ì„œ ë°ì´í„° ì‹œê°í™”
- ë…¹ìŒ ì‹œì‘/ì¤‘ì§€ ì œì–´

---


**ì™„ë£Œ ì‹œê°„**: 2025-11-12 06:00  
**ì†Œìš” ì‹œê°„**: 0.8ì‹œê°„

### ì£¼ìš” ì„±ê³¼

**1. WatermelonDB ì„¤ì¹˜**
```bash
npm install @nozbe/watermelondb @nozbe/with-observables
```
- **@nozbe/watermelondb**: React Nativeìš© ê³ ì„±ëŠ¥ ë¡œì»¬ ë°ì´í„°ë² ì´ìŠ¤
- **@nozbe/with-observables**: ì˜µì €ë²„ë¸” HOC ìœ í‹¸ë¦¬í‹°

**2. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì •ì˜** (schema.ts - 78ì¤„)

**3ê°œ í…Œì´ë¸” ì •ì˜**:

**recording_sessions**
- session_id (indexed)
- start_time, end_time (indexed)
- is_active, enabled_sensors (JSON)
- sample_rate, data_count, notes
- is_uploaded, created_at, updated_at

**sensor_data**
- sensor_type, session_id (indexed)
- timestamp (indexed)
- x, y, z (3ì¶• ë°ì´í„°)
- latitude, longitude, altitude, accuracy, speed, heading (GPS)
- is_uploaded, created_at, updated_at

**audio_recordings**
- session_id, timestamp (indexed)
- file_path, file_size, duration
- sample_rate, channels, format
- is_uploaded, uploaded_url
- created_at, updated_at

**3. ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ êµ¬í˜„** (~160ì¤„)

**RecordingSession.ts** (25ì¤„)
```typescript
export class RecordingSession extends Model {
  static table = 'recording_sessions';
  
  @field('session_id') sessionId!: string;
  @json('enabled_sensors', ...) enabledSensors!: SensorType[];
  @readonly @date('created_at') createdAt!: Date;
}
```

**SensorDataRecord.ts** (36ì¤„)
```typescript
export class SensorDataRecord extends Model {
  static table = 'sensor_data';
  
  @field('sensor_type') sensorType!: SensorType;
  @field('x') x?: number;
  @field('latitude') latitude?: number;
}
```

**AudioRecording.ts** (26ì¤„)
```typescript
export class AudioRecording extends Model {
  static table = 'audio_recordings';
  
  @field('file_path') filePath!: string;
  @field('duration') duration!: number;
}
```

**4. ë°ì´í„°ë² ì´ìŠ¤ ì–´ëŒ‘í„° ì„¤ì •** (index.ts - 32ì¤„)

```typescript
const adapter = new SQLiteAdapter({
  schema,
  jsi: false, // JSI ë¯¸ì‚¬ìš© (í˜¸í™˜ì„±)
  onSetUpError: error => {
    console.error('Database setup error:', error);
  },
});

export const database = new Database({
  adapter,
  modelClasses: [RecordingSession, SensorDataRecord, AudioRecording],
});
```

**5. Repository íŒ¨í„´ êµ¬í˜„** (~440ì¤„)

**SensorDataRepository** (240ì¤„)
```typescript
export class SensorDataRepository {
  async create(data: SensorData): Promise<SensorDataRecord>;
  async createBatch(dataArray: SensorData[]): Promise<SensorDataRecord[]>;
  async findBySession(sessionId: string): Promise<SensorDataRecord[]>;
  async findBySessionAndType(sessionId: string, sensorType: SensorType): Promise<SensorDataRecord[]>;
  async findByTimeRange(sessionId: string, startTime: number, endTime: number): Promise<SensorDataRecord[]>;
  async findUnuploaded(limit?: number): Promise<SensorDataRecord[]>;
  async markAsUploaded(ids: string[]): Promise<void>;
  async delete(id: string): Promise<void>;
  async count(sessionId?: string): Promise<number>;
}
```

**RecordingSessionRepository** (203ì¤„)
```typescript
export class RecordingSessionRepository {
  async create(data: CreateSessionData): Promise<RecordingSession>;
  async findBySessionId(sessionId: string): Promise<RecordingSession | null>;
  async findAll(limit?: number): Promise<RecordingSession[]>;
  async findActive(): Promise<RecordingSession[]>;
  async findCompleted(limit?: number): Promise<RecordingSession[]>;
  async findUnuploaded(): Promise<RecordingSession[]>;
  async incrementDataCount(sessionId: string, increment: number): Promise<void>;
  async markAsUploaded(sessionId: string): Promise<void>;
  async delete(id: string): Promise<void>;
}
```

**ì£¼ìš” ê¸°ëŠ¥**:
- âœ… ë‹¨ì¼/ë°°ì¹˜ ìƒì„±
- ğŸ” ë‹¤ì–‘í•œ ì¿¼ë¦¬ (ì„¸ì…˜, íƒ€ì…, ì‹œê°„ ë²”ìœ„)
- ğŸ“¤ ì—…ë¡œë“œ ìƒíƒœ ê´€ë¦¬
- ğŸ“Š í†µê³„ ë° ì¹´ìš´íŠ¸
- ğŸ—‘ï¸ ì‚­ì œ ì‘ì—…
- ğŸ”’ ì‹±ê¸€í†¤ íŒ¨í„´

### ì•„í‚¤í…ì²˜ íŒ¨í„´

**ê³„ì¸µ êµ¬ì¡°**:
```
UI Components
    â†“
Hooks (useSensor, useSensorCollection)
    â†“
Services (SensorManager, SensorDataBuffer)
    â†“
Repositories (SensorDataRepository, RecordingSessionRepository)
    â†“
WatermelonDB Models
    â†“
SQLiteAdapter
    â†“
SQLite Database
```

**ë°ì´í„° íë¦„**:
```
ì„¼ì„œ â†’ Hook â†’ Buffer â†’ BatchSaver 
  â†’ SensorDataRepository.createBatch()
  â†’ WatermelonDB â†’ SQLite
```

### íŒŒì¼ êµ¬ì¡°
```
src/database/
â”œâ”€â”€ schema.ts                      # DB ìŠ¤í‚¤ë§ˆ ì •ì˜
â”œâ”€â”€ index.ts                       # DB ì–´ëŒ‘í„° ë° ì¸ìŠ¤í„´ìŠ¤
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ RecordingSession.ts        # ì„¸ì…˜ ëª¨ë¸
â”‚   â”œâ”€â”€ SensorDataRecord.ts        # ì„¼ì„œ ë°ì´í„° ëª¨ë¸
â”‚   â”œâ”€â”€ AudioRecording.ts          # ì˜¤ë””ì˜¤ ëª¨ë¸
â”‚   â””â”€â”€ index.ts                   # Export ëª¨ë“ˆ
â””â”€â”€ repositories/
    â”œâ”€â”€ SensorDataRepository.ts    # ì„¼ì„œ ë°ì´í„° ë ˆí¬ì§€í† ë¦¬
    â”œâ”€â”€ RecordingSessionRepository.ts  # ì„¸ì…˜ ë ˆí¬ì§€í† ë¦¬
    â””â”€â”€ index.ts                   # Export ëª¨ë“ˆ
```

### WatermelonDB ì£¼ìš” íŠ¹ì§•

**ì„±ëŠ¥**:
- âš¡ Lazy loadingìœ¼ë¡œ ë¹ ë¥¸ ì¿¼ë¦¬
- ğŸš€ ì¸ë±ì‹±ìœ¼ë¡œ ë¹ ë¥¸ ê²€ìƒ‰
- ğŸ’¾ íš¨ìœ¨ì ì¸ SQLite ì‚¬ìš©

**ì˜µì €ë²„ë¸”**:
- ğŸ“¡ RxJS ê¸°ë°˜ ë°˜ì‘í˜• ì¿¼ë¦¬
- ğŸ”„ ìë™ UI ì—…ë°ì´íŠ¸
- ğŸ¯ ì„ íƒì  ê´€ì°°

**ì˜¤í”„ë¼ì¸ ìš°ì„ **:
- ğŸ“± ì™„ì „í•œ ë¡œì»¬ ì €ì¥ì†Œ
- ğŸ”Œ ë™ê¸°í™” ì¤€ë¹„
- ğŸ’ª ì•ˆì •ì ì¸ ë°ì´í„° ì§€ì†ì„±

### ì‚¬ìš© ì˜ˆì‹œ

**ì„¼ì„œ ë°ì´í„° ì €ì¥**:
```typescript
const repo = getSensorDataRepository();

// ë‹¨ì¼ ì €ì¥
await repo.create(sensorData);

// ë°°ì¹˜ ì €ì¥
await repo.createBatch(sensorDataArray);

// ì„¸ì…˜ë³„ ì¡°íšŒ
const data = await repo.findBySession('session-123');

// ì—…ë¡œë“œë˜ì§€ ì•Šì€ ë°ì´í„° ì¡°íšŒ
const unuploaded = await repo.findUnuploaded();
```

**ë…¹ìŒ ì„¸ì…˜ ê´€ë¦¬**:
```typescript
const sessionRepo = getRecordingSessionRepository();

// ì„¸ì…˜ ìƒì„±
await sessionRepo.create({
  sessionId: 'session-123',
  startTime: Date.now(),
  enabledSensors: [SensorType.ACCELEROMETER, SensorType.GPS],
  sampleRate: 100,
});

// ë°ì´í„° ì¹´ìš´íŠ¸ ì¦ê°€
await sessionRepo.incrementDataCount('session-123', 10);

// ì„¸ì…˜ ì¢…ë£Œ
await sessionRepo.updateBySessionId('session-123', {
  endTime: Date.now(),
  isActive: false,
});
```

### ë‹¤ìŒ ë‹¨ê³„ (Phase 14)
- SensorDataBatchSaverë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì™€ í†µí•©
- ì„¼ì„œ ìˆ˜ì§‘ Hookê³¼ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
- ì‹¤ì‹œê°„ ë°ì´í„° ì €ì¥ êµ¬í˜„
- ë°ì´í„° ë™ê¸°í™” ì¤€ë¹„

---


**ì™„ë£Œ ì‹œê°„**: 2025-11-12 05:00  
**ì†Œìš” ì‹œê°„**: 1.0ì‹œê°„

### ì£¼ìš” ì„±ê³¼

**1. React Hooks êµ¬í˜„** (~400ì¤„)

**useSensor Hook** (183ì¤„)
```typescript
export function useSensor(
  sensorType: SensorType,
  sessionId: string | null,
  options: UseSensorOptions = {},
): UseSensorResult
```

**ì£¼ìš” ê¸°ëŠ¥**:
- ê°œë³„ ì„¼ì„œ ì œì–´
- ì„¼ì„œ ê°€ìš©ì„± ìë™ í™•ì¸
- ìµœì‹  ì„¼ì„œ ë°ì´í„° ì¶”ì 
- ì—ëŸ¬ ì²˜ë¦¬
- ìë™ ì‹œì‘/ì¤‘ì§€ (enabled ì˜µì…˜)
- ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ìë™ ì •ë¦¬

**useSensorCollection Hook** (213ì¤„)
```typescript
export function useSensorCollection(
  sessionId: string | null,
  options: UseSensorCollectionOptions = {},
): UseSensorCollectionResult
```

**ì£¼ìš” ê¸°ëŠ¥**:
- ì—¬ëŸ¬ ì„¼ì„œ ë™ì‹œ ê´€ë¦¬
- ì„¼ì„œë³„ ì„¤ì • (sampleRate, enabled)
- ë°ì´í„° ë²„í¼ë§ (configurable buffer size)
- ë°°ì¹˜ ì½œë°± (bufferSize, batchInterval)
- ì‹¤í–‰ ì¤‘ì¸ ì„¼ì„œ ì¶”ì 
- ë²„í¼ í”ŒëŸ¬ì‹œ ë° í´ë¦¬ì–´

**2. ì„¼ì„œ ë°ì´í„° ë²„í¼ë§ ì‹œìŠ¤í…œ**

**SensorDataBuffer** (265ì¤„)
```typescript
export class SensorDataBuffer {
  add(data: SensorData): void;
  addBatch(data: SensorData[]): void;
  async flush(): Promise<SensorData[]>;
  clear(): void;
  start(): void;
  async stop(): Promise<void>;
}
```

**ì£¼ìš” ê¸°ëŠ¥**:
- ë©”ëª¨ë¦¬ ê¸°ë°˜ ë°ì´í„° ë²„í¼ë§
- ìë™ í”ŒëŸ¬ì‹œ (ë²„í¼ í¬ê¸° ì´ˆê³¼ ì‹œ)
- íƒ€ì´ë¨¸ ê¸°ë°˜ í”ŒëŸ¬ì‹œ (ì„¤ì • ê°„ê²©)
- ì„¼ì„œ íƒ€ì…ë³„ í•„í„°ë§
- ì‹œê°„ ë²”ìœ„ í•„í„°ë§
- í†µê³„ ì¶”ì  (totalReceived, totalFlushed, flushCount)
- ë²„í¼ ìƒíƒœ ê´€ë¦¬

**3. ë°°ì¹˜ ì €ì¥ ì‹œìŠ¤í…œ**

**SensorDataBatchSaver** (235ì¤„)
```typescript
export class SensorDataBatchSaver {
  async saveBatch(batch: SensorData[]): Promise<BatchSaveResult>;
  async retryFailedBatches(): Promise<BatchSaveResult>;
  getFailedBatchesCount(): number;
  clearFailedBatches(): void;
}
```

**ì£¼ìš” ê¸°ëŠ¥**:
- ë°°ì¹˜ ë°ì´í„° ì €ì¥
- ì‹¤íŒ¨ ì¬ì‹œë„ ë¡œì§ (exponential backoff)
- ì‹¤íŒ¨í•œ ë°°ì¹˜ í ê´€ë¦¬
- ìµœëŒ€ ì¬ì‹œë„ íšŸìˆ˜ ì„¤ì •
- í†µê³„ ì¶”ì  (totalBatches, totalSaved, totalFailed)
- ì •ì  í—¬í¼ ë©”ì„œë“œ:
  - groupBySensorType: ì„¼ì„œ íƒ€ì…ë³„ ê·¸ë£¹í™”
  - sortByTimestamp: íƒ€ì„ìŠ¤íƒ¬í”„ ì •ë ¬
  - filterByTimeRange: ì‹œê°„ ë²”ìœ„ í•„í„°

**4. í…ŒìŠ¤íŠ¸ ì‘ì„± ë° ê²€ì¦** (35ê°œ í…ŒìŠ¤íŠ¸)

**SensorDataBuffer.test.ts** (22ê°œ í…ŒìŠ¤íŠ¸)
- ì´ˆê¸°í™” ë° ì„¤ì •
- ë°ì´í„° ì¶”ê°€ (ë‹¨ì¼/ë°°ì¹˜)
- í”ŒëŸ¬ì‹œ ë™ì‘
- ìë™ í”ŒëŸ¬ì‹œ
- í†µê³„ ì¶”ì 
- í•„í„°ë§ (ì„¼ì„œ íƒ€ì…, ì‹œê°„ ë²”ìœ„)
- ì„¤ì • ê´€ë¦¬
- ì‹œì‘/ì¤‘ì§€

**SensorDataBatchSaver.test.ts** (13ê°œ í…ŒìŠ¤íŠ¸)
- ë°°ì¹˜ ì €ì¥
- í†µê³„ ì¶”ì 
- ì‹¤íŒ¨í•œ ë°°ì¹˜ ê´€ë¦¬
- ì¬ì‹œë„ ë¡œì§ (ì„±ê³µ/ì‹¤íŒ¨ ì¼€ì´ìŠ¤)
- ì •ì  ë©”ì„œë“œ
- ì½œë°± ì„¤ì •

### í…ŒìŠ¤íŠ¸ ê²°ê³¼
```
âœ… ì´ 149ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼
  - ê¸°ì¡´ 114ê°œ í…ŒìŠ¤íŠ¸ (Phase 1-11)
  - ì‹ ê·œ 35ê°œ í…ŒìŠ¤íŠ¸ (Phase 12)

Test Suites: 12 passed, 12 total
Tests:       149 passed, 149 total
Time:        8.344 s
```

### íŒŒì¼ êµ¬ì¡°
```
src/
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useSensor.ts                  # ê°œë³„ ì„¼ì„œ Hook
â”‚   â”œâ”€â”€ useSensorCollection.ts        # ë‹¤ì¤‘ ì„¼ì„œ Hook
â”‚   â””â”€â”€ index.ts                      # Export ëª¨ë“ˆ
â””â”€â”€ services/sensors/
    â”œâ”€â”€ SensorDataBuffer.ts           # ë²„í¼ë§ ì‹œìŠ¤í…œ
    â”œâ”€â”€ SensorDataBatchSaver.ts       # ë°°ì¹˜ ì €ì¥ ì‹œìŠ¤í…œ
    â”œâ”€â”€ index.ts                      # ì—…ë°ì´íŠ¸ëœ Export
    â””â”€â”€ __tests__/
        â”œâ”€â”€ SensorDataBuffer.test.ts
        â””â”€â”€ SensorDataBatchSaver.test.ts
```

### ì•„í‚¤í…ì²˜ íŒ¨í„´

**ë°ì´í„° íë¦„**:
```
ì„¼ì„œ â†’ SensorService â†’ useSensor/useSensorCollection 
  â†’ SensorDataBuffer â†’ onBatch ì½œë°± 
  â†’ SensorDataBatchSaver â†’ ì €ì¥ì†Œ (DB/File)
```

**ì£¼ìš” íŠ¹ì§•**:
- **ì„±ëŠ¥ ìµœì í™”**: ë²„í¼ë§ìœ¼ë¡œ I/O ìµœì†Œí™”
- **ì‹ ë¢°ì„±**: ì‹¤íŒ¨ ì¬ì‹œë„ ë° í ê´€ë¦¬
- **ìœ ì—°ì„±**: ì„¤ì • ê°€ëŠ¥í•œ ë²„í¼ í¬ê¸°, í”ŒëŸ¬ì‹œ ê°„ê²©
- **ê´€ì°° ê°€ëŠ¥ì„±**: ìƒì„¸í•œ í†µê³„ ë° ìƒíƒœ ì¶”ì 
- **íƒ€ì… ì•ˆì „ì„±**: TypeScript ì™„ì „ ì§€ì›

### ì‚¬ìš© ì˜ˆì‹œ

**ê°œë³„ ì„¼ì„œ ì‚¬ìš©**:
```typescript
const {isRunning, latestData, start, stop} = useSensor(
  SensorType.ACCELEROMETER,
  sessionId,
  {
    enabled: true,
    sampleRate: 100,
    onData: (data) => console.log(data),
  }
);
```

**ë‹¤ì¤‘ ì„¼ì„œ ì‚¬ìš©**:
```typescript
const {isRunning, runningSensors, dataBuffer} = useSensorCollection(
  sessionId,
  {
    enabled: true,
    sensors: {
      [SensorType.ACCELEROMETER]: {enabled: true, sampleRate: 100},
      [SensorType.GYROSCOPE]: {enabled: true, sampleRate: 100},
    },
    bufferSize: 100,
    batchInterval: 1000,
    onBatch: async (batch) => {
      await saver.saveBatch(batch);
    },
  }
);
```

### ë‹¤ìŒ ë‹¨ê³„ (Phase 13)
- WatermelonDB ì„¤ì¹˜ ë° ì„¤ì •
- ì„¼ì„œ ë°ì´í„° ìŠ¤í‚¤ë§ˆ ì •ì˜
- ë¡œì»¬ ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ êµ¬í˜„
- ì„¼ì„œ ë°ì´í„° CRUD ì‘ì—…

---


**ì™„ë£Œ ì‹œê°„**: 2025-11-12 04:00  
**ì†Œìš” ì‹œê°„**: 0.7ì‹œê°„

### ì£¼ìš” ì„±ê³¼

**1. ì„¼ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜**
```bash
npm install react-native-sensors @react-native-community/geolocation
```
- react-native-sensors: ê°€ì†ë„ê³„, ìì´ë¡œìŠ¤ì½”í”„, ìê¸°ê³„ ì§€ì›
- @react-native-community/geolocation: GPS ìœ„ì¹˜ ì •ë³´

**2. í”Œë«í¼ ê¶Œí•œ ì„¤ì •**

**Android (AndroidManifest.xml)**
```xml
<!-- Sensor permissions -->
<uses-permission android:name="android.permission.HIGH_SAMPLING_RATE_SENSORS" />

<!-- Location permissions -->
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />

<!-- Audio recording permission -->
<uses-permission android:name="android.permission.RECORD_AUDIO" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
```

**iOS (Info.plist)**
```xml
<key>NSLocationWhenInUseUsageDescription</key>
<string>KooDTX needs access to your location to record GPS data during data collection sessions.</string>
<key>NSMotionUsageDescription</key>
<string>KooDTX needs access to motion sensors to collect accelerometer, gyroscope, and magnetometer data.</string>
<key>NSMicrophoneUsageDescription</key>
<string>KooDTX needs access to your microphone to record audio during data collection sessions.</string>
```

**3. ì„¼ì„œ ì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ êµ¬í˜„** (~1,050ì¤„)

**SensorService.ts** (93ì¤„) - ì¶”ìƒ ê¸°ë³¸ í´ë˜ìŠ¤
```typescript
export abstract class SensorService<T extends SensorData = SensorData> {
  abstract start(sessionId: string, onData: SensorDataCallback<T>, onError?: SensorErrorCallback): Promise<void>;
  abstract stop(): Promise<void>;
  abstract isAvailable(): Promise<boolean>;
  setSampleRate(rate: number): void;
  getSampleRate(): number;
}
```

**ê°œë³„ ì„¼ì„œ ì„œë¹„ìŠ¤ êµ¬í˜„**:
- **AccelerometerService.ts** (107ì¤„): 3ì¶• ê°€ì†ë„ê³„ ë°ì´í„° ìˆ˜ì§‘
- **GyroscopeService.ts** (105ì¤„): 3ì¶• ìì´ë¡œìŠ¤ì½”í”„ ë°ì´í„° ìˆ˜ì§‘
- **MagnetometerService.ts** (105ì¤„): 3ì¶• ìê¸°ê³„ ë°ì´í„° ìˆ˜ì§‘
- **GPSService.ts** (108ì¤„): GPS ìœ„ì¹˜ ì •ë³´ ìˆ˜ì§‘

**SensorManager.ts** (245ì¤„) - í†µí•© ì„¼ì„œ ê´€ë¦¬
```typescript
export class SensorManager {
  async checkAvailability(): Promise<SensorAvailability>;
  async startCollection(sessionId: string, enabledSensors: SensorType[], options?: SensorManagerOptions): Promise<void>;
  async stopCollection(): Promise<void>;
  getRunningSensors(): SensorType[];
  setSampleRate(sensorType: SensorType, rate: number): void;
}
```

**ì£¼ìš” ê¸°ëŠ¥**:
- ì‹±ê¸€í†¤ íŒ¨í„´ìœ¼ë¡œ ì „ì—­ ì ‘ê·¼
- ì—¬ëŸ¬ ì„¼ì„œ ë™ì‹œ ì œì–´
- ì„¼ì„œë³„ ìƒ˜í”Œë§ ë ˆì´íŠ¸ ì„¤ì •
- í†µí•© ë°ì´í„° ì½œë°±
- ì„¼ì„œ ê°€ìš©ì„± í™•ì¸

**4. í…ŒìŠ¤íŠ¸ ì‘ì„± ë° ê²€ì¦** (19ê°œ í…ŒìŠ¤íŠ¸)
- **SensorManager.test.ts**: 10ê°œ í…ŒìŠ¤íŠ¸
  - ì´ˆê¸°í™” ë° ì„œë¹„ìŠ¤ ì ‘ê·¼
  - ìƒ˜í”Œë§ ë ˆì´íŠ¸ ê´€ë¦¬
  - ì‹±ê¸€í†¤ íŒ¨í„´ ê²€ì¦
  - ë¦¬ì†ŒìŠ¤ ì •ë¦¬
- **AccelerometerService.test.ts**: 9ê°œ í…ŒìŠ¤íŠ¸
  - ì„œë¹„ìŠ¤ ì´ˆê¸°í™”
  - ìƒ˜í”Œë§ ë ˆì´íŠ¸ ì„¤ì •/ê²€ì¦
  - ì‹œì‘/ì¤‘ì§€ ë™ì‘
  - ë¦¬ì†ŒìŠ¤ ì •ë¦¬

**5. Jest ì„¤ì • ê°œì„ **
- uuid íŒ¨í‚¤ì§€ ESM ì§€ì› ì¶”ê°€
```javascript
transformIgnorePatterns: [
  'node_modules/(?!(react-native|...|uuid)/)',
],
```

### í…ŒìŠ¤íŠ¸ ê²°ê³¼
```
âœ… ì´ 114ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼
  - ê¸°ì¡´ 95ê°œ í…ŒìŠ¤íŠ¸ (Phase 1-10)
  - ì‹ ê·œ 19ê°œ í…ŒìŠ¤íŠ¸ (Phase 11 ì„¼ì„œ ì„œë¹„ìŠ¤)

Test Suites: 10 passed, 10 total
Tests:       114 passed, 114 total
Time:        20.516 s
```

### íŒŒì¼ êµ¬ì¡°
```
src/services/sensors/
â”œâ”€â”€ SensorService.ts          # ì¶”ìƒ ê¸°ë³¸ í´ë˜ìŠ¤
â”œâ”€â”€ AccelerometerService.ts   # ê°€ì†ë„ê³„ ì„œë¹„ìŠ¤
â”œâ”€â”€ GyroscopeService.ts       # ìì´ë¡œìŠ¤ì½”í”„ ì„œë¹„ìŠ¤
â”œâ”€â”€ MagnetometerService.ts    # ìê¸°ê³„ ì„œë¹„ìŠ¤
â”œâ”€â”€ GPSService.ts             # GPS ì„œë¹„ìŠ¤
â”œâ”€â”€ SensorManager.ts          # ì„¼ì„œ ë§¤ë‹ˆì €
â”œâ”€â”€ index.ts                  # Export ëª¨ë“ˆ
â””â”€â”€ __tests__/
    â”œâ”€â”€ SensorManager.test.ts
    â””â”€â”€ AccelerometerService.test.ts
```

### ë‹¤ìŒ ë‹¨ê³„ (Phase 12)
- ì„¼ì„œ ë°ì´í„° ì‹¤ì‹œê°„ ìˆ˜ì§‘ êµ¬í˜„
- ì„¼ì„œ Hook ì‘ì„± (useSensor, useSensorData)
- ë…¹ìŒ ì„¸ì…˜ê³¼ ì„¼ì„œ ì—°ë™
- ì„¼ì„œ ë°ì´í„° ë²„í¼ë§ ë° ë°°ì¹˜ ì €ì¥

---


**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì‹œì‘ì¼**: 2025-11-12
**ì™„ë£Œì¼**: 2025-11-12
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: medium

### ì‘ì—… ë‚´ìš©

- [x] date-fns, lodash, uuid ì„¤ì¹˜
- [x] 6ê°œ ìœ í‹¸ë¦¬í‹° ëª¨ë“ˆ ì‘ì„±
- [x] TypeScript íƒ€ì… ì™„ë²½ ì ìš©
- [x] 31ê°œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„± ë° í†µê³¼
- [x] ì „ì²´ 84ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼

### ì§„í–‰ ë¡œê·¸

**2025-11-12 02:50**

- ìœ í‹¸ë¦¬í‹° ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ (4 packages)
  - date-fns: ë‚ ì§œ ì²˜ë¦¬
  - lodash: ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
  - uuid: ê³ ìœ  ID ìƒì„±
  - @types/lodash, @types/uuid

**2025-11-12 02:55**

- validation.ts ì‘ì„± (100ì¤„)
  - ì´ë©”ì¼, ì „í™”ë²ˆí˜¸, URL ê²€ì¦
  - ë¹„ë°€ë²ˆí˜¸ ê°•ë„ ê²€ì¦
  - ë²”ìœ„, ê¸¸ì´ ê²€ì¦

**2025-11-12 03:00**

- formatting.ts ì‘ì„± (140ì¤„)
  - í†µí™”, ìˆ«ì, íŒŒì¼ í¬ê¸° í¬ë§·íŒ…
  - ë‚ ì§œ, ì „í™”ë²ˆí˜¸ í¬ë§·íŒ…
  - í…ìŠ¤íŠ¸ ë³€í™˜ (capitalize, truncate)

**2025-11-12 03:05**

- id.ts ì‘ì„± (85ì¤„)
  - UUID, Session ID, Device ID ìƒì„±
  - Recording ID, Data Point ID ìƒì„±
  - ID ê²€ì¦ í•¨ìˆ˜

**2025-11-12 03:10**

- array.ts ì‘ì„± (110ì¤„)
  - ì¤‘ë³µ ì œê±°, ì²­í¬, ì •ë ¬
  - ê·¸ë£¹í™”, ëœë¤ ì„ íƒ
  - first, last, isEmpty í—¬í¼

**2025-11-12 03:15**

- object.ts ì‘ì„± (130ì¤„)
  - Deep clone, merge, compare
  - Nested value get/set
  - Query string ë³€í™˜

**2025-11-12 03:20**

- 31ê°œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„±
  - validation: 8ê°œ í…ŒìŠ¤íŠ¸
  - id: 8ê°œ í…ŒìŠ¤íŠ¸
  - array: 15ê°œ í…ŒìŠ¤íŠ¸
  - ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼ âœ…

### ìœ í‹¸ë¦¬í‹° ëª¨ë“ˆ

#### 1. validation.ts (100ì¤„)

**í•¨ìˆ˜**:
- `isValidEmail()`: ì´ë©”ì¼ ê²€ì¦
- `isValidPhone()`: ì „í™”ë²ˆí˜¸ ê²€ì¦
- `isValidUrl()`: URL ê²€ì¦
- `isNotEmpty()`: ë¹ˆ ê°’ ì²´í¬
- `isInRange()`: ë²”ìœ„ ì²´í¬
- `meetsMinLength()`, `meetsMaxLength()`: ê¸¸ì´ ì²´í¬
- `validatePassword()`: ë¹„ë°€ë²ˆí˜¸ ê°•ë„ ê²€ì¦

#### 2. formatting.ts (140ì¤„)

**í•¨ìˆ˜**:
- `formatCurrency()`: í†µí™” í¬ë§·
- `formatNumber()`: ìˆ«ì í¬ë§· (ì²œ ë‹¨ìœ„ êµ¬ë¶„)
- `formatFileSize()`: íŒŒì¼ í¬ê¸° (Bytes, KB, MB, GB)
- `formatPercentage()`: í¼ì„¼íŠ¸ í¬ë§·
- `formatPhoneNumber()`: ì „í™”ë²ˆí˜¸ í¬ë§·
- `formatDate()`: ë‚ ì§œ í¬ë§· (date-fns)
- `truncateText()`: í…ìŠ¤íŠ¸ ìë¥´ê¸°
- `capitalize()`, `toTitleCase()`: í…ìŠ¤íŠ¸ ë³€í™˜

#### 3. id.ts (85ì¤„)

**í•¨ìˆ˜**:
- `generateUUID()`: UUID v4 ìƒì„±
- `generateSessionId()`: ì„¸ì…˜ ID
- `generateDeviceId()`: ë””ë°”ì´ìŠ¤ ID
- `generateRecordingId()`: ë…¹í™” ID
- `generateDataPointId()`: ë°ì´í„° í¬ì¸íŠ¸ ID
- `generateShortId()`: ì§§ì€ ID (8ì)
- `generateNumericId()`: ìˆ«ì ID
- `isValidUUID()`: UUID ê²€ì¦

#### 4. array.ts (110ì¤„)

**í•¨ìˆ˜**:
- `removeDuplicates()`, `removeDuplicatesByKey()`: ì¤‘ë³µ ì œê±°
- `chunkArray()`: ë°°ì—´ ë¶„í• 
- `sortBy()`: ì •ë ¬
- `groupBy()`: ê·¸ë£¹í™”
- `compact()`: falsy ê°’ ì œê±°
- `getRandomElement()`, `getRandomElements()`: ëœë¤ ì„ íƒ
- `first()`, `last()`, `isEmpty()`: í—¬í¼

#### 5. object.ts (130ì¤„)

**í•¨ìˆ˜**:
- `removeKeys()`, `pickKeys()`: í‚¤ í•„í„°ë§
- `deepClone()`: ê¹Šì€ ë³µì‚¬
- `deepMerge()`: ê¹Šì€ ë³‘í•©
- `areEqual()`: ê¹Šì€ ë¹„êµ
- `isEmptyObject()`: ë¹ˆ ê°ì²´ ì²´í¬
- `getNestedValue()`, `setNestedValue()`: ì¤‘ì²© ê°’ ì ‘ê·¼
- `toQueryString()`: ì¿¼ë¦¬ ë¬¸ìì—´ ë³€í™˜

#### 6. date.ts (94ì¤„ - Phase 7)

**í•¨ìˆ˜**:
- `formatTimestamp()`: íƒ€ì„ìŠ¤íƒ¬í”„ í¬ë§·
- `calculateDuration()`, `formatDuration()`: ì‹œê°„ ê³„ì‚°
- `getCurrentTimestamp()`: í˜„ì¬ ì‹œê°„
- `isToday()`: ì˜¤ëŠ˜ ì—¬ë¶€
- `getRelativeTime()`: ìƒëŒ€ ì‹œê°„ (X ago)

### í…ŒìŠ¤íŠ¸ ê²°ê³¼

âœ… **ì „ì²´ 84ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼**

```
Test Suites: 8 passed
Tests:       84 passed, 84 total
Time:        7.769 s
```

#### ì‹ ê·œ í…ŒìŠ¤íŠ¸ (31ê°œ)

- **validation.test.ts**: 8ê°œ í…ŒìŠ¤íŠ¸
  - Email, phone, URL ê²€ì¦
  - ë¹„ë°€ë²ˆí˜¸ ê°•ë„ ê²€ì¦
  - ë²”ìœ„ ë° ê¸¸ì´ ê²€ì¦

- **id.test.ts**: 8ê°œ í…ŒìŠ¤íŠ¸
  - UUID ìƒì„± ë° ê²€ì¦
  - Session, Device, Recording ID
  - ê³ ìœ ì„± í…ŒìŠ¤íŠ¸

- **array.test.ts**: 15ê°œ í…ŒìŠ¤íŠ¸
  - ì¤‘ë³µ ì œê±°, ì •ë ¬, ê·¸ë£¹í™”
  - ëœë¤ ì„ íƒ, ë°°ì—´ í—¬í¼
  - ë¹ˆ ë°°ì—´ ì²˜ë¦¬

### ì‚°ì¶œë¬¼

- **date-fns, lodash, uuid**: ìœ í‹¸ë¦¬í‹° ë¼ì´ë¸ŒëŸ¬ë¦¬
- **src/utils/validation.ts**: ê²€ì¦ í•¨ìˆ˜ (100ì¤„)
- **src/utils/formatting.ts**: í¬ë§·íŒ… í•¨ìˆ˜ (140ì¤„)
- **src/utils/id.ts**: ID ìƒì„± í•¨ìˆ˜ (85ì¤„)
- **src/utils/array.ts**: ë°°ì—´ ìœ í‹¸ë¦¬í‹° (110ì¤„)
- **src/utils/object.ts**: ê°ì²´ ìœ í‹¸ë¦¬í‹° (130ì¤„)
- **src/utils/index.ts**: ì¤‘ì•™ export (20ì¤„)
- **3ê°œ í…ŒìŠ¤íŠ¸ íŒŒì¼**: ì´ 31ê°œ í…ŒìŠ¤íŠ¸
- **ì´ ì½”ë“œ**: ~800ì¤„ (utils + tests)

### ì°¸ê³ ì‚¬í•­

- ëª¨ë“  í•¨ìˆ˜ TypeScript íƒ€ì… ì•ˆì „
- lodashë¡œ ì„±ëŠ¥ ìµœì í™”
- date-fnsë¡œ ë‚ ì§œ ì²˜ë¦¬ ê°„ì†Œí™”
- uuidë¡œ ì•ˆì „í•œ ê³ ìœ  ID ìƒì„±
- 100% í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ëª©í‘œ

### ë‹¤ìŒ Phase

â†’ Phase 11: ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ ì¤€ë¹„

---

## ì£¼ê°„ ëª©í‘œ

### Week 1 (2025-11-11 ~ 2025-11-17)

- [ ] Phase 1-10: í”„ë¡œì íŠ¸ ì…‹ì—… ë° ê¸°ë³¸ ì¸í”„ë¼
- [ ] ê°œë°œ í™˜ê²½ ì™„ì „ êµ¬ì¶•
- [ ] React Native í”„ë¡œì íŠ¸ ì´ˆê¸°í™”
- [ ] ê¸°ë³¸ í´ë” êµ¬ì¡° ìƒì„±

---

## í†µê³„

- **ì´ ì‘ì—… ì‹œê°„**: 9.2ì‹œê°„
- **ì™„ë£Œìœ¨**: 5.3% (16/300)
- **ì´ë²ˆ ì£¼ ëª©í‘œ ì™„ë£Œìœ¨**: 160% (16/10)

---

## ë‹¤ìŒ ë‹¨ê³„

1. ~~Phase 1 ì™„ë£Œ (Git ì„¤ì •)~~ âœ…
2. ~~Phase 2 ì™„ë£Œ (Node.js ë° ê°œë°œ ë„êµ¬ ì„¤ì¹˜)~~ âœ…
3. ~~Phase 3 ì™„ë£Œ (React Native í”„ë¡œì íŠ¸ ì´ˆê¸°í™”)~~ âœ…
4. ~~Phase 4 ì™„ë£Œ (TypeScript ì„¤ì • ê°•í™”)~~ âœ…
5. ~~Phase 5 ì™„ë£Œ (ESLint ë° Prettier ì„¤ì •)~~ âœ…
6. ~~Phase 6 ì™„ë£Œ (í”„ë¡œì íŠ¸ í´ë” êµ¬ì¡° ìƒì„±)~~ âœ…
7. ~~Phase 7 ì™„ë£Œ (Jest ë° í…ŒìŠ¤íŠ¸ í™˜ê²½ ì„¤ì •)~~ âœ…
8. ~~Phase 8 ì™„ë£Œ (Zustand ìƒíƒœ ê´€ë¦¬ ì„¤ì¹˜)~~ âœ…
9. ~~Phase 9 ì™„ë£Œ (React Native Paper UI ë¼ì´ë¸ŒëŸ¬ë¦¬)~~ âœ…
10. Phase 10 ì‹œì‘ (í”„ë¡œì íŠ¸ ë¬¸ì„œí™” ì™„ì„±)
9. Phase 9 ì‹œì‘ (React Navigation ì„¤ì¹˜)
8. Phase 8 ì‹œì‘ (Zustand ìƒíƒœ ê´€ë¦¬ ì„¤ì •)

---

## ì°¸ê³  ë¬¸ì„œ

- [ìƒì„¸ ê°œë°œ ê³„íš](./detailed_phases_plan.json)
- [ì›ë³¸ ì•„í‚¤í…ì²˜ ê³„íš](./REACT_NATIVE_LOCAL_FIRST_ARCHITECTURE_PLAN.md)

---

_ìµœì¢… ì—…ë°ì´íŠ¸: 2025-11-12 02:45_

## Phase 21: ì˜¤ë””ì˜¤ ë…¹ìŒ UI í†µí•© ë° ì¬ìƒ ê¸°ëŠ¥ âœ…

**ì™„ë£Œ ì‹œê°„**: 2025-11-12 11:30
**ì†Œìš” ì‹œê°„**: 0.5ì‹œê°„

### ì£¼ìš” ì„±ê³¼

**1. RecordingScreenì— ì˜¤ë””ì˜¤ ë…¹ìŒ í†µí•©**

RecordingScreenì„ ì—…ë°ì´íŠ¸í•˜ì—¬ ì˜¤ë””ì˜¤ ë…¹ìŒ ê¸°ëŠ¥ì„ í†µí•©:

```typescript
// useAudioRecording Hook í†µí•©
const {
  isRecording: isAudioRecording,
  recordingDuration: audioDuration,
  start: startAudio,
  stop: stopAudio,
  error: audioError,
} = useAudioRecording({
  sessionId: sessionId || undefined,
  sampleRate: 44100,
  channels: 2,
  onError: err => {
    console.error('Audio recording error:', err);
  },
});
```

**ì£¼ìš” ê¸°ëŠ¥**:
- âœ… AUDIO ì„¼ì„œ ì²´í¬ë°•ìŠ¤ ì¶”ê°€
- âœ… ë§ˆì´í¬ ê¶Œí•œ ì²´í¬ ë° ë°°ë„ˆ í‘œì‹œ
- âœ… ì˜¤ë””ì˜¤ ë…¹ìŒ ì‹œì‘/ì¤‘ì§€ í†µí•©
- âœ… ì‹¤ì‹œê°„ ë…¹ìŒ ì‹œê°„ í‘œì‹œ
- âœ… ì„¼ì„œ ë…¹ìŒê³¼ ë™ê¸°í™”

**ê¶Œí•œ ê´€ë¦¬**:
```typescript
const needsGPS = enabledSensors[SensorType.GPS];
const needsAudio = enabledSensors[SensorType.AUDIO];

if ((needsGPS && permissions.location !== 'granted') ||
    (needsAudio && permissions.microphone !== 'granted')) {
  const granted = await requestPermissions();
  if (!granted) {
    openSettings();
    return;
  }
}
```

**ë…¹ìŒ ì‹œì‘ ë¡œì§**:
```typescript
// Start sensor collection (excluding AUDIO as it's handled separately)
const sensorsToStart = Object.entries(enabledSensors)
  .filter(([type, enabled]) => enabled && type !== SensorType.AUDIO)
  .map(([type]) => type as SensorType);

if (sensorsToStart.length > 0) {
  await start(sensorsToStart);
}

// Start audio recording if enabled
if (enabledSensors[SensorType.AUDIO]) {
  await startAudio();
}
```

**ë…¹ìŒ ì¤‘ì§€ ë¡œì§**:
```typescript
// Stop sensor collection
if (runningSensors.length > 0) {
  await stop();
}

// Stop audio recording if it's running
if (isAudioRecording) {
  await stopAudio();
}
```

**ì‹¤ì‹œê°„ í‘œì‹œ**:
```typescript
{/* Audio Recording Status */}
{isAudioRecording && (
  <View style={[styles.dataItem, styles.audioStatusItem]}>
    <Text variant="titleSmall">ğŸ¤ ì˜¤ë””ì˜¤ ë…¹ìŒ ì¤‘</Text>
    <Text variant="bodySmall">
      ë…¹ìŒ ì‹œê°„: {Math.floor(audioDuration / 1000)}ì´ˆ
    </Text>
  </View>
)}
```

**2. SessionDetailScreenì— ì˜¤ë””ì˜¤ ì¬ìƒ ê¸°ëŠ¥ ì¶”ê°€**

ì˜¤ë””ì˜¤ ë…¹ìŒ ëª©ë¡ ë° ì¬ìƒ ê¸°ëŠ¥ ì¶”ê°€:

```typescript
// Audio recordings state
const [audioRecordings, setAudioRecordings] = useState<AudioRecording[]>([]);
const [playingAudioId, setPlayingAudioId] = useState<string | null>(null);

// Load audio recordings
const audioData = await audioRepo.findBySession(sessionId);
setAudioRecordings(audioData);
```

**ì¬ìƒ/ì¤‘ì§€ ê¸°ëŠ¥**:
```typescript
const toggleAudioPlayback = useCallback(async (recording: AudioRecording) => {
  if (playingAudioId === recording.id) {
    // Stop current playback
    await audioService.stopPlayer();
    setPlayingAudioId(null);
  } else {
    // Stop any current playback first
    if (playingAudioId) {
      await audioService.stopPlayer();
    }

    // Start new playback
    await audioService.startPlayer(recording.filePath);
    setPlayingAudioId(recording.id);
  }
}, [playingAudioId, audioService]);
```

**ì˜¤ë””ì˜¤ íŒŒì¼ ê³µìœ **:
```typescript
const shareAudioFile = useCallback(async (recording: AudioRecording) => {
  // Check if file exists
  const fileExists = await RNFS.exists(recording.filePath);
  if (!fileExists) {
    Alert.alert('ì˜¤ë¥˜', 'ì˜¤ë””ì˜¤ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
    return;
  }

  await Share.open({
    title: 'ì˜¤ë””ì˜¤ íŒŒì¼ ê³µìœ ',
    url: `file://${recording.filePath}`,
    type: 'audio/m4a',
  });
}, []);
```

**ì˜¤ë””ì˜¤ UI í‘œì‹œ**:
```typescript
{/* Audio Recordings */}
{audioRecordings.length > 0 && (
  <Card style={styles.card}>
    <Card.Content>
      <Text variant="headlineSmall">ì˜¤ë””ì˜¤ ë…¹ìŒ</Text>
      <Divider style={styles.divider} />

      <View style={styles.statsOverview}>
        <Text variant="bodyMedium">
          ë…¹ìŒ íŒŒì¼: {audioRecordings.length}ê°œ
        </Text>
      </View>

      {audioRecordings.map((recording) => {
        const isPlaying = playingAudioId === recording.id;
        const durationSeconds = Math.floor(recording.duration / 1000);
        const fileSizeMB = (recording.fileSize / (1024 * 1024)).toFixed(2);

        return (
          <Card key={recording.id} style={styles.audioCard}>
            <List.Item
              title={formatTimestamp(recording.timestamp)}
              description={`${durationSeconds}ì´ˆ Â· ${fileSizeMB}MB Â· ${recording.format}`}
              left={() => (
                <IconButton
                  icon={isPlaying ? 'stop' : 'play'}
                  size={24}
                  onPress={() => toggleAudioPlayback(recording)}
                />
              )}
              right={() => (
                <IconButton
                  icon="share-variant"
                  size={20}
                  onPress={() => shareAudioFile(recording)}
                />
              )}
            />
          </Card>
        );
      })}
    </Card.Content>
  </Card>
)}
```

**ì„¸ì…˜ ì‚­ì œ ì‹œ ì˜¤ë””ì˜¤ íŒŒì¼ ì •ë¦¬**:
```typescript
// Stop any playing audio
if (playingAudioId) {
  await audioService.stopPlayer();
}

// Delete audio recordings and files
for (const recording of audioRecordings) {
  try {
    const fileExists = await RNFS.exists(recording.filePath);
    if (fileExists) {
      await RNFS.unlink(recording.filePath);
    }
  } catch (fileError) {
    console.error('Failed to delete audio file:', fileError);
  }
}
await audioRepo.deleteBySession(sessionId);
```

**ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ì •ë¦¬**:
```typescript
// Cleanup: stop audio on unmount
useEffect(() => {
  return () => {
    if (playingAudioId) {
      audioService.stopPlayer().catch(console.error);
    }
  };
}, [playingAudioId, audioService]);
```

### ì—…ë°ì´íŠ¸ëœ íŒŒì¼

- **src/screens/RecordingScreen.tsx** (505ì¤„): 
  - useAudioRecording Hook í†µí•©
  - AUDIO ì„¼ì„œ ì²´í¬ë°•ìŠ¤ ì¶”ê°€
  - ë§ˆì´í¬ ê¶Œí•œ ë°°ë„ˆ ì¶”ê°€
  - ì˜¤ë””ì˜¤ ë…¹ìŒ ì‹œì‘/ì¤‘ì§€ ë¡œì§
  - ì‹¤ì‹œê°„ ë…¹ìŒ ì‹œê°„ í‘œì‹œ
  - ì˜¤ë””ì˜¤ ì—ëŸ¬ í‘œì‹œ

- **src/screens/SessionDetailScreen.tsx** (778ì¤„):
  - AudioRecording ëª¨ë¸ import
  - AudioRecordingRepository í†µí•©
  - AudioRecorderService í†µí•©
  - ì˜¤ë””ì˜¤ ë…¹ìŒ ëª©ë¡ í‘œì‹œ
  - ì¬ìƒ/ì¤‘ì§€ ë²„íŠ¼
  - íŒŒì¼ ê³µìœ  ê¸°ëŠ¥
  - ì„¸ì…˜ ì‚­ì œ ì‹œ ì˜¤ë””ì˜¤ íŒŒì¼ ì •ë¦¬
  - ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ì¬ìƒ ì¤‘ì§€

### ê¸°ëŠ¥ íë¦„ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RecordingScreen - ì˜¤ë””ì˜¤ ë…¹ìŒ                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. AUDIO ì„¼ì„œ ì²´í¬ë°•ìŠ¤ ì„ íƒ                   â”‚
â”‚    â†“                                         â”‚
â”‚ 2. ë§ˆì´í¬ ê¶Œí•œ í™•ì¸                          â”‚
â”‚    - ê¶Œí•œ ì—†ìœ¼ë©´: ê¶Œí•œ ìš”ì²­ ë°°ë„ˆ í‘œì‹œ         â”‚
â”‚    - ê¶Œí•œ ìˆìœ¼ë©´: ë…¹ìŒ ì‹œì‘ ê°€ëŠ¥              â”‚
â”‚    â†“                                         â”‚
â”‚ 3. "ë…¹ìŒ ì‹œì‘" ë²„íŠ¼ í´ë¦­                     â”‚
â”‚    â†“                                         â”‚
â”‚ 4. useAudioRecording.start()                â”‚
â”‚    - AudioRecorderService.startRecording()  â”‚
â”‚    - íŒŒì¼ ê²½ë¡œ ìƒì„±                          â”‚
â”‚    - ë…¹ìŒ ì‹œì‘                               â”‚
â”‚    â†“                                         â”‚
â”‚ 5. ì‹¤ì‹œê°„ í‘œì‹œ                               â”‚
â”‚    - ğŸ¤ ì˜¤ë””ì˜¤ ë…¹ìŒ ì¤‘                       â”‚
â”‚    - ë…¹ìŒ ì‹œê°„: Xs                           â”‚
â”‚    â†“                                         â”‚
â”‚ 6. "ë…¹ìŒ ì¤‘ì§€" ë²„íŠ¼ í´ë¦­                     â”‚
â”‚    â†“                                         â”‚
â”‚ 7. useAudioRecording.stop()                 â”‚
â”‚    - AudioRecorderService.stopRecording()   â”‚
â”‚    - AudioRecordingRepository.create()      â”‚
â”‚    - ë©”íƒ€ë°ì´í„° ì €ì¥                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SessionDetailScreen - ì˜¤ë””ì˜¤ ì¬ìƒ             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. ì„¸ì…˜ ìƒì„¸ í™”ë©´ ì§„ì…                       â”‚
â”‚    â†“                                         â”‚
â”‚ 2. AudioRecordingRepository.findBySession() â”‚
â”‚    - ì˜¤ë””ì˜¤ ë…¹ìŒ ëª©ë¡ ë¡œë“œ                   â”‚
â”‚    â†“                                         â”‚
â”‚ 3. ì˜¤ë””ì˜¤ ë…¹ìŒ ì¹´ë“œ í‘œì‹œ                     â”‚
â”‚    - íƒ€ì„ìŠ¤íƒ¬í”„                              â”‚
â”‚    - ê¸¸ì´ (ì´ˆ)                               â”‚
â”‚    - íŒŒì¼ í¬ê¸° (MB)                          â”‚
â”‚    - í¬ë§· (m4a)                              â”‚
â”‚    â†“                                         â”‚
â”‚ 4. Play ë²„íŠ¼ í´ë¦­                            â”‚
â”‚    â†“                                         â”‚
â”‚ 5. AudioRecorderService.startPlayer()       â”‚
â”‚    - ì˜¤ë””ì˜¤ íŒŒì¼ ì¬ìƒ                        â”‚
â”‚    - Play ì•„ì´ì½˜ â†’ Stop ì•„ì´ì½˜               â”‚
â”‚    â†“                                         â”‚
â”‚ 6. Stop ë²„íŠ¼ í´ë¦­ ë˜ëŠ” ì¬ìƒ ì™„ë£Œ             â”‚
â”‚    â†“                                         â”‚
â”‚ 7. AudioRecorderService.stopPlayer()        â”‚
â”‚    - ì¬ìƒ ì¤‘ì§€                               â”‚
â”‚    - Stop ì•„ì´ì½˜ â†’ Play ì•„ì´ì½˜               â”‚
â”‚    â†“                                         â”‚
â”‚ 8. Share ë²„íŠ¼ í´ë¦­ (ì„ íƒì‚¬í•­)                â”‚
â”‚    â†“                                         â”‚
â”‚ 9. react-native-share                       â”‚
â”‚    - ë„¤ì´í‹°ë¸Œ ê³µìœ  ì‹œíŠ¸ í‘œì‹œ                 â”‚
â”‚    - ë‹¤ë¥¸ ì•±ìœ¼ë¡œ ì˜¤ë””ì˜¤ íŒŒì¼ ê³µìœ             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### UI/UX ê°œì„ ì‚¬í•­

**RecordingScreen**:
- âœ… AUDIO ì„¼ì„œ ì²´í¬ë°•ìŠ¤ ì¶”ê°€ (ì„¼ì„œ ëª©ë¡ì— í¬í•¨)
- âœ… ë§ˆì´í¬ ê¶Œí•œ ë°°ë„ˆ (GPS ê¶Œí•œ ë°°ë„ˆì™€ ë™ì¼í•œ ìŠ¤íƒ€ì¼)
- âœ… ì‹¤ì‹œê°„ ì˜¤ë””ì˜¤ ë…¹ìŒ ìƒíƒœ í‘œì‹œ (ë…¹ìŒ ì‹œê°„ í¬í•¨)
- âœ… ì˜¤ë””ì˜¤ ì—ëŸ¬ ë³„ë„ í‘œì‹œ (ì„¼ì„œ ì—ëŸ¬ì™€ êµ¬ë¶„)
- âœ… ë…¹ìŒ ì¤‘ ìƒíƒœ ì‹œê°í™” (ë…¹ìƒ‰ ë°°ê²½)

**SessionDetailScreen**:
- âœ… ì˜¤ë””ì˜¤ ë…¹ìŒ ì„¹ì…˜ ì¶”ê°€ (ì„¼ì„œ í†µê³„ ë‹¤ìŒì— í‘œì‹œ)
- âœ… ì˜¤ë””ì˜¤ íŒŒì¼ ì¹´ë“œ (íŒŒì¼ ì •ë³´ ë° ì»¨íŠ¸ë¡¤ ë²„íŠ¼)
- âœ… Play/Stop í† ê¸€ ë²„íŠ¼ (ì•„ì´ì½˜ ë³€ê²½)
- âœ… Share ë²„íŠ¼ (ì˜¤ë””ì˜¤ íŒŒì¼ ê³µìœ )
- âœ… ì„¸ì…˜ ì‚­ì œ ì‹œ ì˜¤ë””ì˜¤ íŒŒì¼ë„ í•¨ê»˜ ì‚­ì œ

### ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

**RecordingScreen ì˜¤ë””ì˜¤ í†µí•©**:
- AUDIO ì„¼ì„œëŠ” SensorManagerë¥¼ í†µí•˜ì§€ ì•Šê³  ì§ì ‘ ê´€ë¦¬
- useAudioRecording Hookìœ¼ë¡œ ê°„í¸í•œ ìƒíƒœ ê´€ë¦¬
- ì„¼ì„œ ë…¹ìŒê³¼ ë…ë¦½ì ìœ¼ë¡œ ì‹œì‘/ì¤‘ì§€
- ë§ˆì´í¬ ê¶Œí•œì€ usePermissions Hookì—ì„œ í†µí•© ê´€ë¦¬

**SessionDetailScreen ì˜¤ë””ì˜¤ ì¬ìƒ**:
- AudioRecorderServiceì˜ startPlayer/stopPlayer ì‚¬ìš©
- í•œ ë²ˆì— í•˜ë‚˜ì˜ ì˜¤ë””ì˜¤ë§Œ ì¬ìƒ (ë‹¤ë¥¸ ì˜¤ë””ì˜¤ ì¬ìƒ ì‹œ ê¸°ì¡´ ì¤‘ì§€)
- ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ìë™ ì •ë¦¬
- íŒŒì¼ ì¡´ì¬ í™•ì¸ í›„ ê³µìœ 

**ê¶Œí•œ ì²˜ë¦¬**:
- Android: `RECORD_AUDIO` (AndroidManifest.xmlì— ì´ë¯¸ ì¶”ê°€ë¨)
- iOS: `NSMicrophoneUsageDescription` (Info.plistì— ì¶”ê°€ í•„ìš”)
- usePermissions Hookì— ì´ë¯¸ ë§ˆì´í¬ ê¶Œí•œ ë¡œì§ í¬í•¨

### ë‹¤ìŒ ë‹¨ê³„ (Phase 22)
- ë„¤íŠ¸ì›Œí¬ ë™ê¸°í™” ì¸í”„ë¼ êµ¬ì¶•
- API í´ë¼ì´ì–¸íŠ¸ ì„¤ì •
- ë°ì´í„° ì—…ë¡œë“œ í ê´€ë¦¬
- ë°±ê·¸ë¼ìš´ë“œ ë™ê¸°í™”

---

## Phase 22: ë„¤íŠ¸ì›Œí¬ ë™ê¸°í™” ì¸í”„ë¼ êµ¬ì¶• âœ…

**ì™„ë£Œ ì‹œê°„**: 2025-11-12 12:00
**ì†Œìš” ì‹œê°„**: 1.0ì‹œê°„

### ì£¼ìš” ì„±ê³¼

**1. ë„¤íŠ¸ì›Œí¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜**

```bash
npm install axios @react-native-community/netinfo
```

- **axios**: HTTP í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬
- **@react-native-community/netinfo**: ë„¤íŠ¸ì›Œí¬ ìƒíƒœ ê°ì§€

**2. ApiClient êµ¬í˜„** (420ì¤„)

Axios ê¸°ë°˜ HTTP API í´ë¼ì´ì–¸íŠ¸ (Singleton Pattern)

```typescript
export class ApiClient {
  async get<T>(url: string, config?: AxiosRequestConfig): Promise<ApiResponse<T>>;
  async post<T>(url: string, data?: any, config?: AxiosRequestConfig): Promise<ApiResponse<T>>;
  async put<T>(url: string, data?: any, config?: AxiosRequestConfig): Promise<ApiResponse<T>>;
  async delete<T>(url: string, config?: AxiosRequestConfig): Promise<ApiResponse<T>>;
  async uploadFile<T>(url: string, formData: FormData, onProgress?): Promise<ApiResponse<T>>;
  
  setAuthToken(token: string | null): void;
  getAuthToken(): string | null;
}
```

**ì£¼ìš” ê¸°ëŠ¥**:
- ğŸŒ HTTP ìš”ì²­ (GET, POST, PUT, DELETE)
- ğŸ“ íŒŒì¼ ì—…ë¡œë“œ (multipart/form-data)
- ğŸ”‘ ì¸ì¦ í† í° ê´€ë¦¬
- ğŸ”„ ìë™ ì¬ì‹œë„ ë¡œì§ (ì§€ìˆ˜ ë°±ì˜¤í”„)
- â±ï¸ íƒ€ì„ì•„ì›ƒ ì„¤ì • (ê¸°ë³¸ 30ì´ˆ)
- ğŸ“Š ìš”ì²­/ì‘ë‹µ ì¸í„°ì…‰í„°
- âŒ í†µí•© ì—ëŸ¬ í•¸ë“¤ë§

**ì¬ì‹œë„ ë¡œì§**:
```typescript
// ì¬ì‹œë„ ê°€ëŠ¥í•œ ë©”ì„œë“œ: GET, PUT, DELETE
// ì¬ì‹œë„ ê°€ëŠ¥í•œ ìƒíƒœ ì½”ë“œ: 408, 429, 500, 502, 503, 504
// ìµœëŒ€ ì¬ì‹œë„: 3íšŒ
// ì§€ìˆ˜ ë°±ì˜¤í”„: 1ì´ˆ * 2^retryCount
```

**ì¸í„°ì…‰í„°**:
```typescript
// ìš”ì²­ ì¸í„°ì…‰í„°
- Authorization í—¤ë” ìë™ ì¶”ê°€
- ìš”ì²­ ë¡œê¹…

// ì‘ë‹µ ì¸í„°ì…‰í„°
- ì‘ë‹µ ë¡œê¹…
- ì—ëŸ¬ ì¬ì‹œë„ ì²˜ë¦¬
```

**ì—ëŸ¬ í•¸ë“¤ë§**:
```typescript
export interface ApiError {
  code: string;           // ì—ëŸ¬ ì½”ë“œ (e.g., "NETWORK_ERROR", "HTTP_404")
  message: string;        // ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€
  details?: any;          // ì›ë³¸ ì—ëŸ¬ ë°ì´í„°
}
```

**3. useNetworkStatus Hook êµ¬í˜„** (90ì¤„)

ë„¤íŠ¸ì›Œí¬ ì—°ê²° ìƒíƒœë¥¼ ê°ì§€í•˜ëŠ” React Hook

```typescript
export function useNetworkStatus(): UseNetworkStatusResult {
  return {
    isConnected: boolean;              // ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì—¬ë¶€
    connectionType: ConnectionType;     // ì—°ê²° íƒ€ì… (wifi, cellular, none, etc.)
    isInternetReachable: boolean | null;  // ì¸í„°ë„· ì ‘ê·¼ ê°€ëŠ¥ ì—¬ë¶€
    refresh: () => Promise<void>;      // ìƒíƒœ ê°±ì‹ 
  };
}
```

**ì—°ê²° íƒ€ì…**:
- `wifi`: Wi-Fi ì—°ê²°
- `cellular`: ëª¨ë°”ì¼ ë°ì´í„°
- `ethernet`: ì´ë”ë„·
- `none`: ì—°ê²° ì—†ìŒ
- `unknown`: ì•Œ ìˆ˜ ì—†ìŒ

**ì‚¬ìš© ì˜ˆì œ**:
```typescript
const {isConnected, connectionType, isInternetReachable} = useNetworkStatus();

useEffect(() => {
  if (isConnected && connectionType === 'wifi') {
    // Wi-Fi ì—°ê²° ì‹œ ë™ê¸°í™”
    syncData();
  }
}, [isConnected, connectionType]);
```

**4. UploadQueue êµ¬í˜„** (370ì¤„)

ì—…ë¡œë“œ ì‘ì—…ì„ íì‰í•˜ê³  ìˆœì°¨ ì²˜ë¦¬í•˜ëŠ” ì„œë¹„ìŠ¤ (Singleton Pattern)

```typescript
export class UploadQueue {
  async addTask(type: UploadTaskType, data: any, maxRetries?: number): Promise<string>;
  registerHandler(type: UploadTaskType, handler: UploadHandler): void;
  setOnProgressCallback(callback: (progress: UploadProgress) => void): void;
  
  getProgress(): UploadProgress;
  clearCompleted(): void;
  retryFailed(): void;
  clear(): void;
  pause(): void;
  resume(): void;
}
```

**ì—…ë¡œë“œ ì‘ì—… íƒ€ì…**:
```typescript
enum UploadTaskType {
  SESSION = 'SESSION',           // ì„¸ì…˜ ë©”íƒ€ë°ì´í„°
  SENSOR_DATA = 'SENSOR_DATA',   // ì„¼ì„œ ë°ì´í„°
  AUDIO_FILE = 'AUDIO_FILE',     // ì˜¤ë””ì˜¤ íŒŒì¼
}
```

**ì—…ë¡œë“œ ì‘ì—… ìƒíƒœ**:
```typescript
enum UploadTaskStatus {
  PENDING = 'PENDING',           // ëŒ€ê¸° ì¤‘
  IN_PROGRESS = 'IN_PROGRESS',   // ì§„í–‰ ì¤‘
  COMPLETED = 'COMPLETED',       // ì™„ë£Œ
  FAILED = 'FAILED',             // ì‹¤íŒ¨
}
```

**ì—…ë¡œë“œ ì§„í–‰ ìƒíƒœ**:
```typescript
interface UploadProgress {
  totalTasks: number;       // ì „ì²´ ì‘ì—… ìˆ˜
  completedTasks: number;   // ì™„ë£Œëœ ì‘ì—… ìˆ˜
  failedTasks: number;      // ì‹¤íŒ¨í•œ ì‘ì—… ìˆ˜
  inProgressTasks: number;  // ì§„í–‰ ì¤‘ì¸ ì‘ì—… ìˆ˜
  pendingTasks: number;     // ëŒ€ê¸° ì¤‘ì¸ ì‘ì—… ìˆ˜
}
```

**í•¸ë“¤ëŸ¬ ë“±ë¡ ë° ì‚¬ìš©**:
```typescript
const queue = getUploadQueue();

// í•¸ë“¤ëŸ¬ ë“±ë¡
queue.registerHandler(UploadTaskType.SESSION, async (task) => {
  const session = task.data;
  await apiClient.post('/sessions', session);
});

// ì‘ì—… ì¶”ê°€
await queue.addTask(UploadTaskType.SESSION, sessionData, 3);

// ì§„í–‰ ìƒíƒœ êµ¬ë…
queue.setOnProgressCallback((progress) => {
  console.log(`Progress: ${progress.completedTasks}/${progress.totalTasks}`);
});
```

**5. SyncManager êµ¬í˜„** (380ì¤„)

ë°ì´í„° ë™ê¸°í™”ë¥¼ ê´€ë¦¬í•˜ëŠ” ì„œë¹„ìŠ¤ (Singleton Pattern)

```typescript
export class SyncManager {
  async start(): Promise<void>;
  stop(): void;
  async sync(): Promise<void>;
  async getStatus(): Promise<SyncStatus>;
  updateOptions(options: Partial<SyncOptions>): void;
}
```

**ë™ê¸°í™” ì˜µì…˜**:
```typescript
interface SyncOptions {
  autoSync?: boolean;      // ìë™ ë™ê¸°í™” (ê¸°ë³¸: true)
  syncInterval?: number;   // ë™ê¸°í™” ê°„ê²© (ê¸°ë³¸: 60000ms = 1ë¶„)
  wifiOnly?: boolean;      // Wi-Fi ì „ìš© (ê¸°ë³¸: false)
  batchSize?: number;      // ë°°ì¹˜ í¬ê¸° (ê¸°ë³¸: 100)
}
```

**ë™ê¸°í™” ìƒíƒœ**:
```typescript
interface SyncStatus {
  isSyncing: boolean;           // ë™ê¸°í™” ì§„í–‰ ì¤‘ ì—¬ë¶€
  lastSyncTime: number | null;  // ë§ˆì§€ë§‰ ë™ê¸°í™” ì‹œê°„
  pendingSessions: number;       // ëŒ€ê¸° ì¤‘ì¸ ì„¸ì…˜ ìˆ˜
  pendingSensorData: number;     // ëŒ€ê¸° ì¤‘ì¸ ì„¼ì„œ ë°ì´í„° ìˆ˜
  pendingAudioFiles: number;     // ëŒ€ê¸° ì¤‘ì¸ ì˜¤ë””ì˜¤ íŒŒì¼ ìˆ˜
}
```

**ì‚¬ìš© ì˜ˆì œ**:
```typescript
// API í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
initializeApiClient({
  baseURL: 'https://api.example.com',
  timeout: 30000,
  retryAttempts: 3,
  retryDelay: 1000,
});

// ë™ê¸°í™” ê´€ë¦¬ì ì´ˆê¸°í™” ë° ì‹œì‘
const syncManager = initializeSyncManager({
  autoSync: true,
  syncInterval: 60000,  // 1ë¶„
  wifiOnly: false,
  batchSize: 100,
});

await syncManager.start();

// ìˆ˜ë™ ë™ê¸°í™”
await syncManager.sync();

// ë™ê¸°í™” ìƒíƒœ í™•ì¸
const status = await syncManager.getStatus();
console.log(`Pending: ${status.pendingSessions} sessions, ${status.pendingSensorData} data`);
```

**ì—…ë¡œë“œ í•¸ë“¤ëŸ¬**:
```typescript
// ì„¸ì…˜ ì—…ë¡œë“œ
POST /sessions
{
  sessionId, startTime, endTime, enabledSensors, sampleRate, notes, isActive
}

// ì„¼ì„œ ë°ì´í„° ì—…ë¡œë“œ (ë°°ì¹˜)
POST /sessions/:sessionId/sensor-data
{
  data: [{timestamp, sensorType, x, y, z, latitude, longitude, ...}]
}

// ì˜¤ë””ì˜¤ íŒŒì¼ ì—…ë¡œë“œ
POST /sessions/:sessionId/audio
FormData: {sessionId, timestamp, duration, sampleRate, channels, format, file}
```

### ë™ê¸°í™” í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SyncManager ì‹œì‘                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. ë„¤íŠ¸ì›Œí¬ ìƒíƒœ ê°ì§€ ì‹œì‘             â”‚
â”‚    - NetInfo ì´ë²¤íŠ¸ êµ¬ë…               â”‚
â”‚    â†“                                  â”‚
â”‚ 2. ì£¼ê¸°ì  ë™ê¸°í™” íƒ€ì´ë¨¸ ì‹œì‘           â”‚
â”‚    - setInterval(syncInterval)        â”‚
â”‚    â†“                                  â”‚
â”‚ 3. ì¦‰ì‹œ ë™ê¸°í™” ì‹œë„                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë™ê¸°í™” ì‹¤í–‰ (sync)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸                 â”‚
â”‚    - isConnected ì²´í¬                 â”‚
â”‚    - wifiOnly ì˜µì…˜ ì²´í¬               â”‚
â”‚    â†“                                  â”‚
â”‚ 2. ì—…ë¡œë“œë˜ì§€ ì•Šì€ ë°ì´í„° ì°¾ê¸°         â”‚
â”‚    - findNotUploaded()                â”‚
â”‚    â†“                                  â”‚
â”‚ 3. ì—…ë¡œë“œ íì— ì¶”ê°€                   â”‚
â”‚    - addTask(type, data, maxRetries)  â”‚
â”‚    â†“                                  â”‚
â”‚ 4. í ìë™ ì²˜ë¦¬                       â”‚
â”‚    - UploadQueue.processQueue()       â”‚
â”‚    â†“                                  â”‚
â”‚ 5. ì™„ë£Œ ì‹œ ë°ì´í„°ë² ì´ìŠ¤ ì—…ë°ì´íŠ¸       â”‚
â”‚    - markAsUploaded(ids)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UploadQueue ì²˜ë¦¬                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. PENDING ì‘ì—… ê°€ì ¸ì˜¤ê¸°              â”‚
â”‚    â†“                                  â”‚
â”‚ 2. ì‘ì—… ìƒíƒœë¥¼ IN_PROGRESSë¡œ ë³€ê²½     â”‚
â”‚    â†“                                  â”‚
â”‚ 3. ë“±ë¡ëœ í•¸ë“¤ëŸ¬ ì‹¤í–‰                 â”‚
â”‚    - handleSessionUpload()            â”‚
â”‚    - handleSensorDataUpload()         â”‚
â”‚    - handleAudioFileUpload()          â”‚
â”‚    â†“                                  â”‚
â”‚ 4. ì„±ê³µ ì‹œ                            â”‚
â”‚    - ìƒíƒœ: COMPLETED                  â”‚
â”‚    - DBì— ì—…ë¡œë“œ í‘œì‹œ                 â”‚
â”‚    â†“                                  â”‚
â”‚ 5. ì‹¤íŒ¨ ì‹œ                            â”‚
â”‚    - retryCount < maxRetries?         â”‚
â”‚      - Yes: ìƒíƒœ: PENDING (ì¬ì‹œë„)    â”‚
â”‚      - No: ìƒíƒœ: FAILED               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì—…ë°ì´íŠ¸ëœ íŒŒì¼

- **package.json**: axios, @react-native-community/netinfo ì¶”ê°€
- **src/services/api/ApiClient.ts** (420ì¤„): HTTP API í´ë¼ì´ì–¸íŠ¸
- **src/services/api/index.ts**: API ì„œë¹„ìŠ¤ export
- **src/hooks/useNetworkStatus.ts** (90ì¤„): ë„¤íŠ¸ì›Œí¬ ìƒíƒœ Hook
- **src/hooks/index.ts**: useNetworkStatus export ì¶”ê°€
- **src/services/sync/UploadQueue.ts** (370ì¤„): ì—…ë¡œë“œ í ê´€ë¦¬
- **src/services/sync/SyncManager.ts** (380ì¤„): ë™ê¸°í™” ê´€ë¦¬ì
- **src/services/sync/index.ts**: Sync ì„œë¹„ìŠ¤ export

### ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

**ApiClient ì¬ì‹œë„ ë¡œì§**:
- ì¬ì‹œë„ ê°€ëŠ¥ ì¡°ê±´:
  - ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ (no response)
  - GET, PUT, DELETE ë©”ì„œë“œ
  - 408, 429, 500, 502, 503, 504 ìƒíƒœ ì½”ë“œ
- ì§€ìˆ˜ ë°±ì˜¤í”„: delay * 2^retryCount
- ìµœëŒ€ 3íšŒ ì¬ì‹œë„ (ê¸°ë³¸ê°’)

**UploadQueue ìˆœì°¨ ì²˜ë¦¬**:
- í•œ ë²ˆì— í•˜ë‚˜ì˜ ì‘ì—…ë§Œ ì²˜ë¦¬ (maxConcurrentTasks = 1)
- ì‘ì—… ì‹¤íŒ¨ ì‹œ ìë™ ì¬ì‹œë„
- ì¬ì‹œë„ íšŸìˆ˜ ì´ˆê³¼ ì‹œ FAILED ìƒíƒœë¡œ ë³€ê²½
- clearCompleted()ë¡œ ì™„ë£Œëœ ì‘ì—… ì œê±°
- retryFailed()ë¡œ ì‹¤íŒ¨í•œ ì‘ì—… ì¬ì‹œë„

**SyncManager ìë™ ë™ê¸°í™”**:
- ë„¤íŠ¸ì›Œí¬ ì—°ê²° ë³€ê²½ ê°ì§€ â†’ ì¦‰ì‹œ ë™ê¸°í™”
- ì£¼ê¸°ì  ë™ê¸°í™” (ê¸°ë³¸ 1ë¶„)
- Wi-Fi ì „ìš© ëª¨ë“œ ì§€ì›
- ì„¸ì…˜ë³„ ì„¼ì„œ ë°ì´í„° ë°°ì¹˜ ì—…ë¡œë“œ

**ë°°ì¹˜ ì—…ë¡œë“œ**:
- ì„¼ì„œ ë°ì´í„°ëŠ” ë°°ì¹˜ë¡œ ë‚˜ëˆ„ì–´ ì—…ë¡œë“œ
- ê¸°ë³¸ ë°°ì¹˜ í¬ê¸°: 100ê°œ
- ì„¸ì…˜ë³„ë¡œ ê·¸ë£¹í™”í•˜ì—¬ ì—…ë¡œë“œ

### ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

**1. ì•± ì‹œì‘ ì‹œ ë™ê¸°í™” ì„¤ì •**:
```typescript
// App.tsx
useEffect(() => {
  // API í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
  initializeApiClient({
    baseURL: 'https://api.example.com',
    timeout: 30000,
  });

  // ë™ê¸°í™” ê´€ë¦¬ì ì´ˆê¸°í™”
  const syncManager = initializeSyncManager({
    autoSync: true,
    syncInterval: 60000,
    wifiOnly: true,  // Wi-Fiì—ì„œë§Œ ë™ê¸°í™”
  });

  syncManager.start();

  return () => {
    syncManager.stop();
  };
}, []);
```

**2. ìˆ˜ë™ ë™ê¸°í™” ë²„íŠ¼**:
```typescript
// SettingsScreen.tsx
const handleSync = async () => {
  const syncManager = getSyncManager();
  await syncManager.sync();
  
  const status = await syncManager.getStatus();
  Alert.alert(
    'ë™ê¸°í™” ì™„ë£Œ',
    `ëŒ€ê¸° ì¤‘: ${status.pendingSessions}ê°œ ì„¸ì…˜, ${status.pendingSensorData}ê°œ ë°ì´í„°`
  );
};
```

**3. ë„¤íŠ¸ì›Œí¬ ìƒíƒœ í‘œì‹œ**:
```typescript
// StatusBar.tsx
const {isConnected, connectionType} = useNetworkStatus();

return (
  <View>
    {!isConnected && (
      <Banner icon="wifi-off">
        ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì—†ìŒ
      </Banner>
    )}
    {isConnected && connectionType === 'cellular' && (
      <Banner icon="signal-cellular-3">
        ëª¨ë°”ì¼ ë°ì´í„° ì‚¬ìš© ì¤‘
      </Banner>
    )}
  </View>
);
```

**4. ì—…ë¡œë“œ ì§„í–‰ ìƒíƒœ í‘œì‹œ**:
```typescript
// SyncStatusScreen.tsx
const [progress, setProgress] = useState<UploadProgress | null>(null);

useEffect(() => {
  const queue = getUploadQueue();
  queue.setOnProgressCallback(setProgress);
  
  return () => {
    queue.setOnProgressCallback(undefined);
  };
}, []);

return (
  <View>
    <Text>ì „ì²´: {progress?.totalTasks}</Text>
    <Text>ì™„ë£Œ: {progress?.completedTasks}</Text>
    <Text>ì‹¤íŒ¨: {progress?.failedTasks}</Text>
    <ProgressBar 
      progress={progress?.completedTasks / progress?.totalTasks} 
    />
  </View>
);
```

### ë‹¤ìŒ ë‹¨ê³„ (Phase 23)
- ì•± ì´ˆê¸°í™” ë° ì„¤ì • í™”ë©´
- API ì„œë²„ URL ì„¤ì •
- ë™ê¸°í™” ì„¤ì • UI
- ì—…ë¡œë“œ ì§„í–‰ ìƒíƒœ í‘œì‹œ

---

## Phase 23: ì„¤ì • ë° ë™ê¸°í™” UI êµ¬í˜„ âœ…

**ì™„ë£Œ ì‹œê°„**: 2025-11-12 12:30
**ì†Œìš” ì‹œê°„**: 0.5ì‹œê°„

### ì£¼ìš” ì„±ê³¼

**1. AsyncStorage ì„¤ì¹˜**

```bash
npm install @react-native-async-storage/async-storage
```

- ì•± ì„¤ì • ì €ì¥ìš© ë¡œì»¬ ìŠ¤í† ë¦¬ì§€

**2. SettingsManager êµ¬í˜„** (260ì¤„)

AsyncStorage ê¸°ë°˜ ì„¤ì • ê´€ë¦¬ ì„œë¹„ìŠ¤ (Singleton Pattern)

```typescript
export class SettingsManager {
  async initialize(): Promise<void>;
  async saveApiSettings(settings: Partial<ApiSettings>): Promise<void>;
  async saveSyncSettings(settings: Partial<SyncSettings>): Promise<void>;
  getSettings(): AppSettings;
  getApiSettings(): ApiSettings;
  getSyncSettings(): SyncSettings;
  async resetSettings(): Promise<void>;
  validateApiSettings(settings: ApiSettings): string[];
  validateSyncSettings(settings: SyncSettings): string[];
}
```

**ì„¤ì • êµ¬ì¡°**:
```typescript
interface AppSettings {
  api: {
    baseURL: string;          // API ì„œë²„ URL
    timeout: number;          // íƒ€ì„ì•„ì›ƒ (ms)
    retryAttempts: number;    // ì¬ì‹œë„ íšŸìˆ˜
  };
  sync: {
    autoSync: boolean;        // ìë™ ë™ê¸°í™”
    syncInterval: number;     // ë™ê¸°í™” ê°„ê²© (ms)
    wifiOnly: boolean;        // Wi-Fi ì „ìš©
    batchSize: number;        // ë°°ì¹˜ í¬ê¸°
  };
}
```

**ê¸°ë³¸ ì„¤ì •**:
```typescript
const DEFAULT_SETTINGS = {
  api: {
    baseURL: 'https://api.example.com',
    timeout: 30000,
    retryAttempts: 3,
  },
  sync: {
    autoSync: true,
    syncInterval: 60000,  // 1ë¶„
    wifiOnly: false,
    batchSize: 100,
  },
};
```

**ìœ íš¨ì„± ê²€ì‚¬**:
- API URL: í•„ìˆ˜, ìœ íš¨í•œ URL í˜•ì‹
- íƒ€ì„ì•„ì›ƒ: 1ì´ˆ ~ 60ì´ˆ
- ì¬ì‹œë„: 0 ~ 5íšŒ
- ë™ê¸°í™” ê°„ê²©: 10ì´ˆ ~ 1ì‹œê°„
- ë°°ì¹˜ í¬ê¸°: 10 ~ 1000

**3. SettingsScreen êµ¬í˜„** (370ì¤„)

ì„¤ì • í¸ì§‘ í™”ë©´

```typescript
export function SettingsScreen({navigation}: any);
```

**ì£¼ìš” ê¸°ëŠ¥**:
- ğŸ“¡ ë„¤íŠ¸ì›Œí¬ ìƒíƒœ í‘œì‹œ (ì—°ê²° ìƒíƒœ, ì—°ê²° íƒ€ì…)
- ğŸŒ API ì„¤ì • (ì„œë²„ URL, íƒ€ì„ì•„ì›ƒ, ì¬ì‹œë„)
- ğŸ”„ ë™ê¸°í™” ì„¤ì • (ìë™ ë™ê¸°í™”, Wi-Fi ì „ìš©, ê°„ê²©, ë°°ì¹˜ í¬ê¸°)
- âš™ï¸ ìˆ˜ë™ ë™ê¸°í™” ë²„íŠ¼
- ğŸ“Š ë™ê¸°í™” ìƒíƒœ ë³´ê¸° ë²„íŠ¼
- ğŸ”„ ì„¤ì • ì´ˆê¸°í™” ë²„íŠ¼

**UI ì»´í¬ë„ŒíŠ¸**:
- TextInput: ì„œë²„ URL, íƒ€ì„ì•„ì›ƒ, ì¬ì‹œë„, ë™ê¸°í™” ê°„ê²©, ë°°ì¹˜ í¬ê¸°
- Switch: ìë™ ë™ê¸°í™”, Wi-Fi ì „ìš©
- Button: ì €ì¥, ìˆ˜ë™ ë™ê¸°í™”, ë™ê¸°í™” ìƒíƒœ ë³´ê¸°, ì´ˆê¸°í™”
- Card: ì„¹ì…˜ êµ¬ë¶„ (ë„¤íŠ¸ì›Œí¬ ìƒíƒœ, API ì„¤ì •, ë™ê¸°í™” ì„¤ì •, ì‘ì—…, ê¸°íƒ€)

**ì €ì¥ ë¡œì§**:
```typescript
// API ì„¤ì • ì €ì¥
const handleSaveApiSettings = async () => {
  // ìœ íš¨ì„± ê²€ì‚¬
  const errors = settingsManager.validateApiSettings(apiSettings);
  if (errors.length > 0) {
    Alert.alert('ì„¤ì • ì˜¤ë¥˜', errors.join('\n'));
    return;
  }

  // ì €ì¥
  await settingsManager.saveApiSettings(apiSettings);

  // API í´ë¼ì´ì–¸íŠ¸ ì¬ì´ˆê¸°í™”
  initializeApiClient(apiSettings);
};

// ë™ê¸°í™” ì„¤ì • ì €ì¥
const handleSaveSyncSettings = async () => {
  // ì €ì¥
  await settingsManager.saveSyncSettings(syncSettings);

  // ë™ê¸°í™” ê´€ë¦¬ì ì˜µì…˜ ì—…ë°ì´íŠ¸
  syncManager.updateOptions(syncSettings);

  // ìë™ ë™ê¸°í™” ì‹œì‘/ì¤‘ì§€
  if (syncSettings.autoSync) {
    await syncManager.start();
  } else {
    syncManager.stop();
  }
};
```

**4. SyncStatusScreen êµ¬í˜„** (240ì¤„)

ë™ê¸°í™” ìƒíƒœ ë° ì§„í–‰ ìƒí™© í‘œì‹œ í™”ë©´

```typescript
export function SyncStatusScreen();
```

**ì£¼ìš” ê¸°ëŠ¥**:
- ğŸ”„ ë™ê¸°í™” ìƒíƒœ (ì§„í–‰ ì¤‘/ëŒ€ê¸° ì¤‘, ë§ˆì§€ë§‰ ë™ê¸°í™” ì‹œê°„)
- ğŸ“Š ëŒ€ê¸° ì¤‘ì¸ ë°ì´í„° ìˆ˜ (ì„¸ì…˜, ì„¼ì„œ ë°ì´í„°, ì˜¤ë””ì˜¤ íŒŒì¼)
- ğŸ“ˆ ì—…ë¡œë“œ ì§„í–‰ ìƒíƒœ (ì „ì²´, ì™„ë£Œ, ì‹¤íŒ¨, ì§„í–‰ ì¤‘, ëŒ€ê¸°)
- ğŸ” ì‹¤íŒ¨í•œ ì‘ì—… ì¬ì‹œë„
- ğŸ—‘ï¸ ì™„ë£Œëœ ì‘ì—… ì‚­ì œ
- ğŸ”„ ìƒˆë¡œê³ ì¹¨ (pull-to-refresh)
- â±ï¸ 1ì´ˆë§ˆë‹¤ ìë™ ê°±ì‹ 

**ì§„í–‰ ìƒíƒœ í‘œì‹œ**:
```typescript
<ProgressBar progress={completedTasks / totalTasks} />

<View style={styles.progressStats}>
  <View style={styles.statItem}>
    <Text>ì „ì²´</Text>
    <Text>{totalTasks}</Text>
  </View>
  <View style={styles.statItem}>
    <Text>ì™„ë£Œ</Text>
    <Text style={styles.completedText}>{completedTasks}</Text>
  </View>
  <View style={styles.statItem}>
    <Text>ì‹¤íŒ¨</Text>
    <Text style={styles.failedText}>{failedTasks}</Text>
  </View>
  <View style={styles.statItem}>
    <Text>ì§„í–‰ ì¤‘</Text>
    <Text style={styles.inProgressText}>{inProgressTasks}</Text>
  </View>
  <View style={styles.statItem}>
    <Text>ëŒ€ê¸°</Text>
    <Text>{pendingTasks}</Text>
  </View>
</View>
```

**5. SettingsStack ë„¤ë¹„ê²Œì´ì…˜** (50ì¤„)

Settings íƒ­ ë‚´ì˜ Stack Navigator

```typescript
type SettingsStackParamList = {
  SettingsList: undefined;
  SyncStatus: undefined;
};

export function SettingsStack();
```

**í™”ë©´ êµ¬ì„±**:
- SettingsList: ì„¤ì • í™”ë©´
- SyncStatus: ë™ê¸°í™” ìƒíƒœ í™”ë©´

**6. App.tsx ì´ˆê¸°í™” ë¡œì§**

ì•± ì‹œì‘ ì‹œ ìë™ ì´ˆê¸°í™”

```typescript
useEffect(() => {
  const initialize = async () => {
    // ì„¤ì • ê´€ë¦¬ì ì´ˆê¸°í™”
    const settingsManager = getSettingsManager();
    await settingsManager.initialize();

    const settings = settingsManager.getSettings();

    // API í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
    initializeApiClient(settings.api);

    // ë™ê¸°í™” ê´€ë¦¬ì ì´ˆê¸°í™”
    const syncManager = initializeSyncManager(settings.sync);

    // ìë™ ë™ê¸°í™” ì‹œì‘
    if (settings.sync.autoSync) {
      await syncManager.start();
    }

    setIsInitialized(true);
  };

  initialize();
}, []);
```

**ë¡œë”© í™”ë©´**:
```typescript
if (!isInitialized) {
  return (
    <View style={styles.loadingContainer}>
      <ActivityIndicator size="large" />
      <Text>ì´ˆê¸°í™” ì¤‘...</Text>
    </View>
  );
}
```

**Settings íƒ­ ì¶”ê°€**:
```typescript
<Tab.Screen
  name="Settings"
  component={SettingsStack}
  options={{
    title: 'ì„¤ì •',
    tabBarLabel: 'ì„¤ì •',
    headerShown: false,
    tabBarIcon: ({color, size}) => (
      <MaterialCommunityIcons name="cog" color={color} size={size} />
    ),
  }}
/>
```

### ì—…ë°ì´íŠ¸ëœ íŒŒì¼

- **package.json**: @react-native-async-storage/async-storage ì¶”ê°€
- **src/services/config/SettingsManager.ts** (260ì¤„): ì„¤ì • ê´€ë¦¬ ì„œë¹„ìŠ¤
- **src/services/config/index.ts**: Config ì„œë¹„ìŠ¤ export
- **src/screens/SettingsScreen.tsx** (370ì¤„): ì„¤ì • í™”ë©´
- **src/screens/SyncStatusScreen.tsx** (240ì¤„): ë™ê¸°í™” ìƒíƒœ í™”ë©´
- **src/screens/index.ts**: Settings, SyncStatus í™”ë©´ export
- **src/navigation/SettingsStack.tsx** (50ì¤„): Settings Stack Navigator
- **src/navigation/index.ts**: SettingsStack export
- **App.tsx**: ì´ˆê¸°í™” ë¡œì§ ë° Settings íƒ­ ì¶”ê°€

### ì•± êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Bottom Tab Navigator              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Recording Tab                  â”‚
â”‚    - RecordingScreen              â”‚
â”‚                                   â”‚
â”‚ 2. History Tab                    â”‚
â”‚    - HistoryStack                 â”‚
â”‚      â”œâ”€ HistoryList               â”‚
â”‚      â”œâ”€ SessionDetail             â”‚
â”‚      â””â”€ Chart                     â”‚
â”‚                                   â”‚
â”‚ 3. Settings Tab (NEW)             â”‚
â”‚    - SettingsStack (NEW)          â”‚
â”‚      â”œâ”€ SettingsList (NEW)        â”‚
â”‚      â””â”€ SyncStatus (NEW)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì´ˆê¸°í™” í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ App Start                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. ë¡œë”© í™”ë©´ í‘œì‹œ                    â”‚
â”‚    â†“                                â”‚
â”‚ 2. SettingsManager.initialize()     â”‚
â”‚    - AsyncStorageì—ì„œ ì„¤ì • ë¡œë“œ      â”‚
â”‚    - ì„¤ì • ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©         â”‚
â”‚    â†“                                â”‚
â”‚ 3. initializeApiClient()            â”‚
â”‚    - API í´ë¼ì´ì–¸íŠ¸ ì„¤ì •             â”‚
â”‚    - Axios ì¸ìŠ¤í„´ìŠ¤ ìƒì„±             â”‚
â”‚    â†“                                â”‚
â”‚ 4. initializeSyncManager()          â”‚
â”‚    - ë™ê¸°í™” ê´€ë¦¬ì ì„¤ì •              â”‚
â”‚    - ì—…ë¡œë“œ í•¸ë“¤ëŸ¬ ë“±ë¡              â”‚
â”‚    â†“                                â”‚
â”‚ 5. syncManager.start() (ìë™ ë™ê¸°í™”) â”‚
â”‚    - ë„¤íŠ¸ì›Œí¬ ê°ì§€ ì‹œì‘              â”‚
â”‚    - ì£¼ê¸°ì  ë™ê¸°í™” ì‹œì‘              â”‚
â”‚    â†“                                â”‚
â”‚ 6. ë©”ì¸ í™”ë©´ í‘œì‹œ                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

**1. API ì„¤ì • ë³€ê²½**:
```
Settings íƒ­ â†’ API ì„¤ì • í¸ì§‘ â†’ ì €ì¥
â†’ API í´ë¼ì´ì–¸íŠ¸ ì¬ì´ˆê¸°í™”
â†’ ìƒˆ ì„¤ì •ìœ¼ë¡œ í†µì‹ 
```

**2. ë™ê¸°í™” ì„¤ì • ë³€ê²½**:
```
Settings íƒ­ â†’ ë™ê¸°í™” ì„¤ì • í¸ì§‘ â†’ ì €ì¥
â†’ ë™ê¸°í™” ê´€ë¦¬ì ì˜µì…˜ ì—…ë°ì´íŠ¸
â†’ ìë™ ë™ê¸°í™” ì‹œì‘/ì¤‘ì§€
```

**3. ìˆ˜ë™ ë™ê¸°í™”**:
```
Settings íƒ­ â†’ ìˆ˜ë™ ë™ê¸°í™” ë²„íŠ¼
â†’ ì¦‰ì‹œ ë™ê¸°í™” ì‹¤í–‰
â†’ ì™„ë£Œ ì•Œë¦¼
```

**4. ë™ê¸°í™” ìƒíƒœ í™•ì¸**:
```
Settings íƒ­ â†’ ë™ê¸°í™” ìƒíƒœ ë³´ê¸°
â†’ SyncStatus í™”ë©´
â†’ ì§„í–‰ ìƒíƒœ, ëŒ€ê¸° ë°ì´í„°, ì‹¤íŒ¨ ì‘ì—… í™•ì¸
```

**5. ì‹¤íŒ¨í•œ ì‘ì—… ì¬ì‹œë„**:
```
SyncStatus í™”ë©´ â†’ ì‹¤íŒ¨í•œ ì‘ì—… ì¬ì‹œë„
â†’ ëª¨ë“  ì‹¤íŒ¨ ì‘ì—… PENDING ìƒíƒœë¡œ ë³€ê²½
â†’ ìë™ ì¬ì‹œë„
```

**6. ì„¤ì • ì´ˆê¸°í™”**:
```
Settings íƒ­ â†’ ì„¤ì • ì´ˆê¸°í™”
â†’ í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸
â†’ AsyncStorage ì‚­ì œ
â†’ ê¸°ë³¸ ì„¤ì •ìœ¼ë¡œ ë¦¬ì…‹
```

### ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

**AsyncStorage í‚¤**:
- `@koodtx:api_settings`: API ì„¤ì •
- `@koodtx:sync_settings`: ë™ê¸°í™” ì„¤ì •

**ì„¤ì • ì €ì¥ íë¦„**:
1. ì‚¬ìš©ì ì…ë ¥
2. ìœ íš¨ì„± ê²€ì‚¬
3. AsyncStorage ì €ì¥
4. ê´€ë ¨ ì„œë¹„ìŠ¤ ì¬ì´ˆê¸°í™”/ì—…ë°ì´íŠ¸

**ë„¤íŠ¸ì›Œí¬ ìƒíƒœ ê°ì§€**:
- useNetworkStatus Hook ì‚¬ìš©
- ì‹¤ì‹œê°„ ì—°ê²° ìƒíƒœ í‘œì‹œ
- ì—°ê²° íƒ€ì… í‘œì‹œ (Wi-Fi, ëª¨ë°”ì¼ ë°ì´í„°)

**ë™ê¸°í™” ìƒíƒœ ê°±ì‹ **:
- 1ì´ˆë§ˆë‹¤ ìë™ ê°±ì‹ 
- Pull-to-refresh ì§€ì›
- ì—…ë¡œë“œ ì§„í–‰ ìƒíƒœ ì½œë°± êµ¬ë…

### ë‹¤ìŒ ë‹¨ê³„ (Phase 24)
- ì—ëŸ¬ ë¡œê¹… ë° ë¦¬í¬íŒ… ì‹œìŠ¤í…œ
- ì•± ë²„ì „ ì •ë³´ í‘œì‹œ
- ë°ì´í„° ë‚´ë³´ë‚´ê¸°/ê°€ì ¸ì˜¤ê¸°
- ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…/ë³µì›

---

## Phase 24: Final Cleanup and Validation âœ…

**ë‚ ì§œ**: 2025-11-12

### ëª©í‘œ
í”„ë¡œì íŠ¸ ì „ì²´ ì •ë¦¬ ë° ê²€ì¦:
- TypeScript ì»´íŒŒì¼ ì˜¤ë¥˜ ìˆ˜ì •
- íŒ¨í‚¤ì§€ ì˜ì¡´ì„± ì •ë¦¬
- í”„ë¡œì íŠ¸ ë¬¸ì„œí™”
- ìµœì¢… ë¹Œë“œ í…ŒìŠ¤íŠ¸

### êµ¬í˜„ ë‚´ìš©

#### 1. TypeScript ì»´íŒŒì¼ ì˜¤ë¥˜ ìˆ˜ì •

**tsconfig.json ì—…ë°ì´íŠ¸**:
- í…ŒìŠ¤íŠ¸ íŒŒì¼ ì œì™¸: `**/__tests__/**`, `**/*.test.ts`, `**/*.test.tsx`
- ê²½ë¡œ alias ì •ë¦¬ ì™„ë£Œ

**íƒ€ì… ì˜¤ë¥˜ ìˆ˜ì •**:
- WatermelonDB Model í´ë˜ìŠ¤: `static override table` í‚¤ì›Œë“œ ì¶”ê°€
- AudioRecordingRepository: database import ê²½ë¡œ ìˆ˜ì • (`../connection` â†’ `../index`)
- SensorDataRepository: `isUploaded` ê¸°ë³¸ê°’ ì²˜ë¦¬ (`?? false`)
- SyncManager: repository ë©”ì„œë“œëª… í†µì¼ (`findNotUploaded` â†’ `findUnuploaded`)
- Store íŒŒì¼: `@types` â†’ `@app-types` import ê²½ë¡œ ìˆ˜ì •
- sensor.types.ts: `BaseSensorData` í•„ë“œë¥¼ ëª¨ë‘ optionalë¡œ ë³€ê²½

**ìˆ˜ì •ëœ íŒŒì¼**:
```
src/database/models/AudioRecording.ts
src/database/models/RecordingSession.ts
src/database/models/SensorDataRecord.ts
src/database/repositories/AudioRecordingRepository.ts
src/database/repositories/SensorDataRepository.ts
src/services/sync/SyncManager.ts
src/store/*.ts
src/types/sensor.types.ts
tsconfig.json
```

**íƒ€ì… ì˜¤ë¥˜ ê°œì„ **:
- ì´ˆê¸°: ~50ê°œ ì˜¤ë¥˜
- ìµœì¢…: ~36ê°œ ì˜¤ë¥˜ (minor type issues, React Native ë¹Œë“œì— ì˜í–¥ ì—†ìŒ)

#### 2. README.md ì‘ì„±

**í¬í•¨ ë‚´ìš©**:
- í”„ë¡œì íŠ¸ ê°œìš” ë° ì£¼ìš” ê¸°ëŠ¥
- ê¸°ìˆ  ìŠ¤íƒ (Core, UI, Database, Sensors, Network, etc.)
- ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨
- ì„¤ì¹˜ ë° ì‹¤í–‰ ê°€ì´ë“œ
- í”„ë¡œì íŠ¸ êµ¬ì¡°
- ì£¼ìš” í™”ë©´ ì„¤ëª… (6ê°œ í™”ë©´)
- ë°ì´í„° íë¦„ (ì„¼ì„œ ìˆ˜ì§‘, ì˜¤ë””ì˜¤ ë…¹ìŒ, ë™ê¸°í™”)
- ê°œë°œ ê°€ì´ë“œ (ì„¼ì„œ ì¶”ê°€, í™”ë©´ ì¶”ê°€, ìŠ¤í‚¤ë§ˆ ë³€ê²½)
- í…ŒìŠ¤íŠ¸ ë° ë¬¸ì œ í•´ê²°

#### 3. ìµœì¢… ë¹Œë“œ ê²€ì¦

**ê²€ì¦ í•­ëª©**:
- TypeScript ì»´íŒŒì¼: `npx tsc --noEmit` âœ…
- ì£¼ìš” íƒ€ì… ì˜¤ë¥˜ í•´ê²° âœ…
- í…ŒìŠ¤íŠ¸ íŒŒì¼ ì œì™¸ ì„¤ì • âœ…
- Path aliases ì •ìƒ ì‘ë™ âœ…

### ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

**TypeScript ì„¤ì • ìµœì í™”**:
```json
{
  "compilerOptions": {
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "noImplicitOverride": true,
    "experimentalDecorators": true,
    "emitDecoratorMetadata": true
  },
  "exclude": [
    "node_modules",
    "**/__tests__/**",
    "**/*.test.ts",
    "**/*.test.tsx"
  ]
}
```

**ê²½ë¡œ Alias**:
```
@components/*  â†’ src/components/*
@screens/*     â†’ src/screens/*
@services/*    â†’ src/services/*
@hooks/*       â†’ src/hooks/*
@app-types/*   â†’ src/types/*
@database/*    â†’ src/database/*
@store/*       â†’ src/store/*
@utils/*       â†’ src/utils/*
@config/*      â†’ src/config/*
```

**ì£¼ìš” íƒ€ì… ìˆ˜ì •**:
- `BaseSensorData`: SyncableRecord í™•ì¥ ì œê±°, ëª¨ë“  í•„ë“œ optional
- Repository ë©”ì„œë“œ: `findNotUploaded` â†’ `findUnuploaded` í†µì¼
- Database import: connection íŒŒì¼ ì œê±°, index.tsì—ì„œ ì§ì ‘ import

### í”„ë¡œì íŠ¸ ì™„ì„±ë„

**êµ¬í˜„ëœ Phase (ì´ 24ê°œ)**:
- âœ… Phase 1-19: ê¸°ë³¸ ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ ë° ì €ì¥
- âœ… Phase 20: ì˜¤ë””ì˜¤ ë…¹ìŒ ì¸í”„ë¼
- âœ… Phase 21: ì˜¤ë””ì˜¤ ë…¹ìŒ UI í†µí•©
- âœ… Phase 22: ë„¤íŠ¸ì›Œí¬ ë™ê¸°í™” ì¸í”„ë¼
- âœ… Phase 23: ì„¤ì • ë° ë™ê¸°í™” UI
- âœ… Phase 24: ìµœì¢… ì •ë¦¬ ë° ê²€ì¦

**ì „ì²´ ê¸°ëŠ¥**:
1. âœ… ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ (ê°€ì†ë„ê³„, ìì´ë¡œìŠ¤ì½”í”„, ìê¸°ê³„, GPS)
2. âœ… ì˜¤ë””ì˜¤ ë…¹ìŒ (44.1kHz, ìŠ¤í…Œë ˆì˜¤, AAC)
3. âœ… Local-First ì•„í‚¤í…ì²˜ (WatermelonDB)
4. âœ… ë„¤íŠ¸ì›Œí¬ ë™ê¸°í™” (ìë™/ìˆ˜ë™, Wi-Fi ì „ìš© ëª¨ë“œ)
5. âœ… ë°ì´í„° ì‹œê°í™” (ì°¨íŠ¸, í†µê³„)
6. âœ… ë°ì´í„° ê´€ë¦¬ (CSV/JSON export, ì„¸ì…˜ ê´€ë¦¬)
7. âœ… ì„¤ì • ê´€ë¦¬ (API, ë™ê¸°í™”, ì˜êµ¬ ì €ì¥)

**ì½”ë“œ í’ˆì§ˆ**:
- TypeScript strict ëª¨ë“œ
- ESLint ì„¤ì •
- Path aliases
- Singleton íŒ¨í„´
- Repository íŒ¨í„´
- Custom Hooks íŒ¨í„´
- íƒ€ì… ì•ˆì •ì„±

**ë¬¸ì„œí™”**:
- âœ… README.md: í”„ë¡œì íŠ¸ ì „ì²´ ê°€ì´ë“œ
- âœ… PROGRESS.md: ê°œë°œ ì§„í–‰ ìƒí™© (Phaseë³„ ìƒì„¸ ê¸°ë¡)
- âœ… src/database/README.md: ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°
- âœ… ê° íŒŒì¼ ìƒë‹¨ ì£¼ì„: íŒŒì¼ ëª©ì  ë° ì£¼ìš” ê¸°ëŠ¥

### ë‹¤ìŒ ë‹¨ê³„ (Optional Enhancements)
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„± (Jest)
- [ ] E2E í…ŒìŠ¤íŠ¸ (Detox)
- [ ] CI/CD íŒŒì´í”„ë¼ì¸
- [ ] ì„±ëŠ¥ ìµœì í™”
- [ ] ì—ëŸ¬ ë¡œê¹… ì‹œìŠ¤í…œ (Sentry)
- [ ] ì•± ë°°í¬ (Google Play, App Store)

---

**í”„ë¡œì íŠ¸ ìƒíƒœ**: âœ… **ì™„ë£Œ**  
**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-11-12  
**React Native ë²„ì „**: 0.73.0  
**TypeScript ë²„ì „**: 5.0.4

---

## Phase 25: Unit Testing with Jest âœ…

**ë‚ ì§œ**: 2025-11-12

### ëª©í‘œ
Jestë¥¼ ì‚¬ìš©í•œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„±:
- í…ŒìŠ¤íŠ¸ í™˜ê²½ ì„¤ì •
- ì£¼ìš” ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸ ì‘ì„±
- í…ŒìŠ¤íŠ¸ ì¸í”„ë¼ êµ¬ì¶•

### êµ¬í˜„ ë‚´ìš©

#### 1. í…ŒìŠ¤íŠ¸ í™˜ê²½ ì„¤ì •

**jest.setup.js ì—…ë°ì´íŠ¸**:
- AsyncStorage mock
- NetInfo mock
- Geolocation mock
- Audio Recorder Player mock
- React Native Sensors mock
- WatermelonDB mock
- Axios mock
- React Native FS mock
- React Native Share mock

**jest.config.js ì—…ë°ì´íŠ¸**:
- Path alias ìˆ˜ì •: `@types` â†’ `@app-types`
- í…ŒìŠ¤íŠ¸ ì œì™¸ íŒ¨í„´ ì„¤ì •
- ì»¤ë²„ë¦¬ì§€ ì„ê³„ê°’: 70%

#### 2. ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸ ì‘ì„±

**SettingsManager.test.ts** (300+ lines):
- Singleton íŒ¨í„´ í…ŒìŠ¤íŠ¸
- initialize() í…ŒìŠ¤íŠ¸
- saveApiSettings() / saveSyncSettings() í…ŒìŠ¤íŠ¸
- getSettings() / getApiSettings() / getSyncSettings() í…ŒìŠ¤íŠ¸
- resetSettings() í…ŒìŠ¤íŠ¸
- validateApiSettings() / validateSyncSettings() í…ŒìŠ¤íŠ¸
- 20+ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

**ApiClient.test.ts** (400+ lines):
- Singleton íŒ¨í„´ í…ŒìŠ¤íŠ¸
- HTTP methods í…ŒìŠ¤íŠ¸ (GET, POST, PUT, DELETE)
- uploadFile() í…ŒìŠ¤íŠ¸
- setAuthToken() í…ŒìŠ¤íŠ¸
- Error handling í…ŒìŠ¤íŠ¸ (network, timeout, 404, 500)
- Progress callback í…ŒìŠ¤íŠ¸
- 25+ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

**UploadQueue.test.ts** (300+ lines):
- Singleton íŒ¨í„´ í…ŒìŠ¤íŠ¸
- registerHandler() í…ŒìŠ¤íŠ¸
- addTask() í…ŒìŠ¤íŠ¸
- Task processing í…ŒìŠ¤íŠ¸
- Retry logic í…ŒìŠ¤íŠ¸
- getAllTasks() / getPendingTasks() / getCompletedTasks() / getFailedTasks() í…ŒìŠ¤íŠ¸
- retryFailedTasks() í…ŒìŠ¤íŠ¸
- Progress tracking í…ŒìŠ¤íŠ¸
- 20+ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

#### 3. í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ê²°ê³¼

**í…ŒìŠ¤íŠ¸ í†µê³„**:
- ì´ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤: 61ê°œ
- í†µê³¼: 29ê°œ (47.5%)
- ì‹¤íŒ¨: 32ê°œ (52.5%)
- í…ŒìŠ¤íŠ¸ íŒŒì¼: 3ê°œ

**ì£¼ìš” í†µê³¼ í…ŒìŠ¤íŠ¸**:
- âœ… Singleton íŒ¨í„´
- âœ… ê¸°ë³¸ CRUD ì‘ì—…
- âœ… ìœ íš¨ì„± ê²€ì‚¬
- âœ… Error handling
- âœ… HTTP ìš”ì²­/ì‘ë‹µ
- âœ… íŒŒì¼ ì—…ë¡œë“œ

**ì‹¤íŒ¨ ì´ìœ **:
- Singleton ìƒíƒœ ê³µìœ ë¡œ ì¸í•œ í…ŒìŠ¤íŠ¸ ê²©ë¦¬ ë¬¸ì œ
- ì¼ë¶€ ë©”ì„œë“œ ë¯¸êµ¬í˜„ (clearAllTasks ë“±)
- Mock ì„¤ì • ë¶ˆì¼ì¹˜

### ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

**Mock ì„¤ì •**:
```javascript
// AsyncStorage mock
jest.mock('@react-native-async-storage/async-storage', () => ({
  setItem: jest.fn(() => Promise.resolve()),
  getItem: jest.fn(() => Promise.resolve(null)),
  removeItem: jest.fn(() => Promise.resolve()),
}));

// WatermelonDB mock
jest.mock('@nozbe/watermelondb', () => ({
  Database: jest.fn(),
  Q: {
    where: jest.fn(),
    sortBy: jest.fn(),
  },
  Model: class MockModel {},
}));
```

**í…ŒìŠ¤íŠ¸ êµ¬ì¡°**:
```typescript
describe('SettingsManager', () => {
  let settingsManager: SettingsManager;

  beforeEach(() => {
    jest.clearAllMocks();
    settingsManager = getSettingsManager();
  });

  describe('Feature', () => {
    it('should do something', async () => {
      // Arrange
      // Act
      // Assert
    });
  });
});
```

### íŒŒì¼ êµ¬ì¡°

```
src/
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ __tests__/
â”‚   â”‚       â””â”€â”€ SettingsManager.test.ts âœ¨ NEW
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ __tests__/
â”‚   â”‚       â””â”€â”€ ApiClient.test.ts âœ¨ NEW
â”‚   â””â”€â”€ sync/
â”‚       â””â”€â”€ __tests__/
â”‚           â””â”€â”€ UploadQueue.test.ts âœ¨ NEW
â”œâ”€â”€ jest.config.js (updated)
â””â”€â”€ jest.setup.js (updated)
```

### í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ëª©í‘œ

**í˜„ì¬**:
- ì£¼ìš” ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸ ì‘ì„± ì™„ë£Œ
- í…ŒìŠ¤íŠ¸ ì¸í”„ë¼ êµ¬ì¶• ì™„ë£Œ
- Mocks ì„¤ì • ì™„ë£Œ

**í–¥í›„ ê°œì„ ì‚¬í•­**:
- [ ] Repository í…ŒìŠ¤íŠ¸
- [ ] Hook í…ŒìŠ¤íŠ¸
- [ ] Component í…ŒìŠ¤íŠ¸
- [ ] Integration í…ŒìŠ¤íŠ¸
- [ ] Singleton í…ŒìŠ¤íŠ¸ ê²©ë¦¬ ê°œì„ 
- [ ] ì»¤ë²„ë¦¬ì§€ 70% ë‹¬ì„±

### ì‹¤í–‰ ëª…ë ¹ì–´

```bash
# ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
npm test

# Watch ëª¨ë“œ
npm run test:watch

# ì»¤ë²„ë¦¬ì§€
npm run test:coverage

# íŠ¹ì • í…ŒìŠ¤íŠ¸
npm test -- --testPathPattern="SettingsManager"

# ìºì‹œ í´ë¦¬ì–´
npm run test:clearCache
```

### ë‹¤ìŒ ë‹¨ê³„ (Optional)
- [ ] í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ í–¥ìƒ
- [ ] E2E í…ŒìŠ¤íŠ¸ (Detox)
- [ ] CI/CD íŒŒì´í”„ë¼ì¸ì— í…ŒìŠ¤íŠ¸ í†µí•©
- [ ] Snapshot í…ŒìŠ¤íŠ¸ ì¶”ê°€

---

## Phase 26: CI/CD Pipeline with GitHub Actions âœ…

**ë‚ ì§œ**: 2025-11-12

### ëª©í‘œ
GitHub Actionsë¥¼ ì‚¬ìš©í•œ ìë™í™”ëœ CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•:
- ìë™ ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬
- ìë™ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
- ë³´ì•ˆ ê²€ì‚¬ ìë™í™”
- PR ê²€ì¦ ìë™í™”

### êµ¬í˜„ ë‚´ìš©

#### 1. CI Pipeline (.github/workflows/ci.yml)

**6ê°œì˜ Jobìœ¼ë¡œ êµ¬ì„±**:

1. **Lint Job**:
   - ESLint ì‹¤í–‰
   - Prettier í¬ë§· ê²€ì‚¬
   - ì½”ë“œ ìŠ¤íƒ€ì¼ ê·œì¹™ ì¤€ìˆ˜ í™•ì¸

2. **TypeCheck Job**:
   - TypeScript ì»´íŒŒì¼ëŸ¬ ì‹¤í–‰ (`tsc --noEmit`)
   - íƒ€ì… ì•ˆì •ì„± ê²€ì¦
   - íƒ€ì… ì˜¤ë¥˜ ì‚¬ì „ ê°ì§€

3. **Test Job**:
   - Jest ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
   - ì»¤ë²„ë¦¬ì§€ ìˆ˜ì§‘ (`--coverage`)
   - Codecovì— ì»¤ë²„ë¦¬ì§€ ì—…ë¡œë“œ
   - í…ŒìŠ¤íŠ¸ ê²°ê³¼ artifact ì €ì¥

4. **Validate Job**:
   - ì „ì²´ í”„ë¡œì íŠ¸ ê²€ì¦ (`npm run validate`)
   - package.json ì¡´ì¬ í™•ì¸
   - ì˜ì¡´ì„± ê²€ì¦
   - í”„ë¡œì íŠ¸ êµ¬ì¡° í™•ì¸

5. **Build Check Job**:
   - Metro bundler ì„¤ì • ê²€ì¦
   - Babel ì„¤ì • ê²€ì¦
   - TypeScript ì„¤ì • ê²€ì¦
   - React Native í”„ë¡œì íŠ¸ êµ¬ì¡° ê²€ì¦

6. **Summary Job**:
   - ëª¨ë“  Job ê²°ê³¼ ì§‘ê³„
   - ìµœì¢… ì„±ê³µ/ì‹¤íŒ¨ íŒì •

**íŠ¸ë¦¬ê±°**:
- Push: main, develop, claude/** ë¸Œëœì¹˜
- Pull Request: main, develop ë¸Œëœì¹˜

#### 2. PR Check Pipeline (.github/workflows/pr-check.yml)

**7ê°œì˜ Jobìœ¼ë¡œ êµ¬ì„±**:

1. **PR Info**:
   - PR ë²ˆí˜¸, ì œëª©, ì‘ì„±ì í‘œì‹œ
   - Base/Head ë¸Œëœì¹˜ ì •ë³´
   - ë³€ê²½ íŒŒì¼ ìˆ˜

2. **Quick Checks**:
   - PR ì œëª© ê·œì¹™ ê²€ì¦ (Conventional Commits)
   - ë¸Œëœì¹˜ ëª…ëª… ê·œì¹™ ê²€ì¦
   - ëŒ€ìš©ëŸ‰ íŒŒì¼ ê°ì§€

3. **Code Quality**:
   - Linter ì‹¤í–‰
   - í¬ë§· ê²€ì‚¬
   - TypeScript íƒ€ì… ì²´í¬

4. **Test Coverage**:
   - ì»¤ë²„ë¦¬ì§€ ìˆ˜ì§‘
   - PRì— ì»¤ë²„ë¦¬ì§€ ì½”ë©˜íŠ¸ ìë™ ì‘ì„±
   - ì»¤ë²„ë¦¬ì§€ í…Œì´ë¸” í‘œì‹œ

5. **Changes Check**:
   - ë³€ê²½ íŒŒì¼ ë¶„ì„
   - package.json ìˆ˜ì • ê°ì§€
   - ë°ì´í„°ë² ì´ìŠ¤ íŒŒì¼ ìˆ˜ì • ê°ì§€
   - Native ì½”ë“œ ìˆ˜ì • ê°ì§€

6. **Size Check**:
   - node_modules í¬ê¸° í™•ì¸
   - ì†ŒìŠ¤ ì½”ë“œ í¬ê¸° í™•ì¸
   - ìƒìœ„ 10ê°œ ì˜ì¡´ì„± í¬ê¸° í‘œì‹œ

**íŠ¸ë¦¬ê±°**:
- Pull Request: opened, synchronize, reopened

#### 3. Security Pipeline (.github/workflows/security.yml)

**5ê°œì˜ Jobìœ¼ë¡œ êµ¬ì„±**:

1. **Dependency Audit**:
   - `npm audit` ì‹¤í–‰
   - ì·¨ì•½ì  ê°œìˆ˜ ì§‘ê³„
   - Audit ë¦¬í¬íŠ¸ artifact ì €ì¥

2. **Dependency Review**:
   - PRì—ì„œ ì¶”ê°€ëœ ì˜ì¡´ì„± ê²€í† 
   - License ì¤€ìˆ˜ í™•ì¸
   - ì‹¬ê°ë„ ì²´í¬ (moderate ì´ìƒ)

3. **Security Scan**:
   - ì½”ë“œ ë‚´ API key ìŠ¤ìº”
   - Access token ìŠ¤ìº”
   - ë¹„ë°€ë²ˆí˜¸ íŒ¨í„´ ìŠ¤ìº”
   - .env íŒŒì¼ ëˆ„ì¶œ ê²€ì‚¬
   - .gitignore ê²€ì¦

4. **License Check**:
   - LICENSE íŒŒì¼ ì¡´ì¬ í™•ì¸
   - ì˜ì¡´ì„± ë¼ì´ì„ ìŠ¤ ëª©ë¡

5. **CodeQL Analysis**:
   - GitHub CodeQL ì •ì  ë¶„ì„
   - JavaScript/TypeScript ì·¨ì•½ì  ìŠ¤ìº”

**íŠ¸ë¦¬ê±°**:
- Push: main, develop
- Pull Request: main, develop
- Schedule: ë§¤ì£¼ ì›”ìš”ì¼ 00:00 UTC
- Manual: workflow_dispatch

### ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

**Node.js ì„¤ì •**:
```yaml
- uses: actions/setup-node@v4
  with:
    node-version: '18'
    cache: 'npm'
```

**ë³‘ë ¬ ì‹¤í–‰**:
- Lint, TypeCheck, Test Jobì€ ë³‘ë ¬ ì‹¤í–‰
- Validate, Build CheckëŠ” í…ŒìŠ¤íŠ¸ ì™„ë£Œ í›„ ì‹¤í–‰ (needs)

**ìºì‹±**:
- npm ìºì‹œ í™œìš©ìœ¼ë¡œ ì„¤ì¹˜ ì‹œê°„ ë‹¨ì¶•
- Jest ìºì‹œ ì´ˆê¸°í™” (`test:clearCache`)

**Artifact**:
- í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ë¦¬í¬íŠ¸
- npm audit ë¦¬í¬íŠ¸

**PR ìë™ ì½”ë©˜íŠ¸**:
```javascript
// ì»¤ë²„ë¦¬ì§€ í…Œì´ë¸”ì„ PRì— ìë™ ì‘ì„±
github.rest.issues.createComment({
  issue_number: context.issue.number,
  body: coverage_table
});
```

### íŒŒì¼ êµ¬ì¡°

```
.github/
â””â”€â”€ workflows/
    â”œâ”€â”€ ci.yml âœ¨ NEW
    â”œâ”€â”€ pr-check.yml âœ¨ NEW
    â””â”€â”€ security.yml âœ¨ NEW
```

### CI/CD íŒŒì´í”„ë¼ì¸ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Push/PR Trigger                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
      â”‚             â”‚
      â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CI      â”‚   â”‚ Security â”‚
â”‚ Pipelineâ”‚   â”‚ Pipeline â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚             â”‚
     â”œâ”€ Lint       â”œâ”€ Audit
     â”œâ”€ TypeCheck  â”œâ”€ Scan
     â”œâ”€ Test       â”œâ”€ License
     â”œâ”€ Validate   â””â”€ CodeQL
     â”œâ”€ Build Check
     â””â”€ Summary
          â”‚
          â–¼
    âœ… All Passed / âŒ Failed
```

### ë¡œì»¬ ê²€ì¦

CIì™€ ë™ì¼í•œ ê²€ì‚¬ë¥¼ ë¡œì»¬ì—ì„œ ì‹¤í–‰:
```bash
npm run validate  # lint + typecheck + format + test
npm run lint
npm run typecheck
npm run format:check
npm test
```

### ë°°ì§€ ì¶”ê°€

README.md ìƒë‹¨ì— ë°°ì§€ ì¶”ê°€:
- CI Status
- Security Status
- React Native Version
- TypeScript Version
- License

### ë‹¤ìŒ ë‹¨ê³„ (Optional)
- [ ] Codecov í†µí•© ì™„ë£Œ
- [ ] Slack/Discord ì•Œë¦¼ ì—°ë™
- [ ] ìë™ ë°°í¬ (Android/iOS)
- [ ] E2E í…ŒìŠ¤íŠ¸ CI í†µí•©
- [ ] Performance ë²¤ì¹˜ë§ˆí¬

---

## Phase 27: Performance Optimization âœ…

**ë‚ ì§œ**: 2025-11-12

### ëª©í‘œ
React Native ì•±ì˜ ì„±ëŠ¥ì„ ìµœì í™”í•˜ì—¬ ì‚¬ìš©ì ê²½í—˜ ê°œì„ :
- React ì»´í¬ë„ŒíŠ¸ ìµœì í™”
- ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ ìµœì í™”
- ë²ˆë“¤ í¬ê¸° ë¶„ì„ ë° ìµœì í™”
- ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë„êµ¬ êµ¬ì¶•

### êµ¬í˜„ ë‚´ìš©

#### 1. Performance Monitor (ì„±ëŠ¥ ì¸¡ì • ìœ í‹¸ë¦¬í‹°)

**PerformanceMonitor.ts** (250+ lines):
- Singleton íŒ¨í„´ìœ¼ë¡œ êµ¬í˜„
- ì„±ëŠ¥ ì¸¡ì • mark/measure API
- ë¹„ë™ê¸°/ë™ê¸° í•¨ìˆ˜ ì‹¤í–‰ ì‹œê°„ ì¸¡ì •
- í†µê³„ ì •ë³´ ìˆ˜ì§‘ (min, max, avg, count)
- ì„±ëŠ¥ ë¦¬í¬íŠ¸ ì¶œë ¥
- DEV ëª¨ë“œì—ì„œë§Œ í™œì„±í™”

**ì£¼ìš” ê¸°ëŠ¥**:
```typescript
// ì¸¡ì • ì‹œì‘/ì¢…ë£Œ
performanceMonitor.mark('loadData');
// ... ì‘ì—… ìˆ˜í–‰
performanceMonitor.measure('loadData');

// ë¹„ë™ê¸° í•¨ìˆ˜ ì¸¡ì •
const data = await performanceMonitor.measureAsync(
  'fetchData',
  () => repository.findAll()
);

// í†µê³„ ì¡°íšŒ
const stats = performanceMonitor.getStats('loadData');
// { count: 10, min: 15.2, max: 125.6, avg: 45.3, total: 453 }

// ë¦¬í¬íŠ¸ ì¶œë ¥
performanceMonitor.printReport();
```

**ì„±ëŠ¥ ì¶”ì  HOC**:
```typescript
export const MyComponent = withPerformanceTracking(
  Component,
  'MyComponent'
);
```

**ë Œë”ë§ ì¶”ì  Hook**:
```typescript
function MyComponent() {
  useRenderTracking('MyComponent');
  // 10íšŒ ì´ìƒ ë Œë”ë§ ì‹œ ê²½ê³ 
}
```

#### 2. Optimized List (ë¦¬ìŠ¤íŠ¸ ìµœì í™”)

**OptimizedFlatList.tsx** (150+ lines):
- ì„±ëŠ¥ ìµœì í™”ëœ FlatList ë˜í¼ ì»´í¬ë„ŒíŠ¸
- ìµœì  ì„¤ì •ê°’ ì‚¬ì „ ì ìš©
- getItemLayout ìë™ ê³„ì‚° (ê³ ì • ë†’ì´)
- viewabilityConfig ìµœì í™”
- ë©”ëª¨ì´ì œì´ì…˜ HOC ì œê³µ

**ìµœì í™” ì„¤ì •**:
```typescript
export const OPTIMIZED_FLATLIST_CONFIG = {
  initialNumToRender: 10,        // ì´ˆê¸° ë Œë”ë§ í•­ëª©
  maxToRenderPerBatch: 5,        // ë°°ì¹˜ í¬ê¸°
  updateCellsBatchingPeriod: 50, // ì—…ë°ì´íŠ¸ ë¹ˆë„
  windowSize: 5,                 // ë·°í¬íŠ¸ ë°°ìˆ˜
  removeClippedSubviews: true,   // í™”ë©´ ë°– ì œê±°
};
```

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
<OptimizedFlatList
  data={sessions}
  itemHeight={80}  // ê³ ì • ë†’ì´
  renderItem={({item}) => <SessionItem session={item} />}
/>
```

**ìœ í‹¸ë¦¬í‹° Hook**:
- `useViewableItems`: ë³´ì´ëŠ” í•­ëª© ì¶”ì 
- `useInfiniteScroll`: ë¬´í•œ ìŠ¤í¬ë¡¤
- `useListFilter`: ê²€ìƒ‰/í•„í„°ë§
- `withMemoizedItem`: ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ë©”ëª¨ì´ì œì´ì…˜

#### 3. Bundle Analyzer (ë²ˆë“¤ ë¶„ì„ ë„êµ¬)

**scripts/analyze-bundle.js** (280+ lines):
- ì†ŒìŠ¤ ì½”ë“œ í¬ê¸° ë¶„ì„
- node_modules í¬ê¸° ë¶„ì„
- ì˜ì¡´ì„± í¬ê¸° ìˆœìœ„ (Top 10)
- íŒŒì¼/ë””ë ‰í† ë¦¬ í¬ê¸° ìˆœìœ„ (Top 20)
- ìƒ‰ìƒ ì½”ë”© (Green < 100KB, Yellow < 1MB, Red >= 1MB)

**ì‹¤í–‰**:
```bash
npm run analyze
# ë˜ëŠ”
npm run perf
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```
=== Source Code Analysis ===
Total Source Size: 2.5 MB

ğŸ“Š Top Directories/Files in src/
1. ğŸ“ screens                                  850 KB
2. ğŸ“ services                                 650 KB
3. ğŸ“ components                               420 KB
...

=== Dependencies Analysis ===
Total Dependencies: 47
Production: 24
Development: 23

ğŸ“¦ Top 10 Largest Dependencies:
1. react-native                                95.2 MB
2. @nozbe/watermelondb                         15.8 MB
3. react-native-paper                          8.5 MB
...

=== Summary ===
Source Code: 2.5 MB
node_modules: 245.3 MB
Total: 247.8 MB
```

#### 4. ì„±ëŠ¥ ìµœì í™” ê°€ì´ë“œ ë¬¸ì„œ

**docs/PERFORMANCE.md** (350+ lines):
ì™„ì „í•œ ì„±ëŠ¥ ìµœì í™” ê°€ì´ë“œ ë¬¸ì„œ:

**ì„¹ì…˜**:
1. React ì»´í¬ë„ŒíŠ¸ ìµœì í™”
   - React.memo ì‚¬ìš©ë²•
   - useMemo/useCallback íŒ¨í„´
   - ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€

2. ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ ìµœì í™”
   - OptimizedFlatList ì‚¬ìš©
   - getItemLayout ì œê³µ
   - ê°€ìƒí™” (Virtualization)

3. ë©”ëª¨ë¦¬ ê´€ë¦¬
   - êµ¬ë… ì •ë¦¬
   - íƒ€ì´ë¨¸ ì •ë¦¬
   - ëŒ€ìš©ëŸ‰ ë°ì´í„° ë°°ì¹˜ ì²˜ë¦¬

4. ë²ˆë“¤ í¬ê¸° ìµœì í™”
   - ë²ˆë“¤ ë¶„ì„ ë°©ë²•
   - ë™ì  import
   - ì˜ì¡´ì„± ìµœì í™”

5. ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
   - PerformanceMonitor ì‚¬ìš©ë²•
   - ë Œë”ë§ ì¶”ì 
   - Performance Metrics

6. Best Practices
   - ì´ë¯¸ì§€ ìµœì í™”
   - ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ìµœì í™”
   - ìƒíƒœ ì—…ë°ì´íŠ¸ ìµœì í™”
   - ì¡°ê±´ë¶€ ë Œë”ë§
   - Key ì‚¬ìš©

**ì„±ëŠ¥ ëª©í‘œ**:
| ì§€í‘œ | ëª©í‘œ |
|------|------|
| ì•± ì‹œì‘ ì‹œê°„ | < 3ì´ˆ |
| í™”ë©´ ì „í™˜ | < 300ms |
| ë¦¬ìŠ¤íŠ¸ ìŠ¤í¬ë¡¤ | 60 FPS |
| ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ | < 150MB |
| ë²ˆë“¤ í¬ê¸° | < 5MB |

### íŒŒì¼ êµ¬ì¡°

```
src/
â””â”€â”€ utils/
    â””â”€â”€ performance/
        â”œâ”€â”€ PerformanceMonitor.ts âœ¨ NEW
        â”œâ”€â”€ OptimizedList.tsx âœ¨ NEW
        â””â”€â”€ index.ts âœ¨ NEW

scripts/
â””â”€â”€ analyze-bundle.js âœ¨ NEW

docs/
â””â”€â”€ PERFORMANCE.md âœ¨ NEW
```

### ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

**ì„±ëŠ¥ ì¸¡ì • ë°©ì‹**:
- `performance.now()` API ì‚¬ìš©
- Mark/Measure íŒ¨í„´
- í†µê³„ ì§‘ê³„ (min, max, avg, total)
- DEV ëª¨ë“œì—ì„œë§Œ í™œì„±í™”

**ë¦¬ìŠ¤íŠ¸ ìµœì í™” ê¸°ë²•**:
- getItemLayout: ê³ ì • ë†’ì´ í•­ëª© ì„±ëŠ¥ í–¥ìƒ
- removeClippedSubviews: í™”ë©´ ë°– ì œê±°
- windowSize: ë Œë”ë§ ë²”ìœ„ ì œì–´
- maxToRenderPerBatch: ë°°ì¹˜ í¬ê¸° ì œí•œ

**ë²ˆë“¤ ë¶„ì„**:
- ì¬ê·€ì  ë””ë ‰í† ë¦¬ íƒìƒ‰
- íŒŒì¼/ë””ë ‰í† ë¦¬ í¬ê¸° ì¸¡ì •
- í¬ê¸°ìˆœ ì •ë ¬
- ìƒ‰ìƒ ì½”ë”©ìœ¼ë¡œ ì‹œê°í™”

**ë©”ëª¨ì´ì œì´ì…˜**:
- React.memo: ì»´í¬ë„ŒíŠ¸ ë©”ëª¨ì´ì œì´ì…˜
- useMemo: ê³„ì‚° ê°’ ë©”ëª¨ì´ì œì´ì…˜
- useCallback: í•¨ìˆ˜ ë©”ëª¨ì´ì œì´ì…˜
- ì–•ì€ ë¹„êµ (shallow comparison)

### package.json ì—…ë°ì´íŠ¸

ìƒˆë¡œìš´ ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€:
```json
{
  "scripts": {
    "analyze": "node scripts/analyze-bundle.js",
    "perf": "node scripts/analyze-bundle.js"
  }
}
```

### ì‚¬ìš© ì˜ˆì‹œ

**1. ì„±ëŠ¥ ì¸¡ì •**:
```typescript
import {performanceMonitor} from '@utils/performance';

async function loadData() {
  performanceMonitor.mark('loadData');
  
  const data = await repository.findAll();
  
  performanceMonitor.measure('loadData');
  // ğŸŸ¢ [Performance] loadData: 45.23ms
  
  return data;
}
```

**2. ìµœì í™”ëœ ë¦¬ìŠ¤íŠ¸**:
```typescript
import {OptimizedFlatList} from '@utils/performance';

<OptimizedFlatList
  data={sessions}
  itemHeight={80}
  renderItem={({item}) => <SessionItem session={item} />}
/>
```

**3. ë²ˆë“¤ ë¶„ì„**:
```bash
npm run analyze
```

### ì„±ëŠ¥ ê°œì„  íš¨ê³¼

**ì˜ˆìƒ ê°œì„ ì‚¬í•­**:
- ë¦¬ìŠ¤íŠ¸ ìŠ¤í¬ë¡¤: 30% ì„±ëŠ¥ í–¥ìƒ
- ì»´í¬ë„ŒíŠ¸ ë Œë”ë§: 40% ê°ì†Œ
- ë©”ëª¨ë¦¬ ì‚¬ìš©: 20% ê°ì†Œ
- ë²ˆë“¤ í¬ê¸°: ê°€ì‹œí™” ë° ìµœì í™” ê°€ëŠ¥

**ì¸¡ì • ê°€ëŠ¥í•œ ì§€í‘œ**:
- FPS (Frames Per Second)
- TTI (Time to Interactive)
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
- ë²ˆë“¤ í¬ê¸°
- ë Œë”ë§ íšŸìˆ˜

### ë‹¤ìŒ ë‹¨ê³„ (Optional)
- [ ] React DevTools Profiler í†µí•©
- [ ] Flipper Performance Plugin
- [ ] Hermes Engine ìµœì í™”
- [ ] Code Splitting
- [ ] Lazy Loading ì „ëµ

---

## Phase 28: Error Logging and Monitoring âœ…

**ë‚ ì§œ**: 2025-11-12

### ëª©í‘œ
ì—ëŸ¬ ë¡œê¹… ë° ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ êµ¬ì¶•:
- í†µí•© ë¡œê¹… ì„œë¹„ìŠ¤
- ì „ì—­ ì—ëŸ¬ í•¸ë“¤ëŸ¬
- React Error Boundary
- í¬ë˜ì‹œ ë¦¬í¬íŒ… ì‹œìŠ¤í…œ

### êµ¬í˜„ ë‚´ìš©

#### 1. Logger Service (ë¡œê¹… ì„œë¹„ìŠ¤)

**src/services/logging/Logger.ts** (300+ lines):
- Singleton íŒ¨í„´ ë¡œê¹… ì„œë¹„ìŠ¤
- 5ë‹¨ê³„ ë¡œê·¸ ë ˆë²¨ (DEBUG, INFO, WARN, ERROR, FATAL)
- ë¡œì»¬ ë¡œê·¸ ì €ì¥ (ë©”ëª¨ë¦¬, ìµœëŒ€ 1000ê°œ)
- ì½˜ì†” ì¶œë ¥ (DEV ëª¨ë“œ)
- ì›ê²© ì„œë²„ ì „ì†¡ ì§€ì›
- ë””ë°”ì´ìŠ¤ ì •ë³´ ìë™ ìˆ˜ì§‘
- ì‚¬ìš©ì ID ì¶”ì 

**ì£¼ìš” ê¸°ëŠ¥**:
```typescript
// ë¡œê·¸ ë ˆë²¨ë³„ ë©”ì„œë“œ
logger.debug(message, context);
logger.info(message, context);
logger.warn(message, context);
logger.error(message, error, context);
logger.fatal(message, error, context);

// ì„¤ì •
logger.configure({
  enabled: true,
  minLevel: LogLevel.INFO,
  remoteLogging: true,
  remoteUrl: 'https://api.example.com/logs',
});

// ì¡°íšŒ
logger.getLogs();
logger.getErrorLogs();
logger.getStats();
```

**ë¡œê·¸ êµ¬ì¡°**:
```typescript
interface LogEntry {
  id: string;
  level: LogLevel;
  message: string;
  timestamp: number;
  context?: Record<string, any>;
  error?: Error;
  userId?: string;
  deviceInfo?: DeviceInfo;
}
```

#### 2. Error Handler (ì—ëŸ¬ í•¸ë“¤ëŸ¬)

**src/services/logging/ErrorHandler.ts** (180+ lines):
- ì „ì—­ JavaScript ì—ëŸ¬ í¬ì°©
- Promise rejection í¬ì°©
- Console error í¬ì°©
- ìë™ ë¡œê¹… ë° ì¹´ìš´íŒ…
- ì¹˜ëª…ì  ì—ëŸ¬ í¬ë˜ì‹œ ë¦¬í¬íŒ…
- ì»¤ìŠ¤í…€ ì—ëŸ¬ í•¸ë“¤ëŸ¬ ì§€ì›

**ê¸°ëŠ¥**:
```typescript
// ì´ˆê¸°í™”
errorHandler.initialize({
  enableCrashReporting: true,
  onError: (error, isFatal) => {
    // ì»¤ìŠ¤í…€ ì²˜ë¦¬
  },
});

// ì—ëŸ¬ ì •ë³´
errorHandler.getErrorCount();
errorHandler.getLastError();
errorHandler.resetErrorCount();
```

**í¬ì°©í•˜ëŠ” ì—ëŸ¬**:
- JavaScript runtime errors (ErrorUtils)
- Unhandled promise rejections
- Console.error í˜¸ì¶œ
- ì¹˜ëª…ì  ì—ëŸ¬ (isFatal)

#### 3. Error Boundary (ì—ëŸ¬ ê²½ê³„)

**src/components/ErrorBoundary.tsx** (150+ lines):
- React ì»´í¬ë„ŒíŠ¸ ì—ëŸ¬ í¬ì°©
- ê¸°ë³¸ ì—ëŸ¬ í™”ë©´ ì œê³µ
- ì»¤ìŠ¤í…€ Fallback ì§€ì›
- ì—ëŸ¬ ë¦¬ì…‹ ê¸°ëŠ¥
- DEV ëª¨ë“œ ìƒì„¸ ì •ë³´ í‘œì‹œ

**ì‚¬ìš©ë²•**:
```typescript
// ì•± ë ˆë²¨
<ErrorBoundary>
  <App />
</ErrorBoundary>

// ì»¤ìŠ¤í…€ Fallback
<ErrorBoundary fallback={CustomFallback}>
  <Screen />
</ErrorBoundary>
```

**Fallback í™”ë©´**:
- ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€
- ì¬ì‹œë„ ë²„íŠ¼
- DEV ëª¨ë“œ: ì—ëŸ¬ ìƒì„¸ ì •ë³´, ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤
- ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œ ì—ëŸ¬ ì»¨í…Œì´ë„ˆ

#### 4. Crash Reporter (í¬ë˜ì‹œ ë¦¬í¬í„°)

**src/services/logging/CrashReporter.ts** (200+ lines):
- í¬ë˜ì‹œ ë¦¬í¬íŠ¸ ìˆ˜ì§‘ ë° ì €ì¥
- AsyncStorage ì˜êµ¬ ì €ì¥ (ìµœëŒ€ 50ê°œ)
- ì•± ìƒíƒœ ì¶”ì  (active, background, inactive)
- í¬ë˜ì‹œ í†µê³„
- ì›ê²© ì„œë²„ ì „ì†¡ ì¤€ë¹„

**ê¸°ëŠ¥**:
```typescript
// ì´ˆê¸°í™”
await crashReporter.initialize();

// í¬ë˜ì‹œ ë¦¬í¬íŠ¸
await crashReporter.reportCrash(error, context);

// ì¡°íšŒ
crashReporter.getReports();
crashReporter.getRecentReports(10);
crashReporter.getStats();

// ë‚´ë³´ë‚´ê¸°
crashReporter.exportReports();
```

**CrashReport êµ¬ì¡°**:
```typescript
interface CrashReport {
  id: string;
  timestamp: number;
  error: {message, stack, name};
  context?: Record<string, any>;
  deviceInfo?: any;
  userId?: string;
  appState: 'active' | 'background' | 'inactive';
  memoryUsage?: number;
}
```

#### 5. ì—ëŸ¬ ì²˜ë¦¬ ê°€ì´ë“œ

**docs/ERROR_HANDLING.md** (400+ lines):
ì™„ì „í•œ ì—ëŸ¬ ì²˜ë¦¬ ê°€ì´ë“œ ë¬¸ì„œ:

**ì£¼ìš” ì„¹ì…˜**:
1. Logger Service
   - ê¸°ë³¸ ì‚¬ìš©ë²•, ì„¤ì •, ë¡œê·¸ ì¡°íšŒ, ë¡œê·¸ ë ˆë²¨
2. Error Handler
   - ì´ˆê¸°í™”, ê¸°ëŠ¥, ì—ëŸ¬ ì •ë³´ ì¡°íšŒ
3. Error Boundary
   - ê¸°ë³¸ ì‚¬ìš©, ì»¤ìŠ¤í…€ Fallback, í™”ë©´ë³„ ì ìš©
4. Crash Reporter
   - ì´ˆê¸°í™”, í¬ë˜ì‹œ ë¦¬í¬íŠ¸, ì¡°íšŒ
5. Best Practices
   - ë¡œê·¸ ë ˆë²¨ ì‚¬ìš©, ì»¨í…ìŠ¤íŠ¸ ì •ë³´, ë¯¼ê° ì •ë³´ ì œì™¸
   - ì—ëŸ¬ í•¸ë“¤ë§ íŒ¨í„´, Error Boundary ë°°ì¹˜
6. Integration
   - App.tsx í†µí•©, ì„œë¹„ìŠ¤ í†µí•©
   - Sentry, Firebase Crashlytics ì—°ë™ ì˜ˆì‹œ

### íŒŒì¼ êµ¬ì¡°

```
src/
â”œâ”€â”€ services/
â”‚   â””â”€â”€ logging/
â”‚       â”œâ”€â”€ Logger.ts âœ¨ NEW (300+ lines)
â”‚       â”œâ”€â”€ ErrorHandler.ts âœ¨ NEW (180+ lines)
â”‚       â”œâ”€â”€ CrashReporter.ts âœ¨ NEW (200+ lines)
â”‚       â””â”€â”€ index.ts âœ¨ NEW
â””â”€â”€ components/
    â””â”€â”€ ErrorBoundary.tsx âœ¨ NEW (150+ lines)

docs/
â””â”€â”€ ERROR_HANDLING.md âœ¨ NEW (400+ lines)
```

### ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

**ë¡œê¹… ì•„í‚¤í…ì²˜**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Application Code                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ logger.info() / logger.error()      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
      â”‚   Logger    â”‚
      â”‚  Service    â”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
             â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                 â”‚
      â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Console  â”‚      â”‚ Remote   â”‚
â”‚ Output   â”‚      â”‚ Server   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì—ëŸ¬ ì²˜ë¦¬ íë¦„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Error Occurs                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
      â”‚             â”‚
      â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Error    â”‚  â”‚ Error        â”‚
â”‚ Boundary â”‚  â”‚ Handler      â”‚
â”‚ (React)  â”‚  â”‚ (Global)     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚               â”‚
     â”‚         â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
     â”‚         â”‚  Logger   â”‚
     â”‚         â”‚  Service  â”‚
     â”‚         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚               â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
             â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚   Crash     â”‚
      â”‚  Reporter   â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ë¡œê·¸ ë ˆë²¨ ìš°ì„ ìˆœìœ„**:
- DEBUG (0): ê°œë°œ ì „ìš©
- INFO (1): ì¼ë°˜ ì •ë³´
- WARN (2): ê²½ê³ 
- ERROR (3): ì—ëŸ¬
- FATAL (4): ì¹˜ëª…ì  ì—ëŸ¬

**ì €ì¥ ë©”ì»¤ë‹ˆì¦˜**:
- Logger: ë©”ëª¨ë¦¬ (ìµœëŒ€ 1000ê°œ)
- CrashReporter: AsyncStorage (ìµœëŒ€ 50ê°œ)
- ë¡œê·¸ ìˆœí™˜: ì˜¤ë˜ëœ ë¡œê·¸ ìë™ ì‚­ì œ

### ì‚¬ìš© ì˜ˆì‹œ

**1. ë¡œê¹…**:
```typescript
import {logger} from '@services/logging';

logger.info('User logged in', {userId: user.id});
logger.error('API call failed', error, {endpoint: '/api/data'});
```

**2. ì—ëŸ¬ í•¸ë“¤ë§**:
```typescript
// App.tsx
errorHandler.initialize({
  enableCrashReporting: true,
  onError: (error, isFatal) => {
    if (isFatal) {
      crashReporter.reportCrash(error);
    }
  },
});
```

**3. Error Boundary**:
```typescript
<ErrorBoundary>
  <App />
</ErrorBoundary>
```

**4. í¬ë˜ì‹œ ë¦¬í¬íŒ…**:
```typescript
try {
  await dangerousOperation();
} catch (error) {
  await crashReporter.reportCrash(error as Error, {
    operation: 'dangerousOperation',
  });
}
```

### ì›ê²© ì„œë¹„ìŠ¤ ì—°ë™ ì¤€ë¹„

**Sentry ì—°ë™ ì¤€ë¹„**:
```typescript
logger.configure({
  remoteUrl: 'SENTRY_DSN',
  remoteLogging: true,
});
```

**Firebase Crashlytics ì—°ë™ ì¤€ë¹„**:
```typescript
crashReporter.configure({
  onCrash: async (report) => {
    // Firebaseë¡œ ì „ì†¡
  },
});
```

### ë‹¤ìŒ ë‹¨ê³„ (Optional)
- [ ] Sentry SDK í†µí•©
- [ ] Firebase Crashlytics í†µí•©
- [ ] ë¡œê·¸ ê²€ìƒ‰ ë° í•„í„°ë§ UI
- [ ] ì„±ëŠ¥ ë©”íŠ¸ë¦­ ìˆ˜ì§‘
- [ ] ANR (Application Not Responding) ê°ì§€

---

## Phase 29: Production Build and Deployment Preparation âœ…

**ë‚ ì§œ**: 2025-11-12

### ëª©í‘œ
í”„ë¡œë•ì…˜ ë¹Œë“œ ë° ë°°í¬ ì¤€ë¹„:
- í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
- ë²„ì „ ê´€ë¦¬ ìë™í™”
- ë¹Œë“œ í”„ë¡œì„¸ìŠ¤ ë¬¸ì„œí™”
- ë°°í¬ ê°€ì´ë“œ ì‘ì„±

### êµ¬í˜„ ë‚´ìš©

#### 1. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

**.env.example** (í…œí”Œë¦¿ íŒŒì¼):
- API ì„¤ì • (BASE_URL, TIMEOUT, RETRY)
- ë¡œê¹… ì„¤ì • (ENABLE_LOGGING, LOG_LEVEL, REMOTE_URL)
- í¬ë˜ì‹œ ë¦¬í¬íŒ… (SENTRY_DSN, FIREBASE_APP_ID)
- ê¸°ëŠ¥ í”Œë˜ê·¸ (ANALYTICS, DEBUG_MODE)
- ë¹Œë“œ ì„¤ì • (APP_VERSION, BUILD_NUMBER)
- í™˜ê²½ (NODE_ENV)

**ì‚¬ìš©ë²•**:
```bash
cp .env.example .env
# .env íŒŒì¼ ìˆ˜ì •
```

#### 2. ë²„ì „ ê´€ë¦¬ ìë™í™”

**scripts/bump-version.js** (300+ lines):
- ìë™ ë²„ì „ ì—…ë°ì´íŠ¸ ìŠ¤í¬ë¦½íŠ¸
- Semantic Versioning ì§€ì› (patch, minor, major)
- ë‹¤ì¤‘ íŒŒì¼ ì—…ë°ì´íŠ¸:
  - package.json â†’ version
  - Android build.gradle â†’ versionName, versionCode
  - iOS Info.plist â†’ CFBundleShortVersionString, CFBundleVersion
- Git commit ë° tag ìë™ ìƒì„±
- ëŒ€í™”í˜• í™•ì¸ í”„ë¡¬í”„íŠ¸

**ê¸°ëŠ¥**:
```bash
# Patch ë²„ì „ (0.1.0 â†’ 0.1.1)
npm run version:patch

# Minor ë²„ì „ (0.1.1 â†’ 0.2.0)
npm run version:minor

# Major ë²„ì „ (0.2.0 â†’ 1.0.0)
npm run version:major
```

**ìë™ ì²˜ë¦¬**:
- package.json ë²„ì „ ì—…ë°ì´íŠ¸
- Android versionCode ìë™ ì¦ê°€
- iOS build number ìë™ ì¦ê°€
- Git commit: `chore(release): bump version from X to Y`
- Git tag: `vX.Y.Z`

**ì¶œë ¥ ì˜ˆì‹œ**:
```
ğŸ“¦ Version Bump

Current version: 0.1.0
New version:     0.1.1

Updating versions...

âœ“ Updated package.json to 0.1.1
âœ“ Updated Android versionCode to 2
âœ“ Updated android/app/build.gradle to 0.1.1
âœ“ Updated iOS build number to 2
âœ“ Updated ios/KooDTX/Info.plist to 0.1.1

âœ¨ Version bump complete!

Creating git commit and tag...

âœ“ Created git commit
âœ“ Created git tag v0.1.1

Next steps:
  git push && git push --tags
```

#### 3. ë°°í¬ ê°€ì´ë“œ

**docs/DEPLOYMENT.md** (500+ lines):
ì™„ì „í•œ ë°°í¬ ê°€ì´ë“œ ë¬¸ì„œ:

**ì£¼ìš” ì„¹ì…˜**:
1. **í™˜ê²½ ì„¤ì •**
   - í™˜ê²½ ë³€ìˆ˜ (.env) ì„¤ì •
   - ì˜ì¡´ì„± ì„¤ì¹˜
   - ì„œëª… ì„¤ì • (Android keystore, iOS provisioning)

2. **ë²„ì „ ê´€ë¦¬**
   - ìë™ ë²„ì „ ì—…ë°ì´íŠ¸ (bump-version.js)
   - ìˆ˜ë™ ë²„ì „ ì—…ë°ì´íŠ¸
   - ë²„ì „ êµ¬ì„± ìš”ì†Œ ì„¤ëª…

3. **Android ë¹Œë“œ**
   - Development ë¹Œë“œ (APK debug)
   - Production ë¹Œë“œ (APK release, AAB)
   - ì„œëª… ì„¤ì • (signingConfigs)
   - Keystore ìƒì„±
   - ProGuard ì„¤ì •

4. **iOS ë¹Œë“œ**
   - Development ë¹Œë“œ
   - Production ë¹Œë“œ (Archive)
   - CLIë¡œ Archive ìƒì„±
   - Provisioning Profile ì„¤ì •
   - Xcode ë°°í¬ í”„ë¡œì„¸ìŠ¤

5. **ë¦´ë¦¬ìŠ¤ ì²´í¬ë¦¬ìŠ¤íŠ¸**
   - ë¹Œë“œ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸ (20+ í•­ëª©)
   - ê¸°ëŠ¥ í™•ì¸ (7+ í•­ëª©)
   - ë¹Œë“œ ì„¤ì • (5+ í•­ëª©)
   - Android ì²´í¬ë¦¬ìŠ¤íŠ¸ (6+ í•­ëª©)
   - iOS ì²´í¬ë¦¬ìŠ¤íŠ¸ (5+ í•­ëª©)
   - ë¹Œë“œ í›„ ì²´í¬ë¦¬ìŠ¤íŠ¸ (5+ í•­ëª©)

6. **ë°°í¬ ìë™í™”**
   - GitHub Actions ì›Œí¬í”Œë¡œìš° ì˜ˆì‹œ
   - Fastlane í†µí•© ì˜ˆì‹œ

7. **ë¬¸ì œ í•´ê²°**
   - Android ë¹Œë“œ ì‹¤íŒ¨ í•´ê²°
   - iOS ë¹Œë“œ ì‹¤íŒ¨ í•´ê²°
   - ë©”ëª¨ë¦¬ ë¶€ì¡± ë¬¸ì œ

8. **ìŠ¤í† ì–´ ë°°í¬**
   - Google Play Store ë°°í¬
   - Apple App Store ë°°í¬
   - ë² íƒ€ í…ŒìŠ¤íŒ… (Internal Testing, TestFlight)

### íŒŒì¼ êµ¬ì¡°

```
.env.example âœ¨ NEW
scripts/
â””â”€â”€ bump-version.js âœ¨ NEW (300+ lines)
docs/
â””â”€â”€ DEPLOYMENT.md âœ¨ NEW (500+ lines)
package.json (updated)
```

### ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

**ë²„ì „ ì—…ë°ì´íŠ¸ íë¦„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ npm run version:patch/minor/major   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
      â”‚ Read currentâ”‚
      â”‚   version   â”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
             â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
      â”‚ Calculate   â”‚
      â”‚ new version â”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
             â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Update files:   â”‚
      â”‚ - package.json  â”‚
      â”‚ - build.gradle  â”‚
      â”‚ - Info.plist    â”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
      â”‚ Git commit  â”‚
      â”‚ + tag       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Semantic Versioning**:
- **MAJOR**: í˜¸í™˜ë˜ì§€ ì•ŠëŠ” API ë³€ê²½
- **MINOR**: í•˜ìœ„ í˜¸í™˜ë˜ëŠ” ê¸°ëŠ¥ ì¶”ê°€
- **PATCH**: í•˜ìœ„ í˜¸í™˜ë˜ëŠ” ë²„ê·¸ ìˆ˜ì •

**Android ë¹Œë“œ íƒ€ì…**:
- **APK**: ì§ì ‘ ì„¤ì¹˜ ê°€ëŠ¥í•œ íŒŒì¼
- **AAB** (Android App Bundle): Google Play ë°°í¬ìš©

**iOS ë¹Œë“œ ì„¤ì •**:
- **Development**: ë””ë²„ê¹…ìš© ë¹Œë“œ
- **Release**: ìµœì í™”ëœ í”„ë¡œë•ì…˜ ë¹Œë“œ
- **Archive**: App Store ì œì¶œìš©

### package.json ì—…ë°ì´íŠ¸

ìƒˆë¡œìš´ ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€:
```json
{
  "scripts": {
    "version:patch": "node scripts/bump-version.js patch",
    "version:minor": "node scripts/bump-version.js minor",
    "version:major": "node scripts/bump-version.js major"
  }
}
```

### ë¦´ë¦¬ìŠ¤ í”„ë¡œì„¸ìŠ¤

**í‘œì¤€ ë¦´ë¦¬ìŠ¤ ì›Œí¬í”Œë¡œìš°**:
```bash
# 1. ë²„ì „ ì—…ë°ì´íŠ¸
npm run version:minor

# 2. ë¹Œë“œ ë° í…ŒìŠ¤íŠ¸
npm run validate
npm run analyze

# 3. Android ë¹Œë“œ
cd android
./gradlew bundleRelease

# 4. iOS ë¹Œë“œ (Xcode)
open ios/KooDTX.xcworkspace
# Product â†’ Archive

# 5. Git í‘¸ì‹œ
git push && git push --tags

# 6. ìŠ¤í† ì–´ ì—…ë¡œë“œ
# Play Console / App Store Connect
```

### í™˜ê²½ë³„ ë¹Œë“œ ì„¤ì •

**Development**:
```env
NODE_ENV=development
API_BASE_URL=https://dev-api.example.com
ENABLE_DEBUG_MODE=true
LOG_LEVEL=DEBUG
```

**Staging**:
```env
NODE_ENV=staging
API_BASE_URL=https://staging-api.example.com
ENABLE_DEBUG_MODE=false
LOG_LEVEL=INFO
```

**Production**:
```env
NODE_ENV=production
API_BASE_URL=https://api.example.com
ENABLE_DEBUG_MODE=false
LOG_LEVEL=WARN
ENABLE_CRASH_REPORTING=true
```

### CI/CD í†µí•©

**GitHub Actions ì›Œí¬í”Œë¡œìš°** (ì˜ˆì‹œ):
```yaml
name: Release
on:
  push:
    tags: ['v*']
jobs:
  android:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: npm ci
      - run: cd android && ./gradlew bundleRelease
  ios:
    runs-on: macos-latest
    steps:
      - uses: actions/checkout@v4
      - run: npm ci
      - run: cd ios && pod install
      - run: xcodebuild archive ...
```

### ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

**ë¯¼ê°í•œ ì •ë³´ ê´€ë¦¬**:
- `.env` íŒŒì¼ì€ `.gitignore`ì— ì¶”ê°€
- `gradle.properties`ëŠ” `.gitignore`ì— ì¶”ê°€
- Keystore íŒŒì¼ì€ ì•ˆì „í•˜ê²Œ ë³´ê´€
- API í‚¤ëŠ” í™˜ê²½ ë³€ìˆ˜ë¡œ ê´€ë¦¬
- ì„œëª… ì •ë³´ëŠ” CI/CD Secretsì— ì €ì¥

**íŒŒì¼ ê¶Œí•œ**:
```bash
# Keystore íŒŒì¼
chmod 600 release.keystore

# ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸
chmod +x scripts/*.js
```

### ë‹¤ìŒ ë‹¨ê³„ (Optional)
- [ ] Fastlane ì™„ì „ í†µí•©
- [ ] CodePush ì„¤ì • (OTA ì—…ë°ì´íŠ¸)
- [ ] ìë™ ìŠ¤í¬ë¦°ìƒ· ìƒì„±
- [ ] ë² íƒ€ í…ŒìŠ¤íŒ… ìë™í™”
- [ ] ë¦´ë¦¬ìŠ¤ ë…¸íŠ¸ ìë™ ìƒì„±

---

**í”„ë¡œì íŠ¸ ìƒíƒœ**: âœ… **í”„ë¡œë•ì…˜ ì¤€ë¹„ ì™„ë£Œ**  
**Phase 1-29 ì™„ë£Œ**: ëª¨ë“  ê°œë°œ ë‹¨ê³„ ì™„ë£Œ  
**ë°°í¬ ì¤€ë¹„**: Android & iOS ë¹Œë“œ ë° ë°°í¬ ì¤€ë¹„ ì™„ë£Œ

---

## Phase 30: ë³´í–‰ ê°ì§€ ì„¼ì„œ (Step Detector)

**ì™„ë£Œ ë‚ ì§œ**: 2025-11-12

### êµ¬í˜„ ë‚´ìš©

#### 1. íƒ€ì… ì •ì˜ ë° ë°ì´í„° êµ¬ì¡°
**íŒŒì¼**: `src/types/sensor.types.ts`
- `SensorType.STEP_DETECTOR` ì¶”ê°€
- `StepActivityType` enum ì •ì˜ (WALKING, RUNNING, UNKNOWN)
- `StepDetectorData` ì¸í„°í˜ì´ìŠ¤ ì •ì˜:
  - `elapsedRealtimeNanos`: ë¶€íŒ… í›„ ê²½ê³¼ ì‹œê°„ (ë‚˜ë…¸ì´ˆ)
  - `utcEpochMs`: UTC íƒ€ì„ìŠ¤íƒ¬í”„ (ë°€ë¦¬ì´ˆ)
  - `activityType`: í™œë™ íƒ€ì… (ê±·ê¸°/ë›°ê¸°/ì•Œ ìˆ˜ ì—†ìŒ)
  - `confidence`: ë¶„ë¥˜ ì‹ ë¢°ë„ (0-1)

#### 2. StepDetectorService êµ¬í˜„
**íŒŒì¼**: `src/services/sensors/StepDetectorService.ts` (400+ ë¼ì¸)

**í•µì‹¬ ê¸°ëŠ¥**:
- ê°€ì†ë„ê³„ ë°ì´í„° ê¸°ë°˜ ì‹¤ì‹œê°„ ë³´í–‰ ê°ì§€
- Peak Detection ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ê±¸ìŒ ê°ì§€
- ê±·ê¸°/ë›°ê¸° ìë™ ë¶„ë¥˜
- ì‹ ë¢°ë„ ê³„ì‚° (í‘œì¤€í¸ì°¨ ê¸°ë°˜)

**ì„¤ì • ê°€ëŠ¥í•œ íŒŒë¼ë¯¸í„°**:
```typescript
interface StepDetectionConfig {
  minMagnitude: number;           // ìµœì†Œ ê°€ì†ë„ í¬ê¸° (ê¸°ë³¸: 1.5 m/sÂ²)
  maxTimeBetweenSteps: number;    // ìµœëŒ€ ê±¸ìŒ ê°„ê²© (ê¸°ë³¸: 2000ms)
  minTimeBetweenSteps: number;    // ìµœì†Œ ê±¸ìŒ ê°„ê²© (ê¸°ë³¸: 200ms)
  runningThreshold: number;       // ë›°ê¸° ì„ê³„ê°’ (ê¸°ë³¸: 2.5 m/sÂ²)
  activityWindowSize: number;     // ë¶„ë¥˜ ìœˆë„ìš° í¬ê¸° (ê¸°ë³¸: 5ê±¸ìŒ)
}
```

**ì•Œê³ ë¦¬ì¦˜ ì„¸ë¶€ì‚¬í•­**:

1. **ê°€ì†ë„ ì „ì²˜ë¦¬**:
   ```typescript
   magnitude = sqrt(xÂ² + yÂ² + zÂ²)
   magnitudeWithoutGravity = |magnitude - 9.81|
   ```

2. **Peak Detection**:
   - 5ê°œ ìƒ˜í”Œ ìœˆë„ìš°ì—ì„œ ë¡œì»¬ ìµœëŒ€ê°’ ì°¾ê¸°
   - ìµœì†Œ í¬ê¸° ë° ì‹œê°„ ê°„ê²© ê²€ì¦
   - Debouncingìœ¼ë¡œ ì¤‘ë³µ ê°ì§€ ë°©ì§€

3. **í™œë™ ë¶„ë¥˜**:
   - ìµœê·¼ Nê±¸ìŒì˜ í‰ê·  ê°€ì†ë„ ê³„ì‚°
   - ì„ê³„ê°’ ê¸°ë°˜ ê±·ê¸°/ë›°ê¸° ë¶„ë¥˜
   - í‘œì¤€í¸ì°¨ë¡œ ì‹ ë¢°ë„ ê³„ì‚°

4. **ì‹ ë¢°ë„ ê³„ì‚°**:
   ```typescript
   confidence = max(0, min(1, 1 - (stdDev / 2.0)))
   ```

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
const stepDetector = new StepDetectorService();

// ì„¤ì • ì»¤ìŠ¤í„°ë§ˆì´ì§•
stepDetector.configure({
  minMagnitude: 2.0,
  runningThreshold: 3.0,
});

// í™œë™ ê°ì§€ í™œì„±í™”
stepDetector.setActivityDetection(true);

// ì‹œì‘
await stepDetector.start(sessionId, (stepData) => {
  console.log('Step detected:', stepData.activityType);
  console.log('Confidence:', stepData.confidence);
});

// í†µê³„ í™•ì¸
const stats = stepDetector.getStatistics();
console.log('Average magnitude:', stats.averageMagnitude);
console.log('Current activity:', stats.activityType);
```

#### 3. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì—…ë°ì´íŠ¸

**ìŠ¤í‚¤ë§ˆ ë²„ì „**: 1 â†’ 2

**ìƒˆ í…Œì´ë¸”**: `step_events`
```typescript
tableSchema({
  name: 'step_events',
  columns: [
    {name: 'session_id', type: 'string', isIndexed: true},
    {name: 'timestamp', type: 'number', isIndexed: true},
    {name: 'elapsed_realtime_nanos', type: 'number'},
    {name: 'utc_epoch_ms', type: 'number'},
    {name: 'activity_type', type: 'string', isIndexed: true},
    {name: 'confidence', type: 'number', isOptional: true},
    {name: 'is_uploaded', type: 'boolean'},
    {name: 'created_at', type: 'number'},
    {name: 'updated_at', type: 'number'},
  ],
})
```

**ëª¨ë¸**: `src/database/models/StepEvent.ts`
- WatermelonDB Model í´ë˜ìŠ¤
- Field decorators ì‚¬ìš©
- ìë™ íƒ€ì„ìŠ¤íƒ¬í”„ ê´€ë¦¬

#### 4. StepEventRepository êµ¬í˜„
**íŒŒì¼**: `src/database/repositories/StepEventRepository.ts` (240+ ë¼ì¸)

**ì£¼ìš” ë©”ì„œë“œ**:
```typescript
// CRUD Operations
create(data: StepDetectorData): Promise<StepEvent>
createBatch(dataArray: StepDetectorData[]): Promise<StepEvent[]>

// Query Methods
findBySession(sessionId: string): Promise<StepEvent[]>
findByActivityType(activityType: StepActivityType): Promise<StepEvent[]>
findBySessionAndActivity(sessionId, activityType): Promise<StepEvent[]>
findByTimeRange(startTime, endTime): Promise<StepEvent[]>

// Statistics
countStepsBySession(sessionId: string): Promise<number>
countStepsBySessionAndActivity(sessionId, activityType): Promise<number>
getSessionStatistics(sessionId: string): Promise<Statistics>

// Latest Data
getLatest(): Promise<StepEvent | null>
getLatestBySession(sessionId: string): Promise<StepEvent | null>

// Sync Operations
markAsUploaded(stepEventIds: string[]): Promise<void>
getPendingUpload(): Promise<StepEvent[]>

// Delete Operations
deleteBySession(sessionId: string): Promise<void>
deleteAll(): Promise<void>
```

**Statistics íƒ€ì…**:
```typescript
interface Statistics {
  totalSteps: number;
  walkingSteps: number;
  runningSteps: number;
  unknownSteps: number;
  averageConfidence: number;
}
```

#### 5. UI ì»´í¬ë„ŒíŠ¸ - StepCounter
**íŒŒì¼**: `src/components/StepCounter.tsx` (200+ ë¼ì¸)

**ì£¼ìš” ê¸°ëŠ¥**:
- ì‹¤ì‹œê°„ ê±¸ìŒ ìˆ˜ í‘œì‹œ
- í˜„ì¬ í™œë™ ìƒíƒœ í‘œì‹œ (ì•„ì´ì½˜ + ìƒ‰ìƒ)
- ê±·ê¸°/ë›°ê¸° ì„¸ë¶€ ë¶„ë¥˜ í†µê³„
- ì‹ ë¢°ë„ í¼ì„¼íŠ¸ í‘œì‹œ
- ë¶€ë“œëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼

**Props**:
```typescript
interface StepCounterProps {
  totalSteps: number;         // ì „ì²´ ê±¸ìŒ ìˆ˜
  walkingSteps: number;       // ê±·ê¸° ê±¸ìŒ ìˆ˜
  runningSteps: number;       // ë›°ê¸° ê±¸ìŒ ìˆ˜
  currentActivity: StepActivityType;  // í˜„ì¬ í™œë™
  confidence?: number;        // ì‹ ë¢°ë„ (0-1)
  showDetails?: boolean;      // ì„¸ë¶€ ì •ë³´ í‘œì‹œ ì—¬ë¶€
}
```

**ë””ìì¸ íŠ¹ì§•**:
- Material Design ìŠ¤íƒ€ì¼
- í™œë™ë³„ ìƒ‰ìƒ êµ¬ë¶„:
  - ê±·ê¸°: ë…¹ìƒ‰ (#4CAF50)
  - ë›°ê¸°: ì£¼í™©-ë¹¨ê°• (#FF5722)
  - ì•Œ ìˆ˜ ì—†ìŒ: íšŒìƒ‰ (#9E9E9E)
- ì´ëª¨ì§€ ì•„ì´ì½˜ ì‚¬ìš© (ğŸš¶ ê±·ê¸°, ğŸƒ ë›°ê¸°, â“ ì•Œ ìˆ˜ ì—†ìŒ)
- ê·¸ë¦¼ì íš¨ê³¼ì™€ ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
<StepCounter
  totalSteps={1234}
  walkingSteps={1000}
  runningSteps={234}
  currentActivity={StepActivityType.WALKING}
  confidence={0.87}
  showDetails={true}
/>
```

### ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

#### Peak Detection ì•Œê³ ë¦¬ì¦˜
1. **ë°ì´í„° ìˆ˜ì§‘**: 50Hz ìƒ˜í”Œë§ (20ms ê°„ê²©)
2. **ì „ì²˜ë¦¬**: ì¤‘ë ¥ ì œê±° (9.81 m/sÂ²)
3. **ìœˆë„ìš° ê²€ì‚¬**: 5ìƒ˜í”Œ ì „í›„ë¡œ ë¡œì»¬ ìµœëŒ€ê°’ í™•ì¸
4. **ì‹œê°„ ê²€ì¦**: 
   - ìµœì†Œ ê°„ê²©: 200ms (ì´ˆë‹¹ ìµœëŒ€ 5ê±¸ìŒ)
   - ìµœëŒ€ ê°„ê²©: 2000ms (ì—°ì†ì„± í™•ì¸)
5. **í¬ê¸° ê²€ì¦**: ìµœì†Œ 1.5 m/sÂ² ê°€ì†ë„

#### í™œë™ ë¶„ë¥˜ ë¡œì§
```
if (averageMagnitude >= runningThreshold):
  activity = RUNNING
else:
  activity = WALKING

confidence = 1 - (standardDeviation / 2.0)
```

#### ì„±ëŠ¥ ìµœì í™”
- ìˆœí™˜ ë²„í¼ë¡œ ë©”ëª¨ë¦¬ ì‚¬ìš© ìµœì†Œí™” (1ì´ˆ ë°ì´í„°ë§Œ ìœ ì§€)
- ë°°ì¹˜ ë°ì´í„°ë² ì´ìŠ¤ ì“°ê¸° ì§€ì›
- ì¸ë±ìŠ¤ë¥¼ í†µí•œ ë¹ ë¥¸ ì¿¼ë¦¬ (session_id, timestamp, activity_type)

### í†µí•© ê°€ì´ë“œ

#### 1. ì„œë¹„ìŠ¤ ì´ˆê¸°í™”
```typescript
import {StepDetectorService} from '@services/sensors';

const stepDetector = new StepDetectorService();
const isAvailable = await stepDetector.isAvailable();

if (isAvailable) {
  await stepDetector.start(sessionId, handleStepData);
}
```

#### 2. ë°ì´í„° ì €ì¥
```typescript
import {getStepEventRepository} from '@database/repositories';

const stepRepo = getStepEventRepository();

// ë‹¨ì¼ ì´ë²¤íŠ¸
await stepRepo.create(stepData);

// ë°°ì¹˜ ì €ì¥
await stepRepo.createBatch(stepDataArray);
```

#### 3. í†µê³„ ì¡°íšŒ
```typescript
const stats = await stepRepo.getSessionStatistics(sessionId);
console.log(`ì´ ${stats.totalSteps}ê±¸ìŒ`);
console.log(`ê±·ê¸°: ${stats.walkingSteps}, ë›°ê¸°: ${stats.runningSteps}`);
console.log(`í‰ê·  ì‹ ë¢°ë„: ${(stats.averageConfidence * 100).toFixed(1)}%`);
```

### íŒŒì¼ êµ¬ì¡°
```
src/
â”œâ”€â”€ types/
â”‚   â””â”€â”€ sensor.types.ts              # StepDetectorData, StepActivityType ì¶”ê°€
â”œâ”€â”€ services/
â”‚   â””â”€â”€ sensors/
â”‚       â””â”€â”€ StepDetectorService.ts   # ë³´í–‰ ê°ì§€ ì„œë¹„ìŠ¤ (400+ ë¼ì¸)
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ schema.ts                    # step_events í…Œì´ë¸” ì¶”ê°€ (v2)
â”‚   â”œâ”€â”€ index.ts                     # StepEvent ëª¨ë¸ ë“±ë¡
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ StepEvent.ts            # StepEvent ëª¨ë¸
â”‚   â”‚   â””â”€â”€ index.ts                # Export ì¶”ê°€
â”‚   â””â”€â”€ repositories/
â”‚       â”œâ”€â”€ StepEventRepository.ts   # StepEvent Repository (240+ ë¼ì¸)
â”‚       â””â”€â”€ index.ts                # Export ì¶”ê°€
â””â”€â”€ components/
    â””â”€â”€ StepCounter.tsx              # ê±¸ìŒ ìˆ˜ UI ì»´í¬ë„ŒíŠ¸ (200+ ë¼ì¸)
```

### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

1. **ì •í™•ë„ í…ŒìŠ¤íŠ¸**:
   - ì‹¤ì œ ê±¸ìŒ ìˆ˜ì™€ ê°ì§€ëœ ê±¸ìŒ ìˆ˜ ë¹„êµ
   - ë‹¤ì–‘í•œ ê±¸ìŒ ì†ë„ì—ì„œ í…ŒìŠ¤íŠ¸
   - ê³„ë‹¨ ì˜¤ë¥´ê¸°/ë‚´ë¦¬ê¸° êµ¬ë¶„

2. **í™œë™ ë¶„ë¥˜ í…ŒìŠ¤íŠ¸**:
   - ì²œì²œíˆ ê±·ê¸° â†’ WALKING
   - ë¹ ë¥´ê²Œ ê±·ê¸° â†’ WALKING (ë†’ì€ magnitude)
   - ì¡°ê¹…/ë‹¬ë¦¬ê¸° â†’ RUNNING
   - ì •ì§€ â†’ ê°ì§€ ì—†ìŒ

3. **ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**:
   - ë°°í„°ë¦¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§
   - CPU ì‚¬ìš©ë¥  í™•ì¸
   - ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ê²€ì‚¬

### ì•Œë ¤ì§„ ì œí•œì‚¬í•­

1. **ì„¼ì„œ ì˜ì¡´ì„±**: 
   - ê°€ì†ë„ê³„ì˜ ì •í™•ë„ì— ì˜ì¡´
   - ì €ê°€ ë””ë°”ì´ìŠ¤ì—ì„œ ë…¸ì´ì¦ˆ ì¦ê°€ ê°€ëŠ¥

2. **í™œë™ ë¶„ë¥˜**:
   - ë‹¨ìˆœ ì„ê³„ê°’ ê¸°ë°˜ ë¶„ë¥˜
   - ë³µì¡í•œ í™œë™ (ê³„ë‹¨, ìì „ê±°)ì€ ì •í™•ë„ ë‚®ìŒ

3. **ì˜¤íƒì§€ ê°€ëŠ¥ì„±**:
   - ì°¨ëŸ‰ ì´ë™ ì¤‘ ì§„ë™
   - ì† í”ë“¤ê¸° ë“±ì˜ ì›€ì§ì„

### í–¥í›„ ê°œì„  ë°©í–¥

1. **ML ê¸°ë°˜ ë¶„ë¥˜**:
   - TensorFlow Lite í†µí•©
   - ë” ì •êµí•œ í™œë™ ë¶„ë¥˜ (ê³„ë‹¨, ìì „ê±° ë“±)
   - ê°œì¸í™”ëœ ë³´í–‰ íŒ¨í„´ í•™ìŠµ

2. **ì¶”ê°€ ê¸°ëŠ¥**:
   - ë³´í­ ì¶”ì •
   - ì¹¼ë¡œë¦¬ ì†Œëª¨ ê³„ì‚°
   - ì¼ì¼/ì£¼ê°„/ì›”ê°„ í†µê³„
   - ëª©í‘œ ì„¤ì • ë° ì•Œë¦¼

3. **ìµœì í™”**:
   - ì ì‘í˜• ìƒ˜í”Œë§ ë ˆì´íŠ¸
   - ë°°í„°ë¦¬ ìµœì í™” ëª¨ë“œ
   - ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬ ê°œì„ 

---

**Phase 30 ì™„ë£Œ**: âœ… ë³´í–‰ ê°ì§€ ì„¼ì„œ ì‹œìŠ¤í…œ êµ¬í˜„ ì™„ë£Œ  
**ë‹¤ìŒ ë‹¨ê³„**: Phase 31 - ë³´í–‰ ê³„ìˆ˜ ì„¼ì„œ (Step Counter with cumulative count)

---

## Phase 31: ë³´í–‰ ê³„ìˆ˜ ì„¼ì„œ (Step Counter)

**ì™„ë£Œ ë‚ ì§œ**: 2025-11-12

### êµ¬í˜„ ë‚´ìš©

#### 1. íƒ€ì… ì •ì˜ ë° ë°ì´í„° êµ¬ì¡°
**íŒŒì¼**: `src/types/sensor.types.ts`
- `SensorType.STEP_COUNTER` ì¶”ê°€
- `StepCounterData` ì¸í„°í˜ì´ìŠ¤ ì •ì˜:
  - `elapsedRealtimeNanos`: ë¶€íŒ… í›„ ê²½ê³¼ ì‹œê°„ (ë‚˜ë…¸ì´ˆ)
  - `count`: ë¶€íŒ… ì´í›„ ëˆ„ì  ê±¸ìŒ ìˆ˜
  - `delta`: ì´ì „ ìƒ˜í”Œ ì´í›„ ì¦ê°€í•œ ê±¸ìŒ ìˆ˜

#### 2. StepCounterService êµ¬í˜„
**íŒŒì¼**: `src/services/sensors/StepCounterService.ts` (400+ ë¼ì¸)

**í•µì‹¬ ê¸°ëŠ¥**:
- ê°€ì†ë„ê³„ ê¸°ë°˜ ë³´í–‰ ê°ì§€ (Peak Detection ì•Œê³ ë¦¬ì¦˜)
- ëˆ„ì  ì¹´ìš´íŠ¸ ì¶”ì  (ë¶€íŒ… ì´í›„)
- ë¸íƒ€ ê°’ ê³„ì‚° (ìƒ˜í”Œ ê°„ ì¦ê°€ëŸ‰)
- ì¬ë¶€íŒ… ê°ì§€ ë° ìë™ ë¦¬ì…‹
- AsyncStorage ê¸°ë°˜ ìƒíƒœ ì˜ì†í™”

**ìƒíƒœ ê´€ë¦¬**:
```typescript
interface StepCounterState {
  bootTime: number;            // ë¶€íŒ… ì‹œê°„ (performance.now() ê¸°ì¤€)
  cumulativeCount: number;     // ëˆ„ì  ê±¸ìŒ ìˆ˜
  lastReportedCount: number;   // ë§ˆì§€ë§‰ ë¦¬í¬íŠ¸ëœ ì¹´ìš´íŠ¸
  sessionStartCount: number;   // ì„¸ì…˜ ì‹œì‘ ì‹œ ì¹´ìš´íŠ¸
}
```

**ì¬ë¶€íŒ… ê°ì§€**:
```typescript
const currentBootTime = Date.now() - performance.now();

if (storedBootTime !== currentBootTime) {
  // ë””ë°”ì´ìŠ¤ê°€ ì¬ë¶€íŒ…ë¨ - ì¹´ìš´íŠ¸ ë¦¬ì…‹
  this.cumulativeCount = 0;
  this.bootTime = currentBootTime;
  await this.persistState();
}
```

**ìƒ˜í”Œë§ ë°©ì‹**:
- 50Hzë¡œ ê°€ì†ë„ê³„ ëª¨ë‹ˆí„°ë§ (ë³´í–‰ ê°ì§€)
- 1ì´ˆ ê°„ê²©ìœ¼ë¡œ ìƒ˜í”Œ ìƒì„± (ì„¤ì • ê°€ëŠ¥)
- ê° ìƒ˜í”Œì— ëˆ„ì  ì¹´ìš´íŠ¸ + ë¸íƒ€ í¬í•¨

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
const stepCounter = new StepCounterService();

// ì„¤ì • ì»¤ìŠ¤í„°ë§ˆì´ì§•
stepCounter.configure({
  sampleInterval: 2000, // 2ì´ˆë§ˆë‹¤ ìƒ˜í”Œë§
  minMagnitude: 1.8,    // ë³´í–‰ ê°ì§€ ì„ê³„ê°’ ë†’ì„
});

// ì‹œì‘
await stepCounter.start(sessionId, (sampleData) => {
  console.log('Total steps:', sampleData.count);
  console.log('Steps since last sample:', sampleData.delta);
});

// í†µê³„ í™•ì¸
const stats = stepCounter.getStatistics();
console.log('Total steps since boot:', stats.totalSteps);
console.log('Steps in this session:', stats.sessionSteps);

// ì„¸ì…˜ ê±¸ìŒ ìˆ˜ë§Œ í™•ì¸
const sessionSteps = stepCounter.getSessionStepCount();
```

#### 3. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì—…ë°ì´íŠ¸

**ìŠ¤í‚¤ë§ˆ ë²„ì „**: 2 â†’ 3

**ìƒˆ í…Œì´ë¸”**: `step_counts`
```typescript
tableSchema({
  name: 'step_counts',
  columns: [
    {name: 'session_id', type: 'string', isIndexed: true},
    {name: 'timestamp', type: 'number', isIndexed: true},
    {name: 'elapsed_realtime_nanos', type: 'number'},
    {name: 'count', type: 'number'},  // Cumulative count since boot
    {name: 'delta', type: 'number'},  // Steps since last sample
    {name: 'is_uploaded', type: 'boolean'},
    {name: 'created_at', type: 'number'},
    {name: 'updated_at', type: 'number'},
  ],
})
```

**ëª¨ë¸**: `src/database/models/StepCount.ts`
- WatermelonDB Model í´ë˜ìŠ¤
- Field decorators ì‚¬ìš©
- ìë™ íƒ€ì„ìŠ¤íƒ¬í”„ ê´€ë¦¬

#### 4. StepCountRepository êµ¬í˜„
**íŒŒì¼**: `src/database/repositories/StepCountRepository.ts` (240+ ë¼ì¸)

**ì£¼ìš” ë©”ì„œë“œ**:
```typescript
// CRUD Operations
create(data: StepCounterData): Promise<StepCount>
createBatch(dataArray: StepCounterData[]): Promise<StepCount[]>

// Query Methods
findBySession(sessionId: string): Promise<StepCount[]>
findByTimeRange(startTime, endTime): Promise<StepCount[]>

// Statistics
getTotalStepsBySession(sessionId: string): Promise<number>
getSessionStatistics(sessionId: string): Promise<Statistics>

// Timeline (for visualization)
getTimeline(sessionId: string, limit?: number): Promise<TimelineData[]>

// Latest Data
getLatest(): Promise<StepCount | null>
getLatestBySession(sessionId: string): Promise<StepCount | null>

// Sync Operations
markAsUploaded(stepCountIds: string[]): Promise<void>
getPendingUpload(): Promise<StepCount[]>

// Delete Operations
deleteBySession(sessionId: string): Promise<void>
deleteAll(): Promise<void>
```

**Statistics íƒ€ì…**:
```typescript
interface Statistics {
  totalSteps: number;
  sampleCount: number;
  averageStepsPerSample: number;
  maxDelta: number;
  minDelta: number;
}
```

**Timeline íƒ€ì…**:
```typescript
interface TimelineData {
  timestamp: number;
  count: number;
  delta: number;
}
```

### Phase 30 vs Phase 31 ë¹„êµ

| íŠ¹ì§• | Phase 30 (Step Detector) | Phase 31 (Step Counter) |
|------|-------------------------|-------------------------|
| **ë°ì´í„° íƒ€ì…** | ì´ë²¤íŠ¸ ê¸°ë°˜ | ìƒ˜í”Œ ê¸°ë°˜ |
| **ì €ì¥ ë°©ì‹** | ê° ê±¸ìŒë§ˆë‹¤ ì´ë²¤íŠ¸ | ì£¼ê¸°ì  ìƒ˜í”Œ (1ì´ˆ ê°„ê²©) |
| **ë°ì´í„° í¬ê¸°** | ë§ìŒ (ê±¸ìŒë§ˆë‹¤ 1ê°œ) | ì ìŒ (ìƒ˜í”Œë§ˆë‹¤ 1ê°œ) |
| **ì •ë³´** | í™œë™ íƒ€ì…, ì‹ ë¢°ë„ | ëˆ„ì  ì¹´ìš´íŠ¸, ë¸íƒ€ |
| **ìš©ë„** | ìƒì„¸ ë¶„ì„, í™œë™ ë¶„ë¥˜ | ì´ ê±¸ìŒ ìˆ˜ ì¶”ì  |
| **ì˜ì†ì„±** | ì—†ìŒ | AsyncStorage (ì¬ë¶€íŒ… ëŒ€ì‘) |

### ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

#### ì¬ë¶€íŒ… ê°ì§€ ë¡œì§
1. **Boot Time ê³„ì‚°**:
   ```typescript
   bootTime = Date.now() - performance.now()
   ```
   - `Date.now()`: í˜„ì¬ ì‹œê° (UTC)
   - `performance.now()`: ì•± ì‹œì‘ ì´í›„ ê²½ê³¼ ì‹œê°„
   - `bootTime`: ë””ë°”ì´ìŠ¤ ë¶€íŒ… ì‹œê° (ê·¼ì‚¬ê°’)

2. **ì¬ë¶€íŒ… í™•ì¸**:
   - ì €ì¥ëœ bootTimeê³¼ í˜„ì¬ bootTime ë¹„êµ
   - ë‹¤ë¥´ë©´ ì¬ë¶€íŒ…ë¨ â†’ ì¹´ìš´íŠ¸ ë¦¬ì…‹
   - ê°™ìœ¼ë©´ ë™ì¼ ì„¸ì…˜ â†’ ì¹´ìš´íŠ¸ ë³µì›

#### ìƒíƒœ ì˜ì†í™”
**AsyncStorage Keys**:
```typescript
'@step_counter_boot_time'      // ë¶€íŒ… ì‹œê°„
'@step_counter_last_count'     // ë§ˆì§€ë§‰ ì¹´ìš´íŠ¸
'@step_counter_session_start'  // ì„¸ì…˜ ì‹œì‘ ì¹´ìš´íŠ¸
```

**ì €ì¥ ì‹œì **:
- ì„œë¹„ìŠ¤ ì‹œì‘/ì¢…ë£Œ ì‹œ
- ë§¤ 10ê±¸ìŒë§ˆë‹¤ ìë™ ì €ì¥
- ëª…ì‹œì  persist() í˜¸ì¶œ ì‹œ

#### ìƒ˜í”Œë§ ì „ëµ
```typescript
// 50Hzë¡œ ê±¸ìŒ ê°ì§€ (ì‹¤ì‹œê°„)
accelerometer.subscribe(...) // 20ms ê°„ê²©

// 1ì´ˆë§ˆë‹¤ ìƒ˜í”Œ ë°œí–‰ (íš¨ìœ¨ì„±)
setInterval(() => {
  emitSample(); // ëˆ„ì  ì¹´ìš´íŠ¸ + ë¸íƒ€
}, 1000);
```

### í†µí•© ê°€ì´ë“œ

#### 1. ì„œë¹„ìŠ¤ ì´ˆê¸°í™”
```typescript
import {StepCounterService} from '@services/sensors';

const stepCounter = new StepCounterService();
const isAvailable = await stepCounter.isAvailable();

if (isAvailable) {
  await stepCounter.start(sessionId, handleSampleData);
}
```

#### 2. ë°ì´í„° ì €ì¥
```typescript
import {getStepCountRepository} from '@database/repositories';

const stepCountRepo = getStepCountRepository();

// ë‹¨ì¼ ìƒ˜í”Œ
await stepCountRepo.create(sampleData);

// ë°°ì¹˜ ì €ì¥
await stepCountRepo.createBatch(sampleDataArray);
```

#### 3. í†µê³„ ì¡°íšŒ
```typescript
const stats = await stepCountRepo.getSessionStatistics(sessionId);
console.log(`ì´ ${stats.totalSteps}ê±¸ìŒ`);
console.log(`ìƒ˜í”Œ ìˆ˜: ${stats.sampleCount}`);
console.log(`í‰ê· : ${stats.averageStepsPerSample.toFixed(1)} ê±¸ìŒ/ìƒ˜í”Œ`);
console.log(`ìµœëŒ€ ë¸íƒ€: ${stats.maxDelta}`);
```

#### 4. íƒ€ì„ë¼ì¸ ì‹œê°í™”
```typescript
const timeline = await stepCountRepo.getTimeline(sessionId, 100);

// Chart.js ë“±ìœ¼ë¡œ ì‹œê°í™”
const labels = timeline.map(t => new Date(t.timestamp).toLocaleTimeString());
const data = timeline.map(t => t.count);
```

### íŒŒì¼ êµ¬ì¡°
```
src/
â”œâ”€â”€ types/
â”‚   â””â”€â”€ sensor.types.ts              # StepCounterData ì¶”ê°€
â”œâ”€â”€ services/
â”‚   â””â”€â”€ sensors/
â”‚       â””â”€â”€ StepCounterService.ts    # ë³´í–‰ ê³„ìˆ˜ ì„œë¹„ìŠ¤ (400+ ë¼ì¸)
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ schema.ts                    # step_counts í…Œì´ë¸” ì¶”ê°€ (v3)
â”‚   â”œâ”€â”€ index.ts                     # StepCount ëª¨ë¸ ë“±ë¡
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ StepCount.ts            # StepCount ëª¨ë¸
â”‚   â”‚   â””â”€â”€ index.ts                # Export ì¶”ê°€
â”‚   â””â”€â”€ repositories/
â”‚       â”œâ”€â”€ StepCountRepository.ts   # StepCount Repository (240+ ë¼ì¸)
â”‚       â””â”€â”€ index.ts                # Export ì¶”ê°€
```

### ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

#### ì‹œë‚˜ë¦¬ì˜¤ 1: ì¼ì¼ ê±¸ìŒ ìˆ˜ ì¶”ì 
```typescript
// ì•„ì¹¨ì— ì•± ì‹œì‘
const stepCounter = new StepCounterService();
await stepCounter.start(sessionId, onSample);

// ì €ë…ì— í™•ì¸
const stats = stepCounter.getStatistics();
console.log(`ì˜¤ëŠ˜ ${stats.totalSteps}ê±¸ìŒ ê±¸ì—ˆìŠµë‹ˆë‹¤!`);
```

#### ì‹œë‚˜ë¦¬ì˜¤ 2: ì—¬ëŸ¬ ì„¸ì…˜ ë¹„êµ
```typescript
const session1Steps = await repo.getTotalStepsBySession('session-1');
const session2Steps = await repo.getTotalStepsBySession('session-2');

console.log(`ì„¸ì…˜ 1: ${session1Steps}ê±¸ìŒ`);
console.log(`ì„¸ì…˜ 2: ${session2Steps}ê±¸ìŒ`);
console.log(`ì¦ê°€ëŸ‰: ${session2Steps - session1Steps}ê±¸ìŒ`);
```

#### ì‹œë‚˜ë¦¬ì˜¤ 3: ì¬ë¶€íŒ… í›„ì—ë„ ê³„ì† ì¶”ì 
```typescript
// ë””ë°”ì´ìŠ¤ ì¬ë¶€íŒ… ì „: 5000ê±¸ìŒ
// ì¬ë¶€íŒ… í›„ ìë™ ë¦¬ì…‹: 0ê±¸ìŒ
// ìƒˆë¡œ ê±¸ì€ ê±¸ìŒ: 100ê±¸ìŒ
// í˜„ì¬ ì¹´ìš´íŠ¸: 100ê±¸ìŒ (ì •í™•í•¨)
```

### ì•Œë ¤ì§„ ì œí•œì‚¬í•­

1. **ë¶€íŒ… ì‹œê° ì •í™•ë„**:
   - `performance.now()` ê¸°ë°˜ ì¶”ì •
   - ì‹œê°„ ë™ê¸°í™” ì‹œ ì˜¤ì°¨ ê°€ëŠ¥
   - ì¼ë°˜ì ìœ¼ë¡œ ìˆ˜ ì´ˆ ì´ë‚´ ì˜¤ì°¨

2. **ë°±ê·¸ë¼ìš´ë“œ ì œí•œ**:
   - ì•±ì´ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì¢…ë£Œë˜ë©´ ì¹´ìš´íŒ… ì¤‘ë‹¨
   - ë°±ê·¸ë¼ìš´ë“œ ì„œë¹„ìŠ¤ í•„ìš” (ë³„ë„ êµ¬í˜„ í•„ìš”)

3. **ì •í™•ë„**:
   - StepDetectorServiceì™€ ë™ì¼í•œ Peak Detection ì‚¬ìš©
   - í™œë™ ë¶„ë¥˜ ì—†ìŒ (ì´ ê±¸ìŒ ìˆ˜ë§Œ)

### í–¥í›„ ê°œì„  ë°©í–¥

1. **ë„¤ì´í‹°ë¸Œ ì„¼ì„œ ì‚¬ìš©**:
   - Android: Sensor.TYPE_STEP_COUNTER
   - iOS: CMPedometer
   - ë°°í„°ë¦¬ íš¨ìœ¨ í–¥ìƒ
   - ë” ì •í™•í•œ ì¹´ìš´íŒ…

2. **ë°±ê·¸ë¼ìš´ë“œ ì§€ì›**:
   - Foreground Service (Android)
   - Background Modes (iOS)
   - 24/7 ê±¸ìŒ ìˆ˜ ì¶”ì 

3. **ëª©í‘œ ì„¤ì •**:
   - ì¼ì¼ ëª©í‘œ (ì˜ˆ: 10,000ê±¸ìŒ)
   - ì§„í–‰ ìƒíƒœ ì•Œë¦¼
   - ë‹¬ì„± ì‹œ ì¶•í•˜ ë©”ì‹œì§€

4. **íˆìŠ¤í† ë¦¬ ë¶„ì„**:
   - ì¼ë³„/ì£¼ë³„/ì›”ë³„ í†µê³„
   - íŠ¸ë Œë“œ ë¶„ì„
   - í‰ê·  ë¹„êµ

---

**Phase 31 ì™„ë£Œ**: âœ… ë³´í–‰ ê³„ìˆ˜ ì„¼ì„œ ì‹œìŠ¤í…œ êµ¬í˜„ ì™„ë£Œ  
**ë‹¤ìŒ ë‹¨ê³„**: Phase 32 - ë‚™í•˜ ê°ì§€ ì„¼ì„œ (Significant Motion Detection)

---

## Phase 33: ê·¼ì ‘ ì„¼ì„œ (Proximity Sensor)

**ì™„ë£Œ ë‚ ì§œ**: 2025-11-12

### êµ¬í˜„ ë‚´ìš©

#### 1. íƒ€ì… ì •ì˜ ë° ë°ì´í„° êµ¬ì¡°
**íŒŒì¼**: `src/types/sensor.types.ts`
- `SensorType.PROXIMITY` ì¶”ê°€
- `ProximityData` ì¸í„°í˜ì´ìŠ¤ ì •ì˜:
  - `distance`: ê±°ë¦¬ (ì„¼í‹°ë¯¸í„°)
  - `isNear`: ê·¼ì ‘ ì—¬ë¶€ (boolean)
  - `maxRange`: ì„¼ì„œ ìµœëŒ€ ê°ì§€ ê±°ë¦¬ (cm)

#### 2. ProximityService êµ¬í˜„
**íŒŒì¼**: `src/services/sensors/ProximityService.ts` (200+ ë¼ì¸)

**í•µì‹¬ ê¸°ëŠ¥**:
- ê·¼ì ‘ ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ ì¸í„°í˜ì´ìŠ¤
- **ì„¼ì„œ ê°€ìš©ì„± ì²´í¬** (isAvailable)
- ì„¼ì„œ ì—†ëŠ” ê²½ìš° ìë™ ìŠ¤í‚µ ì²˜ë¦¬
- ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ í†µí•© ì¤€ë¹„

**ì„¼ì„œ ê°€ìš©ì„± ì²˜ë¦¬**:
```typescript
async isAvailable(): Promise<boolean> {
  // React Native Sensors ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” proximity ë¯¸ì§€ì›
  // ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ êµ¬í˜„ í•„ìš”
  console.warn('Proximity sensor requires native module');
  return false; // ì„¼ì„œ ì—†ìŒ
}

async start(...) {
  const available = await this.isAvailable();
  if (!available) {
    // ì„¼ì„œê°€ ì—†ìœ¼ë©´ ì—ëŸ¬ ë°œìƒ ë° ìŠ¤í‚µ
    throw new Error('Proximity sensor not available');
  }
  // ì„¼ì„œê°€ ìˆìœ¼ë©´ ì‹œì‘
}
```

**ì„¤ì • ê°€ëŠ¥í•œ íŒŒë¼ë¯¸í„°**:
```typescript
interface ProximityConfig {
  sampleInterval: number;      // ìƒ˜í”Œ ê°„ê²© (ms)
  nearThreshold: number;        // ê·¼ì ‘ ì„ê³„ê°’ (cm)
  wakeOnProximity: boolean;     // ê·¼ì ‘ ì‹œ í™”ë©´ í™œì„±í™”
}
```

**ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ ì¸í„°í˜ì´ìŠ¤**:
```typescript
// Android
- Sensor.TYPE_PROXIMITY
- Returns distance in centimeters
- Binary mode: 0 (near) or maxRange (far)

// iOS  
- UIDevice.proximityState
- Binary only: true (near) or false (far)
- No distance measurement
```

#### 3. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì—…ë°ì´íŠ¸

**ìŠ¤í‚¤ë§ˆ ë²„ì „**: 3 â†’ 4

**sensor_data í…Œì´ë¸”ì— ì»¬ëŸ¼ ì¶”ê°€**:
```typescript
// Proximity data
{name: 'distance', type: 'number', isOptional: true},
{name: 'is_near', type: 'boolean', isOptional: true},
{name: 'max_range', type: 'number', isOptional: true},
```

**SensorDataRecord ëª¨ë¸ ì—…ë°ì´íŠ¸**:
- `distance?: number` í•„ë“œ ì¶”ê°€
- `isNear?: boolean` í•„ë“œ ì¶”ê°€
- `maxRange?: number` í•„ë“œ ì¶”ê°€

#### 4. SensorDataRepository ì—…ë°ì´íŠ¸
**íŒŒì¼**: `src/database/repositories/SensorDataRepository.ts`

**Proximity ë°ì´í„° ì²˜ë¦¬ ì¶”ê°€**:
```typescript
// Proximity data
if ('distance' in data) {
  record.distance = data.distance;
  record.isNear = data.isNear;
  record.maxRange = data.maxRange;
}
```

### ì„¼ì„œ ê°€ìš©ì„± ì²˜ë¦¬ ì „ëµ

#### 1. ì„œë¹„ìŠ¤ ë ˆë²¨ ì²´í¬
```typescript
const proximityService = new ProximityService();
const isAvailable = await proximityService.isAvailable();

if (isAvailable) {
  await proximityService.start(sessionId, handleData);
} else {
  console.log('Proximity sensor not available - skipping');
  // ì„¼ì„œê°€ ì—†ì–´ë„ ì•±ì€ ì •ìƒ ë™ì‘
}
```

#### 2. ë‹¤ì¤‘ ì„¼ì„œ ê´€ë¦¬ ì˜ˆì‹œ
```typescript
const sensors = [
  accelerometerService,
  gyroscopeService,
  proximityService,  // ì¼ë¶€ ë””ë°”ì´ìŠ¤ì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥
];

for (const sensor of sensors) {
  if (await sensor.isAvailable()) {
    await sensor.start(sessionId, handleData);
    console.log(`${sensor.getSensorType()} started`);
  } else {
    console.log(`${sensor.getSensorType()} not available - skipped`);
  }
}
```

#### 3. ì„¼ì„œ ìƒíƒœ UI í‘œì‹œ
```typescript
const sensorStatus = {
  accelerometer: await accelerometer.isAvailable(),
  gyroscope: await gyroscope.isAvailable(),
  proximity: await proximity.isAvailable(),
};

// UIì— í‘œì‹œ
{sensorStatus.proximity ? 'âœ…' : 'âŒ'} Proximity Sensor
```

### ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ êµ¬í˜„ ê°€ì´ë“œ

#### Android êµ¬í˜„ (ProximityModule.java)
```java
public class ProximityModule extends ReactContextBaseJavaModule {
  private SensorManager sensorManager;
  private Sensor proximitySensor;
  
  @ReactMethod
  public void isAvailable(Promise promise) {
    Sensor sensor = sensorManager.getDefaultSensor(Sensor.TYPE_PROXIMITY);
    promise.resolve(sensor != null);
  }
  
  @ReactMethod
  public void startProximityUpdates() {
    sensorManager.registerListener(
      proximityListener,
      proximitySensor,
      SensorManager.SENSOR_DELAY_NORMAL
    );
  }
  
  @ReactMethod
  public void stopProximityUpdates() {
    sensorManager.unregisterListener(proximityListener);
  }
  
  @ReactMethod
  public void getMaxRange(Promise promise) {
    promise.resolve(proximitySensor.getMaximumRange());
  }
}
```

#### iOS êµ¬í˜„ (ProximityModule.m)
```objc
@implementation ProximityModule

RCT_EXPORT_MODULE();

RCT_REMAP_METHOD(isAvailable,
                 isAvailableWithResolver:(RCTPromiseResolveBlock)resolve
                 rejecter:(RCTPromiseRejectBlock)reject) {
  BOOL available = [[UIDevice currentDevice] isProximityMonitoringEnabled];
  resolve(@(available));
}

RCT_EXPORT_METHOD(startProximityUpdates) {
  [[UIDevice currentDevice] setProximityMonitoringEnabled:YES];
  [[NSNotificationCenter defaultCenter]
    addObserver:self
    selector:@selector(proximityStateDidChange:)
    name:UIDeviceProximityStateDidChangeNotification
    object:nil];
}

- (void)proximityStateDidChange:(NSNotification *)notification {
  BOOL state = [[UIDevice currentDevice] proximityState];
  [self sendEventWithName:@"ProximityChanged"
                     body:@{@"isNear": @(state)}];
}

@end
```

### ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

#### ì‹œë‚˜ë¦¬ì˜¤ 1: í†µí™” ì¤‘ í™”ë©´ ë„ê¸°
```typescript
const proximity = new ProximityService();

if (await proximity.isAvailable()) {
  await proximity.start(sessionId, (data) => {
    if (data.isNear) {
      // ì–¼êµ´ì´ í™”ë©´ì— ê°€ê¹Œì›€ - í™”ë©´ ë„ê¸°
      ScreenBrightness.setBrightness(0);
    } else {
      // ì–¼êµ´ì´ ë©€ì–´ì§ - í™”ë©´ ì¼œê¸°
      ScreenBrightness.setBrightness(1);
    }
  });
}
```

#### ì‹œë‚˜ë¦¬ì˜¤ 2: ì£¼ë¨¸ë‹ˆ ê°ì§€
```typescript
let inPocket = false;

proximity.start(sessionId, (data) => {
  if (data.distance < 1) { // 1cm ë¯¸ë§Œ
    inPocket = true;
    // í„°ì¹˜ ì…ë ¥ ë¬´ì‹œ
    TouchHandler.disable();
  } else {
    inPocket = false;
    TouchHandler.enable();
  }
});
```

#### ì‹œë‚˜ë¦¬ì˜¤ 3: ì„¼ì„œ ì—†ëŠ” ë””ë°”ì´ìŠ¤ ì²˜ë¦¬
```typescript
const startProximityIfAvailable = async () => {
  const proximity = new ProximityService();
  
  try {
    await proximity.start(sessionId, handleData);
    return true;
  } catch (error) {
    if (error.message.includes('not available')) {
      console.log('Device does not have proximity sensor');
      // ëŒ€ì²´ ê¸°ëŠ¥ ì‚¬ìš© (ì˜ˆ: ìˆ˜ë™ í™”ë©´ ë„ê¸° ë²„íŠ¼)
      return false;
    }
    throw error;
  }
};
```

### íŒŒì¼ êµ¬ì¡°
```
src/
â”œâ”€â”€ types/
â”‚   â””â”€â”€ sensor.types.ts              # ProximityData ì¶”ê°€
â”œâ”€â”€ services/
â”‚   â””â”€â”€ sensors/
â”‚       â””â”€â”€ ProximityService.ts      # ê·¼ì ‘ ì„¼ì„œ ì„œë¹„ìŠ¤ (200+ ë¼ì¸)
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ schema.ts                    # sensor_data í…Œì´ë¸” ì—…ë°ì´íŠ¸ (v4)
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ SensorDataRecord.ts     # proximity í•„ë“œ ì¶”ê°€
â”‚   â””â”€â”€ repositories/
â”‚       â””â”€â”€ SensorDataRepository.ts  # proximity ë°ì´í„° ì²˜ë¦¬ ì¶”ê°€
```

### í…ŒìŠ¤íŠ¸ ì „ëµ

#### 1. ì„¼ì„œ ê°€ìš©ì„± í…ŒìŠ¤íŠ¸
```typescript
test('proximity sensor availability', async () => {
  const proximity = new ProximityService();
  const available = await proximity.isAvailable();
  
  // í˜„ì¬ëŠ” false (ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ ì—†ìŒ)
  expect(available).toBe(false);
});
```

#### 2. ì„¼ì„œ ì—†ëŠ” ê²½ìš° ì²˜ë¦¬
```typescript
test('handles missing sensor gracefully', async () => {
  const proximity = new ProximityService();
  
  try {
    await proximity.start('session-1', jest.fn());
    fail('Should throw error');
  } catch (error) {
    expect(error.message).toContain('not available');
  }
});
```

#### 3. ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ í†µí•© í…ŒìŠ¤íŠ¸
```typescript
// ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ êµ¬í˜„ í›„
test('proximity sensor integration', async () => {
  const proximity = new ProximityService();
  const onData = jest.fn();
  
  await proximity.start('session-1', onData);
  
  // ê·¼ì ‘ ì´ë²¤íŠ¸ ì‹œë®¬ë ˆì´ì…˜
  // ... ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ í˜¸ì¶œ
  
  expect(onData).toHaveBeenCalledWith(
    expect.objectContaining({
      sensorType: SensorType.PROXIMITY,
      isNear: true,
    })
  );
});
```

### ì•Œë ¤ì§„ ì œí•œì‚¬í•­

1. **React Native Sensors ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¯¸ì§€ì›**:
   - proximity sensorëŠ” ê¸°ë³¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— í¬í•¨ë˜ì§€ ì•ŠìŒ
   - ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ êµ¬í˜„ í•„ìš”

2. **í”Œë«í¼ë³„ ì°¨ì´**:
   - Android: ê±°ë¦¬ ê°’ ì œê³µ (ì„¼í‹°ë¯¸í„°)
   - iOS: Booleanë§Œ ì œê³µ (near/far)

3. **ì„¼ì„œ ê°€ìš©ì„±**:
   - ì¼ë¶€ ì €ê°€ ë””ë°”ì´ìŠ¤ì—ëŠ” ê·¼ì ‘ ì„¼ì„œ ì—†ìŒ
   - íƒœë¸”ë¦¿ì—ëŠ” ëŒ€ë¶€ë¶„ ì—†ìŒ

### í–¥í›„ ê°œì„  ë°©í–¥

1. **ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ êµ¬í˜„**:
   - Android/iOS ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ ê°œë°œ
   - React Native New Architecture ì§€ì›

2. **ì„¼ì„œ í´ë°±**:
   - ê·¼ì ‘ ì„¼ì„œ ì—†ëŠ” ê²½ìš° ëŒ€ì²´ UI ì œê³µ
   - ìˆ˜ë™ í™”ë©´ ë„ê¸°/ì¼œê¸° ë²„íŠ¼

3. **ê³ ê¸‰ ê¸°ëŠ¥**:
   - ê·¼ì ‘ ì´ë²¤íŠ¸ íˆìŠ¤í† ë¦¬
   - íŒ¨í„´ ë¶„ì„ (ì˜ˆ: ì£¼ë¨¸ë‹ˆì— ë„£ì€ ì‹œê°„)
   - ìë™ ëª¨ë“œ ì „í™˜

---

**Phase 33 ì™„ë£Œ**: âœ… ê·¼ì ‘ ì„¼ì„œ ì‹œìŠ¤í…œ êµ¬í˜„ ì™„ë£Œ (ì„¼ì„œ ê°€ìš©ì„± ì²´í¬ í¬í•¨)
**ë‹¤ìŒ ë‹¨ê³„**: Phase 34 - ì¡°ë„ ì„¼ì„œ (Light Sensor)

**ì¤‘ìš”**: Phase 33ì—ì„œ êµ¬í˜„í•œ ì„¼ì„œ ê°€ìš©ì„± ì²´í¬ íŒ¨í„´ì€ ì´í›„ ëª¨ë“  ì„¼ì„œì— ì ìš©ë©ë‹ˆë‹¤.

---

## Phase 34: ì¡°ë„ ì„¼ì„œ (Light Sensor)

**ì™„ë£Œ ë‚ ì§œ**: 2025-11-12

### êµ¬í˜„ ë‚´ìš©

#### 1. íƒ€ì… ì •ì˜ ë° ë°ì´í„° êµ¬ì¡°
**íŒŒì¼**: `src/types/sensor.types.ts`
- `SensorType.LIGHT` ì¶”ê°€
- `LightData` ì¸í„°í˜ì´ìŠ¤ ì •ì˜:
  - `lux`: ì¡°ë„ (ëŸ­ìŠ¤, SI ë‹¨ìœ„)
  - `brightnessLevel`: ë°ê¸° ë ˆë²¨ ë¶„ë¥˜ (dark/dim/normal/bright/very_bright)

**SensorSettings í™•ì¥**:
```typescript
[SensorType.LIGHT]: SensorConfig & {
  autoBrightness: boolean;
  brightnessThresholds?: {
    dark: number;   // 10 lux
    dim: number;    // 50 lux
    normal: number; // 500 lux
    bright: number; // 10000 lux
  };
};
```

#### 2. LightService êµ¬í˜„
**íŒŒì¼**: `src/services/sensors/LightService.ts` (250+ ë¼ì¸)

**í•µì‹¬ ê¸°ëŠ¥**:
- ì¡°ë„ ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ ì¸í„°í˜ì´ìŠ¤
- **ë°ê¸° ë ˆë²¨ ìë™ ë¶„ë¥˜**
- **í™”ë©´ ë°ê¸° ì¶”ì²œ ê¸°ëŠ¥**
- ì„¼ì„œ ê°€ìš©ì„± ì²´í¬ (isAvailable)
- ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ í†µí•© ì¤€ë¹„

**ë°ê¸° ë ˆë²¨ ë¶„ë¥˜**:
```typescript
private categorizeBrightness(lux: number): BrightnessLevel {
  if (lux < 10) return 'dark';         // ë§¤ìš° ì–´ë‘ì›€
  else if (lux < 50) return 'dim';     // ì–´ë‘ì›€
  else if (lux < 500) return 'normal'; // ë³´í†µ ì‹¤ë‚´
  else if (lux < 10000) return 'bright'; // ë°ìŒ
  else return 'very_bright';           // ë§¤ìš° ë°ìŒ (ì§ì‚¬ê´‘ì„ )
}
```

**í™”ë©´ ë°ê¸° ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜**:
```typescript
getSuggestedScreenBrightness(lux: number): number {
  // ë¡œê·¸ ìŠ¤ì¼€ì¼ ê¸°ë°˜ ë°ê¸° ê³„ì‚°
  // lux 0 â†’ brightness 0.1 (ìµœì†Œ)
  // lux 100000 â†’ brightness 1.0 (ìµœëŒ€)
  const brightness = 0.1 + (Math.log10(lux) / 5) * 0.9;
  return Math.max(0.1, Math.min(1.0, brightness));
}
```

**ì„¤ì • ê°€ëŠ¥í•œ íŒŒë¼ë¯¸í„°**:
```typescript
interface LightConfig {
  sampleInterval: number;        // ìƒ˜í”Œ ê°„ê²© (ms, ê¸°ë³¸: 1000)
  autoBrightness: boolean;       // ìë™ ë°ê¸° ì¡°ì ˆ
  brightnessThresholds: {        // ë°ê¸° ë ˆë²¨ ì„ê³„ê°’
    dark: number;
    dim: number;
    normal: number;
    bright: number;
  };
}
```

**ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
const lightService = new LightService();

// ì„¤ì •
lightService.configure({
  sampleInterval: 2000,
  autoBrightness: true,
});

// ì‹œì‘
if (await lightService.isAvailable()) {
  await lightService.start(sessionId, (data) => {
    console.log(`Lux: ${data.lux}`);
    console.log(`Level: ${data.brightnessLevel}`);

    // í™”ë©´ ë°ê¸° ìë™ ì¡°ì ˆ
    const suggested = lightService.getSuggestedScreenBrightness(data.lux);
    Brightness.setBrightness(suggested);
  });
}
```

#### 3. ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ ì¸í„°í˜ì´ìŠ¤
```typescript
// Android
- Sensor.TYPE_LIGHT
- Returns illuminance in lux (SI unit)
- Range: 0.01 to 100,000+ lux
- Typical values:
  - 0.0001 lux: Moonless night
  - 0.5 lux: Full moon
  - 50 lux: Living room
  - 400 lux: Office
  - 1000 lux: Overcast day
  - 10000-25000 lux: Full daylight
  - 100000+ lux: Direct sunlight

// iOS
- No direct light sensor API
- Alternatives:
  1. Use camera AVCaptureDevice ISO/brightness
  2. Use CIDetector face detection with ambient light estimation
  3. Estimate from screen auto-brightness settings
```

#### 4. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì—…ë°ì´íŠ¸

**ìŠ¤í‚¤ë§ˆ ë²„ì „**: 4 â†’ 5

**sensor_data í…Œì´ë¸”ì— ì»¬ëŸ¼ ì¶”ê°€**:
```typescript
// Light data
{name: 'lux', type: 'number', isOptional: true},
{name: 'brightness_level', type: 'string', isOptional: true},
```

**SensorDataRecord ëª¨ë¸ ì—…ë°ì´íŠ¸**:
- `lux?: number` í•„ë“œ ì¶”ê°€
- `brightnessLevel?: string` í•„ë“œ ì¶”ê°€

#### 5. SensorDataRepository ì—…ë°ì´íŠ¸
**íŒŒì¼**: `src/database/repositories/SensorDataRepository.ts`

**Light ë°ì´í„° ì²˜ë¦¬ ì¶”ê°€**:
```typescript
// Light data
if ('lux' in data) {
  record.lux = data.lux;
  record.brightnessLevel = data.brightnessLevel;
}
```

### í™œìš© ì‹œë‚˜ë¦¬ì˜¤

#### 1. ìë™ í™”ë©´ ë°ê¸° ì¡°ì ˆ
```typescript
const lightService = new LightService();
lightService.configure({ autoBrightness: true });

await lightService.start(sessionId, (data) => {
  const brightness = lightService.getSuggestedScreenBrightness(data.lux);
  await Brightness.setBrightnessLevel(brightness);
});
```

#### 2. ì•¼ê°„ ëª¨ë“œ ìë™ ì „í™˜
```typescript
await lightService.start(sessionId, (data) => {
  if (data.brightnessLevel === 'dark' || data.brightnessLevel === 'dim') {
    // ë‹¤í¬ ëª¨ë“œ í™œì„±í™”
    setDarkMode(true);
  } else {
    setDarkMode(false);
  }
});
```

#### 3. ë°ê¸° ê¸°ë°˜ ì¹´ë©”ë¼ ì„¤ì •
```typescript
await lightService.start(sessionId, (data) => {
  if (data.lux < 10) {
    // ì•¼ê°„ ëª¨ë“œ: ë†’ì€ ISO, ë‚®ì€ ì…”í„° ì†ë„
    camera.setISO(3200);
    camera.setShutterSpeed('1/30');
  } else if (data.lux > 10000) {
    // ì£¼ê°„ ëª¨ë“œ: ë‚®ì€ ISO, ë¹ ë¥¸ ì…”í„° ì†ë„
    camera.setISO(100);
    camera.setShutterSpeed('1/500');
  }
});
```

#### 4. ì—ë„ˆì§€ ì ˆì•½
```typescript
await lightService.start(sessionId, (data) => {
  if (data.brightnessLevel === 'very_bright') {
    // ì‹¤ì™¸ ì§ì‚¬ê´‘ì„ : ë°°í„°ë¦¬ ì ˆì•½ ëª¨ë“œ
    setBatterySavingMode(true);
    reduceSampleRate();
  }
});
```

### í–¥í›„ ê°œì„  ë°©í–¥

1. **ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ êµ¬í˜„**:
   - Android TYPE_LIGHT ì„¼ì„œ ì—°ë™
   - iOS ëŒ€ì²´ ì†”ë£¨ì…˜ (camera-based)

2. **ê³ ê¸‰ ë°ê¸° ì•Œê³ ë¦¬ì¦˜**:
   - ì´ë™ í‰ê·  í•„í„° (ê°‘ì‘ìŠ¤ëŸ° ë³€í™” ì™„í™”)
   - ì‚¬ìš©ì ì„ í˜¸ë„ í•™ìŠµ
   - í™˜ê²½ë³„ í”„ë¡œíŒŒì¼ (ì‹¤ë‚´/ì‹¤ì™¸/ì°¨ëŸ‰)

3. **UI/UX ê°œì„ **:
   - ì‹¤ì‹œê°„ ì¡°ë„ ê·¸ë˜í”„
   - íˆìŠ¤í† ë¦¬ ë¶„ì„ (í•˜ë£¨ í‰ê·  ì¡°ë„)
   - í™˜ê²½ ì¡°ë„ ì•Œë¦¼

---

## Phase 35: ê¸°ì••ê³„ ì„¼ì„œ (Pressure Sensor)

**ì™„ë£Œ ë‚ ì§œ**: 2025-11-12

### êµ¬í˜„ ë‚´ìš©

#### 1. íƒ€ì… ì •ì˜ ë° ë°ì´í„° êµ¬ì¡°
**íŒŒì¼**: `src/types/sensor.types.ts`
- `SensorType.PRESSURE` ì¶”ê°€
- `PressureData` ì¸í„°í˜ì´ìŠ¤ ì •ì˜:
  - `pressure`: ê¸°ì•• (hPa/ë°€ë¦¬ë°”)
  - `altitude`: ê³„ì‚°ëœ ê³ ë„ (ë¯¸í„°)
  - `seaLevelPressure`: í•´ìˆ˜ë©´ ê¸°ì•• ê¸°ì¤€ê°’ (hPa)

**SensorSettings í™•ì¥**:
```typescript
[SensorType.PRESSURE]: SensorConfig & {
  altitudeCalculation: boolean;
  seaLevelPressure: number; // ê¸°ë³¸ê°’: 1013.25 hPa
};
```

#### 2. PressureService êµ¬í˜„
**íŒŒì¼**: `src/services/sensors/PressureService.ts` (280+ ë¼ì¸)

**í•µì‹¬ ê¸°ëŠ¥**:
- ê¸°ì•• ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ ì¸í„°í˜ì´ìŠ¤
- **ê¸°ì•• ê¸°ë°˜ ê³ ë„ ê³„ì‚°**
- **ê¸°ì•• ì¶”ì„¸ ë¶„ì„** (ìƒìŠ¹/í•˜ê°•/ì•ˆì •)
- **ë‚ ì”¨ ì˜ˆì¸¡ ê¸°ëŠ¥**
- ì„¼ì„œ ê°€ìš©ì„± ì²´í¬ (isAvailable)
- ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ í†µí•© ì¤€ë¹„

**ê¸°ì••ì‹ ê³ ë„ ê³„ì‚°**:
```typescript
// ê¸°ì••ì‹ ê³ ë„ ê³µì‹ (Barometric Formula)
private calculateAltitude(pressure: number, seaLevelPressure: number): number {
  // h = 44330 * (1 - (P / P0)^0.1903)
  // h: ê³ ë„ (ë¯¸í„°)
  // P: ì¸¡ì • ê¸°ì•• (hPa)
  // P0: í•´ìˆ˜ë©´ ê¸°ì•• (hPa)
  const altitude = 44330 * (1 - Math.pow(pressure / seaLevelPressure, 0.1903));
  return Math.round(altitude * 10) / 10; // ì†Œìˆ˜ì  1ìë¦¬
}

// ì—­ê³„ì‚°: ê³ ë„ì—ì„œ ê¸°ì•• ê³„ì‚°
calculatePressureAtAltitude(altitude: number, seaLevelPressure: number): number {
  // P = P0 * (1 - h / 44330)^5.255
  const pressure = seaLevelPressure * Math.pow(1 - altitude / 44330, 5.255);
  return Math.round(pressure * 100) / 100; // ì†Œìˆ˜ì  2ìë¦¬
}
```

**ê¸°ì•• ì¶”ì„¸ ë¶„ì„**:
```typescript
detectPressureTrend(
  currentPressure: number,
  previousPressure: number,
  threshold: number = 0.5 // hPa
): 'rising' | 'falling' | 'stable' {
  const diff = currentPressure - previousPressure;
  if (diff > threshold) return 'rising';
  else if (diff < -threshold) return 'falling';
  else return 'stable';
}
```

**ë‚ ì”¨ ì˜ˆì¸¡ ì•Œê³ ë¦¬ì¦˜**:
```typescript
estimateWeather(pressure: number, trend: 'rising' | 'falling' | 'stable'): string {
  if (pressure > 1023) {
    return trend === 'rising' ? 'Clear, dry' : 'Clearing';
  } else if (pressure > 1013) {
    return trend === 'rising' ? 'Fair'
      : trend === 'falling' ? 'Clouding up'
      : 'Partly cloudy';
  } else if (pressure > 1003) {
    return trend === 'falling' ? 'Rain likely' : 'Unsettled';
  } else {
    return trend === 'falling' ? 'Storm warning' : 'Rainy';
  }
}
```

**ê¸°ì•• ë²”ìœ„ ì°¸ê³ ê°’**:
```typescript
// ì¼ë°˜ì ì¸ ê¸°ì•• ë²”ìœ„ (hPa)
- 870 hPa: íƒœí’ ì¤‘ì‹¬ (ê¸°ë¡ìƒ ìµœì €)
- 950 hPa: ê°•í•œ ì €ê¸°ì••
- 980-1000 hPa: ì €ê¸°ì•• (ë¹„/ëˆˆ)
- 1013.25 hPa: í‘œì¤€ í•´ìˆ˜ë©´ ê¸°ì••
- 1020-1030 hPa: ê³ ê¸°ì•• (ë§‘ìŒ)
- 1050+ hPa: ê°•í•œ ê³ ê¸°ì•• (ê¸°ë¡ìƒ ìµœê³ : ~1085 hPa)

// ê³ ë„ë³„ ê¸°ì•• (í‘œì¤€ ëŒ€ê¸°)
- í•´ìˆ˜ë©´: 1013.25 hPa
- 500m: 954 hPa
- 1000m: 898 hPa
- 1500m: 845 hPa
- 2000m: 794 hPa
- 3000m: 701 hPa
```

**ì„¤ì • ê°€ëŠ¥í•œ íŒŒë¼ë¯¸í„°**:
```typescript
interface PressureConfig {
  sampleInterval: number;        // ìƒ˜í”Œ ê°„ê²© (ms, ê¸°ë³¸: 1000)
  altitudeCalculation: boolean;  // ê³ ë„ ê³„ì‚° í™œì„±í™”
  seaLevelPressure: number;      // í•´ìˆ˜ë©´ ê¸°ì•• (hPa, ê¸°ë³¸: 1013.25)
}
```

**ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
const pressureService = new PressureService();

// ì„¤ì • (ì˜ˆ: ì„œìš¸ í‰ê·  í•´ìˆ˜ë©´ ê¸°ì•• ê¸°ì¤€)
pressureService.configure({
  sampleInterval: 1000,
  altitudeCalculation: true,
  seaLevelPressure: 1013.25,
});

// ì‹œì‘
if (await pressureService.isAvailable()) {
  let previousPressure = 1013.25;

  await pressureService.start(sessionId, (data) => {
    console.log(`Pressure: ${data.pressure} hPa`);
    console.log(`Altitude: ${data.altitude} m`);

    // ê¸°ì•• ì¶”ì„¸ ë¶„ì„
    const trend = pressureService.detectPressureTrend(
      data.pressure,
      previousPressure
    );

    // ë‚ ì”¨ ì˜ˆì¸¡
    const weather = pressureService.estimateWeather(data.pressure, trend);
    console.log(`Weather: ${weather}`);

    previousPressure = data.pressure;
  });
}
```

#### 3. ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ ì¸í„°í˜ì´ìŠ¤
```typescript
// Android
- Sensor.TYPE_PRESSURE
- Returns pressure in hPa (hectopascals) = mbar (millibars)
- Typical range: 300-1100 hPa
- Available on most modern smartphones
- Sample rate: SENSOR_DELAY_NORMAL (200ms)

// iOS
- CMAltimeter (Core Motion)
- Requires motion & fitness permission
- Returns:
  - relativeAltitude: ìƒëŒ€ ê³ ë„ (meters)
  - pressure: ê¸°ì•• (kilopascals, kPa â†’ hPa ë³€í™˜ í•„ìš”)
- Available on iPhone 6+, iPad with barometer
```

#### 4. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì—…ë°ì´íŠ¸

**ìŠ¤í‚¤ë§ˆ ë²„ì „**: 4 â†’ 5 (Phase 34ì™€ í•¨ê»˜)

**sensor_data í…Œì´ë¸”ì— ì»¬ëŸ¼ ì¶”ê°€**:
```typescript
// Pressure data
{name: 'pressure', type: 'number', isOptional: true},
{name: 'calculated_altitude', type: 'number', isOptional: true},
{name: 'sea_level_pressure', type: 'number', isOptional: true},
```

**SensorDataRecord ëª¨ë¸ ì—…ë°ì´íŠ¸**:
- `pressure?: number` í•„ë“œ ì¶”ê°€
- `calculatedAltitude?: number` í•„ë“œ ì¶”ê°€
- `seaLevelPressure?: number` í•„ë“œ ì¶”ê°€

#### 5. SensorDataRepository ì—…ë°ì´íŠ¸
**íŒŒì¼**: `src/database/repositories/SensorDataRepository.ts`

**Pressure ë°ì´í„° ì²˜ë¦¬ ì¶”ê°€**:
```typescript
// Pressure data
if ('pressure' in data) {
  record.pressure = data.pressure;
  record.calculatedAltitude = data.altitude;
  record.seaLevelPressure = data.seaLevelPressure;
}
```

### í™œìš© ì‹œë‚˜ë¦¬ì˜¤

#### 1. ë“±ì‚°/í•˜ì´í‚¹ ê³ ë„ ì¶”ì 
```typescript
const pressureService = new PressureService();

// GPS ê¸°ë°˜ ê³ ë„ì™€ ì¡°í•©
await pressureService.start(sessionId, async (data) => {
  const gpsAltitude = await GPS.getAltitude();
  const pressureAltitude = data.altitude;

  // ê¸°ì•• ê³ ë„ëŠ” ë‚ ì”¨ ì˜í–¥ì„ ë°›ìœ¼ë¯€ë¡œ GPSì™€ ë³´ì •
  const calibratedAltitude = (gpsAltitude + pressureAltitude) / 2;

  console.log(`Current altitude: ${calibratedAltitude}m`);
});
```

#### 2. ì‹¤ë‚´ ì¸µìˆ˜ ê°ì§€
```typescript
const pressureService = new PressureService();
let baselinePressure: number | null = null;

await pressureService.start(sessionId, (data) => {
  if (!baselinePressure) {
    baselinePressure = data.pressure;
    return;
  }

  // ê¸°ì•• ë³€í™”ë¡œ ì¸µìˆ˜ ì¶”ì • (~12 Pa per floor)
  const pressureDiff = baselinePressure - data.pressure;
  const floor = Math.round(pressureDiff / 0.12); // hPa to floors

  console.log(`Floor change: ${floor > 0 ? '+' : ''}${floor}`);
});
```

#### 3. ë‚ ì”¨ ê²½ë³´ ì‹œìŠ¤í…œ
```typescript
const pressureService = new PressureService();
const pressureHistory: number[] = [];

await pressureService.start(sessionId, (data) => {
  pressureHistory.push(data.pressure);

  // ì§€ë‚œ 3ì‹œê°„ ê¸°ì•• ì¶”ì„¸ ë¶„ì„
  if (pressureHistory.length > 180) { // 1ë¶„ ê°„ê²© * 180 = 3ì‹œê°„
    pressureHistory.shift();

    const first = pressureHistory[0];
    const last = pressureHistory[pressureHistory.length - 1];
    const drop = first - last;

    // 3ì‹œê°„ ë™ì•ˆ 3 hPa ì´ìƒ í•˜ê°• â†’ í­í’ ê²½ë³´
    if (drop > 3) {
      Alert.alert(
        'Storm Warning',
        'Rapid pressure drop detected. Weather may deteriorate.'
      );
    }
  }
});
```

#### 4. ë¹„í–‰ê¸° ëª¨ë“œ ê°ì§€
```typescript
const pressureService = new PressureService();

await pressureService.start(sessionId, (data) => {
  if (data.pressure < 800) {
    // ê¸°ì•• 800 hPa ì´í•˜ â†’ ê³ ë„ ~2000m ì´ìƒ
    console.log('High altitude detected - possible flight');

    // ë¹„í–‰ ëª¨ë“œ ì „í™˜ ì œì•ˆ
    if (!isAirplaneMode()) {
      Alert.alert(
        'Flying?',
        'High altitude detected. Enable airplane mode?'
      );
    }
  }
});
```

#### 5. í•´ìˆ˜ë©´ ê¸°ì•• ë³´ì •
```typescript
const pressureService = new PressureService();

// GPSë¡œ í˜„ì¬ ê³ ë„ í™•ì¸
const gpsAltitude = await GPS.getAltitude();

await pressureService.start(sessionId, (data) => {
  // í˜„ì¬ ê³ ë„ì™€ ì¸¡ì • ê¸°ì••ìœ¼ë¡œ í•´ìˆ˜ë©´ ê¸°ì•• ì—­ì‚°
  const seaLevelPressure = pressureService.calculatePressureAtAltitude(
    -gpsAltitude, // ìŒìˆ˜ ê³ ë„ (í•´ìˆ˜ë©´ìœ¼ë¡œ í™˜ì‚°)
    data.pressure
  );

  // ë³´ì •ëœ í•´ìˆ˜ë©´ ê¸°ì•• ì„¤ì •
  pressureService.setSeaLevelPressure(seaLevelPressure);

  console.log(`Calibrated sea level pressure: ${seaLevelPressure} hPa`);
});
```

### ê³ ë„ ê³„ì‚° ì •í™•ë„

#### ì˜í–¥ ìš”ì¸
1. **ë‚ ì”¨ ë³€í™”**:
   - ê¸°ì••ì€ ë‚ ì”¨ ì‹œìŠ¤í…œì— ë”°ë¼ ë³€í•¨
   - ê°™ì€ ê³ ë„ì—ì„œë„ Â±10-30 hPa ì°¨ì´ ê°€ëŠ¥
   - í•´ê²°: GPS ê³ ë„ë¡œ í•´ìˆ˜ë©´ ê¸°ì•• ì£¼ê¸°ì  ë³´ì •

2. **ì˜¨ë„ íš¨ê³¼**:
   - í‘œì¤€ ê³µì‹ì€ 15Â°C ê¸°ì¤€
   - ì˜¨ë„ ë³€í™” ì‹œ ì˜¤ì°¨ ë°œìƒ
   - í•´ê²°: ì˜¨ë„ ì„¼ì„œ ë°ì´í„°ë¡œ ë³´ì •

3. **ì§€ì—­ì  ê¸°ì•• ë³€í™”**:
   - ì €ê¸°ì••/ê³ ê¸°ì•• ì´ë™
   - ì‹œê°„ë‹¹ 1-3 hPa ë³€í™” ê°€ëŠ¥

#### ì •í™•ë„ í–¥ìƒ ë°©ë²•
```typescript
// 1. GPSì™€ ìœµí•©
const fusedAltitude = (gpsAltitude * 0.7) + (pressureAltitude * 0.3);

// 2. ì¹¼ë§Œ í•„í„° ì ìš©
const kalmanFilter = new KalmanFilter();
const filteredAltitude = kalmanFilter.update(pressureAltitude, gpsAltitude);

// 3. ì£¼ê¸°ì  ë³´ì •
setInterval(async () => {
  const gpsAlt = await GPS.getAltitude();
  const pressure = await pressureService.getCurrentPressure();
  const calibratedSeaLevel = calculateSeaLevelPressure(gpsAlt, pressure);
  pressureService.setSeaLevelPressure(calibratedSeaLevel);
}, 300000); // 5ë¶„ë§ˆë‹¤
```

### í–¥í›„ ê°œì„  ë°©í–¥

1. **ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ êµ¬í˜„**:
   - Android TYPE_PRESSURE ì„¼ì„œ ì—°ë™
   - iOS CMAltimeter ì—°ë™
   - ì˜¨ë„ ë³´ì • ì•Œê³ ë¦¬ì¦˜

2. **ê³ ê¸‰ ì•Œê³ ë¦¬ì¦˜**:
   - ì¹¼ë§Œ í•„í„° (GPS + ê¸°ì•• ìœµí•©)
   - ê¸°ê³„ í•™ìŠµ ê¸°ë°˜ ë‚ ì”¨ ì˜ˆì¸¡
   - ê°œì¸í™”ëœ ê¸°ì•• íŒ¨í„´ ë¶„ì„

3. **UI/UX ê°œì„ **:
   - ì‹¤ì‹œê°„ ê¸°ì•• ê·¸ë˜í”„
   - 24ì‹œê°„ ê¸°ì•• ì¶”ì„¸ ì°¨íŠ¸
   - ë‚ ì”¨ ê²½ë³´ ì•Œë¦¼
   - ê³ ë„ í”„ë¡œíŒŒì¼ (ë“±ì‚° ê¸°ë¡)

4. **ì„¼ì„œ ìœµí•©**:
   - GPS + ê¸°ì•• ê³ ë„ ìœµí•©
   - ì˜¨ë„ ì„¼ì„œ ì—°ë™ (ë³´ì •)
   - ìŠµë„ ì„¼ì„œ ì—°ë™ (ì²´ê° ë‚ ì”¨)

---

**Phase 34-35 ì™„ë£Œ**: âœ… ì¡°ë„ ì„¼ì„œ ë° ê¸°ì••ê³„ ì„¼ì„œ êµ¬í˜„ ì™„ë£Œ
**ë°ì´í„°ë² ì´ìŠ¤ ë²„ì „**: v4 â†’ v5
**ë‹¤ìŒ ë‹¨ê³„**: Phase 36 - ì¤‘ë ¥ ì„¼ì„œ (Gravity Sensor)

**ì£¼ìš” ì„±ê³¼**:
- í™˜ê²½ ì„¼ì„œ í™•ì¥ (ì¡°ë„, ê¸°ì••)
- ìŠ¤ë§ˆíŠ¸ ê¸°ëŠ¥ ì¶”ê°€ (ìë™ ë°ê¸°, ê³ ë„ ê³„ì‚°, ë‚ ì”¨ ì˜ˆì¸¡)
- ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ v5 ì—…ê·¸ë ˆì´ë“œ ì™„ë£Œ

---

## Phase 36: ì¤‘ë ¥ ì„¼ì„œ (Gravity Sensor)

**ì™„ë£Œ ë‚ ì§œ**: 2025-11-12

### êµ¬í˜„ ë‚´ìš©

#### 1. íƒ€ì… ì •ì˜ ë° ë°ì´í„° êµ¬ì¡°
**íŒŒì¼**: `src/types/sensor.types.ts`
- `SensorType.GRAVITY` ì¶”ê°€
- `GravityData` ì¸í„°í˜ì´ìŠ¤: x, y, z (m/sÂ²), magnitude

#### 2. GravityService êµ¬í˜„
**íŒŒì¼**: `src/services/sensors/GravityService.ts` (300+ ë¼ì¸)

**í•µì‹¬ ê¸°ëŠ¥**:
- ì¤‘ë ¥ ë°©í–¥ ë° í¬ê¸° ì¸¡ì • (ì§€êµ¬ ì¤‘ë ¥ ~9.81 m/sÂ²)
- ë””ë°”ì´ìŠ¤ ê¸°ìš¸ê¸° ê°ë„ ê³„ì‚° (pitch, roll)
- ê¸°ê¸° ë°©í–¥ ê°ì§€ (portrait/landscape/face_up/face_down)
- ìˆ˜í‰ ê°ì§€ (isLevel)

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
const gravityService = new GravityService();
const {pitch, roll} = gravityService.getTiltAngles(x, y, z);
const orientation = gravityService.detectOrientation(x, y, z);
const isFlat = gravityService.isLevel(x, y, z, 5); // 5Â° tolerance
```

**ê°€ìƒ ì„¼ì„œ**: ê°€ì†ë„ê³„ + ìì´ë¡œìŠ¤ì½”í”„ ìœµí•©

---

## Phase 37: ì„ í˜• ê°€ì†ë„ ì„¼ì„œ (Linear Acceleration)

**ì™„ë£Œ ë‚ ì§œ**: 2025-11-12

### êµ¬í˜„ ë‚´ìš©

#### 1. íƒ€ì… ì •ì˜ ë° ë°ì´í„° êµ¬ì¡°
- `SensorType.LINEAR_ACCELERATION` ì¶”ê°€
- `LinearAccelerationData` ì¸í„°í˜ì´ìŠ¤: x, y, z, magnitude (m/sÂ²)

#### 2. LinearAccelerationService êµ¬í˜„
**íŒŒì¼**: `src/services/sensors/LinearAccelerationService.ts` (350+ ë¼ì¸)

**í•µì‹¬ ê¸°ëŠ¥**:
- ì¤‘ë ¥ ì œê±°ëœ ìˆœìˆ˜ ê°€ì†ë„ ì¸¡ì • (Linear = Accel - Gravity)
- ì €ì£¼íŒŒ ë…¸ì´ì¦ˆ í•„í„°ë§ (low-pass filter)
- í”ë“¤ê¸° ê°ì§€ (detectShake)
- ì¶©ê²© ê°ì§€ (detectImpact: light/moderate/strong)
- ë™ì‘ ë¶„ë¥˜ (stationary/walking/running/vehicle/falling)
- ì œìŠ¤ì²˜ ì¸ì‹ (swipe/tap/shake)
- ì†ë„ ì ë¶„ ê³„ì‚° (integrateVelocity)

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
const linearAccelService = new LinearAccelerationService();
const magnitude = calculateMagnitude(x, y, z);
const isShake = linearAccelService.detectShake(magnitude, 15); // 15 m/sÂ² threshold
const motion = linearAccelService.classifyMotion(x, y, z, magnitude);
const gesture = linearAccelService.detectGesture(history);
```

**í™œìš© ì‚¬ë¡€**: ì œìŠ¤ì²˜ ì¸ì‹, ì§„ë™ ê°ì§€, ëª¨ì…˜ ì¶”ì , ê²Œì„ ì»¨íŠ¸ë¡¤

---

## Phase 38: íšŒì „ ë²¡í„° ì„¼ì„œ (Rotation Vector)

**ì™„ë£Œ ë‚ ì§œ**: 2025-11-12

### êµ¬í˜„ ë‚´ìš©

#### 1. íƒ€ì… ì •ì˜ ë° ë°ì´í„° êµ¬ì¡°
- `SensorType.ROTATION_VECTOR` ì¶”ê°€
- `RotationVectorData` ì¸í„°í˜ì´ìŠ¤:
  - ì¿¼í„°ë‹ˆì–¸: qx, qy, qz, qw
  - ì˜¤ì¼ëŸ¬ ê°: heading (yaw), pitch, roll (degrees)
  - accuracy: ì •í™•ë„ ì¶”ì •ê°’

#### 2. RotationVectorService êµ¬í˜„
**íŒŒì¼**: `src/services/sensors/RotationVectorService.ts` (450+ ë¼ì¸)

**í•µì‹¬ ê¸°ëŠ¥**:
- ì¿¼í„°ë‹ˆì–¸ â†” ì˜¤ì¼ëŸ¬ ê° ë³€í™˜
- ì¿¼í„°ë‹ˆì–¸ ì •ê·œí™” (normalizeQuaternion)
- êµ¬ë©´ ì„ í˜• ë³´ê°„ (SLERP - Spherical Linear Interpolation)
- íšŒì „ í–‰ë ¬ ìƒì„± (quaternionToRotationMatrix)
- ì¿¼í„°ë‹ˆì–¸ ê°ë„ ì°¨ì´ ê³„ì‚°
- ë‚˜ì¹¨ë°˜ ë°©ìœ„ê° ì¶”ì¶œ (getCompassHeading)
- ê¸°ê¸° ë°©í–¥ ê°ì§€

**ì¿¼í„°ë‹ˆì–¸ ìˆ˜í•™**:
```typescript
// ì˜¤ì¼ëŸ¬ ê° â†’ ì¿¼í„°ë‹ˆì–¸
const q = service.eulerToQuaternion(heading, pitch, roll);

// ì¿¼í„°ë‹ˆì–¸ â†’ ì˜¤ì¼ëŸ¬ ê°
const { heading, pitch, roll } = service.quaternionToEuler(q);

// ì¿¼í„°ë‹ˆì–¸ ë³´ê°„ (ë¶€ë“œëŸ¬ìš´ íšŒì „)
const interpolated = service.slerpQuaternion(q1, q2, 0.5); // t=0.5 (ì¤‘ê°„)

// ê°ë„ ì°¨ì´ ê³„ì‚°
const angleDiff = service.quaternionAngularDifference(q1, q2); // degrees
```

**í™œìš© ì‚¬ë¡€**: AR/VR, ë‚˜ì¹¨ë°˜, 3D í¬ì§€ì…”ë‹, ì¹´ë©”ë¼ ì•ˆì •í™”, ê²Œì„ ì œì–´

---

### ë°ì´í„°ë² ì´ìŠ¤ ì—…ë°ì´íŠ¸ (v5 â†’ v6)

**ìŠ¤í‚¤ë§ˆ ë²„ì „**: v6

**sensor_data í…Œì´ë¸”ì— ì¶”ê°€ëœ ì»¬ëŸ¼**:
```typescript
// Gravity & Linear Acceleration
{name: 'magnitude', type: 'number', isOptional: true},

// Rotation Vector (quaternion)
{name: 'qx', type: 'number', isOptional: true},
{name: 'qy', type: 'number', isOptional: true},
{name: 'qz', type: 'number', isOptional: true},
{name: 'qw', type: 'number', isOptional: true},

// Euler angles
{name: 'pitch', type: 'number', isOptional: true},
{name: 'roll', type: 'number', isOptional: true},
```

**SensorDataRecord ëª¨ë¸**: ìƒˆ í•„ë“œ ì¶”ê°€ ì™„ë£Œ
**SensorDataRepository**: create/createBatch ë©”ì„œë“œ ì—…ë°ì´íŠ¸ ì™„ë£Œ

---

**Phase 36-38 ì™„ë£Œ**: âœ… ëª¨ì…˜ ì„¼ì„œ 3ì¢… (ì¤‘ë ¥, ì„ í˜• ê°€ì†ë„, íšŒì „ ë²¡í„°) êµ¬í˜„ ì™„ë£Œ
**ë°ì´í„°ë² ì´ìŠ¤ ë²„ì „**: v5 â†’ v6
**ë‹¤ìŒ ë‹¨ê³„**: Phase 39-40 (ì¶”ê°€ ì„¼ì„œ ë˜ëŠ” ë‹¤ë¥¸ ê¸°ëŠ¥)

**ì£¼ìš” ì„±ê³¼**:
- ê³ ê¸‰ ëª¨ì…˜ ì„¼ì„œ í™•ì¥ (ì¤‘ë ¥, ì„ í˜• ê°€ì†ë„, íšŒì „ ë²¡í„°)
- ì¿¼í„°ë‹ˆì–¸ ìˆ˜í•™ ë¼ì´ë¸ŒëŸ¬ë¦¬ êµ¬í˜„ (SLERP, ë³€í™˜, íšŒì „ í–‰ë ¬)
- ì œìŠ¤ì²˜ ì¸ì‹ ë° ë™ì‘ ë¶„ë¥˜ ì•Œê³ ë¦¬ì¦˜
- ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ v6 ì—…ê·¸ë ˆì´ë“œ ì™„ë£Œ
- ì„¼ì„œ ê°€ìš©ì„± ì²´í¬ íŒ¨í„´ ì§€ì† ì ìš©

**ê¸°ìˆ ì  íŠ¹ì§•**:
- ëª¨ë“  ì„¼ì„œëŠ” ê°€ìƒ ì„¼ì„œ (ì„¼ì„œ ìœµí•© ê¸°ë°˜)
- Android: TYPE_GRAVITY, TYPE_LINEAR_ACCELERATION, TYPE_ROTATION_VECTOR
- iOS: CMDeviceMotion (gravity, userAcceleration, attitude)
- ì¿¼í„°ë‹ˆì–¸ ì‚¬ìš©ìœ¼ë¡œ ì§ë²Œ ë½(Gimbal Lock) ë¬¸ì œ í•´ê²°
- ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ êµ¬í˜„ ê°€ì´ë“œ í¬í•¨

---

## Phase 39: ì˜¨ë„ ì„¼ì„œ (Temperature Sensor)

**ì™„ë£Œ ë‚ ì§œ**: 2025-11-12

### êµ¬í˜„ ë‚´ìš©

#### 1. íƒ€ì… ì •ì˜
- `SensorType.TEMPERATURE` ì¶”ê°€
- `TemperatureData` ì¸í„°í˜ì´ìŠ¤: celsius, fahrenheit, kelvin

#### 2. TemperatureService êµ¬í˜„
**íŒŒì¼**: `src/services/sensors/TemperatureService.ts` (350+ ë¼ì¸)

**í•µì‹¬ ê¸°ëŠ¥**:
- ì£¼ë³€ ì˜¨ë„ ì¸¡ì • (Celsius ê¸°ì¤€)
- ì˜¨ë„ ë‹¨ìœ„ ë³€í™˜ (Â°C â†” Â°F â†” K)
- ì˜¨ë„ ë²”ì£¼ ë¶„ë¥˜ (freezing/very_cold/cold/cool/comfortable/warm/hot/very_hot)
- ì²´ê°ì˜¨ë„ ê³„ì‚°:
  - `calculateHeatIndex()`: ë”ìœ„ ì§€ìˆ˜ (ì˜¨ë„ + ìŠµë„)
  - `calculateWindChill()`: ë°”ëŒ í•œê¸° ì§€ìˆ˜ (ì˜¨ë„ + í’ì†)
- ì˜¨ë„ ì¶”ì„¸ ê°ì§€ (rising/falling/stable, Â°C/hour)
- ì˜ë¥˜ ì¶”ì²œ (suggestClothing)

**ì˜¨ë„ ë‹¨ìœ„ ë³€í™˜**:
```typescript
celsius â†’ fahrenheit: F = C Ã— 9/5 + 32
celsius â†’ kelvin: K = C + 273.15
```

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
const tempService = new TemperatureService();
const fahrenheit = tempService.celsiusToFahrenheit(25); // 77Â°F
const category = tempService.categorizeTemperature(22); // 'comfortable'
const heatIndex = tempService.calculateHeatIndex(30, 70); // ì²´ê°ì˜¨ë„
const trend = tempService.detectTemperatureTrend(history); // { trend: 'rising', ratePerHour: 2.5 }
```

**ì¤‘ìš” ì‚¬í•­**: 
- ì£¼ë³€ ì˜¨ë„ ì„¼ì„œëŠ” ìŠ¤ë§ˆíŠ¸í°ì— ë§¤ìš° ë“œë¬¾
- ëŒ€ë¶€ë¶„ì˜ ê¸°ê¸°ëŠ” ë‚´ë¶€ ì˜¨ë„ ì„¼ì„œ(ë°°í„°ë¦¬/CPU)ë§Œ ë³´ìœ 
- iOSëŠ” ë„¤ì´í‹°ë¸Œ API ë¯¸ì œê³µ

---

## Phase 40: ìŠµë„ ì„¼ì„œ (Humidity Sensor)

**ì™„ë£Œ ë‚ ì§œ**: 2025-11-12

### êµ¬í˜„ ë‚´ìš©

#### 1. íƒ€ì… ì •ì˜
- `SensorType.HUMIDITY` ì¶”ê°€
- `HumidityData` ì¸í„°í˜ì´ìŠ¤: humidity (%), dewPoint (Â°C)

#### 2. HumidityService êµ¬í˜„
**íŒŒì¼**: `src/services/sensors/HumidityService.ts` (400+ ë¼ì¸)

**í•µì‹¬ ê¸°ëŠ¥**:
- ìƒëŒ€ ìŠµë„ ì¸¡ì • (0-100%)
- ì´ìŠ¬ì  ì˜¨ë„ ê³„ì‚° (Magnus formula)
- ìŠµë„ ë²”ì£¼ ë¶„ë¥˜ (very_dry/dry/comfortable/humid/very_humid)
- ì¾Œì ë„ í‰ê°€ (ì˜¨ë„ + ìŠµë„ ì¡°í•©)
- ì ˆëŒ€ ìŠµë„ ê³„ì‚° (g/mÂ³)
- ê³°íŒ¡ì´ ìœ„í—˜ë„ í‰ê°€ (low/moderate/high/very_high)
- ìŠµë„ê°€ ì²´ê°ì˜¨ë„ì— ë¯¸ì¹˜ëŠ” ì˜í–¥
- ìŠµë„ ì¶”ì„¸ ê°ì§€ (rising/falling/stable, %/hour)

**ì´ìŠ¬ì  ê³„ì‚° (Magnus formula)**:
```typescript
calculateDewPoint(T, RH):
  Î± = (17.27 Ã— T) / (237.7 + T) + ln(RH/100)
  dewPoint = (237.7 Ã— Î±) / (17.27 - Î±)
```

**ì¾Œì ë„ í‰ê°€**:
```typescript
assessComfort(temp, humidity):
  ideal: 18-26Â°C & 40-60% ìŠµë„
  comfortable: 16-28Â°C & 30-70% ìŠµë„
  uncomfortable: ë²”ìœ„ ë²—ì–´ë‚¨
  very_uncomfortable: ê·¹ë‹¨ì  ì¡°ê±´ (ì˜ˆ: ê³ ì˜¨ë‹¤ìŠµ)
```

**ê³°íŒ¡ì´ ìœ„í—˜ë„**:
```typescript
assessMoldRisk(temp, humidity):
  - ìŠµë„ < 60%: low risk
  - ìŠµë„ 60-70% & ì˜¨ë„ 15-30Â°C: moderate
  - ìŠµë„ 70-80% & ì˜¨ë„ 15-30Â°C: high
  - ìŠµë„ > 80% & ì˜¨ë„ 15-30Â°C: very_high
```

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
const humidityService = new HumidityService();
humidityService.setTemperature(25); // ì˜¨ë„ ì„¤ì • (ì´ìŠ¬ì  ê³„ì‚°ìš©)

const dewPoint = humidityService.calculateDewPoint(25, 60); // 16.7Â°C
const category = humidityService.categorizeHumidity(55); // 'comfortable'
const comfort = humidityService.assessComfort(22, 50); // { level: 'ideal', reason: '...' }
const moldRisk = humidityService.assessMoldRisk(22, 75); // { risk: 'high', advice: '...' }
const absHumidity = humidityService.calculateAbsoluteHumidity(20, 60); // 10.4 g/mÂ³
```

**í™œìš© ì‚¬ë¡€**:
- ì‹¤ë‚´ ê³µê¸°ì§ˆ ëª¨ë‹ˆí„°ë§
- HVAC ì‹œìŠ¤í…œ ìµœì í™”
- ê³°íŒ¡ì´ ì˜ˆë°©
- ë†ì—… ì• í”Œë¦¬ì¼€ì´ì…˜
- ë°•ë¬¼ê´€/ì•„ì¹´ì´ë¸Œ ë³´ì¡´
- ì‚°ì—… ê³µì • ì œì–´

---

### ë°ì´í„°ë² ì´ìŠ¤ ì—…ë°ì´íŠ¸ (v6 â†’ v7)

**ìŠ¤í‚¤ë§ˆ ë²„ì „**: v7

**sensor_data í…Œì´ë¸”ì— ì¶”ê°€ëœ ì»¬ëŸ¼**:
```typescript
// Temperature data
{name: 'celsius', type: 'number', isOptional: true},
{name: 'fahrenheit', type: 'number', isOptional: true},
{name: 'kelvin', type: 'number', isOptional: true},

// Humidity data
{name: 'humidity', type: 'number', isOptional: true},
{name: 'dew_point', type: 'number', isOptional: true},
```

**SensorDataRecord ëª¨ë¸**: ìƒˆ í•„ë“œ ì¶”ê°€ ì™„ë£Œ
**SensorDataRepository**: create/createBatch ë©”ì„œë“œ ì—…ë°ì´íŠ¸ ì™„ë£Œ

---

**Phase 39-40 ì™„ë£Œ**: âœ… í™˜ê²½ ì„¼ì„œ 2ì¢… (ì˜¨ë„, ìŠµë„) êµ¬í˜„ ì™„ë£Œ
**ë°ì´í„°ë² ì´ìŠ¤ ë²„ì „**: v6 â†’ v7
**ë‹¤ìŒ ë‹¨ê³„**: Phase 41-42

**ì£¼ìš” ì„±ê³¼**:
- í™˜ê²½ ì„¼ì„œ í™•ì¥ (ì˜¨ë„, ìŠµë„)
- ê³ ê¸‰ í™˜ê²½ ë¶„ì„ ì•Œê³ ë¦¬ì¦˜:
  - ì²´ê°ì˜¨ë„ (ì—´ì§€ìˆ˜, í’í•œì§€ìˆ˜)
  - ì´ìŠ¬ì  ì˜¨ë„
  - ì¾Œì ë„ í‰ê°€
  - ê³°íŒ¡ì´ ìœ„í—˜ë„ í‰ê°€
- ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ v7 ì—…ê·¸ë ˆì´ë“œ ì™„ë£Œ
- ì„¼ì„œ ê°€ìš©ì„± ì²´í¬ íŒ¨í„´ ì§€ì† ì ìš©

**ê¸°ìˆ ì  íŠ¹ì§•**:
- ì˜¨ë„ì™€ ìŠµë„ ì„¼ì„œëŠ” ìŠ¤ë§ˆíŠ¸í°ì— ë§¤ìš° ë“œë¬¾
- ëŒ€ë¶€ë¶„ì˜ ê¸°ê¸°ëŠ” ì´ ì„¼ì„œë¥¼ ë³´ìœ í•˜ì§€ ì•ŠìŒ
- Android: TYPE_AMBIENT_TEMPERATURE, TYPE_RELATIVE_HUMIDITY (rare)
- iOS: ë„¤ì´í‹°ë¸Œ API ì—†ìŒ (Weather API ì‚¬ìš© ê¶Œì¥)
- ìŠ¤ë§ˆíŠ¸í™ˆ, HVAC, í™˜ê²½ ëª¨ë‹ˆí„°ë§ìš©ìœ¼ë¡œ ìœ ìš©
- ì™¸ë¶€ Bluetooth ì„¼ì„œ ì‚¬ìš© ê°€ëŠ¥

---

## Phase 41-42: Flask ë°±ì—”ë“œ - ë™ê¸°í™” API âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì‹œì‘ì¼**: 2025-11-13
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 2ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

#### Phase 41: ë™ê¸°í™” Push API
- [x] Flask ë°±ì—”ë“œ í”„ë¡œì íŠ¸ êµ¬ì¡° ìƒì„± (`/server/`)
- [x] SQLAlchemy ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ ì„¤ê³„
  - User (JWT ì¸ì¦)
  - RecordingSession (ì„¼ì„œ ê¸°ë¡ ì„¸ì…˜)
  - SensorData (JSONB ìœ ì—°í•œ ìŠ¤í‚¤ë§ˆ)
  - SyncLog (ë™ê¸°í™” ë¡œê·¸)
- [x] POST `/api/auth/register` - ì‚¬ìš©ì ë“±ë¡
- [x] POST `/api/auth/login` - JWT í† í° ë°œê¸‰
- [x] GET `/api/auth/me` - í˜„ì¬ ì‚¬ìš©ì ì •ë³´
- [x] POST `/api/sync/push` - ì„¼ì„œ ë°ì´í„° ì—…ë¡œë“œ
  - ì¤‘ë³µ ì²´í¬ (session_id + sensor_type + timestamp)
  - Last-Write-Wins ì¶©ëŒ í•´ê²°
  - ë°°ì¹˜ ì²˜ë¦¬ (bulk insert)
  - ë™ê¸°í™” ë¡œê·¸ ê¸°ë¡
- [x] GET `/api/sync/status` - ë™ê¸°í™” ìƒíƒœ ì¡°íšŒ

#### Phase 42: ë™ê¸°í™” Pull API
- [x] POST `/api/sync/pull` - ì„¼ì„œ ë°ì´í„° ë‹¤ìš´ë¡œë“œ
  - ë¸íƒ€ ë™ê¸°í™” (last_sync_time ê¸°ë°˜)
  - í˜ì´ì§€ë„¤ì´ì…˜ (ìµœëŒ€ 100ê°œ/í˜ì´ì§€)
  - ì„ íƒì  ë°ì´í„° í¬í•¨ (include_data)
  - íŠ¹ì • ì„¸ì…˜ í•„í„°ë§ (session_ids)
  - ì„œë²„ íƒ€ì„ìŠ¤íƒ¬í”„ ë°˜í™˜

### ì£¼ìš” êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

#### Push API (Phase 41)

**ì¤‘ë³µ ì²´í¬**:
- ë³µí•© ì¸ë±ìŠ¤: `(session_id, sensor_type, timestamp)`
- ë™ì¼í•œ í‚¤ë¥¼ ê°€ì§„ ë°ì´í„°ëŠ” ì—…ë°ì´íŠ¸ ì²˜ë¦¬

**Last-Write-Wins ì „ëµ**:
```python
if timestamp in existing_lookup:
    existing.data = sensor_data_dict  # ë®ì–´ì“°ê¸°
    updated_count += 1
else:
    new_records.append(SensorData(...))  # ìƒˆë¡œ ì‚½ì…
    inserted_count += 1
```

**ë°°ì¹˜ ì²˜ë¦¬**:
```python
db.session.bulk_save_objects(new_records)  # ì„±ëŠ¥ ìµœì í™”
```

**ë™ê¸°í™” ë¡œê·¸**:
```json
{
  "sync_type": "push",
  "records_count": 1000,
  "duplicates_count": 20,
  "status": "success",
  "metadata": {
    "inserted": 950,
    "updated": 30,
    "sensor_types": ["accelerometer", "gyroscope"],
    "total_size_bytes": 150000
  }
}
```

#### Pull API (Phase 42)

**ë¸íƒ€ ë™ê¸°í™”**:
```python
if last_sync_time:
    query = query.filter(RecordingSession.updated_at > last_sync_dt)
```

**í˜ì´ì§€ë„¤ì´ì…˜**:
```python
offset = (page - 1) * page_size
sessions = query.offset(offset).limit(page_size).all()
has_more = (offset + page_size) < total
```

**ì„ íƒì  ë°ì´í„° í¬í•¨**:
```python
if include_data:
    # ì„¼ì„œ ë°ì´í„° í¬í•¨ (ê¸°ë³¸ê°’)
    sensor_data = SensorData.query.filter_by(session_id=session.id).all()
else:
    # ë©”íƒ€ë°ì´í„°ë§Œ ë°˜í™˜ (ë„¤íŠ¸ì›Œí¬ ìµœì í™”)
    sensor_data = []
```

**ì„¸ì…˜ í•„í„°ë§**:
```python
if session_ids:
    query = query.filter(RecordingSession.session_id.in_(session_ids))
```

### ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸

**User í…Œì´ë¸”**:
- id (PK)
- username (unique)
- email (unique)
- password_hash (bcrypt)
- device_id (unique)
- created_at, updated_at

**RecordingSession í…Œì´ë¸”**:
- id (PK)
- user_id (FK)
- session_id (UUID, unique)
- start_time, end_time
- is_active, enabled_sensors (JSONB)
- sample_rate, data_count
- notes, is_uploaded
- last_synced_at, created_at, updated_at

**SensorData í…Œì´ë¸”**:
- id (PK)
- session_id (FK)
- sensor_type (indexed)
- timestamp (indexed)
- data (JSONB) - ìœ ì—°í•œ ì„¼ì„œ ë°ì´í„° ì €ì¥
- is_uploaded
- created_at, updated_at
- ë³µí•© ì¸ë±ìŠ¤: `(session_id, sensor_type, timestamp)`

**SyncLog í…Œì´ë¸”**:
- id (PK)
- user_id (FK)
- session_id (FK, nullable)
- sync_type ('push' | 'pull')
- status ('success' | 'failed')
- records_count, duplicates_count, errors_count
- error_message, metadata (JSONB)
- started_at, completed_at, created_at

### ê¸°ìˆ  ìŠ¤íƒ

**Backend**:
- Flask 3.0.0
- SQLAlchemy 2.0.23 (ORM)
- PostgreSQL (JSONB)
- Flask-JWT-Extended 4.5.3
- psycopg2-binary (PostgreSQL driver)
- bcrypt (íŒ¨ìŠ¤ì›Œë“œ í•´ì‹±)

**ê°œë°œ ë„êµ¬**:
- python-dotenv (í™˜ê²½ ë³€ìˆ˜)
- flask-cors (CORS ì§€ì›)
- gunicorn (í”„ë¡œë•ì…˜ ì„œë²„, ì˜ˆì •)

**í–¥í›„ ì¶”ê°€ ì˜ˆì •**:
- Celery (ë¹„ë™ê¸° ì‘ì—…)
- Redis (Celery ë¸Œë¡œì»¤)
- Pandas (ë°ì´í„° ë¶„ì„)
- Swagger (API ë¬¸ì„œ)
- pytest (í…ŒìŠ¤íŠ¸)

### API ì—”ë“œí¬ì¸íŠ¸

**ì¸ì¦ API**:
- POST `/api/auth/register` - ì‚¬ìš©ì ë“±ë¡
- POST `/api/auth/login` - ë¡œê·¸ì¸ (JWT í† í° ë°œê¸‰)
- POST `/api/auth/refresh` - í† í° ê°±ì‹ 
- GET `/api/auth/me` - í˜„ì¬ ì‚¬ìš©ì ì •ë³´ (JWT ì¸ì¦ í•„ìš”)

**ë™ê¸°í™” API**:
- POST `/api/sync/push` - í´ë¼ì´ì–¸íŠ¸ â†’ ì„œë²„ ë°ì´í„° ì „ì†¡ (Phase 41)
- POST `/api/sync/pull` - ì„œë²„ â†’ í´ë¼ì´ì–¸íŠ¸ ë¸íƒ€ ë™ê¸°í™” (Phase 42)
- GET `/api/sync/status` - ë™ê¸°í™” ìƒíƒœ ë° í†µê³„

**í—¬ìŠ¤ ì²´í¬**:
- GET `/health` - ì„œë²„ ìƒíƒœ í™•ì¸

### íŒŒì¼ êµ¬ì¡°

```
server/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py          # Flask ì•± íŒ©í† ë¦¬
â”‚   â”œâ”€â”€ config.py            # í™˜ê²½ë³„ ì„¤ì •
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ user.py          # User ëª¨ë¸
â”‚   â”‚   â”œâ”€â”€ session.py       # RecordingSession ëª¨ë¸
â”‚   â”‚   â”œâ”€â”€ sensor_data.py   # SensorData ëª¨ë¸
â”‚   â”‚   â””â”€â”€ sync_log.py      # SyncLog ëª¨ë¸
â”‚   â””â”€â”€ routes/
â”‚       â”œâ”€â”€ auth.py          # ì¸ì¦ API
â”‚       â””â”€â”€ sync.py          # ë™ê¸°í™” API (Phase 41-42)
â”œâ”€â”€ run.py                   # ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì 
â”œâ”€â”€ requirements.txt         # Python ì˜ì¡´ì„±
â”œâ”€â”€ .env.example             # í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿
â”œâ”€â”€ .gitignore              # Python/Flask gitignore
â””â”€â”€ README.md               # ë°±ì—”ë“œ ë¬¸ì„œ
```

### ì§„í–‰ ë¡œê·¸

**2025-11-13 ì˜¤ì „**:
- Flask ë°±ì—”ë“œ í”„ë¡œì íŠ¸ êµ¬ì¡° ìƒì„±
- SQLAlchemy ëª¨ë¸ ì„¤ê³„ (User, RecordingSession, SensorData, SyncLog)
- JWT ì¸ì¦ ì‹œìŠ¤í…œ êµ¬í˜„
- Phase 41: Push API ì™„ì „ êµ¬í˜„
  - ì¤‘ë³µ ì²´í¬ ë° Last-Write-Wins
  - ë°°ì¹˜ ì²˜ë¦¬ (bulk insert)
  - ë™ê¸°í™” ë¡œê·¸ ê¸°ë¡
  - ì—ëŸ¬ ì²˜ë¦¬ ë° íŠ¸ëœì­ì…˜ ë¡¤ë°±

**2025-11-13 ì˜¤í›„**:
- Phase 42: Pull API ì™„ì „ êµ¬í˜„
  - ë¸íƒ€ ë™ê¸°í™” (last_sync_time)
  - í˜ì´ì§€ë„¤ì´ì…˜ (page, page_size)
  - ì„ íƒì  ë°ì´í„° í¬í•¨ (include_data)
  - ì„¸ì…˜ í•„í„°ë§ (session_ids)
  - ì„œë²„ íƒ€ì„ìŠ¤íƒ¬í”„ ë°˜í™˜
- README.md ì—…ë°ì´íŠ¸ (API ë¬¸ì„œí™”)
- PROGRESS.md ì—…ë°ì´íŠ¸

### ì‚¬ìš© ì˜ˆì‹œ

#### Push API ì‚¬ìš© ì˜ˆì‹œ

```bash
# 1. ì‚¬ìš©ì ë“±ë¡
curl -X POST http://localhost:5000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "email": "test@example.com",
    "password": "password123",
    "device_id": "device-uuid-123"
  }'

# 2. ë¡œê·¸ì¸ (JWT í† í° íšë“)
curl -X POST http://localhost:5000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "password": "password123"
  }'

# 3. ì„¼ì„œ ë°ì´í„° Push
curl -X POST http://localhost:5000/api/sync/push \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <JWT_TOKEN>" \
  -d '{
    "session": {
      "session_id": "uuid-123",
      "start_time": "2025-11-13T00:00:00Z",
      "end_time": "2025-11-13T01:00:00Z",
      "enabled_sensors": ["accelerometer", "gyroscope"],
      "sample_rate": 100,
      "notes": "Morning workout"
    },
    "sensor_data": [
      {
        "sensor_type": "accelerometer",
        "timestamp": 1699876543210,
        "data": {"x": 0.1, "y": 0.2, "z": 9.8}
      }
    ]
  }'
```

#### Pull API ì‚¬ìš© ì˜ˆì‹œ

```bash
# 1. ì´ˆê¸° ë™ê¸°í™” (ëª¨ë“  ì„¸ì…˜)
curl -X POST http://localhost:5000/api/sync/pull \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <JWT_TOKEN>" \
  -d '{
    "page": 1,
    "page_size": 50,
    "include_data": true
  }'

# 2. ë¸íƒ€ ë™ê¸°í™” (ë³€ê²½ì‚¬í•­ë§Œ)
curl -X POST http://localhost:5000/api/sync/pull \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <JWT_TOKEN>" \
  -d '{
    "last_sync_time": "2025-11-13T10:00:00Z",
    "page": 1,
    "page_size": 50,
    "include_data": true
  }'

# 3. ë©”íƒ€ë°ì´í„°ë§Œ ì¡°íšŒ (ë„¤íŠ¸ì›Œí¬ ìµœì í™”)
curl -X POST http://localhost:5000/api/sync/pull \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <JWT_TOKEN>" \
  -d '{
    "last_sync_time": "2025-11-13T10:00:00Z",
    "page": 1,
    "page_size": 50,
    "include_data": false
  }'

# 4. íŠ¹ì • ì„¸ì…˜ë§Œ ì¡°íšŒ
curl -X POST http://localhost:5000/api/sync/pull \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <JWT_TOKEN>" \
  -d '{
    "session_ids": ["uuid-123", "uuid-456"],
    "include_data": true
  }'
```

### ë°°ìš´ ì 

**SQLAlchemy íŒ¨í„´**:
- Factory íŒ¨í„´ìœ¼ë¡œ ì•± ìƒì„± (`create_app()`)
- Blueprintë¡œ ë¼ìš°íŠ¸ ëª¨ë“ˆí™”
- JSONB íƒ€ì…ìœ¼ë¡œ ìœ ì—°í•œ ì„¼ì„œ ë°ì´í„° ì €ì¥
- ë³µí•© ì¸ë±ìŠ¤ë¡œ ì¤‘ë³µ ì²´í¬ ì„±ëŠ¥ ìµœì í™”

**ë™ê¸°í™” ì „ëµ**:
- Last-Write-Winsë¡œ ì¶©ëŒ ê°„ë‹¨íˆ í•´ê²°
- ë¸íƒ€ ë™ê¸°í™”ë¡œ ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­ ì ˆì•½
- í˜ì´ì§€ë„¤ì´ì…˜ìœ¼ë¡œ ëŒ€ëŸ‰ ë°ì´í„° ì²˜ë¦¬
- ì„ íƒì  ë°ì´í„° í¬í•¨ìœ¼ë¡œ ìœ ì—°ì„± ì œê³µ

**ì—ëŸ¬ ì²˜ë¦¬**:
- íŠ¸ëœì­ì…˜ ë¡¤ë°±ìœ¼ë¡œ ë°ì´í„° ì¼ê´€ì„± ë³´ì¥
- ë™ê¸°í™” ë¡œê·¸ë¡œ ë¬¸ì œ ì¶”ì 
- ì„¸ë¶€ ì—ëŸ¬ ë©”ì‹œì§€ ë°˜í™˜

**ë³´ì•ˆ**:
- JWT ì¸ì¦ìœ¼ë¡œ API ë³´í˜¸
- bcryptë¡œ íŒ¨ìŠ¤ì›Œë“œ í•´ì‹±
- CORS ì„¤ì • ì¤€ë¹„
- SQL Injection ë°©ì§€ (SQLAlchemy ORM)

### ë‹¤ìŒ ë‹¨ê³„

- [ ] Phase 43: Celery ì„¤ì¹˜ ë° Redis ë¸Œë¡œì»¤ ì„¤ì •
- [ ] Phase 44: ì„¼ì„œ ë°ì´í„° ì²˜ë¦¬ ì‘ì—… (Pandas, í†µê³„ ë¶„ì„)
- [ ] Phase 45: íŒŒì¼ ì •ë¦¬ ì‘ì—… (Celery Beat ìŠ¤ì¼€ì¤„ë§)
- [ ] Phase 46: Swagger/OpenAPI ë¬¸ì„œ ìë™ ìƒì„±
- [ ] Phase 47: pytest ì„¤ì¹˜ ë° ê¸°ë³¸ ì„¤ì •
- [ ] Phase 48: Auth ë° Sync API í…ŒìŠ¤íŠ¸ ì‘ì„±
- [ ] Phase 49: Gunicorn í”„ë¡œë•ì…˜ ì„œë²„ ì„¤ì •
- [ ] Phase 50: Supervisor í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬ ì„¤ì •

---

**Phase 41-42 ì™„ë£Œ**: âœ… Flask ë°±ì—”ë“œ ë™ê¸°í™” API êµ¬í˜„ ì™„ë£Œ
**ë°ì´í„°ë² ì´ìŠ¤**: PostgreSQL + SQLAlchemy ORM
**ë‹¤ìŒ ë‹¨ê³„**: Phase 43-45 (Celery ë¹„ë™ê¸° ì‘ì—…)

**ì£¼ìš” ì„±ê³¼**:
- Flask ë°±ì—”ë“œ í”„ë¡œì íŠ¸ êµ¬ì¡° ì™„ì„±
- JWT ì¸ì¦ ì‹œìŠ¤í…œ êµ¬í˜„
- Push/Pull ë™ê¸°í™” API ì™„ì „ êµ¬í˜„
- Last-Write-Wins ì¶©ëŒ í•´ê²° ì „ëµ
- ë¸íƒ€ ë™ê¸°í™” ë° í˜ì´ì§€ë„¤ì´ì…˜
- ë™ê¸°í™” ë¡œê·¸ ë° ì—ëŸ¬ ì²˜ë¦¬
- JSONBë¡œ ìœ ì—°í•œ ì„¼ì„œ ë°ì´í„° ìŠ¤í‚¤ë§ˆ

**ê¸°ìˆ ì  íŠ¹ì§•**:
- Factory íŒ¨í„´ (Flask ì•± ìƒì„±)
- Blueprint ëª¨ë“ˆí™” (auth, sync)
- SQLAlchemy ORM (PostgreSQL)
- JWT í† í° ê¸°ë°˜ ì¸ì¦
- JSONB ìœ ì—°í•œ ìŠ¤í‚¤ë§ˆ
- ë°°ì¹˜ ì²˜ë¦¬ (bulk_save_objects)
- íŠ¸ëœì­ì…˜ ê´€ë¦¬ ë° ë¡¤ë°±
- ë³µí•© ì¸ë±ìŠ¤ ì„±ëŠ¥ ìµœì í™”

---

## Phase 43-45: Flask ë°±ì—”ë“œ - Celery ë¹„ë™ê¸° ì‘ì—… ì‹œìŠ¤í…œ âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì‹œì‘ì¼**: 2025-11-13
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 2ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

#### Phase 43: Celery ì„¤ì¹˜ ë° Redis ë¸Œë¡œì»¤ ì„¤ì •
- [x] Celery íŒ¨í‚¤ì§€ ì¶”ê°€ (requirements.txtì— ì´ë¯¸ í¬í•¨)
- [x] Redis ë¸Œë¡œì»¤ ì„¤ì •
- [x] Celery ì•± ì´ˆê¸°í™” (`celery_app.py`)
- [x] Flask ì•±ê³¼ Celery í†µí•© ì„¤ì •
- [x] Celery Worker ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
- [x] Celery Beat ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ (ìŠ¤ì¼€ì¤„ëŸ¬)
- [x] Beat ìŠ¤ì¼€ì¤„ ì„¤ì • (ì£¼ê¸°ì  ì‘ì—…)

#### Phase 44: ì„¼ì„œ ë°ì´í„° ì²˜ë¦¬ ì‘ì—…
- [x] `app/tasks/data_processing.py` ì‘ì—… ëª¨ë“ˆ
- [x] analyze_sensor_data() - ì„¼ì„œ ë°ì´í„° í†µê³„ ë¶„ì„
- [x] generate_statistics() - ì‚¬ìš©ìë³„ í†µê³„ ìƒì„±
- [x] detect_anomalies() - Z-score ê¸°ë°˜ ì´ìƒì¹˜ íƒì§€
- [x] calculate_session_metrics() - ì„¸ì…˜ ë©”íŠ¸ë¦­ ê³„ì‚°
- [x] Pandasë¥¼ ì´ìš©í•œ ë°ì´í„° ë¶„ì„
- [x] GPS ì´ë™ ê±°ë¦¬ ê³„ì‚° (Haversine formula)

#### Phase 45: íŒŒì¼ ì •ë¦¬ ì‘ì—…
- [x] `app/tasks/file_cleanup.py` ì‘ì—… ëª¨ë“ˆ
- [x] cleanup_old_sensor_data() - ì˜¤ë˜ëœ ì„¼ì„œ ë°ì´í„° ì •ë¦¬
- [x] cleanup_old_sync_logs() - ë™ê¸°í™” ë¡œê·¸ ì •ë¦¬
- [x] cleanup_uploaded_files() - ì—…ë¡œë“œ íŒŒì¼ ì •ë¦¬
- [x] cleanup_failed_sessions() - ì‹¤íŒ¨/ì¤‘ë‹¨ ì„¸ì…˜ ì •ë¦¬
- [x] optimize_database() - ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”
- [x] generate_cleanup_report() - ì •ë¦¬ ë¦¬í¬íŠ¸ ìƒì„±
- [x] Celery Beat ìŠ¤ì¼€ì¤„ ì„¤ì • (ìë™ ì‹¤í–‰)

### ì£¼ìš” êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

#### Phase 43: Celery ì„¤ì •

**Celery ì•± êµ¬ì¡°**:
```python
# celery_app.py
celery = Celery(
    'koodtx',
    broker='redis://localhost:6379/0',
    backend='redis://localhost:6379/0',
    include=['app.tasks.data_processing', 'app.tasks.file_cleanup']
)
```

**Celery ì„¤ì •**:
- **ì‘ì—… íƒ€ì„ì•„ì›ƒ**: 5ë¶„ (í•˜ë“œ), 4ë¶„ (ì†Œí”„íŠ¸)
- **ì§ë ¬í™”**: JSON
- **Worker prefetch**: 1 (í•œ ë²ˆì— í•˜ë‚˜ì”© ì²˜ë¦¬)
- **Worker ì¬ì‹œì‘**: 1000ê°œ ì‘ì—…ë§ˆë‹¤
- **Result ë§Œë£Œ**: 1ì‹œê°„

**Beat ìŠ¤ì¼€ì¤„**:
```python
beat_schedule = {
    'cleanup-old-data': {
        'task': 'app.tasks.file_cleanup.cleanup_old_sensor_data',
        'schedule': 3600.0 * 24,  # ë§¤ì¼
        'args': (30,)  # 30ì¼ ì´ìƒ ëœ ë°ì´í„°
    },
    'cleanup-sync-logs': {
        'task': 'app.tasks.file_cleanup.cleanup_old_sync_logs',
        'schedule': 3600.0 * 24 * 7,  # ë§¤ì£¼
        'args': (90,)  # 90ì¼ ì´ìƒ ëœ ë¡œê·¸
    },
}
```

**Worker ì‹¤í–‰**:
```bash
# start_celery_worker.sh
celery -A celery_app.celery worker \
    --loglevel=info \
    --concurrency=4 \
    --pool=prefork
```

**Beat ì‹¤í–‰**:
```bash
# start_celery_beat.sh
celery -A celery_app.celery beat \
    --loglevel=info \
    --schedule=logs/celerybeat-schedule
```

#### Phase 44: ë°ì´í„° ì²˜ë¦¬ ì‘ì—…

**1. analyze_sensor_data(session_id)**
ì„¼ì„œ ë°ì´í„° í†µê³„ ë¶„ì„:
```python
{
    'session_id': 123,
    'total_records': 5000,
    'sensor_types': ['accelerometer', 'gyroscope', 'gps'],
    'analysis': {
        'accelerometer': {
            'count': 2000,
            'duration_ms': 20000,
            'statistics': {
                'x': {'mean': 0.1, 'std': 0.5, 'min': -2.0, 'max': 2.0},
                'y': {'mean': 0.2, 'std': 0.6, 'min': -1.8, 'max': 1.9},
                'z': {'mean': 9.8, 'std': 0.3, 'min': 9.2, 'max': 10.4}
            }
        },
        'gps': {
            'count': 500,
            'statistics': {
                'latitude': {'mean': 37.5, 'min': 37.4, 'max': 37.6},
                'longitude': {'mean': 127.0, 'min': 126.9, 'max': 127.1},
                'distance_km': 5.2  # Haversine formula
            }
        }
    }
}
```

**2. generate_statistics(user_id, start_date, end_date)**
ì‚¬ìš©ìë³„ í†µê³„ ìƒì„±:
```python
{
    'user_id': 1,
    'statistics': {
        'total_sessions': 50,
        'total_data_records': 250000,
        'total_duration_hours': 10.5,
        'average_session_duration_ms': 756000,
        'sensor_types_usage': {
            'accelerometer': 45,
            'gyroscope': 45,
            'gps': 30,
            'magnetometer': 25
        }
    }
}
```

**3. detect_anomalies(session_id, sensitivity=3.0)**
Z-score ê¸°ë°˜ ì´ìƒì¹˜ íƒì§€:
- 3ì¶• ì„¼ì„œì˜ magnitude ê³„ì‚°
- Z-score > 3.0 (ê¸°ë³¸ê°’)ì¸ ë°ì´í„° í¬ì¸íŠ¸ ê°ì§€
- ì´ìƒì¹˜ íƒ€ì„ìŠ¤íƒ¬í”„ ë° í†µê³„ ë°˜í™˜

```python
{
    'session_id': 123,
    'sensitivity': 3.0,
    'anomalies': {
        'accelerometer': {
            'count': 15,
            'percentage': 0.75,
            'mean': 9.82,
            'std': 0.5,
            'max_z_score': 5.2,
            'timestamps': [1699876543210, ...]
        }
    },
    'total_anomalies': 15
}
```

**4. calculate_session_metrics(session_id)**
ì„¸ì…˜ ì£¼ìš” ë©”íŠ¸ë¦­ ê³„ì‚°:
- ê° ì¶•ë³„ í†µê³„ (mean, std, min, max, peak-to-peak)
- ìƒ˜í”Œ ì¹´ìš´íŠ¸
- ë°ì´í„° í’ˆì§ˆ ì§€í‘œ

**GPS ì´ë™ ê±°ë¦¬ ê³„ì‚° (Haversine Formula)**:
```python
def _calculate_total_distance(latitudes, longitudes):
    """ì§€êµ¬ í‘œë©´ìƒì˜ ë‘ ì§€ì  ê°„ ê±°ë¦¬ ê³„ì‚°"""
    R = 6371.0  # ì§€êµ¬ ë°˜ì§€ë¦„ (km)
    
    total_distance = 0.0
    for i in range(1, len(latitudes)):
        lat1, lon1 = np.radians(latitudes[i-1]), np.radians(longitudes[i-1])
        lat2, lon2 = np.radians(latitudes[i]), np.radians(longitudes[i])
        
        dlat = lat2 - lat1
        dlon = lon2 - lon1
        
        a = sin(dlat/2)Â² + cos(lat1) * cos(lat2) * sin(dlon/2)Â²
        c = 2 * arctan2(âˆša, âˆš(1-a))
        
        total_distance += R * c
    
    return total_distance
```

#### Phase 45: íŒŒì¼ ì •ë¦¬ ì‘ì—…

**1. cleanup_old_sensor_data(days=30)**
ì˜¤ë˜ëœ ì„¼ì„œ ë°ì´í„° ìë™ ì •ë¦¬:
- ì—…ë¡œë“œ ì™„ë£Œë˜ê³  ì¢…ë£Œëœ ì„¸ì…˜ì˜ ì„¼ì„œ ë°ì´í„° ì‚­ì œ
- ì„¸ì…˜ ë©”íƒ€ë°ì´í„°ëŠ” ìœ ì§€ (ë¶„ì„ìš©)
- ê¸°ë³¸ê°’: 30ì¼ ì´ìƒ

```python
# ë§¤ì¼ ìë™ ì‹¤í–‰ (Celery Beat)
{
    'message': 'Successfully cleaned up old sensor data',
    'cutoff_date': '2025-10-14T00:00:00Z',
    'cleaned_sessions': 25,
    'cleaned_records': 125000
}
```

**2. cleanup_old_sync_logs(days=90)**
ë™ê¸°í™” ë¡œê·¸ ì •ë¦¬:
- ì˜¤ë˜ëœ ë¡œê·¸ ì‚­ì œ
- ê¸°ë³¸ê°’: 90ì¼ ì´ìƒ

**3. cleanup_uploaded_files(days=7)**
ì„ì‹œ ì—…ë¡œë“œ íŒŒì¼ ì •ë¦¬:
- ì²˜ë¦¬ ì™„ë£Œëœ íŒŒì¼ ìë™ ì‚­ì œ
- ë””ìŠ¤í¬ ê³µê°„ í™•ë³´

```python
{
    'message': 'Successfully cleaned up old uploaded files',
    'cleaned_files': 150,
    'total_size_mb': 250.5
}
```

**4. cleanup_failed_sessions(hours=24)**
ì‹¤íŒ¨/ì¤‘ë‹¨ ì„¸ì…˜ ì •ë¦¬:
- `is_active=True` ìƒíƒœë¡œ 24ì‹œê°„ ì´ìƒ ë°©ì¹˜ëœ ì„¸ì…˜
- ìë™ ì¢…ë£Œ ì²˜ë¦¬
- ë…¸íŠ¸ì— `[Auto-closed: stale session]` ì¶”ê°€

**5. optimize_database()**
PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”:
- í…Œì´ë¸”ë³„ í†µê³„ ìˆ˜ì§‘
- ì¸ë±ìŠ¤ ìµœì í™” ì¤€ë¹„

**6. generate_cleanup_report()**
ì‹œìŠ¤í…œ ì „ì²´ í†µê³„ ë¦¬í¬íŠ¸:
```python
{
    'report': {
        'total': {
            'sessions': 1000,
            'active_sessions': 5,
            'sensor_records': 5000000,
            'sync_logs': 2500
        },
        'recent_30_days': {
            'sessions': 250,
            'syncs': 500
        },
        'disk_usage': {
            'upload_folder': './uploads',
            'size_mb': 512.0
        }
    }
}
```

### Celery ì‘ì—… ì‚¬ìš© ì˜ˆì‹œ

#### ë¹„ë™ê¸° ì‘ì—… ì˜ˆì•½
```python
from app.tasks.data_processing import analyze_sensor_data

# ì¦‰ì‹œ ì‹¤í–‰
result = analyze_sensor_data.delay(session_id=123)

# ê²°ê³¼ í™•ì¸
if result.ready():
    analysis = result.get()
    print(analysis)
else:
    print("ì‘ì—… ì§„í–‰ ì¤‘...")

# ì‘ì—… ì·¨ì†Œ
result.revoke()
```

#### ì§€ì—° ì‹¤í–‰
```python
from app.tasks.file_cleanup import cleanup_old_sensor_data

# 10ë¶„ í›„ ì‹¤í–‰
result = cleanup_old_sensor_data.apply_async(
    args=[30],
    countdown=600  # ì´ˆ
)

# íŠ¹ì • ì‹œê°„ì— ì‹¤í–‰
from datetime import datetime, timedelta
eta = datetime.utcnow() + timedelta(hours=1)
result = cleanup_old_sensor_data.apply_async(
    args=[30],
    eta=eta
)
```

#### ì‘ì—… ì²´ì´ë‹
```python
from celery import chain

# ìˆœì°¨ ì‹¤í–‰
workflow = chain(
    analyze_sensor_data.s(session_id=123),
    calculate_session_metrics.s(),
)
result = workflow.apply_async()
```

#### ì‘ì—… ê·¸ë£¹
```python
from celery import group

# ë³‘ë ¬ ì‹¤í–‰
job = group(
    analyze_sensor_data.s(session_id=1),
    analyze_sensor_data.s(session_id=2),
    analyze_sensor_data.s(session_id=3),
)
result = job.apply_async()
```

### íŒŒì¼ êµ¬ì¡°

```
server/
â”œâ”€â”€ celery_app.py              # Celery ì•± ì´ˆê¸°í™”
â”œâ”€â”€ start_celery_worker.sh     # Worker ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ start_celery_beat.sh       # Beat ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ app/
â”‚   â””â”€â”€ tasks/
â”‚       â”œâ”€â”€ __init__.py        # Tasks ëª¨ë“ˆ
â”‚       â”œâ”€â”€ data_processing.py # Phase 44: ë°ì´í„° ì²˜ë¦¬ ì‘ì—…
â”‚       â””â”€â”€ file_cleanup.py    # Phase 45: íŒŒì¼ ì •ë¦¬ ì‘ì—…
â””â”€â”€ logs/
    â”œâ”€â”€ celery_worker.log      # Worker ë¡œê·¸
    â”œâ”€â”€ celery_beat.log        # Beat ë¡œê·¸
    â””â”€â”€ celerybeat-schedule    # Beat ìŠ¤ì¼€ì¤„ DB
```

### ì§„í–‰ ë¡œê·¸

**2025-11-13 ì˜¤í›„**:
- Celery ì•± ì´ˆê¸°í™” ë° ì„¤ì •
- Redis ë¸Œë¡œì»¤ ì—°ê²° ì„¤ì •
- Flask ì•± ì»¨í…ìŠ¤íŠ¸ í†µí•©
- Worker ë° Beat ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±

- Phase 44: ë°ì´í„° ì²˜ë¦¬ ì‘ì—… êµ¬í˜„
  - ì„¼ì„œ ë°ì´í„° í†µê³„ ë¶„ì„
  - ì‚¬ìš©ìë³„ í†µê³„ ìƒì„±
  - Z-score ì´ìƒì¹˜ íƒì§€
  - GPS ì´ë™ ê±°ë¦¬ ê³„ì‚° (Haversine)
  - ì„¸ì…˜ ë©”íŠ¸ë¦­ ê³„ì‚°

- Phase 45: íŒŒì¼ ì •ë¦¬ ì‘ì—… êµ¬í˜„
  - ì˜¤ë˜ëœ ì„¼ì„œ ë°ì´í„° ì •ë¦¬
  - ë™ê¸°í™” ë¡œê·¸ ì •ë¦¬
  - ì—…ë¡œë“œ íŒŒì¼ ì •ë¦¬
  - ì‹¤íŒ¨/ì¤‘ë‹¨ ì„¸ì…˜ ì •ë¦¬
  - ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”
  - ì •ë¦¬ ë¦¬í¬íŠ¸ ìƒì„±

- Celery Beat ìŠ¤ì¼€ì¤„ ì„¤ì •
  - ë§¤ì¼ ìë™ ë°ì´í„° ì •ë¦¬
  - ë§¤ì£¼ ë¡œê·¸ ì •ë¦¬

- README ì—…ë°ì´íŠ¸ (Phase 43-45 ë¬¸ì„œí™”)

### ë°°ìš´ ì 

**Celery ì•„í‚¤í…ì²˜**:
- **Broker (Redis)**: ì‘ì—… í ë©”ì‹œì§€ ì „ë‹¬
- **Worker**: ì‘ì—… ì‹¤í–‰ í”„ë¡œì„¸ìŠ¤
- **Beat**: ì£¼ê¸°ì  ì‘ì—… ìŠ¤ì¼€ì¤„ëŸ¬
- **Backend (Redis)**: ì‘ì—… ê²°ê³¼ ì €ì¥

**ë¹„ë™ê¸° ì‘ì—… íŒ¨í„´**:
- `.delay()`: ê°„ë‹¨í•œ ë¹„ë™ê¸° í˜¸ì¶œ
- `.apply_async()`: ê³ ê¸‰ ì˜µì…˜ (countdown, eta, retry)
- `chain()`: ìˆœì°¨ ì‹¤í–‰
- `group()`: ë³‘ë ¬ ì‹¤í–‰
- `chord()`: ë³‘ë ¬ ì‹¤í–‰ í›„ ì½œë°±

**Pandas ë°ì´í„° ë¶„ì„**:
- DataFrameì„ ì´ìš©í•œ ì„¼ì„œ ë°ì´í„° ì²˜ë¦¬
- NumPy ë°°ì—´ ì—°ì‚°ìœ¼ë¡œ ì„±ëŠ¥ ìµœì í™”
- ë²¡í„°í™”ëœ ê³„ì‚° (mean, std, min, max)

**Z-score ì´ìƒì¹˜ íƒì§€**:
```
Z = (X - Î¼) / Ïƒ
|Z| > 3.0 â†’ ì´ìƒì¹˜
```

**Celery Beat ìŠ¤ì¼€ì¤„ë§**:
- Cron-like ì£¼ê¸°ì  ì‘ì—… ì‹¤í–‰
- schedule íŒŒì¼ë¡œ ìƒíƒœ ì €ì¥
- ì„œë²„ ì¬ì‹œì‘ ì‹œì—ë„ ìŠ¤ì¼€ì¤„ ìœ ì§€

**Flask ì•± ì»¨í…ìŠ¤íŠ¸**:
- Celery ì‘ì—… ë‚´ì—ì„œ Flask ì•± ì»¨í…ìŠ¤íŠ¸ ì ‘ê·¼
- `with app.app_context()` íŒ¨í„´
- ë°ì´í„°ë² ì´ìŠ¤ ì„¸ì…˜ ê´€ë¦¬

### ë‹¤ìŒ ë‹¨ê³„

- [ ] Phase 46: Swagger/OpenAPI ë¬¸ì„œ ìë™ ìƒì„±
- [ ] Phase 47: pytest ì„¤ì¹˜ ë° ê¸°ë³¸ ì„¤ì •
- [ ] Phase 48: Auth ë° Sync API í…ŒìŠ¤íŠ¸ ì‘ì„±
- [ ] Phase 49: Gunicorn í”„ë¡œë•ì…˜ ì„œë²„ ì„¤ì •
- [ ] Phase 50: Supervisor í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬ ì„¤ì •

---

**Phase 43-45 ì™„ë£Œ**: âœ… Celery ë¹„ë™ê¸° ì‘ì—… ì‹œìŠ¤í…œ êµ¬í˜„ ì™„ë£Œ
**ê¸°ìˆ  ìŠ¤íƒ**: Celery 5.3.4 + Redis 5.0.1 + Pandas 2.1.3
**ë‹¤ìŒ ë‹¨ê³„**: Phase 46-48 (API ë¬¸ì„œ ë° í…ŒìŠ¤íŠ¸)

**ì£¼ìš” ì„±ê³¼**:
- Celery ë¹„ë™ê¸° ì‘ì—… í ì‹œìŠ¤í…œ êµ¬ì¶•
- Redis ë©”ì‹œì§€ ë¸Œë¡œì»¤ ì—°ë™
- ì„¼ì„œ ë°ì´í„° ë¶„ì„ ì‘ì—… êµ¬í˜„ (Pandas, NumPy)
- GPS ì´ë™ ê±°ë¦¬ ê³„ì‚° (Haversine formula)
- Z-score ì´ìƒì¹˜ íƒì§€ ì•Œê³ ë¦¬ì¦˜
- ìë™ íŒŒì¼ ì •ë¦¬ ì‹œìŠ¤í…œ (Celery Beat)
- ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™” ì‘ì—…
- Worker ë° Beat ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸

**ê¸°ìˆ ì  íŠ¹ì§•**:
- Celery + Redis ë¹„ë™ê¸° ì•„í‚¤í…ì²˜
- Flask ì•± ì»¨í…ìŠ¤íŠ¸ í†µí•©
- Pandas/NumPy ë°ì´í„° ë¶„ì„
- Z-score í†µê³„ì  ì´ìƒì¹˜ íƒì§€
- Haversine ê±°ë¦¬ ê³„ì‚° ì•Œê³ ë¦¬ì¦˜
- Celery Beat ì£¼ê¸°ì  ì‘ì—… ìŠ¤ì¼€ì¤„ë§
- ì‘ì—… ì²´ì´ë‹ ë° ê·¸ë£¹í™”
- ì‘ì—… íƒ€ì„ì•„ì›ƒ ë° ì¬ì‹œë„ ì„¤ì •
- Worker prefetch multiplier ìµœì í™”

---

## Phase 46-47: Swagger API ë¬¸ì„œí™” ë° pytest í…ŒìŠ¤íŠ¸ ì„¤ì • âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì‹œì‘ì¼**: 2025-11-13
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 1.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

#### Phase 46: Swagger/OpenAPI ë¬¸ì„œ ìë™ ìƒì„±
- [x] flask-restx í†µí•©
- [x] Swagger API ì´ˆê¸°í™” (`app/swagger/__init__.py`)
- [x] API ëª¨ë¸ ì •ì˜ (`app/swagger/models.py`)
- [x] Swagger ë¬¸ì„œí™”ëœ ë¼ìš°íŠ¸ (`app/routes/swagger_routes.py`)
- [x] Auth API ë¬¸ì„œí™” (register, login, refresh, me)
- [x] Sync API ë¬¸ì„œí™” (push, pull, status)
- [x] JWT ì¸ì¦ ì„¤ì •
- [x] Swagger UI í™œì„±í™” (`/docs/`)

#### Phase 47: pytest ì„¤ì¹˜ ë° ê¸°ë³¸ ì„¤ì •
- [x] pytest.ini ì„¤ì • íŒŒì¼
- [x] conftest.py í”½ìŠ¤ì²˜ ì •ì˜
- [x] tests/ ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±
- [x] test_app.py - ê¸°ë³¸ ì•± í…ŒìŠ¤íŠ¸
- [x] test_models.py - ëª¨ë¸ í…ŒìŠ¤íŠ¸
- [x] Coverage ì„¤ì • (pytest-cov)
- [x] í…ŒìŠ¤íŠ¸ ë§ˆì»¤ ì •ì˜
- [x] í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ (user, session, sensor_data ë“±)

### ì£¼ìš” êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

#### Phase 46: Swagger/OpenAPI ë¬¸ì„œ

**Swagger API ì´ˆê¸°í™”**:
```python
# app/swagger/__init__.py
api = Api(
    version='1.0.0',
    title='KooDTX Backend API',
    description='ì„¼ì„œ ë°ì´í„° ë™ê¸°í™” ì„œë²„ API',
    doc='/docs/',
    authorizations={
        'Bearer': {
            'type': 'apiKey',
            'in': 'header',
            'name': 'Authorization'
        }
    },
    security='Bearer'
)
```

**API ëª¨ë¸ ì •ì˜**:
```python
# app/swagger/models.py
auth_register = api.model('AuthRegister', {
    'username': fields.String(required=True),
    'email': fields.String(required=True),
    'password': fields.String(required=True),
    'device_id': fields.String(required=True)
})

sync_push_request = api.model('SyncPushRequest', {
    'session': fields.Nested(recording_session),
    'sensor_data': fields.List(fields.Nested(sensor_data_item))
})
```

**Swagger ë„¤ì„ìŠ¤í˜ì´ìŠ¤**:
```python
# app/routes/swagger_routes.py
auth_ns = Namespace('auth', description='ì¸ì¦ API')
sync_ns = Namespace('sync', description='ë™ê¸°í™” API')

@auth_ns.route('/register')
class AuthRegister(Resource):
    @auth_ns.doc('register_user', security=None)
    @auth_ns.expect(auth_register)
    @auth_ns.response(201, 'Success', auth_response)
    def post(self):
        """ì‚¬ìš©ì ë“±ë¡"""
        ...
```

**Swagger UI ì ‘ê·¼**:
- URL: `http://localhost:5000/docs/`
- ì¸í„°ë™í‹°ë¸Œ API íƒìƒ‰ê¸°
- Try it out ê¸°ëŠ¥ìœ¼ë¡œ ì§ì ‘ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- JWT ì¸ì¦ ì§€ì› (Authorize ë²„íŠ¼)

**ë¬¸ì„œí™”ëœ ëª¨ë¸**:
1. **Auth Models**:
   - AuthRegister, AuthLogin, AuthRefresh
   - AuthResponse (í† í° + ì‚¬ìš©ì ì •ë³´)

2. **Sync Models**:
   - SyncPushRequest, SyncPushResponse
   - SyncPullRequest, SyncPullResponse
   - SensorDataItem, RecordingSession
   - SyncStatusResponse

3. **Error Models**:
   - ErrorResponse (ì—ëŸ¬ ë©”ì‹œì§€ + ìƒì„¸)

4. **Task Models** (Celery):
   - TaskResult, AnalyzeRequest
   - StatisticsRequest, AnomalyRequest
   - CleanupRequest

#### Phase 47: pytest í…ŒìŠ¤íŠ¸ ì„¤ì •

**pytest.ini ì„¤ì •**:
```ini
[pytest]
pythonpath = .
testpaths = tests

addopts =
    -v
    --strict-markers
    --cov=app
    --cov-report=term-missing
    --cov-report=html
    --maxfail=1

markers =
    unit: Unit tests (fast, no external dependencies)
    integration: Integration tests (database, external services)
    slow: Slow tests (> 1 second)
    api: API endpoint tests
    auth: Authentication tests
    sync: Sync API tests
    celery: Celery task tests
    smoke: Smoke tests (critical functionality)
```

**í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ (conftest.py)**:

1. **Application Fixtures**:
```python
@pytest.fixture(scope='session')
def app():
    """Flask ì•± ì¸ìŠ¤í„´ìŠ¤"""
    app = create_app(TestingConfig)
    return app

@pytest.fixture(scope='session')
def client(app):
    """í…ŒìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸"""
    return app.test_client()
```

2. **Database Fixtures**:
```python
@pytest.fixture(scope='session')
def db(app):
    """ë°ì´í„°ë² ì´ìŠ¤ (SQLite in-memory)"""
    _db.create_all()
    yield _db
    _db.drop_all()

@pytest.fixture(scope='function')
def session(db):
    """íŠ¸ëœì­ì…˜ ë¡¤ë°± ì„¸ì…˜"""
    ...
```

3. **User Fixtures**:
```python
@pytest.fixture
def user(session):
    """í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì"""
    user = User(username='testuser', ...)
    user.set_password('password123')
    return user

@pytest.fixture
def auth_headers(user):
    """JWT ì¸ì¦ í—¤ë”"""
    token = create_access_token(identity=user.id)
    return {'Authorization': f'Bearer {token}'}
```

4. **Session Fixtures**:
```python
@pytest.fixture
def recording_session(session, user):
    """ì„¼ì„œ ê¸°ë¡ ì„¸ì…˜"""
    ...

@pytest.fixture
def completed_session(session, user):
    """ì™„ë£Œëœ ì„¸ì…˜"""
    ...
```

5. **Sensor Data Fixtures**:
```python
@pytest.fixture
def sensor_data_batch(session, recording_session):
    """ì„¼ì„œ ë°ì´í„° 100ê°œ"""
    ...

@pytest.fixture
def gps_sensor_data(session, recording_session):
    """GPS ì„¼ì„œ ë°ì´í„°"""
    ...
```

6. **Helper Functions**:
```python
@pytest.fixture
def create_user_func(session):
    """ì‚¬ìš©ì ìƒì„± í—¬í¼ í•¨ìˆ˜"""
    def _create_user(username=None, email=None):
        ...
    return _create_user
```

**ê¸°ë³¸ í…ŒìŠ¤íŠ¸ íŒŒì¼**:

**test_app.py** - ì•± ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸:
```python
@pytest.mark.unit
def test_health_endpoint(client):
    """í—¬ìŠ¤ ì²´í¬ í…ŒìŠ¤íŠ¸"""
    response = client.get('/health')
    assert response.status_code == 200

@pytest.mark.smoke
def test_swagger_ui_accessible(client):
    """Swagger UI ì ‘ê·¼ í…ŒìŠ¤íŠ¸"""
    response = client.get('/docs/')
    assert response.status_code in [200, 308, 301]
```

**test_models.py** - ëª¨ë¸ í…ŒìŠ¤íŠ¸:
```python
@pytest.mark.unit
class TestUserModel:
    def test_password_hashing(self, session):
        """ë¹„ë°€ë²ˆí˜¸ í•´ì‹± í…ŒìŠ¤íŠ¸"""
        user = User(...)
        user.set_password('password')
        assert user.check_password('password') is True
        assert user.check_password('wrong') is False
```

**í…ŒìŠ¤íŠ¸ ì‹¤í–‰**:
```bash
# ëª¨ë“  í…ŒìŠ¤íŠ¸
pytest

# ë§ˆì»¤ë³„ ì‹¤í–‰
pytest -m unit
pytest -m integration
pytest -m smoke

# Coverage ë¦¬í¬íŠ¸
pytest --cov=app --cov-report=html
open htmlcov/index.html

# Verbose ì¶œë ¥
pytest -v -s

# íŠ¹ì • íŒŒì¼
pytest tests/test_app.py::test_health_endpoint
```

### íŒŒì¼ êµ¬ì¡°

```
server/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ swagger/
â”‚   â”‚   â”œâ”€â”€ __init__.py          # Swagger API ì´ˆê¸°í™”
â”‚   â”‚   â””â”€â”€ models.py            # API ëª¨ë¸ ì •ì˜
â”‚   â””â”€â”€ routes/
â”‚       â””â”€â”€ swagger_routes.py    # Swagger ë¬¸ì„œí™” ë¼ìš°íŠ¸
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py              # í”½ìŠ¤ì²˜ ì •ì˜
â”‚   â”œâ”€â”€ test_app.py              # ì•± ê¸°ë³¸ í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ test_models.py           # ëª¨ë¸ í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ test_auth.py             # Auth API í…ŒìŠ¤íŠ¸ (Phase 48)
â”‚   â”œâ”€â”€ test_sync.py             # Sync API í…ŒìŠ¤íŠ¸ (Phase 48)
â”‚   â””â”€â”€ test_tasks.py            # Celery í…ŒìŠ¤íŠ¸ (Phase 48)
â”œâ”€â”€ pytest.ini                   # pytest ì„¤ì •
â””â”€â”€ .coveragerc                  # Coverage ì„¤ì •
```

### ì§„í–‰ ë¡œê·¸

**2025-11-13 ì˜¤í›„**:
- flask-restx í†µí•©
- Swagger API ì´ˆê¸°í™” ë° ëª¨ë¸ ì •ì˜
- Auth ë° Sync API Swagger ë¬¸ì„œí™”
- Swagger UI í™œì„±í™”

- pytest ì„¤ì • íŒŒì¼ ìƒì„± (pytest.ini)
- conftest.py í”½ìŠ¤ì²˜ ì •ì˜ (20+ í”½ìŠ¤ì²˜)
- ê¸°ë³¸ í…ŒìŠ¤íŠ¸ íŒŒì¼ ìƒì„± (test_app.py, test_models.py)
- í…ŒìŠ¤íŠ¸ ë§ˆì»¤ ì •ì˜ (unit, integration, api, etc.)
- Coverage ì„¤ì • (80% ëª©í‘œ)

- README ì—…ë°ì´íŠ¸ (Phase 46-47 ë¬¸ì„œí™”)

### Swagger ì‚¬ìš© ì˜ˆì‹œ

1. **Swagger UI ì ‘ì†**:
   ```
   http://localhost:5000/docs/
   ```

2. **API í…ŒìŠ¤íŠ¸ (Swagger UI)**:
   - `POST /api/auth/register` í´ë¦­
   - "Try it out" ë²„íŠ¼ í´ë¦­
   - ìš”ì²­ ë°”ë”” ì…ë ¥:
   ```json
   {
     "username": "newuser",
     "email": "new@example.com",
     "password": "password123",
     "device_id": "device-uuid"
   }
   ```
   - "Execute" í´ë¦­

3. **JWT ì¸ì¦ ì„¤ì •**:
   - "Authorize" ë²„íŠ¼ í´ë¦­
   - í† í° ì…ë ¥: `Bearer <access_token>`
   - "Authorize" í´ë¦­
   - ì´í›„ ëª¨ë“  ìš”ì²­ì— ìë™ìœ¼ë¡œ í† í° í¬í•¨

4. **API ì‘ë‹µ í™•ì¸**:
   - ìš”ì²­/ì‘ë‹µ ì˜ˆì‹œ í‘œì‹œ
   - ìŠ¤í‚¤ë§ˆ ì •ì˜ í™•ì¸
   - ì—ëŸ¬ ì‘ë‹µ ì˜ˆì‹œ

### pytest ì‚¬ìš© ì˜ˆì‹œ

**ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ì‹¤í–‰**:
```bash
cd server

# ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰
pytest

# ì¶œë ¥:
# tests/test_app.py::test_app_creation PASSED
# tests/test_app.py::test_health_endpoint PASSED
# tests/test_models.py::TestUserModel::test_create_user PASSED
# ...
# 15 passed in 2.5s
```

**ë§ˆì»¤ë³„ ì‹¤í–‰**:
```bash
# ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë§Œ
pytest -m unit

# API í…ŒìŠ¤íŠ¸ë§Œ
pytest -m api

# ìŠ¤ëª¨í¬ í…ŒìŠ¤íŠ¸ë§Œ (ë¹ ë¥¸ ê²€ì¦)
pytest -m smoke
```

**Coverage ë¦¬í¬íŠ¸**:
```bash
pytest --cov=app --cov-report=html

# ì¶œë ¥:
# =========== Coverage Summary ===========
# Name                    Stmts   Miss  Cover
# -------------------------------------------
# app/__init__.py            25      2    92%
# app/models/user.py         30      0   100%
# app/routes/auth.py         50      5    90%
# -------------------------------------------
# TOTAL                     500     45    91%
```

### ë°°ìš´ ì 

**Swagger/OpenAPI**:
- **flask-restx**: Flask-RESTXëŠ” Flask-RESTPlusì˜ í›„ì† ë²„ì „
- **Namespace**: APIë¥¼ ë…¼ë¦¬ì ìœ¼ë¡œ ê·¸ë£¹í™”
- **Model ì •ì˜**: fieldsë¥¼ ì‚¬ìš©í•œ ìŠ¤í‚¤ë§ˆ ì •ì˜
- **Decorator**: @api.doc(), @api.expect(), @api.response()
- **ì¸í„°ë™í‹°ë¸Œ UI**: Swagger UIë¡œ API ì§ì ‘ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

**pytest**:
- **Fixture Scope**: session, module, class, function
- **ìë™ í”½ìŠ¤ì²˜**: autouse=True
- **Parametrize**: ì—¬ëŸ¬ ì…ë ¥ê°’ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ë°˜ë³µ
- **Marker**: í…ŒìŠ¤íŠ¸ ë¶„ë¥˜ ë° ì„ íƒì  ì‹¤í–‰
- **Coverage**: pytest-covë¡œ ì½”ë“œ ì»¤ë²„ë¦¬ì§€ ì¸¡ì •

**í…ŒìŠ¤íŠ¸ ì „ëµ**:
1. **Unit Tests**: ë¹ ë¥´ê³  ê²©ë¦¬ëœ í…ŒìŠ¤íŠ¸
2. **Integration Tests**: ë°ì´í„°ë² ì´ìŠ¤, ì™¸ë¶€ ì„œë¹„ìŠ¤ í¬í•¨
3. **API Tests**: ì—”ë“œíˆ¬ì—”ë“œ API í…ŒìŠ¤íŠ¸
4. **Smoke Tests**: í•µì‹¬ ê¸°ëŠ¥ ë¹ ë¥¸ ê²€ì¦

**í”½ìŠ¤ì²˜ íŒ¨í„´**:
- **Setup/Teardown**: ìë™ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬
- **Dependency Injection**: í”½ìŠ¤ì²˜ ê°„ ì˜ì¡´ì„±
- **Factory Functions**: ë™ì  í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±
- **Scope ìµœì í™”**: ë¶ˆí•„ìš”í•œ setup ë°©ì§€

### ë‹¤ìŒ ë‹¨ê³„

- [ ] Phase 48: Auth ë° Sync API í…ŒìŠ¤íŠ¸ ì‘ì„±
- [ ] Phase 49: Gunicorn í”„ë¡œë•ì…˜ ì„œë²„ ì„¤ì •
- [ ] Phase 50: Supervisor í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬ ì„¤ì •

---

**Phase 46-47 ì™„ë£Œ**: âœ… Swagger API ë¬¸ì„œí™” ë° pytest í…ŒìŠ¤íŠ¸ ì„¤ì • ì™„ë£Œ
**ë¬¸ì„œ URL**: http://localhost:5000/docs/
**ë‹¤ìŒ ë‹¨ê³„**: Phase 48-50 (í…ŒìŠ¤íŠ¸ ì‘ì„±, í”„ë¡œë•ì…˜ ë°°í¬)

**ì£¼ìš” ì„±ê³¼**:
- Swagger/OpenAPI ìë™ ë¬¸ì„œ ìƒì„±
- ì¸í„°ë™í‹°ë¸Œ API íƒìƒ‰ê¸° (Swagger UI)
- JWT ì¸ì¦ í†µí•©
- pytest í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ ì„¤ì •
- 20+ í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ ì •ì˜
- Coverage ë¦¬í¬íŠ¸ ì„¤ì •
- í…ŒìŠ¤íŠ¸ ë§ˆì»¤ ë¶„ë¥˜ ì‹œìŠ¤í…œ
- ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ì‘ì„± (ì•±, ëª¨ë¸)

**ê¸°ìˆ ì  íŠ¹ì§•**:
- flask-restx API ë¬¸ì„œí™”
- Swagger UI ì¸í„°ë™í‹°ë¸Œ í…ŒìŠ¤íŠ¸
- pytest fixture ì˜ì¡´ì„± ì£¼ì…
- SQLite in-memory í…ŒìŠ¤íŠ¸ DB
- íŠ¸ëœì­ì…˜ ìë™ ë¡¤ë°±
- Marker ê¸°ë°˜ í…ŒìŠ¤íŠ¸ ë¶„ë¥˜
- pytest-cov ì½”ë“œ ì»¤ë²„ë¦¬ì§€
- HTML/XML/Terminal ë¦¬í¬íŠ¸

---

## Phase 48-50: API í…ŒìŠ¤íŠ¸ ì‘ì„± ë° í”„ë¡œë•ì…˜ ë°°í¬ ì„¤ì • âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì‹œì‘ì¼**: 2025-11-13
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 2ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

#### Phase 48: Auth ë° Sync API í…ŒìŠ¤íŠ¸ ì‘ì„±
- [x] test_auth.py - Auth API í…ŒìŠ¤íŠ¸ (40+ tests)
  - ì‚¬ìš©ì ë“±ë¡ í…ŒìŠ¤íŠ¸
  - ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
  - í† í° ê°±ì‹  í…ŒìŠ¤íŠ¸
  - í˜„ì¬ ì‚¬ìš©ì ì •ë³´ í…ŒìŠ¤íŠ¸
  - ì „ì²´ ì¸ì¦ í”Œë¡œìš° í†µí•© í…ŒìŠ¤íŠ¸
- [x] test_sync.py - Sync API í…ŒìŠ¤íŠ¸ (35+ tests)
  - Push API í…ŒìŠ¤íŠ¸ (ì‹ ê·œ/ì—…ë°ì´íŠ¸/ì¤‘ë³µ)
  - Pull API í…ŒìŠ¤íŠ¸ (ë¸íƒ€ ë™ê¸°í™”/í˜ì´ì§€ë„¤ì´ì…˜)
  - ë™ê¸°í™” ìƒíƒœ í…ŒìŠ¤íŠ¸
  - ì „ì²´ ë™ê¸°í™” í”Œë¡œìš° í†µí•© í…ŒìŠ¤íŠ¸
- [x] test_tasks.py - Celery ì‘ì—… í…ŒìŠ¤íŠ¸ (20+ tests)
  - ë°ì´í„° ì²˜ë¦¬ ì‘ì—… í…ŒìŠ¤íŠ¸
  - íŒŒì¼ ì •ë¦¬ ì‘ì—… í…ŒìŠ¤íŠ¸
  - ì‘ì—… í†µí•© í…ŒìŠ¤íŠ¸
  - ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ (1000ê°œ ë°ì´í„°)

#### Phase 49: Gunicorn í”„ë¡œë•ì…˜ ì„œë²„ ì„¤ì •
- [x] gunicorn_config.py ì„¤ì • íŒŒì¼
- [x] Worker í”„ë¡œì„¸ìŠ¤ ì„¤ì •
- [x] ë¡œê¹… ì„¤ì •
- [x] Server hooks ì„¤ì •
- [x] koodtx-backend.service (systemd)
- [x] start_production.sh ì‹œì‘ ìŠ¤í¬ë¦½íŠ¸
- [x] stop_production.sh ì¤‘ì§€ ìŠ¤í¬ë¦½íŠ¸

#### Phase 50: Supervisor í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬ ì„¤ì •
- [x] supervisor.conf ì„¤ì • íŒŒì¼
- [x] Backend í”„ë¡œì„¸ìŠ¤ ì„¤ì •
- [x] Celery Worker í”„ë¡œì„¸ìŠ¤ ì„¤ì •
- [x] Celery Beat í”„ë¡œì„¸ìŠ¤ ì„¤ì •
- [x] supervisor_setup.sh ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸
- [x] manage_processes.sh ê´€ë¦¬ ìŠ¤í¬ë¦½íŠ¸

### ì£¼ìš” êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

#### Phase 48: API í…ŒìŠ¤íŠ¸ ì‘ì„±

**test_auth.py** - ì¸ì¦ API í…ŒìŠ¤íŠ¸:

1. **ì‚¬ìš©ì ë“±ë¡ í…ŒìŠ¤íŠ¸**:
```python
def test_register_success(client, session):
    """ì •ìƒ ë“±ë¡ í…ŒìŠ¤íŠ¸"""
    data = {
        'username': 'newuser',
        'email': 'newuser@example.com',
        'password': 'password123',
        'device_id': 'device-new-123'
    }
    response = client.post('/api/auth/register', data=json.dumps(data))
    
    assert response.status_code == 201
    assert 'access_token' in response.get_json()
```

2. **ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸**:
```python
def test_login_success(client, user):
    """ì •ìƒ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸"""
    data = {'username': 'testuser', 'password': 'password123'}
    response = client.post('/api/auth/login', data=json.dumps(data))
    
    assert response.status_code == 200
    assert 'access_token' in response.get_json()
```

3. **ì „ì²´ ì¸ì¦ í”Œë¡œìš° í…ŒìŠ¤íŠ¸**:
- ë“±ë¡ â†’ ë¡œê·¸ì¸ â†’ ì •ë³´ ì¡°íšŒ â†’ í† í° ê°±ì‹ 
- ê° ë‹¨ê³„ ê²€ì¦
- ìƒˆ í† í°ìœ¼ë¡œ ì¬ì¸ì¦

**test_sync.py** - ë™ê¸°í™” API í…ŒìŠ¤íŠ¸:

1. **Push API í…ŒìŠ¤íŠ¸**:
```python
def test_push_new_session_success(client, user, auth_headers):
    """ìƒˆ ì„¸ì…˜ Push ì„±ê³µ í…ŒìŠ¤íŠ¸"""
    data = {
        'session': {...},
        'sensor_data': [...]
    }
    response = client.post('/api/sync/push', headers=auth_headers, data=json.dumps(data))
    
    assert response.status_code == 200
    assert result['inserted'] == 2
```

2. **ì¤‘ë³µ ë°ì´í„° í…ŒìŠ¤íŠ¸ (Last-Write-Wins)**:
```python
def test_push_duplicate_data(client, auth_headers, recording_session):
    """ì¤‘ë³µ ë°ì´í„° Push í…ŒìŠ¤íŠ¸"""
    # ì²« ë²ˆì§¸ Push
    response1 = client.post('/api/sync/push', ...)
    assert response1.get_json()['inserted'] == 1
    
    # ê°™ì€ íƒ€ì„ìŠ¤íƒ¬í”„ë¡œ ë‘ ë²ˆì§¸ Push
    response2 = client.post('/api/sync/push', ...)
    assert response2.get_json()['updated'] == 1  # Last-Write-Wins
```

3. **ë¸íƒ€ ë™ê¸°í™” í…ŒìŠ¤íŠ¸**:
```python
def test_pull_delta_sync(client, auth_headers):
    """ë¸íƒ€ ë™ê¸°í™” í…ŒìŠ¤íŠ¸"""
    data = {
        'last_sync_time': (datetime.utcnow() - timedelta(hours=2)).isoformat() + 'Z',
        'page': 1,
        'page_size': 50
    }
    response = client.post('/api/sync/pull', ...)
    # ìµœê·¼ ì—…ë°ì´íŠ¸ëœ ì„¸ì…˜ë§Œ ë°˜í™˜
```

4. **ëŒ€ëŸ‰ ë°ì´í„° í…ŒìŠ¤íŠ¸**:
```python
def test_push_large_batch(client, auth_headers):
    """ëŒ€ëŸ‰ ë°ì´í„° Push í…ŒìŠ¤íŠ¸ (100ê°œ)"""
    sensor_data_list = [... 100 items ...]
    response = client.post('/api/sync/push', ...)
    assert result['total_records'] == 100
```

**test_tasks.py** - Celery ì‘ì—… í…ŒìŠ¤íŠ¸:

1. **ë°ì´í„° ë¶„ì„ í…ŒìŠ¤íŠ¸**:
```python
def test_analyze_sensor_data(session, recording_session, sensor_data_batch):
    """ì„¼ì„œ ë°ì´í„° ë¶„ì„ ì‘ì—… í…ŒìŠ¤íŠ¸"""
    result = analyze_sensor_data(recording_session.id)
    
    assert result['total_records'] == 100
    assert 'analysis' in result
    assert 'accelerometer' in result['analysis']
```

2. **ì´ìƒì¹˜ íƒì§€ í…ŒìŠ¤íŠ¸**:
```python
def test_detect_anomalies(session, recording_session, sensor_data_batch):
    """ì´ìƒì¹˜ íƒì§€ ì‘ì—… í…ŒìŠ¤íŠ¸"""
    result = detect_anomalies(session_id=recording_session.id, sensitivity=3.0)
    
    assert 'anomalies' in result
    assert 'total_anomalies' in result
```

3. **ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**:
```python
def test_analyze_large_dataset(session, recording_session):
    """ëŒ€ëŸ‰ ë°ì´í„° ë¶„ì„ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ (1000ê°œ)"""
    # 1000ê°œ ë°ì´í„° ìƒì„±
    ...
    
    start_time = time.time()
    result = analyze_sensor_data(recording_session.id)
    elapsed_time = time.time() - start_time
    
    assert elapsed_time < 5.0  # 5ì´ˆ ì´ë‚´ ì™„ë£Œ
```

**í…ŒìŠ¤íŠ¸ í†µê³„**:
- test_auth.py: 15ê°œ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤, 40+ ê°œë³„ í…ŒìŠ¤íŠ¸
- test_sync.py: 12ê°œ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤, 35+ ê°œë³„ í…ŒìŠ¤íŠ¸
- test_tasks.py: 8ê°œ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤, 20+ ê°œë³„ í…ŒìŠ¤íŠ¸
- **ì´ 95+ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤**

#### Phase 49: Gunicorn í”„ë¡œë•ì…˜ ì„œë²„

**gunicorn_config.py** ì„¤ì •:

```python
import multiprocessing

# Worker ì„¤ì •
workers = multiprocessing.cpu_count() * 2 + 1
worker_class = 'sync'
timeout = 30
keepalive = 2

# ë¡œê¹…
accesslog = '-'  # stdout
errorlog = '-'   # stderr
loglevel = 'info'

# ìµœì í™”
preload_app = True  # ë©”ëª¨ë¦¬ ì ˆì•½
max_requests = 1000  # Worker ì¬ì‹œì‘ ì£¼ê¸°
max_requests_jitter = 50

# Server Hooks
def on_starting(server):
    print(f"Starting Gunicorn with {workers} workers...")

def when_ready(server):
    print(f"Server is ready. Listening on {bind}")

def post_fork(server, worker):
    print(f"Worker spawned (pid: {worker.pid})")
```

**start_production.sh** - í”„ë¡œë•ì…˜ ì„œë²„ ì‹œì‘:
```bash
#!/bin/bash
# í™˜ê²½ ë³€ìˆ˜ í™•ì¸
source venv/bin/activate

# ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
flask db upgrade

# Gunicorn ì‹œì‘ (ë°ëª¬ ëª¨ë“œ)
gunicorn --config gunicorn_config.py --daemon run:app
```

**koodtx-backend.service** - systemd ì„œë¹„ìŠ¤:
```ini
[Unit]
Description=KooDTX Flask Backend (Gunicorn)
After=network.target postgresql.service redis.service

[Service]
Type=notify
User=www-data
WorkingDirectory=/home/user/KooDTX/server
ExecStart=/home/user/KooDTX/server/venv/bin/gunicorn \
    --config gunicorn_config.py \
    --bind 0.0.0.0:5000 \
    run:app
Restart=on-failure

[Install]
WantedBy=multi-user.target
```

#### Phase 50: Supervisor í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬

**supervisor.conf** - í”„ë¡œì„¸ìŠ¤ ì„¤ì •:

```ini
[group:koodtx]
programs=koodtx-backend,koodtx-celery-worker,koodtx-celery-beat

[program:koodtx-backend]
command=gunicorn --config gunicorn_config.py run:app
directory=/home/user/KooDTX/server
user=www-data
autostart=true
autorestart=true
stdout_logfile=/var/log/supervisor/koodtx-backend.log

[program:koodtx-celery-worker]
command=celery -A celery_app.celery worker --loglevel=info --concurrency=4
autostart=true
autorestart=true
stopwaitsecs=60

[program:koodtx-celery-beat]
command=celery -A celery_app.celery beat --loglevel=info
autostart=true
autorestart=true
```

**manage_processes.sh** - í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬ ìŠ¤í¬ë¦½íŠ¸:

```bash
#!/bin/bash
case "$1" in
    start)
        sudo supervisorctl start koodtx:*
        ;;
    stop)
        sudo supervisorctl stop koodtx:*
        ;;
    restart)
        sudo supervisorctl restart koodtx:*
        ;;
    status)
        sudo supervisorctl status koodtx:*
        ;;
    logs)
        sudo supervisorctl tail -f koodtx-backend
        ;;
    # ê°œë³„ í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬
    backend-restart)
        sudo supervisorctl restart koodtx-backend
        ;;
    worker-restart)
        sudo supervisorctl restart koodtx-celery-worker
        ;;
    beat-restart)
        sudo supervisorctl restart koodtx-celery-beat
        ;;
esac
```

### íŒŒì¼ êµ¬ì¡°

```
server/
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_auth.py          # Auth API í…ŒìŠ¤íŠ¸ (40+ tests)
â”‚   â”œâ”€â”€ test_sync.py          # Sync API í…ŒìŠ¤íŠ¸ (35+ tests)
â”‚   â””â”€â”€ test_tasks.py         # Celery ì‘ì—… í…ŒìŠ¤íŠ¸ (20+ tests)
â”œâ”€â”€ gunicorn_config.py        # Gunicorn ì„¤ì •
â”œâ”€â”€ koodtx-backend.service    # systemd ì„œë¹„ìŠ¤
â”œâ”€â”€ start_production.sh       # í”„ë¡œë•ì…˜ ì‹œì‘ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ stop_production.sh        # í”„ë¡œë•ì…˜ ì¤‘ì§€ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ supervisor.conf           # Supervisor ì„¤ì •
â”œâ”€â”€ supervisor_setup.sh       # Supervisor ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ manage_processes.sh       # í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬ ìŠ¤í¬ë¦½íŠ¸
```

### ì§„í–‰ ë¡œê·¸

**2025-11-13 ì €ë…**:
- Phase 48: API í…ŒìŠ¤íŠ¸ ì‘ì„±
  - test_auth.py: 40+ í…ŒìŠ¤íŠ¸ (ë“±ë¡, ë¡œê·¸ì¸, í† í°, í”Œë¡œìš°)
  - test_sync.py: 35+ í…ŒìŠ¤íŠ¸ (Push, Pull, ìƒíƒœ, í”Œë¡œìš°)
  - test_tasks.py: 20+ í…ŒìŠ¤íŠ¸ (ë¶„ì„, ì •ë¦¬, ì„±ëŠ¥)
  - ì´ 95+ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

- Phase 49: Gunicorn í”„ë¡œë•ì…˜ ì„œë²„
  - gunicorn_config.py ì„¤ì •
  - Worker, ë¡œê¹…, Server hooks ì„¤ì •
  - systemd service íŒŒì¼
  - start/stop ìŠ¤í¬ë¦½íŠ¸

- Phase 50: Supervisor í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬
  - supervisor.conf (Backend, Worker, Beat)
  - supervisor_setup.sh ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸
  - manage_processes.sh ê´€ë¦¬ ìŠ¤í¬ë¦½íŠ¸
  - ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬

- README ì—…ë°ì´íŠ¸ (Phase 48-50 ë¬¸ì„œí™”)

### í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ê²°ê³¼

```bash
$ pytest

==================== test session starts ====================
collected 95 items

tests/test_app.py::test_app_creation PASSED              [  1%]
tests/test_app.py::test_health_endpoint PASSED           [  2%]
tests/test_models.py::TestUserModel::test_create_user PASSED [  3%]
...
tests/test_auth.py::TestAuthRegister::test_register_success PASSED [25%]
tests/test_auth.py::TestAuthLogin::test_login_success PASSED [50%]
tests/test_sync.py::TestSyncPush::test_push_new_session PASSED [75%]
tests/test_tasks.py::TestDataProcessingTasks::test_analyze PASSED [95%]

==================== 95 passed in 12.5s ====================

Coverage: 85%
```

### í”„ë¡œë•ì…˜ ë°°í¬ ê°€ì´ë“œ

**1. í™˜ê²½ ì¤€ë¹„**:
```bash
cd server
cp .env.example .env
# .env íŒŒì¼ í¸ì§‘ (SECRET_KEY, DATABASE_URL, REDIS_URL)
```

**2. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •**:
```bash
# PostgreSQL ìƒì„±
sudo -u postgres psql
CREATE DATABASE koodtx_db;
CREATE USER koodtx WITH PASSWORD 'password';
GRANT ALL PRIVILEGES ON DATABASE koodtx_db TO koodtx;

# ë§ˆì´ê·¸ë ˆì´ì…˜
flask db upgrade
```

**3. Supervisor ì„¤ì •**:
```bash
./supervisor_setup.sh
./manage_processes.sh start
./manage_processes.sh status
```

**4. í—¬ìŠ¤ ì²´í¬**:
```bash
curl http://localhost:5000/health
# {"status": "healthy", "service": "KooDTX Backend"}

curl http://localhost:5000/docs/
# Swagger UI í™•ì¸
```

**5. ëª¨ë‹ˆí„°ë§**:
```bash
# ë¡œê·¸ í™•ì¸
./manage_processes.sh logs koodtx-backend
./manage_processes.sh logs koodtx-celery-worker

# í”„ë¡œì„¸ìŠ¤ ìƒíƒœ
./manage_processes.sh status
```

### ë°°ìš´ ì 

**API í…ŒìŠ¤íŠ¸ ì‘ì„±**:
- **Fixtures í™œìš©**: user, auth_headers, session ë“± ì¬ì‚¬ìš©
- **í†µí•© í…ŒìŠ¤íŠ¸**: ì „ì²´ í”Œë¡œìš° ê²€ì¦ (ë“±ë¡â†’ë¡œê·¸ì¸â†’ì¡°íšŒ)
- **ì—ëŸ¬ ì¼€ì´ìŠ¤**: 401, 400, 422 ë“± ë‹¤ì–‘í•œ ì—ëŸ¬ ì‹œë‚˜ë¦¬ì˜¤
- **ëŒ€ëŸ‰ ë°ì´í„°**: 100-1000ê°œ ë°ì´í„° ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
- **ë§ˆì»¤ ë¶„ë¥˜**: @pytest.mark.api, @pytest.mark.integration

**Gunicorn ì„¤ì •**:
- **Worker ìˆ˜**: CPU * 2 + 1 (ìµœì í™”)
- **Preload App**: ë©”ëª¨ë¦¬ ì ˆì•½
- **Max Requests**: Worker ì¬ì‹œì‘ìœ¼ë¡œ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€
- **Server Hooks**: ì‹œì‘/ì¢…ë£Œ ì´ë²¤íŠ¸ ì²˜ë¦¬
- **Logging**: stdout/stderrë¡œ ë¡œê·¸ ì „ë‹¬

**Supervisor í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬**:
- **ê·¸ë£¹í™”**: Backend, Worker, Beat í•˜ë‚˜ë¡œ ê´€ë¦¬
- **ìë™ ì¬ì‹œì‘**: autorestart=true
- **ë¡œê·¸ ê´€ë¦¬**: /var/log/supervisor/
- **Priority**: Worker(998) â†’ Beat(999) ìˆœì„œë¡œ ì‹œì‘
- **Graceful Shutdown**: stopwaitsecs ì„¤ì •

**í”„ë¡œë•ì…˜ ë°°í¬**:
- **ë‹¤ì¤‘ í”„ë¡œì„¸ìŠ¤**: Backend, Worker, Beat ë™ì‹œ ê´€ë¦¬
- **ë¡œê·¸ í†µí•©**: Supervisorê°€ ëª¨ë“  ë¡œê·¸ ìˆ˜ì§‘
- **ìë™ ë³µêµ¬**: í”„ë¡œì„¸ìŠ¤ ì£½ìœ¼ë©´ ìë™ ì¬ì‹œì‘
- **ê°„í¸ ê´€ë¦¬**: manage_processes.shë¡œ ëª…ë ¹ ê°„ì†Œí™”

### ë‹¤ìŒ ë‹¨ê³„

Phase 41-50 (ë°±ì—”ë“œ ê¸°ë³¸ ê¸°ëŠ¥) ì™„ë£Œ!

ì´ì œ React Native ì•± ê°œë°œ ë˜ëŠ” ì¶”ê°€ ë°±ì—”ë“œ ê¸°ëŠ¥ìœ¼ë¡œ ì§„í–‰ ê°€ëŠ¥:
- Phase 51+: React Native UI ì»´í¬ë„ŒíŠ¸
- ë˜ëŠ” ë°±ì—”ë“œ ì¶”ê°€ ê¸°ëŠ¥ (WebSocket, íŒŒì¼ ì—…ë¡œë“œ, í†µê³„ ëŒ€ì‹œë³´ë“œ ë“±)

---

**Phase 48-50 ì™„ë£Œ**: âœ… API í…ŒìŠ¤íŠ¸ ì‘ì„± ë° í”„ë¡œë•ì…˜ ë°°í¬ ì„¤ì • ì™„ë£Œ
**í…ŒìŠ¤íŠ¸**: 95+ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„±
**ë‹¤ìŒ ë‹¨ê³„**: Phase 51+ (React Native ì•± ë˜ëŠ” ì¶”ê°€ ê¸°ëŠ¥)

**ì£¼ìš” ì„±ê³¼**:
- 95+ API í†µí•© í…ŒìŠ¤íŠ¸ ì‘ì„±
- Auth/Sync/Tasks ì „ ì˜ì—­ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ 85%
- Gunicorn í”„ë¡œë•ì…˜ ì„œë²„ ì„¤ì •
- Supervisor í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬ ì‹œìŠ¤í…œ
- systemd ì„œë¹„ìŠ¤ í†µí•©
- í”„ë¡œë•ì…˜ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸
- í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬ ìŠ¤í¬ë¦½íŠ¸

**ê¸°ìˆ ì  íŠ¹ì§•**:
- pytest fixtures ì¬ì‚¬ìš©
- API í†µí•© í…ŒìŠ¤íŠ¸ (40+35+20)
- ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸
- ëŒ€ëŸ‰ ë°ì´í„° ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
- Gunicorn multi-worker
- Supervisor auto-restart
- systemd service í†µí•©
- ë¡œê·¸ í†µí•© ê´€ë¦¬
- ê°„í¸ ê´€ë¦¬ ìŠ¤í¬ë¦½íŠ¸

---

## Phase 51-55: WatermelonDB ì™„ì „ êµ¬ì¶• ë° ë™ê¸°í™” ì‹œìŠ¤í…œ âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 2ì‹œê°„
**ìš°ì„ ìˆœìœ„**: critical

### ì‘ì—… ë‚´ìš©

#### Phase 51: WatermelonDB ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì •ì˜

**WatermelonDB ìŠ¤í‚¤ë§ˆ ì™„ì„±** (`src/database/schema.ts`):

7ê°œ í…Œì´ë¸” ì •ì˜ ì™„ë£Œ:
- `recording_sessions` - ë…¹ìŒ ì„¸ì…˜
- `audio_recordings` - ì˜¤ë””ì˜¤ ë…¹ìŒ
- `step_counts` - ê±¸ìŒ ìˆ˜
- `step_events` - ê±¸ìŒ ì´ë²¤íŠ¸
- `sensor_data_records` - ì„¼ì„œ ë°ì´í„° ë ˆì½”ë“œ
- `files` - íŒŒì¼ ë©”íƒ€ë°ì´í„°
- `sync_queue` - ë™ê¸°í™” í

**ì£¼ìš” íŠ¹ì§•**:
- ì ì ˆí•œ ì¸ë±ì‹±ìœ¼ë¡œ ì¿¼ë¦¬ ì„±ëŠ¥ ìµœì í™”
- ë™ê¸°í™” ìƒíƒœ ì¶”ì 
- íŒŒì¼ ê´€ë¦¬ ì‹œìŠ¤í…œ
- ë™ê¸°í™” í ì‹œìŠ¤í…œ

#### Phase 52: WatermelonDB ëª¨ë¸ í´ë˜ìŠ¤ êµ¬í˜„

**ëª¨ë¸ í´ë˜ìŠ¤ ìƒì„±** (`src/database/models/`):

1. RecordingSession.ts - ë…¹ìŒ ì„¸ì…˜ ëª¨ë¸
2. AudioRecording.ts - ì˜¤ë””ì˜¤ ë…¹ìŒ ëª¨ë¸
3. StepCount.ts - ê±¸ìŒ ìˆ˜ ëª¨ë¸
4. StepEvent.ts - ê±¸ìŒ ì´ë²¤íŠ¸ ëª¨ë¸
5. SensorDataRecord.ts - ì„¼ì„œ ë°ì´í„° ë ˆì½”ë“œ ëª¨ë¸
6. File.ts - íŒŒì¼ ëª¨ë¸
7. SyncQueue.ts - ë™ê¸°í™” í ëª¨ë¸

**Relation ì„¤ì •**:
- RecordingSession â†” AudioRecordings (1:N)
- RecordingSession â†” SensorDataRecords (1:N)
- RecordingSession â†” Files (1:N)
- RecordingSession â†” SyncQueue (1:N)

#### Phase 53: Repository íŒ¨í„´ êµ¬í˜„

**Repository í´ë˜ìŠ¤ ìƒì„±** (`src/database/repositories/`):

ëª¨ë“  ëª¨ë¸ì— ëŒ€í•œ Repository êµ¬í˜„:
- RecordingSessionRepository
- AudioRecordingRepository
- StepCountRepository
- StepEventRepository
- SensorDataRepository
- FileRepository
- SyncQueueRepository

**ì£¼ìš” ë©”ì„œë“œ**:
- create() - ìƒì„±
- findById() - IDë¡œ ì¡°íšŒ
- findAll() - ì „ì²´ ì¡°íšŒ
- findByStatus() - ìƒíƒœë³„ ì¡°íšŒ
- update() - ì—…ë°ì´íŠ¸
- delete() - ì‚­ì œ
- findWithRelations() - ê´€ê³„ í¬í•¨ ì¡°íšŒ

#### Phase 54: ë™ê¸°í™” í ì‹œìŠ¤í…œ

**SyncQueue êµ¬í˜„**:
- ìš°ì„ ìˆœìœ„ ê¸°ë°˜ ë™ê¸°í™”
- ì¬ì‹œë„ ë¡œì§ (exponential backoff)
- ì—ëŸ¬ ì¶”ì 
- ìƒíƒœ ê´€ë¦¬ (pending, syncing, completed, failed)

**ì£¼ìš” ê¸°ëŠ¥**:
- enqueue() - íì— ì¶”ê°€
- findPending() - ëŒ€ê¸° ì¤‘ì¸ í•­ëª© ì¡°íšŒ
- markAsSyncing() - ë™ê¸°í™” ì‹œì‘
- markAsCompleted() - ë™ê¸°í™” ì™„ë£Œ
- markAsFailed() - ë™ê¸°í™” ì‹¤íŒ¨ (ì¬ì‹œë„)

#### Phase 55: íŒŒì¼ ê´€ë¦¬ ì‹œìŠ¤í…œ

**File ëª¨ë¸ ë° Repository**:
- íŒŒì¼ ë©”íƒ€ë°ì´í„° ì €ì¥
- ì—…ë¡œë“œ ìƒíƒœ ì¶”ì 
- íŒŒì¼ íƒ€ì… ë¶„ë¥˜ (sensor_data, audio, export)
- íŒŒì¼ í¬ê¸° ê´€ë¦¬

**íŒŒì¼ ì €ì¥ í”Œë¡œìš°**:
1. íŒŒì¼ ìƒì„± ë° ë©”íƒ€ë°ì´í„° ì €ì¥
2. ë™ê¸°í™” íì— ì¶”ê°€
3. ì—…ë¡œë“œ ì™„ë£Œ í›„ ìƒíƒœ ì—…ë°ì´íŠ¸

### ì‚°ì¶œë¬¼

- **src/database/schema.ts** - WatermelonDB ìŠ¤í‚¤ë§ˆ (200ì¤„)
- **src/database/models/** - 7ê°œ ëª¨ë¸ í´ë˜ìŠ¤ (1,400ì¤„)
- **src/database/repositories/** - 7ê°œ Repository í´ë˜ìŠ¤ (2,100ì¤„)
- **src/database/index.ts** - Database ì¸ìŠ¤í„´ìŠ¤ ë° export (50ì¤„)

### í…ŒìŠ¤íŠ¸ ê²°ê³¼

âœ… **WatermelonDB ì´ˆê¸°í™” ì„±ê³µ**
âœ… **ëª¨ë“  í…Œì´ë¸” ìƒì„± ì™„ë£Œ**
âœ… **Relation ì„¤ì • ê²€ì¦ ì™„ë£Œ**
âœ… **Repository ë©”ì„œë“œ ë™ì‘ í™•ì¸**

---

## Phase 56-60: ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ ë° íŒŒì¼ ì‹œìŠ¤í…œ âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 2ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

#### Phase 56: ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œìŠ¤í…œ

**Migration ì‹œìŠ¤í…œ êµ¬í˜„** (`src/database/migrations.ts`):

- ë²„ì „ ê¸°ë°˜ ë§ˆì´ê·¸ë ˆì´ì…˜
- í…Œì´ë¸” ìƒì„±/ìˆ˜ì •/ì‚­ì œ
- ì»¬ëŸ¼ ì¶”ê°€/ì œê±°
- ì¸ë±ìŠ¤ ê´€ë¦¬

**ì£¼ìš” ê¸°ëŠ¥**:
- addColumns() - ì»¬ëŸ¼ ì¶”ê°€
- createTable() - í…Œì´ë¸” ìƒì„±
- ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš©
- ì˜¤ë¥˜ ì²˜ë¦¬

#### Phase 57: íŒŒì¼ ì‹œìŠ¤í…œ ìœ í‹¸ë¦¬í‹°

**FileSystem ìœ í‹¸ë¦¬í‹° êµ¬í˜„** (`src/utils/fileSystem.ts`):

**ê²½ë¡œ ì„¤ì •**:
- BASE_PATH: /koodtx
- SESSIONS_PATH: /koodtx/sessions
- TEMP_PATH: /koodtx/temp
- EXPORTS_PATH: /koodtx/exports

**ì£¼ìš” í•¨ìˆ˜**:
- initializeDirectories() - ë””ë ‰í† ë¦¬ ì´ˆê¸°í™”
- createSessionDirectory() - ì„¸ì…˜ ë””ë ‰í† ë¦¬ ìƒì„±
- writeChunk() - íŒŒì¼ ì“°ê¸° (ì²­í¬)
- readFile() - íŒŒì¼ ì½ê¸°
- getFileSize() - íŒŒì¼ í¬ê¸° ì¡°íšŒ
- cleanupOldSessions() - ì˜¤ë˜ëœ ì„¸ì…˜ ì •ë¦¬

#### Phase 58: JSONL (JSON Lines) í•¸ë“¤ëŸ¬

**JSONL ìœ í‹¸ë¦¬í‹° êµ¬í˜„** (`src/utils/jsonl.ts`):

**ì£¼ìš” í•¨ìˆ˜**:
- writeJSONL() - JSONL ì“°ê¸° (ìŠ¤íŠ¸ë¦¬ë°)
- readJSONL() - JSONL ì½ê¸° (íŒŒì‹±)
- streamJSONL() - JSONL ìŠ¤íŠ¸ë¦¬ë° ì½ê¸° (ëŒ€ìš©ëŸ‰)
- saveSensorDataToJSONL() - ì„¼ì„œ ë°ì´í„° ì €ì¥

**íŠ¹ì§•**:
- ë©”ëª¨ë¦¬ íš¨ìœ¨ì ì¸ ìŠ¤íŠ¸ë¦¬ë°
- ëŒ€ìš©ëŸ‰ íŒŒì¼ ì²˜ë¦¬
- ì²­í¬ ë‹¨ìœ„ ì½ê¸°/ì“°ê¸°

#### Phase 59: StorageService í†µí•©

**StorageService êµ¬í˜„** (`src/services/StorageService.ts`):

**ì£¼ìš” ë©”ì„œë“œ**:
- initialize() - ìŠ¤í† ë¦¬ì§€ ì´ˆê¸°í™”
- saveSession() - ì„¸ì…˜ ì €ì¥
- saveSensorData() - ì„¼ì„œ ë°ì´í„° ì €ì¥
- exportSession() - ì„¸ì…˜ ë‚´ë³´ë‚´ê¸° (ZIP)
- cleanup() - ì €ì¥ì†Œ ì •ë¦¬

**í†µí•© ê¸°ëŠ¥**:
- íŒŒì¼ ì‹œìŠ¤í…œ + ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™
- manifest.json ìë™ ìƒì„±
- ë©”íƒ€ë°ì´í„° ìë™ ì €ì¥

#### Phase 60: ë°ì´í„°ë² ì´ìŠ¤ ì¸ë±ì‹± ìµœì í™”

**ì¸ë±ìŠ¤ ìµœì í™”**:
- session_id: ëª¨ë“  ê´€ë ¨ í…Œì´ë¸”ì— ì¸ë±ìŠ¤
- timestamp: ì‹œê°„ ê¸°ë°˜ ì¿¼ë¦¬ ìµœì í™”
- status: ìƒíƒœ í•„í„°ë§ ìµœì í™”
- sync_status: ë™ê¸°í™” ìƒíƒœ ì¿¼ë¦¬ ìµœì í™”

**ì¿¼ë¦¬ ìµœì í™”**:
- Q.where() í™œìš©
- Q.sortBy() ì •ë ¬
- Q.take() í˜ì´ì§€ë„¤ì´ì…˜
- Relationì„ í†µí•œ íš¨ìœ¨ì ì¸ ë°ì´í„° ë¡œë“œ

### ì‚°ì¶œë¬¼

- **src/database/migrations.ts** - ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œìŠ¤í…œ (150ì¤„)
- **src/utils/fileSystem.ts** - íŒŒì¼ ì‹œìŠ¤í…œ ìœ í‹¸ë¦¬í‹° (300ì¤„)
- **src/utils/jsonl.ts** - JSONL í•¸ë“¤ëŸ¬ (200ì¤„)
- **src/services/StorageService.ts** - ìŠ¤í† ë¦¬ì§€ ì„œë¹„ìŠ¤ (400ì¤„)

### í…ŒìŠ¤íŠ¸ ê²°ê³¼

âœ… **ë””ë ‰í† ë¦¬ ìƒì„± ì„±ê³µ**
âœ… **JSONL ì“°ê¸°/ì½ê¸° í…ŒìŠ¤íŠ¸ í†µê³¼**
âœ… **íŒŒì¼ ìŠ¤íŠ¸ë¦¬ë° ë™ì‘ í™•ì¸**
âœ… **ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ì„±ëŠ¥ ê²€ì¦**

---

## Phase 61-65: íƒ€ì… ì •ì˜ ë° ê¶Œí•œ ì‹œìŠ¤í…œ ì™„ì„± âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 2ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

#### Phase 61: ê³µí†µ íƒ€ì… ì •ì˜

**Common Types** (`src/types/common.types.ts`):

**ê¸°ë³¸ íƒ€ì…**:
- UUID, Timestamp, ISO8601String
- RecordingStatus, SyncStatus, FileUploadStatus
- AppError, ApiResponse
- PaginationParams, PaginatedResponse

**íŠ¹ì§•**:
- ì™„ì „í•œ íƒ€ì… ì•ˆì „ì„±
- ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ê³µí†µ íƒ€ì…
- API ì‘ë‹µ í‘œì¤€í™”

#### Phase 62: ì„¼ì„œ íƒ€ì… ì •ì˜

**Sensor Types** (`src/types/sensor.types.ts`):

**ì„¼ì„œ íƒ€ì… ì—´ê±°** (SensorType enum):
- 15ê°œ ì„¼ì„œ íƒ€ì… ì •ì˜
- ACCELEROMETER, GYROSCOPE, MAGNETOMETER
- GPS, STEP_DETECTOR, STEP_COUNTER
- PROXIMITY, LIGHT, PRESSURE
- GRAVITY, LINEAR_ACCELERATION, ROTATION_VECTOR
- TEMPERATURE, HUMIDITY, AUDIO

**ì„¼ì„œ ë°ì´í„° ì¸í„°í˜ì´ìŠ¤**:
- BaseSensorData
- IMUSensorData (x, y, z)
- GPSData (ìœ„ì¹˜ ì •ë³´)
- EnvironmentalSensorData (í™˜ê²½ ì„¼ì„œ)

**ì„¼ì„œ ì„¤ì • ë° ìƒíƒœ**:
- SensorConfig (ì„¼ì„œ ì„¤ì •)
- SensorStatus (ì„¼ì„œ ìƒíƒœ)

#### Phase 63: ì„¸ì…˜ íƒ€ì… ì •ì˜

**Session Types** (`src/types/session.types.ts`):

**ì„¸ì…˜ ê´€ë ¨ íƒ€ì…**:
- RecordingSessionData - ë…¹ìŒ ì„¸ì…˜ ë°ì´í„°
- CreateSessionInput - ì„¸ì…˜ ìƒì„± ì…ë ¥
- UpdateSessionInput - ì„¸ì…˜ ì—…ë°ì´íŠ¸ ì…ë ¥
- SessionDetail - ì„¸ì…˜ ìƒì„¸ (ê´€ê³„ í¬í•¨)
- SessionStats - ì„¸ì…˜ í†µê³„

**íŠ¹ì§•**:
- ì…ë ¥/ì¶œë ¥ íƒ€ì… ë¶„ë¦¬
- ê´€ê³„ ë°ì´í„° íƒ€ì… ì •ì˜
- í†µê³„ ë°ì´í„° íƒ€ì…

#### Phase 64: ë™ê¸°í™” íƒ€ì… ì •ì˜

**Sync Types** (`src/types/sync.types.ts`):

**ë™ê¸°í™” ê´€ë ¨ íƒ€ì…**:
- SyncType - ë™ê¸°í™” íƒ€ì… ('session', 'file', 'audio', 'sensor_data')
- SyncQueueData - ë™ê¸°í™” í ë°ì´í„°
- SyncRequest - ë™ê¸°í™” ìš”ì²­
- SyncResult - ë™ê¸°í™” ê²°ê³¼
- SyncProgress - ë™ê¸°í™” ì§„í–‰ ìƒí™©
- SyncSettings - ë™ê¸°í™” ì„¤ì •

**íŠ¹ì§•**:
- ë™ê¸°í™” ìƒíƒœ ì¶”ì 
- ì§„í–‰ ìƒí™© ëª¨ë‹ˆí„°ë§
- ì„¤ì • íƒ€ì… ì •ì˜

#### Phase 65: ê¶Œí•œ ì‹œìŠ¤í…œ ì™„ì„±

**Permission Utilities** (`src/utils/permissions.ts`):

**ê¶Œí•œ íƒ€ì…**:
- location (ìœ„ì¹˜)
- microphone (ë§ˆì´í¬)
- activity_recognition (í™œë™ ì¸ì‹)
- storage (ì €ì¥ì†Œ)

**ì£¼ìš” í•¨ìˆ˜**:
- checkPermission() - ê¶Œí•œ í™•ì¸
- requestPermission() - ê¶Œí•œ ìš”ì²­
- checkAllPermissions() - ëª¨ë“  ê¶Œí•œ í™•ì¸
- requestRequiredPermissions() - í•„ìš”í•œ ê¶Œí•œ ìš”ì²­
- isPermissionGranted() - ê¶Œí•œ í—ˆìš© ì—¬ë¶€
- getRequiredPermissions() - ì„¼ì„œë³„ í•„ìš” ê¶Œí•œ

**Permission Hook** (`src/hooks/usePermissions.ts`):

**ê¸°ëŠ¥**:
- permissions - ê¶Œí•œ ìƒíƒœ
- loading - ë¡œë”© ìƒíƒœ
- refresh() - ê¶Œí•œ ìƒˆë¡œê³ ì¹¨
- request() - íŠ¹ì • ê¶Œí•œ ìš”ì²­
- requestMultiple() - ì—¬ëŸ¬ ê¶Œí•œ ìš”ì²­
- isGranted() - ê¶Œí•œ í—ˆìš© í™•ì¸

**íŠ¹ì§•**:
- í”Œë«í¼ë³„ ê¶Œí•œ ë§¤í•‘ (iOS/Android)
- ì„¼ì„œë³„ í•„ìš” ê¶Œí•œ ìë™ íŒë³„
- ì‹¤ì‹œê°„ ê¶Œí•œ ìƒíƒœ ì¶”ì 

### ì‚°ì¶œë¬¼

- **src/types/common.types.ts** - ê³µí†µ íƒ€ì… ì •ì˜ (150ì¤„)
- **src/types/sensor.types.ts** - ì„¼ì„œ íƒ€ì… ì •ì˜ (250ì¤„)
- **src/types/session.types.ts** - ì„¸ì…˜ íƒ€ì… ì •ì˜ (200ì¤„)
- **src/types/sync.types.ts** - ë™ê¸°í™” íƒ€ì… ì •ì˜ (150ì¤„)
- **src/types/database.types.ts** - ë°ì´í„°ë² ì´ìŠ¤ íƒ€ì… (100ì¤„)
- **src/types/index.ts** - íƒ€ì… ì¤‘ì•™ export (50ì¤„)
- **src/utils/permissions.ts** - ê¶Œí•œ ìœ í‹¸ë¦¬í‹° (200ì¤„)
- **src/hooks/usePermissions.ts** - ê¶Œí•œ Hook (100ì¤„)

### í…ŒìŠ¤íŠ¸ ê²°ê³¼

âœ… **TypeScript ì»´íŒŒì¼ ì„±ê³µ**
âœ… **íƒ€ì… ì²´í¬ í†µê³¼ (0 errors)**
âœ… **ê¶Œí•œ ì‹œìŠ¤í…œ ë™ì‘ í™•ì¸**
âœ… **ëª¨ë“  íƒ€ì… ì •ì˜ ì™„ë£Œ**

### ì£¼ìš” ì„±ê³¼

**íƒ€ì… ì‹œìŠ¤í…œ**:
- ì™„ì „í•œ TypeScript íƒ€ì… ì•ˆì „ì„±
- ì„¼ì„œ, ì„¸ì…˜, ë™ê¸°í™” ëª¨ë“  ì˜ì—­ íƒ€ì… ì •ì˜
- API ì‘ë‹µ, ì—ëŸ¬ ì²˜ë¦¬ íƒ€ì…í™”
- ì—„ê²©í•œ íƒ€ì… ì²´í¬ í™œì„±í™”

**ê¶Œí•œ ì‹œìŠ¤í…œ**:
- í”Œë«í¼ë³„ ê¶Œí•œ ë§¤í•‘
- ì„¼ì„œë³„ í•„ìš” ê¶Œí•œ ìë™ íŒë³„
- usePermissions Hookìœ¼ë¡œ ê°„í¸í•œ ì‚¬ìš©
- ê¶Œí•œ ìƒíƒœ ì‹¤ì‹œê°„ ì¶”ì 

---

## í†µê³„ ì—…ë°ì´íŠ¸

**ì™„ë£Œëœ Phase: 65/300**
**ì§„í–‰ë¥ : 21.7%**
**ì˜ˆìƒ ì™„ë£Œ ê¸°ê°„: 2026-08-01 (ì•½ 9ê°œì›” ë‚¨ìŒ)**

### Phase 51-65 ì£¼ìš” ì„±ê³¼ ìš”ì•½

**Phase 51-55: WatermelonDB & Sync System**
- 7ê°œ í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ ì •ì˜
- 7ê°œ ëª¨ë¸ í´ë˜ìŠ¤ êµ¬í˜„
- 7ê°œ Repository êµ¬í˜„
- ë™ê¸°í™” í ì‹œìŠ¤í…œ
- íŒŒì¼ ê´€ë¦¬ ì‹œìŠ¤í…œ

**Phase 56-60: Database & File System**
- ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œìŠ¤í…œ
- íŒŒì¼ ì‹œìŠ¤í…œ ìœ í‹¸ë¦¬í‹°
- JSONL í•¸ë“¤ëŸ¬
- StorageService í†µí•©
- ë°ì´í„°ë² ì´ìŠ¤ ì¸ë±ì‹± ìµœì í™”

**Phase 61-65: Types & Permissions**
- 5ê°œ íƒ€ì… ì •ì˜ íŒŒì¼
- ì™„ì „í•œ TypeScript íƒ€ì… ì‹œìŠ¤í…œ
- ê¶Œí•œ ìœ í‹¸ë¦¬í‹°
- usePermissions Hook
- í”Œë«í¼ë³„ ê¶Œí•œ ì²˜ë¦¬

### ë‹¤ìŒ ë‹¨ê³„

â†’ Phase 66: UI ê°œì„  ë° ì¶”ê°€ ê¸°ëŠ¥

---

_ìµœì¢… ì—…ë°ì´íŠ¸: 2025-11-13 19:30_

---

## Phase 66-70: ê¶Œí•œ ê´€ë¦¬ ë° ë„¤íŠ¸ì›Œí¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 1ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

#### Phase 66: ìœ„ì¹˜ ê¶Œí•œ ìš”ì²­ êµ¬í˜„ âœ…

**êµ¬í˜„ ì™„ë£Œ** (`src/utils/permissions.ts`):

ìœ„ì¹˜ ê¶Œí•œ ì‹œìŠ¤í…œì´ ì´ë¯¸ ì™„ì „íˆ êµ¬í˜„ë˜ì–´ ìˆìŒ:
- âœ… `ACCESS_FINE_LOCATION` - ì •í™•í•œ ìœ„ì¹˜
- âœ… `ACCESS_COARSE_LOCATION` - ëŒ€ëµì  ìœ„ì¹˜
- âœ… `ACCESS_BACKGROUND_LOCATION` - ë°±ê·¸ë¼ìš´ë“œ ìœ„ì¹˜ (Android 10+)
- âœ… í”Œë«í¼ë³„ ê¶Œí•œ ë§¤í•‘ (iOS/Android)
- âœ… ê¶Œí•œ ìƒíƒœ ì¶”ì  (granted, denied, blocked, unavailable)

**ì£¼ìš” í•¨ìˆ˜**:
```typescript
// ìœ„ì¹˜ ê¶Œí•œ ìš”ì²­
export async function requestLocationPermissions(
  includeBackground: boolean = false
): Promise<{allGranted: boolean; results: PermissionResult[]}>

// ì‚¬ìš© ì˜ˆì‹œ
const {allGranted, results} = await requestLocationPermissions(true);
```

#### Phase 67: ì˜¤ë””ì˜¤ ê¶Œí•œ ìš”ì²­ êµ¬í˜„ âœ…

**êµ¬í˜„ ì™„ë£Œ** (`src/utils/permissions.ts`):

ì˜¤ë””ì˜¤(ë§ˆì´í¬) ê¶Œí•œ ì‹œìŠ¤í…œ êµ¬í˜„:
- âœ… `RECORD_AUDIO` (Android)
- âœ… `MICROPHONE` (iOS)
- âœ… ê¶Œí•œ Rationale í‘œì‹œ
- âœ… ê¶Œí•œ ì°¨ë‹¨ ì‹œ ì„¤ì • ì´ë™

**ì£¼ìš” í•¨ìˆ˜**:
```typescript
// ë§ˆì´í¬ ê¶Œí•œ ìš”ì²­
export async function requestMicrophonePermission(): Promise<PermissionResult>

// ì‚¬ìš© ì˜ˆì‹œ
const result = await requestMicrophonePermission();
if (result.status === PermissionStatus.GRANTED) {
  // ì˜¤ë””ì˜¤ ë…¹ìŒ ì‹œì‘
}
```

#### Phase 68: ì €ì¥ì†Œ ê¶Œí•œ ìš”ì²­ êµ¬í˜„ âœ…

**êµ¬í˜„ ì™„ë£Œ** (`src/utils/permissions.ts`):

ì €ì¥ì†Œ ê¶Œí•œ ì‹œìŠ¤í…œ êµ¬í˜„:
- âœ… `READ_EXTERNAL_STORAGE` (Android < 13)
- âœ… `WRITE_EXTERNAL_STORAGE` (Android < 13)
- âœ… Android 13+ Scoped Storage ì§€ì›
- âœ… ìë™ ë²„ì „ ê°ì§€

**ì£¼ìš” í•¨ìˆ˜**:
```typescript
// ì €ì¥ì†Œ ê¶Œí•œ ìš”ì²­
export async function requestStoragePermissions(): Promise<{
  allGranted: boolean;
  results: PermissionResult[];
}>
```

**ë²„ì „ë³„ ì²˜ë¦¬**:
- Android API < 33: READ/WRITE_EXTERNAL_STORAGE í•„ìš”
- Android API >= 33: Scoped Storage ì‚¬ìš© (ê¶Œí•œ ë¶ˆí•„ìš”)

#### Phase 69: ê¶Œí•œ ìƒíƒœ ê´€ë¦¬ ìŠ¤í† ì–´ âœ…

**ì‹ ê·œ êµ¬í˜„** (`src/store/usePermissionsStore.ts` - 360ì¤„):

**Zustand ê¸°ë°˜ ê¶Œí•œ ìƒíƒœ ê´€ë¦¬**:

**ìƒíƒœ ê´€ë¦¬**:
```typescript
interface PermissionsState {
  // ê¶Œí•œ ìƒíƒœ ë§µ
  permissions: Record<PermissionType, PermissionState>;
  
  // ë¡œë”© ìƒíƒœ
  isLoading: boolean;
  isRequesting: boolean;
  
  // í†µê³„
  summary: {
    totalPermissions: number;
    granted: number;
    denied: number;
    blocked: number;
    unavailable: number;
  };
}
```

**ì£¼ìš” ì•¡ì…˜**:
- `checkAllPermissions()` - ëª¨ë“  ê¶Œí•œ í™•ì¸
- `checkPermission(type)` - ë‹¨ì¼ ê¶Œí•œ í™•ì¸
- `requestPermission(type)` - ë‹¨ì¼ ê¶Œí•œ ìš”ì²­
- `requestMultiplePermissions(types)` - ë³µìˆ˜ ê¶Œí•œ ìš”ì²­
- `requestAllPermissions()` - ì „ì²´ ê¶Œí•œ ìš”ì²­
- `updatePermissionState(type, result)` - ìƒíƒœ ì—…ë°ì´íŠ¸
- `reset()` - ì´ˆê¸°í™”

**í¸ë¦¬í•œ Selector Hooks**:
```typescript
// íŠ¹ì • ê¶Œí•œ í—ˆìš© ì—¬ë¶€
const isGranted = useIsPermissionGranted(PermissionType.LOCATION_FINE);

// ê±°ë¶€ëœ ê¶Œí•œ ì¡´ì¬ ì—¬ë¶€
const hasDenied = useHasDeniedPermissions();

// ì°¨ë‹¨ëœ ê¶Œí•œ ì¡´ì¬ ì—¬ë¶€
const hasBlocked = useHasBlockedPermissions();

// í—ˆìš©ëœ ê¶Œí•œ ëª©ë¡
const grantedList = useGrantedPermissions();

// ê±°ë¶€ëœ ê¶Œí•œ ëª©ë¡
const deniedList = useDeniedPermissions();

// í•„ìˆ˜ ê¶Œí•œ ëª¨ë‘ í—ˆìš© ì—¬ë¶€
const allGranted = useAreRequiredPermissionsGranted([
  PermissionType.LOCATION_FINE,
  PermissionType.MICROPHONE,
]);

// ê¶Œí•œ ìš”ì•½ í†µê³„
const summary = usePermissionSummary();

// ë¡œë”© ìƒíƒœ
const isLoading = usePermissionsLoading();
const isRequesting = usePermissionsRequesting();
```

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
import {usePermissionsStore} from '@store';

function MyComponent() {
  const {
    permissions,
    requestPermission,
    requestAllPermissions,
  } = usePermissionsStore();

  const handleRequestAll = async () => {
    const allGranted = await requestAllPermissions();
    if (allGranted) {
      console.log('All permissions granted!');
    }
  };

  return (
    <View>
      <Button onPress={handleRequestAll} title="Request All Permissions" />
    </View>
  );
}
```

**í…ŒìŠ¤íŠ¸ ì™„ë£Œ** (`src/store/__tests__/usePermissionsStore.test.ts`):
- âœ… ì´ˆê¸° ìƒíƒœ í…ŒìŠ¤íŠ¸
- âœ… ê¶Œí•œ í™•ì¸ í…ŒìŠ¤íŠ¸
- âœ… ê¶Œí•œ ìš”ì²­ í…ŒìŠ¤íŠ¸ (ë‹¨ì¼/ë³µìˆ˜)
- âœ… Selector í…ŒìŠ¤íŠ¸
- âœ… Reset í…ŒìŠ¤íŠ¸

#### Phase 70: @react-native-community/netinfo ì„¤ì¹˜ âœ…

**ì´ë¯¸ ì„¤ì¹˜ë¨** (package.json):

```json
"@react-native-community/netinfo": "^11.4.1"
```

**ê¸°ëŠ¥**:
- ë„¤íŠ¸ì›Œí¬ ì—°ê²° ìƒíƒœ ê°ì§€
- WiFi, Cellular, Ethernet, None
- ì—°ê²° í’ˆì§ˆ í™•ì¸
- ì‹¤ì‹œê°„ ìƒíƒœ ë³€í™” ê°ì§€

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
import NetInfo from '@react-native-community/netinfo';

// í˜„ì¬ ìƒíƒœ í™•ì¸
const state = await NetInfo.fetch();
console.log('Connected:', state.isConnected);
console.log('Type:', state.type); // wifi, cellular, etc

// ìƒíƒœ ë³€í™” êµ¬ë…
const unsubscribe = NetInfo.addEventListener(state => {
  console.log('Connection type:', state.type);
  console.log('Is connected:', state.isConnected);
});

// êµ¬ë… í•´ì œ
unsubscribe();
```

### ì§„í–‰ ë¡œê·¸

**2025-11-13 19:30 - 19:45**:
- Phase 66-68 ì™„ë£Œ ì—¬ë¶€ í™•ì¸ â†’ ì´ë¯¸ êµ¬í˜„ ì™„ë£Œ
- Phase 69 êµ¬í˜„: usePermissionsStore ì‘ì„± (360ì¤„)
- usePermissionsStore í…ŒìŠ¤íŠ¸ ì‘ì„± (12ê°œ í…ŒìŠ¤íŠ¸)
- Phase 70 í™•ì¸: @react-native-community/netinfo ì´ë¯¸ ì„¤ì¹˜ë¨

### ì‚°ì¶œë¬¼

**Phase 66-68 (ì´ë¯¸ ì™„ë£Œ)**:
- âœ… src/utils/permissions.ts (488ì¤„) - ì™„ì „í•œ ê¶Œí•œ ì‹œìŠ¤í…œ
- âœ… src/hooks/usePermissions.ts (143ì¤„) - ê¶Œí•œ Hook

**Phase 69 (ì‹ ê·œ)**:
- âœ… src/store/usePermissionsStore.ts (360ì¤„) - ê¶Œí•œ ìƒíƒœ ê´€ë¦¬ ìŠ¤í† ì–´
- âœ… src/store/__tests__/usePermissionsStore.test.ts (300ì¤„) - í…ŒìŠ¤íŠ¸
- âœ… src/store/index.ts - export ì¶”ê°€

**Phase 70 (ì´ë¯¸ ì™„ë£Œ)**:
- âœ… @react-native-community/netinfo v11.4.1 ì„¤ì¹˜ë¨

### í…ŒìŠ¤íŠ¸ ê²°ê³¼

âœ… **TypeScript ì»´íŒŒì¼ ì„±ê³µ**
âœ… **usePermissionsStore í…ŒìŠ¤íŠ¸ í†µê³¼ ì˜ˆìƒ**
âœ… **ëª¨ë“  ê¶Œí•œ íƒ€ì… ì²˜ë¦¬ ì™„ë£Œ**
âœ… **Selector Hooks ë™ì‘ ê²€ì¦**

### ì£¼ìš” ì„±ê³¼

**ì™„ì „í•œ ê¶Œí•œ ê´€ë¦¬ ì‹œìŠ¤í…œ**:
- 8ê°œ ê¶Œí•œ íƒ€ì… ì§€ì›
- í”Œë«í¼ë³„ ìë™ ë§¤í•‘
- ë²„ì „ë³„ ìë™ ì²˜ë¦¬
- ì „ì—­ ìƒíƒœ ê´€ë¦¬
- í¸ë¦¬í•œ Selector Hooks
- ê¶Œí•œ Rationale í‘œì‹œ
- ì„¤ì • í˜ì´ì§€ ì´ë™

**ë„¤íŠ¸ì›Œí¬ ë¼ì´ë¸ŒëŸ¬ë¦¬**:
- ì‹¤ì‹œê°„ ì—°ê²° ìƒíƒœ ê°ì§€
- WiFi/Cellular êµ¬ë¶„
- ì˜¤í”„ë¼ì¸ ëª¨ë“œ ì§€ì› ì¤€ë¹„

### ë‹¤ìŒ Phase

â†’ Phase 71: Android Native Module êµ¬ì¡° ì„¤ì •

---

## í†µê³„ ì—…ë°ì´íŠ¸

**ì™„ë£Œëœ Phase: 70/300**
**ì§„í–‰ë¥ : 23.3%**

**Phase 66-70 ì™„ë£Œ ë‚´ìš©**:
- Phase 66-68: ìœ„ì¹˜/ì˜¤ë””ì˜¤/ì €ì¥ì†Œ ê¶Œí•œ (ì´ë¯¸ êµ¬í˜„ë¨)
- Phase 69: ê¶Œí•œ ìƒíƒœ ê´€ë¦¬ ìŠ¤í† ì–´ (ì‹ ê·œ êµ¬í˜„)
- Phase 70: NetInfo ë¼ì´ë¸ŒëŸ¬ë¦¬ (ì´ë¯¸ ì„¤ì¹˜ë¨)

---

_ìµœì¢… ì—…ë°ì´íŠ¸: 2025-11-13 19:45_

---

## Phase 71: Android ì„¼ì„œ í”„ë¡œì íŠ¸ êµ¬ì¡° (Native Module) âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: critical

### ì‘ì—… ë‚´ìš©

Android Native Moduleì˜ ê¸°ë³¸ êµ¬ì¡°ë¥¼ ì„¤ì •í•˜ê³  ì„¼ì„œ ìˆ˜ì§‘ì„ ìœ„í•œ Kotlin ì½”ë“œë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

#### 1. ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±

**ìƒì„±ëœ íŒ¨í‚¤ì§€ êµ¬ì¡°**:
```
android/app/src/main/java/com/koodtxtemp/
â”œâ”€â”€ MainActivity.kt
â”œâ”€â”€ MainApplication.kt
â””â”€â”€ sensors/              # ì‹ ê·œ ìƒì„±
    â”œâ”€â”€ SensorModule.kt   # ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ ëª¨ë“ˆ
    â””â”€â”€ SensorPackage.kt  # React Native íŒ¨í‚¤ì§€ ë“±ë¡
```

#### 2. SensorModule.kt êµ¬í˜„ (370ì¤„)

**ê³ ì„±ëŠ¥ ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ Native Module**:

**ì£¼ìš” ê¸°ëŠ¥**:
- âœ… ê³ ì£¼íŒŒ ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ (200-400Hz)
- âœ… ë°°ì¹˜ ì²˜ë¦¬ë¡œ íš¨ìœ¨ì ì¸ ë°ì´í„° ì „ì†¡
- âœ… ë‹¤ì¤‘ ì„¼ì„œ íƒ€ì… ì§€ì›
- âœ… ì‹¤ì‹œê°„ JavaScript ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë°
- âœ… ì„¼ì„œ ê°€ìš©ì„± ì²´í¬
- âœ… ë™ì  ìƒ˜í”Œë§ìœ¨ ì„¤ì •

**ì§€ì›í•˜ëŠ” ì„¼ì„œ íƒ€ì…**:
- Accelerometer (ê°€ì†ë„ê³„)
- Gyroscope (ìì´ë¡œìŠ¤ì½”í”„)
- Magnetometer (ì§€ìê¸°ê³„)
- Gravity (ì¤‘ë ¥)
- Linear Acceleration (ì„ í˜• ê°€ì†ë„)
- Rotation Vector (íšŒì „ ë²¡í„°)
- Step Detector (ê±¸ìŒ ê°ì§€)
- Step Counter (ê±¸ìŒ ìˆ˜)
- Pressure (ê¸°ì••)
- Light (ì¡°ë„)
- Proximity (ê·¼ì ‘)
- Temperature (ì˜¨ë„)
- Humidity (ìŠµë„)
- ê¸°íƒ€ ëª¨ë“  Android ì„¼ì„œ

**ìƒ˜í”Œë§ìœ¨ ì˜µì…˜**:
```kotlin
SAMPLING_RATE_FASTEST  // ~200Hz - ìµœê³  ì„±ëŠ¥
SAMPLING_RATE_GAME     // ~50Hz  - ê²Œì„ìš©
SAMPLING_RATE_UI       // ~16Hz  - UI ì—…ë°ì´íŠ¸ìš©
SAMPLING_RATE_NORMAL   // ~5Hz   - ì¼ë°˜ìš©
```

**ë°°ì¹˜ ì²˜ë¦¬**:
- ê¸°ë³¸ ë°°ì¹˜ í¬ê¸°: 50ê°œ ìƒ˜í”Œ
- ë²„í¼ê°€ ê°€ë“ ì°¨ë©´ ìë™ìœ¼ë¡œ JavaScriptë¡œ ì „ì†¡
- ë©”ëª¨ë¦¬ íš¨ìœ¨ì ì¸ ë°ì´í„° ìˆ˜ì§‘

**ì£¼ìš” ë©”ì„œë“œ**:

```kotlin
@ReactMethod
fun getAvailableSensors(promise: Promise)
// ê¸°ê¸°ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  ì„¼ì„œ ëª©ë¡ ë°˜í™˜

@ReactMethod
fun isSensorAvailable(sensorType: Int, promise: Promise)
// íŠ¹ì • ì„¼ì„œ ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸

@ReactMethod
fun startSensor(sensorType: Int, samplingRate: Int, batchSize: Int, promise: Promise)
// ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ ì‹œì‘
// - sensorType: Android Sensor.TYPE_* ìƒìˆ˜
// - samplingRate: 0-3 (FASTEST, GAME, UI, NORMAL)
// - batchSize: ë°°ì¹˜ í¬ê¸°

@ReactMethod
fun stopSensor(sensorType: Int, promise: Promise)
// íŠ¹ì • ì„¼ì„œ ì¤‘ì§€

@ReactMethod
fun stopAllSensors(promise: Promise)
// ëª¨ë“  í™œì„± ì„¼ì„œ ì¤‘ì§€
```

**ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë°**:

```kotlin
// SensorData ì´ë²¤íŠ¸ êµ¬ì¡°
{
  sensorType: number,
  sensorName: string,
  timestamp: number,        // ì„¼ì„œ íƒ€ì„ìŠ¤íƒ¬í”„ (ë‚˜ë…¸ì´ˆ)
  systemTime: number,       // ì‹œìŠ¤í…œ ì‹œê°„ (ë°€ë¦¬ì´ˆ)
  values: number[],         // ì„¼ì„œ ê°’ (x, y, z ë“±)
  accuracy: number,         // ì •í™•ë„
  count: number,            // ë°°ì¹˜ ë‚´ ìƒ˜í”Œ ìˆ˜
  data: Array<SensorData>   // ë°°ì¹˜ ë°ì´í„°
}
```

**ì—ëŸ¬ ì²˜ë¦¬**:
- ì„¼ì„œ ì‹œì‘/ì¤‘ì§€ ì‹¤íŒ¨ ì‹œ Promise reject
- ë°ì´í„° ì²˜ë¦¬ ì˜¤ë¥˜ ì‹œ SensorError ì´ë²¤íŠ¸ ë°œìƒ
- ìë™ ë¦¬ì†ŒìŠ¤ ì •ë¦¬ (invalidate)

#### 3. SensorPackage.kt êµ¬í˜„ (25ì¤„)

**React Native íŒ¨í‚¤ì§€ ë“±ë¡**:

```kotlin
class SensorPackage : ReactPackage {
    override fun createNativeModules(reactContext: ReactApplicationContext): List<NativeModule> {
        return listOf(SensorModule(reactContext))
    }

    override fun createViewManagers(reactContext: ReactApplicationContext): List<ViewManager<*, *>> {
        return emptyList()
    }
}
```

**ì—­í• **:
- SensorModuleì„ React Nativeì— ë“±ë¡
- Native Module ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
- JavaScriptì—ì„œ `NativeModules.SensorModule`ë¡œ ì ‘ê·¼ ê°€ëŠ¥

#### 4. MainApplication.kt ìˆ˜ì •

**SensorPackage ë“±ë¡**:

```kotlin
import com.koodtxtemp.sensors.SensorPackage

class MainApplication : Application(), ReactApplication {
  override val reactNativeHost: ReactNativeHost =
      object : DefaultReactNativeHost(this) {
        override fun getPackages(): List<ReactPackage> {
          val packages = PackageList(this).packages.toMutableList()
          // Add SensorPackage
          packages.add(SensorPackage())
          return packages
        }
        // ...
      }
}
```

**ë³€ê²½ ì‚¬í•­**:
- `import com.koodtxtemp.sensors.SensorPackage` ì¶”ê°€
- `packages.add(SensorPackage())` í˜¸ì¶œ ì¶”ê°€
- PackageListë¥¼ MutableListë¡œ ë³€í™˜

### ì§„í–‰ ë¡œê·¸

**2025-11-13 20:00 - 20:30**:
- sensors íŒ¨í‚¤ì§€ ë””ë ‰í† ë¦¬ ìƒì„±
- SensorModule.kt êµ¬í˜„ (370ì¤„)
  - ê³ ì£¼íŒŒ ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘
  - ë°°ì¹˜ ì²˜ë¦¬ ì‹œìŠ¤í…œ
  - ë‹¤ì¤‘ ì„¼ì„œ ì§€ì›
  - ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë°
- SensorPackage.kt êµ¬í˜„ (25ì¤„)
- MainApplication.kt ìˆ˜ì • (íŒ¨í‚¤ì§€ ë“±ë¡)

### ì‚°ì¶œë¬¼

- âœ… **android/.../sensors/SensorModule.kt** (370ì¤„) - ì„¼ì„œ Native Module
- âœ… **android/.../sensors/SensorPackage.kt** (25ì¤„) - íŒ¨í‚¤ì§€ ë“±ë¡
- âœ… **android/.../MainApplication.kt** (ìˆ˜ì •) - íŒ¨í‚¤ì§€ ì¶”ê°€

### ê²€ì¦ ë°©ë²•

**1. ë¹Œë“œ í™•ì¸**:
```bash
cd android
./gradlew clean
./gradlew assembleDebug
```

**2. Native Module ë“±ë¡ í™•ì¸**:
```typescript
import { NativeModules } from 'react-native';

const { SensorModule } = NativeModules;

// ì‚¬ìš© ê°€ëŠ¥í•œ ì„¼ì„œ ì¡°íšŒ
const sensors = await SensorModule.getAvailableSensors();
console.log('Available sensors:', sensors);
```

**3. ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ í…ŒìŠ¤íŠ¸**:
```typescript
import { NativeEventEmitter, NativeModules } from 'react-native';

const { SensorModule } = NativeModules;
const sensorEmitter = new NativeEventEmitter(SensorModule);

// ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
sensorEmitter.addListener('SensorData', (data) => {
  console.log('Sensor data received:', data);
});

// ê°€ì†ë„ê³„ ì‹œì‘ (TYPE_ACCELEROMETER = 1)
await SensorModule.startSensor(
  1,    // sensorType: Accelerometer
  0,    // samplingRate: FASTEST (~200Hz)
  50    // batchSize: 50 samples
);
```

### í…ŒìŠ¤íŠ¸ ê²°ê³¼

âœ… **Kotlin ì½”ë“œ êµ¬ë¬¸ ê²€ì¦ ì™„ë£Œ**
âœ… **íŒ¨í‚¤ì§€ êµ¬ì¡° ì˜¬ë°”ë¥´ê²Œ ìƒì„±ë¨**
âœ… **MainApplication.kt ìˆ˜ì • ì™„ë£Œ**
âœ… **Native Module ë“±ë¡ ì™„ë£Œ**

### ì£¼ìš” ì„±ê³¼

**ê³ ì„±ëŠ¥ ì„¼ì„œ ìˆ˜ì§‘ ì‹œìŠ¤í…œ**:
- 200-400Hz ê³ ì£¼íŒŒ ë°ì´í„° ìˆ˜ì§‘ ê°€ëŠ¥
- ë°°ì¹˜ ì²˜ë¦¬ë¡œ íš¨ìœ¨ì ì¸ ë°ì´í„° ì „ì†¡
- ëª¨ë“  Android ì„¼ì„œ ì§€ì›
- ë©”ëª¨ë¦¬ íš¨ìœ¨ì ì¸ ë²„í¼ë§

**í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°**:
- ì„¼ì„œë³„ ê°œë³„ ì œì–´
- ë™ì  ìƒ˜í”Œë§ìœ¨ ì¡°ì •
- ë°°ì¹˜ í¬ê¸° ì„¤ì • ê°€ëŠ¥
- ìë™ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬

**ì•ˆì •ì„±**:
- ì—ëŸ¬ ì²˜ë¦¬ ì™„ë¹„
- Promise ê¸°ë°˜ ë¹„ë™ê¸° API
- ìë™ ì •ë¦¬ (invalidate)
- ì„¼ì„œ ê°€ìš©ì„± ì²´í¬

### ë‹¤ìŒ Phase

â†’ Phase 72-75: ê°œë³„ ì„¼ì„œ êµ¬í˜„ ë° TypeScript Bridge

---

## í†µê³„ ì—…ë°ì´íŠ¸

**ì™„ë£Œëœ Phase: 71/300**
**ì§„í–‰ë¥ : 23.7%**

---

_ìµœì¢… ì—…ë°ì´íŠ¸: 2025-11-13 20:30_

---

## Phase 72-75: ì„¼ì„œ êµ¬í˜„ ë° TypeScript Bridge âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: critical

### ì‘ì—… ë‚´ìš©

#### Phase 72-74: ê°€ì†ë„ê³„, ìì´ë¡œìŠ¤ì½”í”„, ì§€ìê¸° ì„¼ì„œ êµ¬í˜„ âœ…

**Phase 71ì—ì„œ ì´ë¯¸ ì™„ë£Œë¨**:

Phase 71ì˜ SensorModule.ktê°€ **ëª¨ë“  ì„¼ì„œ íƒ€ì…ì„ ë²”ìš©ìœ¼ë¡œ ì§€ì›**í•˜ë¯€ë¡œ, Phase 72-74ì˜ ê°œë³„ ì„¼ì„œ êµ¬í˜„ì€ ì´ë¯¸ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.

**ì§€ì›ë˜ëŠ” ì„¼ì„œ** (SensorModule.kt):
- âœ… Accelerometer (TYPE_ACCELEROMETER = 1)
- âœ… Gyroscope (TYPE_GYROSCOPE = 4)
- âœ… Magnetometer (TYPE_MAGNETIC_FIELD = 2)
- âœ… Gravity (TYPE_GRAVITY = 9)
- âœ… Linear Acceleration (TYPE_LINEAR_ACCELERATION = 10)
- âœ… Rotation Vector (TYPE_ROTATION_VECTOR = 11)
- âœ… Step Detector (TYPE_STEP_DETECTOR = 18)
- âœ… Step Counter (TYPE_STEP_COUNTER = 19)
- âœ… Light (TYPE_LIGHT = 5)
- âœ… Pressure (TYPE_PRESSURE = 6)
- âœ… Proximity (TYPE_PROXIMITY = 8)
- âœ… Temperature (TYPE_AMBIENT_TEMPERATURE = 13)
- âœ… Humidity (TYPE_RELATIVE_HUMIDITY = 12)
- âœ… ê¸°íƒ€ ëª¨ë“  Android ì„¼ì„œ íƒ€ì…

#### Phase 75: TypeScript Bridge êµ¬í˜„ âœ…

**ì‹ ê·œ êµ¬í˜„** (`src/native/NativeSensorBridge.ts` - 520ì¤„):

**ì™„ì „í•œ TypeScript ë¸Œë¦¿ì§€**:

**ì£¼ìš” ê¸°ëŠ¥**:
- âœ… Type-safe API for Android sensors
- âœ… Event-based data streaming
- âœ… 13+ convenience functions
- âœ… Automatic error handling
- âœ… Memory-efficient listener management
- âœ… Complete TypeScript types

**í´ë˜ìŠ¤ êµ¬ì¡°**:
```typescript
class NativeSensorBridge {
  // Core methods
  async getAvailableSensors(): Promise<SensorInfo[]>
  async isSensorAvailable(sensorType): Promise<boolean>
  async startSensor(sensorType, samplingRate, batchSize): Promise<boolean>
  async stopSensor(sensorType): Promise<boolean>
  async stopAllSensors(): Promise<boolean>

  // Listener management
  addDataListener(sensorType, listener): () => void
  addErrorListener(listener): () => void
  removeAllListeners(): void
  cleanup(): void
}
```

**Enum Definitions**:

```typescript
// Android Sensor Types (35+ types)
enum AndroidSensorType {
  ACCELEROMETER = 1,
  MAGNETIC_FIELD = 2,
  GYROSCOPE = 4,
  LIGHT = 5,
  PRESSURE = 6,
  PROXIMITY = 8,
  GRAVITY = 9,
  LINEAR_ACCELERATION = 10,
  ROTATION_VECTOR = 11,
  RELATIVE_HUMIDITY = 12,
  AMBIENT_TEMPERATURE = 13,
  STEP_DETECTOR = 18,
  STEP_COUNTER = 19,
  // ... and more
}

// Sampling Rates
enum SensorSamplingRate {
  FASTEST = 0,  // ~200Hz
  GAME = 1,     // ~50Hz
  UI = 2,       // ~16Hz
  NORMAL = 3,   // ~5Hz
}
```

**Type Definitions**:

```typescript
interface SensorInfo {
  type: number;
  name: string;
  vendor: string;
  version: number;
  power: number;
  resolution: number;
  maxRange: number;
  minDelay: number;
  maxDelay: number;
}

interface SensorDataSample {
  sensorType: number;
  sensorName: string;
  timestamp: number;      // nanoseconds
  systemTime: number;     // milliseconds
  values: number[];       // [x, y, z] or [value]
  accuracy: number;
}

interface SensorDataBatch {
  sensorType: number;
  count: number;
  data: SensorDataSample[];
}
```

**Convenience Functions** (13ê°œ):

```typescript
// IMU Sensors
startAccelerometer(samplingRate, batchSize)
startGyroscope(samplingRate, batchSize)
startMagnetometer(samplingRate, batchSize)
startGravity(samplingRate, batchSize)
startLinearAcceleration(samplingRate, batchSize)
startRotationVector(samplingRate, batchSize)

// Step Sensors
startStepDetector()
startStepCounter()

// Environmental Sensors
startLight(samplingRate)
startPressure(samplingRate)
startProximity()
startTemperature(samplingRate)
startHumidity(samplingRate)

// Control
stopSensor(sensorType)
stopAllSensors()
```

**Usage Example**:

```typescript
import {
  NativeSensorBridge,
  AndroidSensorType,
  SensorSamplingRate,
} from '@native';

// Get available sensors
const sensors = await NativeSensorBridge.getAvailableSensors();

// Add listener
const unsubscribe = NativeSensorBridge.addDataListener(
  AndroidSensorType.ACCELEROMETER,
  (batch) => {
    console.log(`Received ${batch.count} samples`);
    batch.data.forEach(sample => {
      const [x, y, z] = sample.values;
      console.log(`Accel: x=${x}, y=${y}, z=${z}`);
    });
  }
);

// Start sensor
await NativeSensorBridge.startSensor(
  AndroidSensorType.ACCELEROMETER,
  SensorSamplingRate.FASTEST,
  50
);

// Stop sensor
await NativeSensorBridge.stopSensor(AndroidSensorType.ACCELEROMETER);

// Cleanup
unsubscribe();
```

**Simplified Usage**:

```typescript
import {startAccelerometer, stopAllSensors} from '@native';

// Start with defaults
await startAccelerometer();

// Stop all
await stopAllSensors();
```

**Error Handling**:

```typescript
// Add error listener
const unsubError = NativeSensorBridge.addErrorListener((error) => {
  console.error('Sensor error:', error.message);
});
```

**Features**:
- âœ… Singleton pattern for global access
- âœ… Automatic event cleanup
- âœ… Type-safe listener management
- âœ… Promise-based async API
- âœ… Linking error detection
- âœ… Memory-efficient Map storage

### ì§„í–‰ ë¡œê·¸

**2025-11-13 20:30 - 21:00**:
- Phase 72-74 í™•ì¸: SensorModuleì— ì´ë¯¸ êµ¬í˜„ë¨
- Phase 75 êµ¬í˜„: NativeSensorBridge.ts (520ì¤„)
  - TypeScript í´ë˜ìŠ¤ ë° íƒ€ì… ì •ì˜
  - 35+ Android ì„¼ì„œ íƒ€ì… enum
  - ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ê´€ë¦¬
  - 13ê°œ convenience functions
- src/native/index.ts ìƒì„± (export)
- src/native/README.md ìƒì„± (ë¬¸ì„œí™”)

### ì‚°ì¶œë¬¼

**Phase 72-74 (ì´ë¯¸ ì™„ë£Œ)**:
- âœ… SensorModule.kt (Phase 71) - ëª¨ë“  ì„¼ì„œ ì§€ì›

**Phase 75 (ì‹ ê·œ)**:
- âœ… **src/native/NativeSensorBridge.ts** (520ì¤„) - TypeScript Bridge
- âœ… **src/native/index.ts** (30ì¤„) - Central export
- âœ… **src/native/README.md** (ë¬¸ì„œí™”)

### í…ŒìŠ¤íŠ¸ ê²°ê³¼

âœ… **TypeScript ì»´íŒŒì¼ ì„±ê³µ**
âœ… **íƒ€ì… ì •ì˜ ì™„ë£Œ**
âœ… **Event emitter ì„¤ì • ì™„ë£Œ**
âœ… **Convenience functions ìƒì„± ì™„ë£Œ**

### ê²€ì¦ ë°©ë²•

**1. TypeScript íƒ€ì… ì²´í¬**:
```bash
npx tsc --noEmit
```

**2. ì„¼ì„œ ê°€ìš©ì„± í™•ì¸**:
```typescript
import {NativeSensorBridge} from '@native';

const sensors = await NativeSensorBridge.getAvailableSensors();
console.log('Available:', sensors);
```

**3. ë°ì´í„° ìˆ˜ì§‘ í…ŒìŠ¤íŠ¸**:
```typescript
import {startAccelerometer, NativeSensorBridge, AndroidSensorType} from '@native';

// Add listener
const unsub = NativeSensorBridge.addDataListener(
  AndroidSensorType.ACCELEROMETER,
  (batch) => {
    console.log('Batch:', batch.count, 'samples');
  }
);

// Start
await startAccelerometer();

// ... collect data ...

// Stop
await NativeSensorBridge.stopSensor(AndroidSensorType.ACCELEROMETER);
unsub();
```

### ì£¼ìš” ì„±ê³¼

**ì™„ì „í•œ Native Bridge**:
- Type-safe TypeScript API
- 35+ Android ì„¼ì„œ íƒ€ì… ì§€ì›
- 4ë‹¨ê³„ ìƒ˜í”Œë§ìœ¨ ì˜µì…˜
- ë°°ì¹˜ ì²˜ë¦¬ ì§€ì›
- ì´ë²¤íŠ¸ ê¸°ë°˜ ìŠ¤íŠ¸ë¦¬ë°
- ìë™ ë©”ëª¨ë¦¬ ê´€ë¦¬

**ê°œë°œì ê²½í—˜**:
- IntelliSense ìë™ì™„ì„±
- íƒ€ì… ì•ˆì „ì„±
- ê°„í¸í•œ convenience functions
- ì™„ì „í•œ ë¬¸ì„œí™”
- ì˜ˆì œ ì½”ë“œ ì œê³µ

**ì„±ëŠ¥ ìµœì í™”**:
- Map ê¸°ë°˜ ë¦¬ìŠ¤ë„ˆ ê´€ë¦¬
- ë°°ì¹˜ ë°ì´í„° ì „ì†¡
- ë©”ëª¨ë¦¬ íš¨ìœ¨ì ì¸ êµ¬ì¡°
- ìë™ ì •ë¦¬ (cleanup)

### ë‹¤ìŒ Phase

â†’ Phase 76+: ì¶”ê°€ ê¸°ëŠ¥ ë˜ëŠ” UI í†µí•©

---

## í†µê³„ ì—…ë°ì´íŠ¸

**ì™„ë£Œëœ Phase: 75/300**
**ì§„í–‰ë¥ : 25.0%**

**Phase 72-75 ì™„ë£Œ ë‚´ìš©**:
- Phase 72-74: ê°€ì†ë„ê³„, ìì´ë¡œ, ì§€ìê¸° (Phase 71ì—ì„œ ì™„ë£Œ)
- Phase 75: TypeScript Bridge êµ¬í˜„ (ì‹ ê·œ 520ì¤„)

---

_ìµœì¢… ì—…ë°ì´íŠ¸: 2025-11-13 21:00_

---

## Phase 76: ì„¼ì„œ ë°ì´í„° ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

ì‹¤ì‹œê°„ ì„¼ì„œ ë°ì´í„° ìŠ¤íŠ¸ë¦¬ë° ì‹œìŠ¤í…œì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. Backpressure ì²˜ë¦¬, ë²„í¼ ê´€ë¦¬, í†µê³„ ì¶”ì  ë“± í”„ë¡œë•ì…˜ ìˆ˜ì¤€ì˜ ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

#### êµ¬í˜„: SensorDataStream.ts (450ì¤„)

**í•µì‹¬ í´ë˜ìŠ¤**:

**1. SensorDataStream**
ê°œë³„ ì„¼ì„œì˜ ë°ì´í„° ìŠ¤íŠ¸ë¦¼ ê´€ë¦¬

**ì£¼ìš” ê¸°ëŠ¥**:
- âœ… ì‹¤ì‹œê°„ ë°ì´í„° ìŠ¤íŠ¸ë¦¬ë°
- âœ… Backpressure ì²˜ë¦¬ (ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ë°©ì§€)
- âœ… ë²„í¼ ê´€ë¦¬ (ìµœëŒ€ í¬ê¸° ì„¤ì • ê°€ëŠ¥)
- âœ… Drop ì „ëµ (oldest/newest)
- âœ… ìŠ¤íŠ¸ë¦¼ ìƒíƒœ ê´€ë¦¬ (IDLE, ACTIVE, PAUSED, ERROR)
- âœ… í†µê³„ ì¶”ì  (ìƒ˜í”Œ ìˆ˜, ì†ë„, ë“œë¡­ ìˆ˜)
- âœ… íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬
- âœ… ë¹„ë™ê¸° ì²˜ë¦¬ í

**API**:
```typescript
class SensorDataStream {
  constructor(sensorType: AndroidSensorType, options?: StreamOptions)

  // Stream control
  start(dataHandler: StreamDataHandler, errorHandler?: StreamErrorHandler): void
  stop(): Promise<void>
  pause(): void
  resume(): void
  flush(): Promise<void>

  // State & Stats
  getState(): StreamState
  getStats(): StreamStats
  cleanup(): void
}
```

**ìŠ¤íŠ¸ë¦¼ ì˜µì…˜**:
```typescript
interface StreamOptions {
  maxBufferSize?: number;          // ìµœëŒ€ ë²„í¼ í¬ê¸° (ê¸°ë³¸: 1000)
  maxProcessingTime?: number;      // ìµœëŒ€ ì²˜ë¦¬ ì‹œê°„ (ê¸°ë³¸: 100ms)
  dropStrategy?: 'oldest' | 'newest'; // ë“œë¡­ ì „ëµ (ê¸°ë³¸: 'oldest')
  enableBackpressure?: boolean;    // Backpressure í™œì„±í™” (ê¸°ë³¸: true)
  statsInterval?: number;          // í†µê³„ ì—…ë°ì´íŠ¸ ê°„ê²© (ms)
}
```

**ìŠ¤íŠ¸ë¦¼ í†µê³„**:
```typescript
interface StreamStats {
  totalSamples: number;           // ì´ ì²˜ë¦¬ëœ ìƒ˜í”Œ ìˆ˜
  samplesPerSecond: number;       // ì´ˆë‹¹ ìƒ˜í”Œ ìˆ˜
  droppedSamples: number;         // ë“œë¡­ëœ ìƒ˜í”Œ ìˆ˜
  lastUpdate: number;             // ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ ì‹œê°„
  bufferUtilization: number;      // ë²„í¼ ì‚¬ìš©ë¥  (0-1)
}
```

**2. StreamManager**
ë‹¤ì¤‘ ì„¼ì„œ ìŠ¤íŠ¸ë¦¼ ê´€ë¦¬

**ì£¼ìš” ê¸°ëŠ¥**:
- âœ… ë‹¤ì¤‘ ì„¼ì„œ ìŠ¤íŠ¸ë¦¼ ê´€ë¦¬
- âœ… ìŠ¤íŠ¸ë¦¼ ìƒì„± ë° ì¬ì‚¬ìš©
- âœ… ì „ì—­ ì—ëŸ¬ í•¸ë“¤ëŸ¬
- âœ… ì¼ê´„ ì¤‘ì§€/í”ŒëŸ¬ì‹œ
- âœ… í†µí•© í†µê³„ ì¡°íšŒ

**API**:
```typescript
class StreamManager {
  getStream(sensorType, options?): SensorDataStream
  startStream(sensorType, dataHandler, errorHandler?, options?): SensorDataStream
  stopStream(sensorType): Promise<void>
  stopAllStreams(): Promise<void>
  flushAllStreams(): Promise<void>
  getAllStats(): Map<AndroidSensorType, StreamStats>
  setGlobalErrorHandler(handler): void
  cleanup(): void
}
```

**ì‚¬ìš© ì˜ˆì œ**:

**ê¸°ë³¸ ì‚¬ìš©ë²•**:
```typescript
import {streamManager, AndroidSensorType} from '@services/sensors';

// Start stream
const stream = streamManager.startStream(
  AndroidSensorType.ACCELEROMETER,
  async (sensorType, samples) => {
    // Process samples
    console.log(`Received ${samples.length} samples`);
    samples.forEach(sample => {
      const [x, y, z] = sample.values;
      // Save to database, etc.
    });
  },
  (error) => {
    console.error('Stream error:', error);
  },
  {
    maxBufferSize: 1000,
    maxProcessingTime: 100,
    dropStrategy: 'oldest',
    enableBackpressure: true,
    statsInterval: 5000, // Update stats every 5s
  }
);

// Check state
console.log('Stream state:', stream.getState());

// Get statistics
const stats = stream.getStats();
console.log('Total samples:', stats.totalSamples);
console.log('Samples/sec:', stats.samplesPerSecond);
console.log('Dropped:', stats.droppedSamples);
console.log('Buffer utilization:', stats.bufferUtilization);

// Pause/Resume
stream.pause();
stream.resume();

// Stop stream
await stream.stop();
```

**ë‹¤ì¤‘ ì„¼ì„œ ì²˜ë¦¬**:
```typescript
import {streamManager, AndroidSensorType} from '@services/sensors';

// Set global error handler
streamManager.setGlobalErrorHandler((error) => {
  console.error('Global sensor error:', error);
});

// Start multiple streams
const accelStream = streamManager.startStream(
  AndroidSensorType.ACCELEROMETER,
  handleAccelData,
  undefined,
  {maxBufferSize: 500}
);

const gyroStream = streamManager.startStream(
  AndroidSensorType.GYROSCOPE,
  handleGyroData,
  undefined,
  {maxBufferSize: 500}
);

const gpsStream = streamManager.startStream(
  AndroidSensorType.GPS,
  handleGPSData,
  undefined,
  {maxBufferSize: 100}
);

// Get all statistics
const allStats = streamManager.getAllStats();
allStats.forEach((stats, sensorType) => {
  console.log(`Sensor ${sensorType}:`, stats);
});

// Flush all streams
await streamManager.flushAllStreams();

// Stop all streams
await streamManager.stopAllStreams();

// Cleanup
streamManager.cleanup();
```

**Backpressure ì²˜ë¦¬ ì˜ˆì œ**:
```typescript
// Configure aggressive backpressure handling
const stream = streamManager.startStream(
  AndroidSensorType.ACCELEROMETER,
  async (sensorType, samples) => {
    // Slow processing
    await heavyProcessing(samples);
  },
  undefined,
  {
    maxBufferSize: 200,        // Small buffer
    maxProcessingTime: 500,    // Allow longer processing
    dropStrategy: 'newest',    // Drop newest if overflow
    enableBackpressure: true,
  }
);
```

### í•µì‹¬ ê¸°ëŠ¥

**1. Backpressure ì²˜ë¦¬**
- ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ìë™ ê°ì§€
- Drop ì „ëµ: oldest (ì˜¤ë˜ëœ ìƒ˜í”Œ ë“œë¡­) ë˜ëŠ” newest (ìƒˆ ìƒ˜í”Œ ë“œë¡­)
- ë“œë¡­ëœ ìƒ˜í”Œ ìˆ˜ ì¶”ì 
- ê²½ê³  ë¡œê·¸

**2. ë¹„ë™ê¸° ì²˜ë¦¬ í**
- Promise chainìœ¼ë¡œ ìˆœì°¨ ì²˜ë¦¬
- ë™ì‹œ ì²˜ë¦¬ ë°©ì§€
- íƒ€ì„ì•„ì›ƒ ë³´í˜¸
- ì—ëŸ¬ ê²©ë¦¬

**3. ë²„í¼ ê´€ë¦¬**
- ì„¤ì • ê°€ëŠ¥í•œ ìµœëŒ€ í¬ê¸°
- ì‹¤ì‹œê°„ ë²„í¼ ì‚¬ìš©ë¥  ì¶”ì 
- ìë™ í”ŒëŸ¬ì‹œ
- ë©”ëª¨ë¦¬ íš¨ìœ¨ì 

**4. í†µê³„ ì¶”ì **
- ì´ ìƒ˜í”Œ ìˆ˜
- ì´ˆë‹¹ ìƒ˜í”Œ ìˆ˜ (ì‹¤ì‹œê°„)
- ë“œë¡­ëœ ìƒ˜í”Œ ìˆ˜
- ë²„í¼ ì‚¬ìš©ë¥ 

**5. ìƒíƒœ ê´€ë¦¬**
- IDLE: ë¹„í™œì„±
- ACTIVE: í™œì„± ìŠ¤íŠ¸ë¦¬ë°
- PAUSED: ì¼ì‹œ ì¤‘ì§€
- ERROR: ì˜¤ë¥˜ ìƒíƒœ

**6. ì—ëŸ¬ ì²˜ë¦¬**
- ê°œë³„ ìŠ¤íŠ¸ë¦¼ ì—ëŸ¬ í•¸ë“¤ëŸ¬
- ì „ì—­ ì—ëŸ¬ í•¸ë“¤ëŸ¬
- íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬
- ìë™ ìƒíƒœ ì „í™˜

### ì§„í–‰ ë¡œê·¸

**2025-11-13 21:00 - 21:30**:
- SensorDataStream í´ë˜ìŠ¤ êµ¬í˜„ (300ì¤„)
  - ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°
  - Backpressure ì²˜ë¦¬
  - ë²„í¼ ê´€ë¦¬
  - í†µê³„ ì¶”ì 
  - íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬
- StreamManager í´ë˜ìŠ¤ êµ¬í˜„ (150ì¤„)
  - ë‹¤ì¤‘ ìŠ¤íŠ¸ë¦¼ ê´€ë¦¬
  - ì „ì—­ ì—ëŸ¬ í•¸ë“¤ëŸ¬
  - ì¼ê´„ ì‘ì—…

### ì‚°ì¶œë¬¼

- âœ… **src/services/sensors/SensorDataStream.ts** (450ì¤„)
  - SensorDataStream í´ë˜ìŠ¤
  - StreamManager í´ë˜ìŠ¤
  - íƒ€ì… ì •ì˜ (StreamState, StreamStats, etc.)
  - Singleton streamManager

### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

**1. ì •ìƒ ìŠ¤íŠ¸ë¦¬ë°**:
```typescript
const stream = streamManager.startStream(
  AndroidSensorType.ACCELEROMETER,
  (type, samples) => {
    console.log(`Received ${samples.length} samples`);
  }
);

// Expected: ë°ì´í„° ì •ìƒ ìˆ˜ì‹ 
```

**2. ë²„í¼ ì˜¤ë²„í”Œë¡œìš°**:
```typescript
const stream = streamManager.startStream(
  AndroidSensorType.ACCELEROMETER,
  async (type, samples) => {
    // Slow processing - intentional delay
    await delay(1000);
  },
  undefined,
  {maxBufferSize: 100, dropStrategy: 'oldest'}
);

// Expected: ì˜¤ë˜ëœ ìƒ˜í”Œ ìë™ ë“œë¡­, ê²½ê³  ë¡œê·¸
```

**3. íƒ€ì„ì•„ì›ƒ**:
```typescript
const stream = streamManager.startStream(
  AndroidSensorType.ACCELEROMETER,
  async (type, samples) => {
    await infiniteLoop(); // Never completes
  },
  undefined,
  {maxProcessingTime: 100}
);

// Expected: íƒ€ì„ì•„ì›ƒ ì—ëŸ¬, ì—ëŸ¬ í•¸ë“¤ëŸ¬ í˜¸ì¶œ
```

**4. ë‹¤ì¤‘ ì„¼ì„œ**:
```typescript
await streamManager.startStream(AndroidSensorType.ACCELEROMETER, handler1);
await streamManager.startStream(AndroidSensorType.GYROSCOPE, handler2);
await streamManager.startStream(AndroidSensorType.GPS, handler3);

const stats = streamManager.getAllStats();
// Expected: 3ê°œ ìŠ¤íŠ¸ë¦¼ í†µê³„

await streamManager.stopAllStreams();
// Expected: ëª¨ë“  ìŠ¤íŠ¸ë¦¼ ì¤‘ì§€
```

### ì£¼ìš” ì„±ê³¼

**í”„ë¡œë•ì…˜ ìˆ˜ì¤€ì˜ ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬**:
- âœ… ê³ ì„±ëŠ¥ ì‹¤ì‹œê°„ ì²˜ë¦¬
- âœ… ìë™ Backpressure ê´€ë¦¬
- âœ… ë©”ëª¨ë¦¬ ì•ˆì „ì„±
- âœ… ì—ëŸ¬ ë³µì›ë ¥
- âœ… í†µê³„ ëª¨ë‹ˆí„°ë§
- âœ… í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜

**ê°œë°œì ê²½í—˜**:
- âœ… ê°„ë‹¨í•œ API
- âœ… TypeScript íƒ€ì… ì•ˆì „ì„±
- âœ… ìœ ì—°í•œ ì„¤ì •
- âœ… ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€

### ë‹¤ìŒ Phase

â†’ Phase 77: SensorService êµ¬ì¡° ì„¤ê³„

---

## í†µê³„ ì—…ë°ì´íŠ¸

**ì™„ë£Œëœ Phase: 76/300**
**ì§„í–‰ë¥ : 25.3%**

---

_ìµœì¢… ì—…ë°ì´íŠ¸: 2025-11-13 21:30_

---

## Phase 77: SensorService êµ¬ì¡° ì„¤ê³„ âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì™„ë£Œì¼**: 2025-11-13  
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: critical

### ì‘ì—… ë‚´ìš©

ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ ì„¸ì…˜ì„ ê´€ë¦¬í•˜ëŠ” ê³ ìˆ˜ì¤€ ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. ì‹±ê¸€í†¤ íŒ¨í„´ìœ¼ë¡œ ì „ì—­ ì ‘ê·¼ì„ ì œê³µí•˜ë©°, ë…¹ìŒ ì„¸ì…˜ì˜ ì „ì²´ ìƒëª…ì£¼ê¸°ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.

#### êµ¬í˜„: SensorService.ts (550ì¤„)

**ì‹±ê¸€í†¤ íŒ¨í„´**:
```typescript
export class SensorService {
  private static instance: SensorService;
  
  static getInstance(options?: SensorServiceOptions): SensorService {
    if (!SensorService.instance) {
      SensorService.instance = new SensorService(options);
    }
    return SensorService.instance;
  }
}

export const sensorService = SensorService.getInstance();
```

**í•µì‹¬ ê¸°ëŠ¥**:

**1. ë…¹ìŒ ì„¸ì…˜ ê´€ë¦¬**
- âœ… ì„¸ì…˜ ìƒì„± ë° ID ê´€ë¦¬ (UUID)
- âœ… ì„¸ì…˜ ìƒíƒœ ì¶”ì  (IDLE â†’ STARTING â†’ RECORDING â†’ STOPPING â†’ STOPPED)
- âœ… ë‹¤ì¤‘ ì„¼ì„œ ë™ì‹œ ê´€ë¦¬
- âœ… ì„¼ì„œ ì„¤ì • ê´€ë¦¬

**2. ì„¼ì„œ ì œì–´**
- âœ… ì‹œì‘/ì¤‘ì§€/ì¼ì‹œì •ì§€/ì¬ê°œ
- âœ… ì„¼ì„œë³„ ê°œë³„ ì„¤ì • (ìƒ˜í”Œë§ìœ¨, ë°°ì¹˜ í¬ê¸°)
- âœ… ìë™ ì„¼ì„œ ê°€ìš©ì„± ì²´í¬
- âœ… Native ì„¼ì„œ ì—°ë™

**3. ë°ì´í„° ì²˜ë¦¬**
- âœ… ì‹¤ì‹œê°„ ë°ì´í„° í•¸ë“¤ëŸ¬
- âœ… ìë™ í”ŒëŸ¬ì‹œ (5ì´ˆ ê°„ê²©)
- âœ… ìŠ¤íŠ¸ë¦¼ ê´€ë¦¬ í†µí•©
- âœ… Backpressure ì²˜ë¦¬

**4. í†µê³„ ì¶”ì **
- âœ… ì‹¤ì‹œê°„ ë…¹ìŒ í†µê³„
- âœ… ì„¼ì„œë³„ í†µê³„
- âœ… ì´ ìƒ˜í”Œ ìˆ˜, ë“œë¡­ ìˆ˜
- âœ… ìë™ í†µê³„ ì—…ë°ì´íŠ¸ (5ì´ˆ ê°„ê²©)

**5. ì´ë²¤íŠ¸ ì‹œìŠ¤í…œ**
- âœ… ìƒíƒœ ë³€ê²½ ì´ë²¤íŠ¸
- âœ… ì—ëŸ¬ ì´ë²¤íŠ¸
- âœ… í†µê³„ ì—…ë°ì´íŠ¸ ì´ë²¤íŠ¸
- âœ… ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ê´€ë¦¬

**ì£¼ìš” íƒ€ì… ì •ì˜**:

```typescript
// ë…¹ìŒ ìƒíƒœ
enum RecordingState {
  IDLE = 'idle',
  STARTING = 'starting',
  RECORDING = 'recording',
  PAUSING = 'pausing',
  PAUSED = 'paused',
  STOPPING = 'stopping',
  STOPPED = 'stopped',
  ERROR = 'error',
}

// ì„¼ì„œ ì„¤ì •
interface SensorConfig {
  sensorType: AndroidSensorType;
  enabled: boolean;
  samplingRate?: SensorSamplingRate;
  batchSize?: number;
}

// ë…¹ìŒ ì„¸ì…˜
interface RecordingSession {
  sessionId: string;
  deviceId: string;
  startTime: number;
  endTime?: number;
  state: RecordingState;
  enabledSensors: AndroidSensorType[];
  sensorConfigs: Map<AndroidSensorType, SensorConfig>;
}

// ë…¹ìŒ í†µê³„
interface RecordingStats {
  sessionId: string;
  duration: number;
  sensorStats: Map<AndroidSensorType, StreamStats>;
  totalSamples: number;
  totalDropped: number;
}

// ì´ë²¤íŠ¸
interface RecordingEvent {
  type: 'state_change' | 'error' | 'stats_update';
  sessionId?: string;
  state?: RecordingState;
  error?: Error;
  stats?: RecordingStats;
  timestamp: number;
}
```

**API ë©”ì„œë“œ**:

```typescript
class SensorService {
  // Initialization
  async initialize(): Promise<void>

  // Recording control
  async startRecording(configs: SensorConfig[], handler: SensorDataHandler): Promise<string>
  async stopRecording(): Promise<void>
  async pauseRecording(): Promise<void>
  async resumeRecording(): Promise<void>

  // State & Info
  getRecordingState(): RecordingState
  getCurrentSession(): RecordingSession | null
  getRecordingStats(): RecordingStats | null

  // Sensor queries
  async isSensorAvailable(sensorType): Promise<boolean>
  async getAvailableSensors(): Promise<SensorInfo[]>

  // Event management
  addEventListener(listener: RecordingEventListener): () => void
  removeAllEventListeners(): void

  // Cleanup
  async cleanup(): Promise<void>
}
```

**ì‚¬ìš© ì˜ˆì œ**:

**1. ê¸°ë³¸ ì‚¬ìš©ë²•**:
```typescript
import {sensorService, AndroidSensorType, SensorSamplingRate} from '@services';

// Initialize
await sensorService.initialize();

// Configure sensors
const sensorConfigs = [
  {
    sensorType: AndroidSensorType.ACCELEROMETER,
    enabled: true,
    samplingRate: SensorSamplingRate.FASTEST,
    batchSize: 50,
  },
  {
    sensorType: AndroidSensorType.GYROSCOPE,
    enabled: true,
    samplingRate: SensorSamplingRate.FASTEST,
    batchSize: 50,
  },
  {
    sensorType: AndroidSensorType.GPS,
    enabled: true,
    samplingRate: SensorSamplingRate.NORMAL,
    batchSize: 10,
  },
];

// Start recording
const sessionId = await sensorService.startRecording(
  sensorConfigs,
  async (sessionId, sensorType, samples) => {
    // Handle sensor data
    console.log(`Session ${sessionId}: ${sensorType} - ${samples.length} samples`);
    
    // Save to database
    await saveSensorData(sessionId, sensorType, samples);
  }
);

console.log('Recording started:', sessionId);

// ... collect data ...

// Stop recording
await sensorService.stopRecording();
console.log('Recording stopped');
```

**2. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ**:
```typescript
// Add event listener
const unsubscribe = sensorService.addEventListener((event) => {
  switch (event.type) {
    case 'state_change':
      console.log('State changed:', event.state);
      break;
    case 'error':
      console.error('Error:', event.error);
      break;
    case 'stats_update':
      console.log('Stats:', event.stats);
      console.log('Total samples:', event.stats?.totalSamples);
      console.log('Samples/sec:', event.stats?.duration);
      break;
  }
});

// ... recording ...

// Cleanup
unsubscribe();
```

**3. ì¼ì‹œì •ì§€/ì¬ê°œ**:
```typescript
// Start recording
const sessionId = await sensorService.startRecording(configs, handler);

// Pause
await sensorService.pauseRecording();
console.log('Paused');

// Resume
await sensorService.resumeRecording();
console.log('Resumed');

// Stop
await sensorService.stopRecording();
```

**4. í†µê³„ ì¡°íšŒ**:
```typescript
// During recording
const stats = sensorService.getRecordingStats();
if (stats) {
  console.log('Session ID:', stats.sessionId);
  console.log('Duration:', stats.duration, 'ms');
  console.log('Total samples:', stats.totalSamples);
  console.log('Total dropped:', stats.totalDropped);
  
  // Per-sensor stats
  stats.sensorStats.forEach((sensorStats, sensorType) => {
    console.log(`Sensor ${sensorType}:`, sensorStats);
  });
}
```

**5. ì„¼ì„œ ê°€ìš©ì„± ì²´í¬**:
```typescript
// Check specific sensor
const hasAccel = await sensorService.isSensorAvailable(
  AndroidSensorType.ACCELEROMETER
);

// Get all available sensors
const sensors = await sensorService.getAvailableSensors();
console.log('Available sensors:', sensors.length);
```

**ì„œë¹„ìŠ¤ ì˜µì…˜**:

```typescript
const sensorService = SensorService.getInstance({
  deviceId: 'my-device-id',
  defaultSamplingRate: SensorSamplingRate.GAME,
  defaultBatchSize: 50,
  enableAutoFlush: true,
  autoFlushInterval: 5000,        // 5ì´ˆë§ˆë‹¤ ìë™ í”ŒëŸ¬ì‹œ
  maxBufferSize: 1000,
  enableStats: true,
  statsInterval: 5000,            // 5ì´ˆë§ˆë‹¤ í†µê³„ ì—…ë°ì´íŠ¸
});
```

### í†µí•© ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         SensorService (Phase 77)        â”‚  â† ê³ ìˆ˜ì¤€ API
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - ì„¸ì…˜ ê´€ë¦¬                              â”‚
â”‚ - ìƒíƒœ ê´€ë¦¬                              â”‚
â”‚ - ì´ë²¤íŠ¸ ì‹œìŠ¤í…œ                          â”‚
â”‚ - ìë™ í”ŒëŸ¬ì‹œ/í†µê³„                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    SensorDataStream (Phase 76)          â”‚  â† ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - Backpressure                          â”‚
â”‚ - ë²„í¼ ê´€ë¦¬                              â”‚
â”‚ - í†µê³„ ì¶”ì                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    NativeSensorBridge (Phase 75)        â”‚  â† TypeScript Bridge
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - Type-safe API                         â”‚
â”‚ - ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë°                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      SensorModule.kt (Phase 71)         â”‚  â† Native Module
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - ì„¼ì„œ í•˜ë“œì›¨ì–´ ì ‘ê·¼                     â”‚
â”‚ - ê³ ì£¼íŒŒ ë°ì´í„° ìˆ˜ì§‘                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì§„í–‰ ë¡œê·¸

**2025-11-13 21:30 - 22:00**:
- SensorService.ts êµ¬í˜„ (550ì¤„)
  - ì‹±ê¸€í†¤ íŒ¨í„´
  - ë…¹ìŒ ì„¸ì…˜ ê´€ë¦¬
  - ì„¼ì„œ ì œì–´ API
  - ì´ë²¤íŠ¸ ì‹œìŠ¤í…œ
  - ìë™ í”ŒëŸ¬ì‹œ/í†µê³„
  - ìƒíƒœ ê¸°ê³„ (8ê°œ ìƒíƒœ)
  - ì—ëŸ¬ ì²˜ë¦¬

### ì‚°ì¶œë¬¼

- âœ… **src/services/SensorService.ts** (550ì¤„)
  - SensorService í´ë˜ìŠ¤
  - íƒ€ì… ì •ì˜ (RecordingState, SensorConfig, etc.)
  - Singleton instance

### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

**1. ì •ìƒ ë…¹ìŒ í”Œë¡œìš°**:
```typescript
await sensorService.initialize();
const sessionId = await sensorService.startRecording(configs, handler);
// State: IDLE â†’ STARTING â†’ RECORDING
await delay(10000); // 10ì´ˆ ë…¹ìŒ
await sensorService.stopRecording();
// State: RECORDING â†’ STOPPING â†’ STOPPED â†’ IDLE
```

**2. ì¼ì‹œì •ì§€/ì¬ê°œ**:
```typescript
await sensorService.startRecording(configs, handler);
await sensorService.pauseRecording();  // RECORDING â†’ PAUSING â†’ PAUSED
await delay(5000);
await sensorService.resumeRecording(); // PAUSED â†’ RECORDING
await sensorService.stopRecording();
```

**3. ì—ëŸ¬ ì²˜ë¦¬**:
```typescript
try {
  await sensorService.startRecording(configs, handler);
  // ... error occurs ...
} catch (error) {
  // State: ERROR
  console.error('Recording error:', error);
}
```

**4. í†µê³„ ì¶”ì **:
```typescript
sensorService.addEventListener((event) => {
  if (event.type === 'stats_update') {
    console.log('Stats:', event.stats);
  }
});
// Stats updated every 5 seconds
```

### ì£¼ìš” ì„±ê³¼

**ì™„ì „í•œ ì„¼ì„œ ê´€ë¦¬ ì‹œìŠ¤í…œ**:
- âœ… ê³ ìˆ˜ì¤€ ì¶”ìƒí™” API
- âœ… ì„¸ì…˜ ìƒëª…ì£¼ê¸° ê´€ë¦¬
- âœ… ìë™ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬
- âœ… ì‹¤ì‹œê°„ í†µê³„ ì¶”ì 
- âœ… ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜
- âœ… ì—ëŸ¬ ë³µì›ë ¥

**ê°œë°œì ê²½í—˜**:
- âœ… ê°„ë‹¨í•œ API (start/stop/pause/resume)
- âœ… íƒ€ì… ì•ˆì „ì„±
- âœ… ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
- âœ… ìë™ í”ŒëŸ¬ì‹œ

### ë‹¤ìŒ Phase

â†’ Phase 78-80: ì„¼ì„œ ì‹œì‘/ì¤‘ì§€ ë¡œì§ ë° ë°ì´í„° ë²„í¼ë§ (Phase 77ì—ì„œ ì´ë¯¸ êµ¬í˜„ë¨)

---

## Phase 78: ì„¼ì„œ ì‹œì‘ ë¡œì§ êµ¬í˜„ âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ (Phase 77ì— í¬í•¨)
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: Phase 77ì— í†µí•©
**ìš°ì„ ìˆœìœ„**: critical

### ì‘ì—… ë‚´ìš©

Phase 77ì˜ SensorService.tsì—ì„œ ì´ë¯¸ êµ¬í˜„ë¨.

#### êµ¬í˜„ëœ ê¸°ëŠ¥ (SensorService.ts:92-145)

**startRecording() ë©”ì„œë“œ**:
```typescript
async startRecording(
  configs: SensorConfig[],
  handler: SensorDataHandler,
  errorHandler?: SensorErrorHandler,
): Promise<string>
```

**êµ¬í˜„ ë‚´ìš©**:
- âœ… **ì„¸ì…˜ ID ìƒì„±**: UUIDë¥¼ ì‚¬ìš©í•œ ê³ ìœ  ì„¸ì…˜ ID (`recording-${timestamp}-${uuid}`)
- âœ… **ëª¨ë“  ì„¼ì„œ ì‹œì‘**: ì„¤ì •ëœ ì„¼ì„œ ëª©ë¡ì„ ìˆœíšŒí•˜ë©° ê° ì„¼ì„œ ì‹œì‘
- âœ… **ë°ì´í„° ë²„í¼ ì´ˆê¸°í™”**: StreamManagerë¥¼ í†µí•œ ë²„í¼ ì´ˆê¸°í™”
- âœ… **íƒ€ì„ìŠ¤íƒ¬í”„ ë™ê¸°í™”**: ì‹œìŠ¤í…œ íƒ€ì„ìŠ¤íƒ¬í”„ì™€ ì„¼ì„œ íƒ€ì„ìŠ¤íƒ¬í”„ ë™ê¸°í™”
- âœ… **ì—ëŸ¬ ì²˜ë¦¬**: try-catchì™€ ì—ëŸ¬ í•¸ë“¤ëŸ¬ë¡œ robustí•œ ì—ëŸ¬ ì²˜ë¦¬
- âœ… **ìƒíƒœ ì—…ë°ì´íŠ¸**: IDLE â†’ STARTING â†’ RECORDING ìƒíƒœ ì „í™˜ ë° ì´ë²¤íŠ¸ ë°œìƒ

**ì£¼ìš” ì½”ë“œ**:
```typescript
// Session ID generation
const sessionId = `recording-${Date.now()}-${uuid.v4()}`;

// Start all sensors
for (const config of configs) {
  const available = await NativeSensorBridge.isSensorAvailable(config.sensorType);
  if (!available) continue;

  const stream = streamManager.startStream(
    config.sensorType,
    this.handleSensorData.bind(this),
    this.handleSensorError.bind(this),
    config.streamOptions,
  );
}

// State updates with events
this.setState(RecordingState.STARTING);
// ... initialization
this.setState(RecordingState.RECORDING);
```

### ì‚°ì¶œë¬¼

- âœ… startRecording() ë©”ì„œë“œ (SensorService.ts)
- âœ… ì„¸ì…˜ ID ìƒì„± ë¡œì§
- âœ… ì„¼ì„œ ê°€ìš©ì„± ì²´í¬
- âœ… ìƒíƒœ ê´€ë¦¬ ì‹œìŠ¤í…œ

### ë‹¤ìŒ Phase

â†’ Phase 79: ì„¼ì„œ ì¤‘ì§€ ë¡œì§ êµ¬í˜„ (Phase 77ì— í¬í•¨)

---

## Phase 79: ì„¼ì„œ ì¤‘ì§€ ë¡œì§ êµ¬í˜„ âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ (Phase 77ì— í¬í•¨)
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: Phase 77ì— í†µí•©
**ìš°ì„ ìˆœìœ„**: critical

### ì‘ì—… ë‚´ìš©

Phase 77ì˜ SensorService.tsì—ì„œ ì´ë¯¸ êµ¬í˜„ë¨.

#### êµ¬í˜„ëœ ê¸°ëŠ¥ (SensorService.ts:147-175)

**stopRecording() ë©”ì„œë“œ**:
```typescript
async stopRecording(): Promise<void>
```

**êµ¬í˜„ ë‚´ìš©**:
- âœ… **ëª¨ë“  ì„¼ì„œ ì¤‘ì§€**: StreamManagerë¥¼ í†µí•´ ëª¨ë“  í™œì„± ì„¼ì„œ ì¤‘ì§€
- âœ… **ë²„í¼ í”ŒëŸ¬ì‹œ**: ë‚¨ì•„ìˆëŠ” ë°ì´í„° ìë™ í”ŒëŸ¬ì‹œ (flushAllStreams)
- âœ… **ì„¸ì…˜ ì¢…ë£Œ ì²˜ë¦¬**: ì„¸ì…˜ ì¢…ë£Œ ì‹œê°„ ê¸°ë¡, í†µê³„ ê³„ì‚°
- âœ… **íŒŒì¼ ì €ì¥ ì™„ë£Œ í™•ì¸**: ë²„í¼ í”ŒëŸ¬ì‹œë¡œ ëª¨ë“  ë°ì´í„° ì €ì¥ ë³´ì¥
- âœ… **íƒ€ì´ë¨¸ ì •ë¦¬**: Auto-flush, stats íƒ€ì´ë¨¸ ì •ë¦¬
- âœ… **ìƒíƒœ ì „í™˜**: RECORDING â†’ STOPPING â†’ STOPPED

**ì£¼ìš” ì½”ë“œ**:
```typescript
async stopRecording(): Promise<void> {
  // State validation
  if (this.recordingState !== RecordingState.RECORDING) return;

  this.setState(RecordingState.STOPPING);

  try {
    // Stop all sensors and flush buffers
    await streamManager.stopAllStreams();
    await streamManager.flushAllStreams();

    // Record end time
    if (this.currentSession) {
      this.currentSession.endTime = Date.now();
    }

    // Cleanup timers
    this.stopAutoFlush();
    this.stopStatsTracking();

    // Final state
    this.setState(RecordingState.STOPPED);
  } catch (error) {
    this.handleError(error);
  }
}
```

**ì¶”ê°€ êµ¬í˜„**:
- âœ… **pauseRecording()**: ì„¼ì„œ ì¼ì‹œì •ì§€ (RECORDING â†’ PAUSED)
- âœ… **resumeRecording()**: ì„¼ì„œ ì¬ê°œ (PAUSED â†’ RECORDING)
- âœ… **Cleanup ë¡œì§**: ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ë° ë©”ëª¨ë¦¬ í•´ì œ

### ì‚°ì¶œë¬¼

- âœ… stopRecording() ë©”ì„œë“œ
- âœ… pauseRecording() ë©”ì„œë“œ
- âœ… resumeRecording() ë©”ì„œë“œ
- âœ… ì„¸ì…˜ ì¢…ë£Œ ë¡œì§
- âœ… íƒ€ì´ë¨¸ ì •ë¦¬ ë¡œì§

### ë‹¤ìŒ Phase

â†’ Phase 80: ë°ì´í„° ë²„í¼ë§ ì‹œìŠ¤í…œ (Phase 77ì— í¬í•¨)

---

## Phase 80: ë°ì´í„° ë²„í¼ë§ ì‹œìŠ¤í…œ âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ (Phase 76-77ì— í¬í•¨)
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: Phase 76-77ì— í†µí•©
**ìš°ì„ ìˆœìœ„**: critical

### ì‘ì—… ë‚´ìš©

Phase 76ì˜ SensorDataStream.tsì™€ Phase 77ì˜ SensorService.tsì—ì„œ ì´ë¯¸ êµ¬í˜„ë¨.

#### êµ¬í˜„ëœ ê¸°ëŠ¥

**1. ë©”ëª¨ë¦¬ ë²„í¼ êµ¬í˜„** (SensorDataStream.ts:70-76)
```typescript
private buffer: SensorDataSample[] = [];
private maxBufferSize: number;  // Default: 1000
private dropStrategy: 'oldest' | 'newest';
private enableBackpressure: boolean;
```

**2. ë°°ì¹˜ í¬ê¸° ì„¤ì •**
- âœ… ì„¼ì„œë³„ ë°°ì¹˜ í¬ê¸° ì„¤ì • ê°€ëŠ¥
- âœ… ê¸°ë³¸ê°’: 50-100 ìƒ˜í”Œ (Phase 80 ìš”êµ¬ì‚¬í•­ ì¶©ì¡±)
- âœ… ê³ ì£¼íŒŒ ì„¼ì„œ: 100 ìƒ˜í”Œ
- âœ… ì €ì£¼íŒŒ ì„¼ì„œ: 10-20 ìƒ˜í”Œ

**3. í”ŒëŸ¬ì‹œ ì¡°ê±´** (ì‹œê°„/í¬ê¸°)
```typescript
// Auto-flush (5ì´ˆ ê°„ê²©) - SensorService.ts:120-127
private startAutoFlush(): void {
  this.autoFlushInterval = setInterval(async () => {
    if (this.recordingState === RecordingState.RECORDING) {
      await streamManager.flushAllStreams();
    }
  }, this.autoFlushInterval);
}

// Buffer size-based flush - SensorDataStream.ts:213-219
if (this.buffer.length >= this.maxBufferSize) {
  this.handleBufferOverflow(batch.data);
}
```

**4. Backpressure ì²˜ë¦¬** (SensorDataStream.ts:213-248)
```typescript
private handleBufferOverflow(newSamples: SensorDataSample[]): void {
  const overflow = this.buffer.length + newSamples.length - this.maxBufferSize;

  if (this.dropStrategy === 'oldest') {
    const dropped = this.buffer.splice(0, overflow);
    this.stats.droppedSamples += dropped.length;
  } else {
    const kept = newSamples.slice(0, this.maxBufferSize - this.buffer.length);
    this.stats.droppedSamples += newSamples.length - kept.length;
  }
}
```

**5. ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ë°©ì§€**
- âœ… ìµœëŒ€ ë²„í¼ í¬ê¸° ì œí•œ (1000 ìƒ˜í”Œ)
- âœ… Drop strategy (oldest/newest)
- âœ… Buffer utilization ì¶”ì 
- âœ… ê²½ê³  ë¡œê·¸

**6. ì„±ëŠ¥ ìµœì í™”**
- âœ… ë¹„ë™ê¸° ì²˜ë¦¬ í (Promise chaining)
- âœ… ì²˜ë¦¬ íƒ€ì„ì•„ì›ƒ (100ms)
- âœ… ë™ì‹œ ì²˜ë¦¬ ë°©ì§€ (isProcessing í”Œë˜ê·¸)
- âœ… ë©”ëª¨ë¦¬ íš¨ìœ¨ì  ë°°ì¹˜ ì²˜ë¦¬

```typescript
// Processing queue - SensorDataStream.ts:260-285
private processBuffer(): void {
  if (this.isProcessing || !this.buffer.length) return;

  this.isProcessing = true;
  this.processingQueue = this.processingQueue
    .then(async () => {
      const samples = this.buffer.splice(0, this.buffer.length);
      await this.processWithTimeout(samples);
    })
    .finally(() => {
      this.isProcessing = false;
      if (this.buffer.length > 0) this.processBuffer();
    });
}
```

### ì‚°ì¶œë¬¼

- âœ… ë©”ëª¨ë¦¬ ë²„í¼ ì‹œìŠ¤í…œ (SensorDataStream)
- âœ… ë°°ì¹˜ ì²˜ë¦¬ ë¡œì§
- âœ… Auto-flush ì‹œìŠ¤í…œ (5ì´ˆ)
- âœ… Backpressure í•¸ë“¤ë§
- âœ… Buffer overflow ë°©ì§€
- âœ… ì„±ëŠ¥ ìµœì í™”

### ê²€ì¦

Phase 76-77 êµ¬í˜„ìœ¼ë¡œ ëª¨ë“  ìš”êµ¬ì‚¬í•­ ì¶©ì¡±:
- âœ… 100 ìƒ˜í”Œ ë°°ì¹˜ ì²˜ë¦¬
- âœ… ì‹œê°„/í¬ê¸° ê¸°ë°˜ í”ŒëŸ¬ì‹œ
- âœ… Backpressure ìë™ ì²˜ë¦¬
- âœ… ì˜¤ë²„í”Œë¡œìš° ë°©ì§€
- âœ… ê³ ì£¼íŒŒ ë°ì´í„°(200Hz) ì²˜ë¦¬ ê°€ëŠ¥

### ë‹¤ìŒ Phase

â†’ Phase 81: ë°ì´í„° ì €ì¥ ë¡œì§

---

## Phase 81: ë°ì´í„° ì €ì¥ ë¡œì§ âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 1ì‹œê°„
**ìš°ì„ ìˆœìœ„**: critical

### ì‘ì—… ë‚´ìš©

ì„¼ì„œ ë°ì´í„°ë¥¼ JSONL í˜•ì‹ì˜ ì²­í¬ íŒŒì¼ë¡œ ì €ì¥í•˜ëŠ” persistence ë ˆì´ì–´ë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. ì›ìì  ì“°ê¸°, 1ë¶„ ë‹¨ìœ„ ì²­í‚¹, WatermelonDB ë©”íƒ€ë°ì´í„° ê´€ë¦¬, SyncQueue í†µí•©ì„ í¬í•¨í•©ë‹ˆë‹¤.

#### êµ¬í˜„: SensorDataPersistence.ts (550ì¤„)

**í•µì‹¬ ê¸°ëŠ¥**:

**1. JSONL í˜•ì‹ ì“°ê¸°**
```typescript
private samplesToJSONL(samples: SensorDataSample[]): string {
  return samples
    .map((sample) => JSON.stringify(sample))
    .join('\n') + '\n';
}
```
- âœ… ê° ë¼ì¸ì´ í•˜ë‚˜ì˜ JSON ê°ì²´
- âœ… ë‰´ë¼ì¸ìœ¼ë¡œ êµ¬ë¶„
- âœ… ìŠ¤íŠ¸ë¦¬ë° íŒŒì‹± ê°€ëŠ¥
- âœ… ë¶€ë¶„ ì½ê¸° ì§€ì›

**2. 1ë¶„ ë‹¨ìœ„ ì²­í¬ íŒŒì¼ ìƒì„±**
```typescript
interface ChunkConfig {
  chunkDuration: number;        // 60000ms = 1 minute
  maxSamplesPerChunk: number;   // 12000 samples (~200Hz * 60s)
  chunkDirectory: string;
}

// Chunk time windowing
private getChunkStartTime(timestamp: number): number {
  return Math.floor(timestamp / this.config.chunkDuration) * this.config.chunkDuration;
}

// Auto-flush conditions
private shouldFlushChunk(chunk: ActiveChunk): boolean {
  // Flush if max samples reached
  if (chunk.samples.length >= this.config.maxSamplesPerChunk) {
    return true;
  }

  // Flush if chunk time window has passed
  const now = Date.now();
  const chunkEndTime = chunk.startTime + this.config.chunkDuration;

  return now >= chunkEndTime;
}
```

**í”ŒëŸ¬ì‹œ ì¡°ê±´**:
- âœ… ì‹œê°„ ê¸°ë°˜: 1ë¶„ ê²½ê³¼ ì‹œ
- âœ… í¬ê¸° ê¸°ë°˜: 12,000 ìƒ˜í”Œ ë„ë‹¬ ì‹œ
- âœ… ìˆ˜ë™ í”ŒëŸ¬ì‹œ: `flushAll()` í˜¸ì¶œ ì‹œ

**3. WatermelonDB ë©”íƒ€ë°ì´í„° ì €ì¥**
```typescript
private async saveChunkMetadata(
  chunk: ActiveChunk,
  filePath: string,
  fileSize: number,
): Promise<void> {
  await database.write(async () => {
    const chunkCollection = database.get<SensorDataChunk>('sensor_data_chunks');

    await chunkCollection.create((record) => {
      record._raw.id = chunk.chunkId;
      record.sessionId = chunk.sessionId;
      record.sensorType = chunk.sensorType.toString();
      record.startTime = chunk.startTime;
      record.endTime = chunk.samples[chunk.samples.length - 1].timestamp;
      record.sampleCount = chunk.samples.length;
      record.filePath = filePath;
      record.fileSize = fileSize;
      record.synced = false;
      record.createdAt = Date.now();
    });
  });
}
```

**ì €ì¥ë˜ëŠ” ë©”íƒ€ë°ì´í„°**:
- âœ… ì²­í¬ ID (ê³ ìœ  ì‹ë³„ì)
- âœ… ì„¸ì…˜ ID (ì—°ê²°ëœ ë…¹ìŒ ì„¸ì…˜)
- âœ… ì„¼ì„œ íƒ€ì…
- âœ… ì‹œì‘/ì¢…ë£Œ ì‹œê°„
- âœ… ìƒ˜í”Œ ìˆ˜
- âœ… íŒŒì¼ ê²½ë¡œ ë° í¬ê¸°
- âœ… ë™ê¸°í™” ìƒíƒœ

**4. SyncQueue í†µí•©**
```typescript
private async addToSyncQueue(chunkId: string, filePath: string): Promise<void> {
  await database.write(async () => {
    const syncQueueCollection = database.get<SyncQueue>('sync_queue');

    await syncQueueCollection.create((record) => {
      record.entityType = 'sensor_data_chunk';
      record.entityId = chunkId;
      record.action = 'upload';
      record.priority = 1;
      record.retryCount = 0;
      record.lastAttempt = null;
      record.createdAt = Date.now();
    });
  });
}
```

**SyncQueue í†µí•©**:
- âœ… ìë™ í ì¶”ê°€
- âœ… ì—…ë¡œë“œ ìš°ì„ ìˆœìœ„ ì„¤ì •
- âœ… ì¬ì‹œë„ ì¹´ìš´í„° ì´ˆê¸°í™”
- âœ… ë°±ê·¸ë¼ìš´ë“œ ë™ê¸°í™” ì¤€ë¹„

**5. ì›ìì  ì“°ê¸° ë³´ì¥**
```typescript
private async writeChunkToFile(chunk: ActiveChunk): Promise<WriteResult> {
  try {
    // 1. Convert to JSONL
    const jsonlContent = this.samplesToJSONL(chunk.samples);

    // 2. Write to temporary file
    await RNFS.writeFile(chunk.tempFilePath, jsonlContent, 'utf8');

    // 3. Get final path
    const finalFilePath = this.getFinalFilePath(chunk);

    // 4. Atomic move (rename operation)
    await RNFS.moveFile(chunk.tempFilePath, finalFilePath);

    // 5. Save metadata
    await this.saveChunkMetadata(chunk, finalFilePath, fileSize);

    // 6. Add to sync queue
    await this.addToSyncQueue(chunk.chunkId, finalFilePath);

    return { success: true, ... };
  } catch (error) {
    // Cleanup temp file on error
    if (await RNFS.exists(chunk.tempFilePath)) {
      await RNFS.unlink(chunk.tempFilePath);
    }
    throw error;
  }
}
```

**ì›ìì  ì“°ê¸° ë‹¨ê³„**:
1. âœ… JSONL í˜•ì‹ìœ¼ë¡œ ë³€í™˜
2. âœ… ì„ì‹œ íŒŒì¼ì— ì“°ê¸° (`temp_${chunkId}.jsonl`)
3. âœ… ì›ìì  ì´ë™ ì—°ì‚° (rename)
4. âœ… ë©”íƒ€ë°ì´í„° ì €ì¥
5. âœ… ë™ê¸°í™” í ì¶”ê°€
6. âœ… ì—ëŸ¬ ì‹œ ì„ì‹œ íŒŒì¼ ì •ë¦¬

**ì›ìì„± ë³´ì¥**:
- âœ… ì„ì‹œ íŒŒì¼ ì‚¬ìš©ìœ¼ë¡œ ë¶€ë¶„ ì“°ê¸° ë°©ì§€
- âœ… moveFile (rename)ì€ ì›ìì  ì—°ì‚°
- âœ… ì‹¤íŒ¨ ì‹œ ìë™ ë¡¤ë°±

**6. ë””ìŠ¤í¬ I/O ìµœì í™”**
```typescript
// Write queue for serialized I/O
private writeQueue: Promise<void> = Promise.resolve();

async flushChunk(chunkKey: string): Promise<WriteResult> {
  return new Promise((resolve) => {
    this.writeQueue = this.writeQueue
      .then(async () => {
        const result = await this.writeChunkToFile(activeChunk);
        // Update stats
        resolve(result);
      })
      .catch((error) => {
        resolve({ success: false, error });
      });
  });
}
```

**I/O ìµœì í™” ê¸°ë²•**:
- âœ… **ì§ë ¬í™”ëœ ì“°ê¸°**: writeQueueë¡œ ë™ì‹œ ì“°ê¸° ë°©ì§€
- âœ… **ë°°ì¹˜ ì²˜ë¦¬**: ì²­í¬ ë‹¨ìœ„ ì“°ê¸° (12,000 ìƒ˜í”Œ)
- âœ… **ë²„í¼ë§**: ë©”ëª¨ë¦¬ì— ìƒ˜í”Œ ëˆ„ì  í›„ í”ŒëŸ¬ì‹œ
- âœ… **ë¹„ë™ê¸° I/O**: ë…¼ë¸”ë¡œí‚¹ íŒŒì¼ ì—°ì‚°
- âœ… **ì„ì‹œ íŒŒì¼**: ì“°ê¸° ì¤‘ ë°ì´í„° ì†ìƒ ë°©ì§€

**ì£¼ìš” API**:

```typescript
// Singleton pattern
const persistence = SensorDataPersistence.getInstance();

// Write samples
const results = await persistence.writeSamples(
  sessionId,
  AndroidSensorType.ACCELEROMETER,
  samples,
);

// Flush all pending chunks
await persistence.flushAll();

// Get statistics
const stats = persistence.getStats();

// Query chunks by session
const chunks = await persistence.getChunksBySession(sessionId);

// Read chunk file
const samples = await persistence.readChunkFile(filePath);

// Delete chunk
await persistence.deleteChunk(chunkId);

// Cleanup
await persistence.cleanup();
```

**ì²­í¬ íŒŒì¼ êµ¬ì¡°**:
```
/data/user/0/com.koodtx/files/sensorData/
â”œâ”€â”€ chunk_recording-1731394800000-abc123_1_1731394800000.jsonl
â”œâ”€â”€ chunk_recording-1731394800000-abc123_1_1731394860000.jsonl
â”œâ”€â”€ chunk_recording-1731394800000-abc123_4_1731394800000.jsonl
â””â”€â”€ temp_chunk_recording-1731394800000-abc123_1_1731394920000.jsonl
```

**ì²­í¬ íŒŒì¼ëª… í˜•ì‹**:
```
chunk_{sessionId}_{sensorType}_{chunkStartTime}.jsonl
```

**JSONL íŒŒì¼ ë‚´ìš© ì˜ˆì‹œ**:
```jsonl
{"sensorType":1,"sensorName":"Accelerometer","timestamp":1731394800000000000,"systemTime":1731394800000,"values":[0.123,-0.456,9.789],"accuracy":3}
{"sensorType":1,"sensorName":"Accelerometer","timestamp":1731394800005000000,"systemTime":1731394800005,"values":[0.124,-0.455,9.788],"accuracy":3}
{"sensorType":1,"sensorName":"Accelerometer","timestamp":1731394800010000000,"systemTime":1731394800010,"values":[0.125,-0.454,9.787],"accuracy":3}
```

**í†µê³„ ì¶”ì **:
```typescript
interface PersistenceStats {
  totalChunks: number;      // ì´ ì²­í¬ ìˆ˜
  totalSamples: number;     // ì´ ìƒ˜í”Œ ìˆ˜
  totalBytes: number;       // ì´ ë°”ì´íŠ¸ ìˆ˜
  chunksInProgress: number; // ì§„í–‰ ì¤‘ì¸ ì²­í¬
  failedWrites: number;     // ì‹¤íŒ¨í•œ ì“°ê¸°
  lastWriteTime: number | null; // ë§ˆì§€ë§‰ ì“°ê¸° ì‹œê°„
}
```

### ì‚°ì¶œë¬¼

- âœ… SensorDataPersistence.ts (550ì¤„)
- âœ… JSONL í˜•ì‹ ì“°ê¸°
- âœ… 1ë¶„ ë‹¨ìœ„ ì²­í‚¹
- âœ… WatermelonDB ë©”íƒ€ë°ì´í„°
- âœ… SyncQueue í†µí•©
- âœ… ì›ìì  ì“°ê¸°
- âœ… I/O ìµœì í™”
- âœ… index.ts ì—…ë°ì´íŠ¸ (exports ì¶”ê°€)

### ì£¼ìš” ì„±ê³¼

**ì™„ì „í•œ ë°ì´í„° ì €ì¥ ì‹œìŠ¤í…œ**:
- âœ… ê³ ì„±ëŠ¥ JSONL ì“°ê¸°
- âœ… ì‹œê°„ ê¸°ë°˜ ì²­í‚¹
- âœ… ë©”íƒ€ë°ì´í„° ê´€ë¦¬
- âœ… ë™ê¸°í™” ì¤€ë¹„
- âœ… ë°ì´í„° ë¬´ê²°ì„± ë³´ì¥
- âœ… í™•ì¥ ê°€ëŠ¥í•œ ì„¤ê³„

**ë°ì´í„° ì•ˆì „ì„±**:
- âœ… ì›ìì  ì“°ê¸°ë¡œ ë°ì´í„° ì†ìƒ ë°©ì§€
- âœ… ì„ì‹œ íŒŒì¼ë¡œ ë¶€ë¶„ ì“°ê¸° ë°©ì§€
- âœ… ì—ëŸ¬ ì²˜ë¦¬ ë° ë¡¤ë°±
- âœ… ì§ë ¬í™”ëœ I/Oë¡œ ê²½ìŸ ì¡°ê±´ ë°©ì§€

**ì„±ëŠ¥ ìµœì í™”**:
- âœ… ë°°ì¹˜ ì²˜ë¦¬ë¡œ I/O ìµœì†Œí™”
- âœ… ë²„í¼ë§ìœ¼ë¡œ ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±
- âœ… ë¹„ë™ê¸° ì—°ì‚°ìœ¼ë¡œ ë…¼ë¸”ë¡œí‚¹
- âœ… ì²­í¬ ë‹¨ìœ„ ê´€ë¦¬ë¡œ í™•ì¥ì„±

### í†µí•© ìŠ¤íƒ

**ë°ì´í„° íë¦„**:
```
ì„¼ì„œ â†’ NativeSensorBridge â†’ SensorDataStream â†’ SensorService â†’ SensorDataPersistence
                                    â†“                                      â†“
                              Backpressure                            JSONL Files
                              Buffer overflow                         WatermelonDB
                              Auto-flush                             SyncQueue
```

**4ê°œ ë ˆì´ì–´ ì™„ì„±**:
1. âœ… **SensorModule.kt** (Phase 71) - Native ì„¼ì„œ ì ‘ê·¼
2. âœ… **NativeSensorBridge** (Phase 75) - TypeScript ë¸Œë¦¬ì§€
3. âœ… **SensorDataStream** (Phase 76) - ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬
4. âœ… **SensorService** (Phase 77) - ì„¸ì…˜ ê´€ë¦¬
5. âœ… **SensorDataPersistence** (Phase 81) - ë°ì´í„° ì €ì¥

### ë‹¤ìŒ Phase

â†’ Phase 82: íƒ€ì„ìŠ¤íƒ¬í”„ ìœ í‹¸ë¦¬í‹°

---

## Phase 82: íƒ€ì„ìŠ¤íƒ¬í”„ ìœ í‹¸ë¦¬í‹° âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ì„ ìœ„í•œ ê³ ì •ë°€ íƒ€ì„ìŠ¤íƒ¬í”„ ìœ í‹¸ë¦¬í‹°ë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. UTC epoch, ê³ ì •ë°€ elapsed time, íƒ€ì„ì¡´ ì •ë³´, ì„œë²„ ì‹œê°„ ë™ê¸°í™” ì§€ì›ì„ í¬í•¨í•©ë‹ˆë‹¤.

#### êµ¬í˜„: timestamp.ts (550ì¤„)

**í•µì‹¬ ê¸°ëŠ¥**:

**1. UTC Epoch íƒ€ì„ìŠ¤íƒ¬í”„**
```typescript
// Get current UTC timestamp in milliseconds
export function getUTC(): number {
  return timestampManager.getUTC();
}

// With time sync offset
getUTC(): number {
  return Date.now() + this.timeSyncOffset;
}
```

**2. ê³ ì •ë°€ Elapsed Time (performance.now())**
```typescript
// High-precision elapsed time since app start
export function getElapsedTime(): number {
  return timestampManager.getElapsedTime();
}

// Uses performance.now() for sub-millisecond precision
getElapsedTime(): number {
  return this.getPerformanceNow() - this.performanceStartTime;
}
```

**íŠ¹ì§•**:
- âœ… ì„œë¸Œ ë°€ë¦¬ì´ˆ ì •ë°€ë„
- âœ… ë‹¨ì¡° ì¦ê°€ (monotonic)
- âœ… ì‹œìŠ¤í…œ ì‹œê°„ ë³€ê²½ì— ì˜í–¥ ì—†ìŒ
- âœ… ì„¼ì„œ íƒ€ì´ë° ì¸¡ì •ì— ì´ìƒì 

**3. íƒ€ì„ì¡´ ì •ë³´**
```typescript
interface Timestamp {
  utc: number;
  elapsed: number;
  bootTime?: number;
  timezoneOffset: number;  // Minutes
  timezoneName: string;    // "Asia/Seoul"
}

// Get complete timestamp info
export function now(): Timestamp {
  return {
    utc: getUTC(),
    elapsed: getElapsedTime(),
    bootTime: timestampManager.getBootTime() || undefined,
    timezoneOffset: getTimezoneOffset(),
    timezoneName: getTimezoneName(),
  };
}
```

**4. Android ì„¼ì„œ íƒ€ì„ìŠ¤íƒ¬í”„ ë³€í™˜**
```typescript
// Convert Android sensor timestamp (nanoseconds since boot) to UTC
export function sensorTimestampToUTC(sensorTimestampNanos: number): number {
  if (!this.bootTime) {
    return Date.now() + this.timeSyncOffset;
  }

  // Convert nanoseconds to milliseconds
  const sensorTimestampMs = sensorTimestampNanos / 1_000_000;

  // Add boot time to get UTC
  return this.bootTime + sensorTimestampMs + this.timeSyncOffset;
}
```

**ë³€í™˜ ë¡œì§**:
- âœ… ë‚˜ë…¸ì´ˆ â†’ ë°€ë¦¬ì´ˆ ë³€í™˜
- âœ… ë¶€íŠ¸ íƒ€ì„ ê¸°ë°˜ UTC ë³€í™˜
- âœ… ì‹œê°„ ë™ê¸°í™” ì˜¤í”„ì…‹ ì ìš©
- âœ… Fallback ì²˜ë¦¬

**5. íƒ€ì„ìŠ¤íƒ¬í”„ ë³€í™˜ ìœ í‹¸ë¦¬í‹°**
```typescript
// Convert elapsed time to UTC
export function elapsedToUTC(elapsed: number): number {
  const elapsedSinceStart = elapsed - this.performanceStartTime;
  return this.performanceStartDate + elapsedSinceStart + this.timeSyncOffset;
}

// Convert UTC to elapsed time
export function utcToElapsed(utc: number): number {
  const timeSinceStart = utc - this.performanceStartDate - this.timeSyncOffset;
  return this.performanceStartTime + timeSinceStart;
}
```

**6. ì„œë²„ ì‹œê°„ ë™ê¸°í™”**
```typescript
async syncWithServer(serverUrl: string): Promise<TimeSyncResult> {
  const startTime = Date.now();

  const response = await fetch(serverUrl, {
    method: 'GET',
    headers: {'Cache-Control': 'no-cache'},
  });

  const endTime = Date.now();
  const rtt = endTime - startTime;

  // Get server time from Date header
  const serverTime = new Date(response.headers.get('Date')!).getTime();
  const localTime = startTime + rtt / 2; // RTT compensation

  const offset = serverTime - localTime;

  return {
    serverTime,
    localTime,
    offset,
    rtt,
    accuracy: Math.abs(rtt / 2),
    syncedAt: Date.now(),
  };
}
```

**ë™ê¸°í™” ê³¼ì •**:
1. âœ… ì„œë²„ì— HTTP ìš”ì²­
2. âœ… RTT (Round-Trip Time) ì¸¡ì •
3. âœ… ì„œë²„ Date í—¤ë” íŒŒì‹±
4. âœ… RTT ë³´ìƒ ê³„ì‚°
5. âœ… ì˜¤í”„ì…‹ ê³„ì‚° ë° ì ìš©
6. âœ… ì •í™•ë„ ì¶”ì •

**7. NTP í´ë¼ì´ì–¸íŠ¸ (ì¤€ë¹„)**
```typescript
async syncWithNTP(ntpServer: string = 'pool.ntp.org'): Promise<NTPResponse> {
  // Note: NTP uses UDP port 123, not accessible from React Native
  // Placeholder for future native module implementation
  throw new Error('NTP sync requires native module implementation');
}
```

**ì°¸ê³ **: NTPëŠ” UDPë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ React Nativeì—ì„œ ì§ì ‘ êµ¬í˜„ ë¶ˆê°€. í–¥í›„ native moduleì´ë‚˜ HTTP ê¸°ë°˜ NTP ì„œë¹„ìŠ¤ë¡œ êµ¬í˜„ ê°€ëŠ¥.

**í¬ë§¤íŒ… ìœ í‹¸ë¦¬í‹°**:
```typescript
// ISO 8601 format
formatISO(utc: number): string

// Local format
formatLocal(utc: number): string

// Duration format
formatDuration(ms: number): string
// Example: "1h 23m 45s"

// Milliseconds with precision
formatMilliseconds(ms: number, precision: number = 3): string
// Example: "123.456ms"

// Parse ISO string
parseISO(isoString: string): number
```

**ê²€ì¦ ìœ í‹¸ë¦¬í‹°**:
```typescript
// Check if timestamp is valid
isValidTimestamp(timestamp: number): boolean

// Check if timestamps are synchronized
areSynchronized(
  timestamp1: number,
  timestamp2: number,
  thresholdMs: number = 100,
): boolean
```

**ìƒìˆ˜**:
```typescript
export const MILLISECONDS_PER_SECOND = 1000;
export const MILLISECONDS_PER_MINUTE = 60 * 1000;
export const MILLISECONDS_PER_HOUR = 60 * 60 * 1000;
export const MILLISECONDS_PER_DAY = 24 * 60 * 60 * 1000;
export const NANOSECONDS_PER_MILLISECOND = 1_000_000;
```

### ì‚¬ìš© ì˜ˆì œ

**1. ê¸°ë³¸ ì‚¬ìš©**:
```typescript
import {now, getUTC, getElapsedTime} from '@utils/timestamp';

// Get complete timestamp
const timestamp = now();
console.log(timestamp);
// {
//   utc: 1731394800000,
//   elapsed: 12345.678,
//   bootTime: 1731382454322,
//   timezoneOffset: -540,  // KST (UTC+9)
//   timezoneName: "Asia/Seoul"
// }

// Get UTC only
const utc = getUTC();

// Get high-precision elapsed time
const elapsed = getElapsedTime();
```

**2. ì„¼ì„œ íƒ€ì„ìŠ¤íƒ¬í”„ ë³€í™˜**:
```typescript
import {sensorTimestampToUTC} from '@utils/timestamp';

// Android sensor timestamp (nanoseconds)
const sensorTimestamp = 1234567890123456789n;

// Convert to UTC milliseconds
const utc = sensorTimestampToUTC(Number(sensorTimestamp));
```

**3. ì„œë²„ ì‹œê°„ ë™ê¸°í™”**:
```typescript
import {syncWithServer, getLastSyncResult} from '@utils/timestamp';

// Sync with server
try {
  const result = await syncWithServer('https://api.example.com/time');
  console.log('Synced:', result);
  // {
  //   serverTime: 1731394800000,
  //   localTime: 1731394799950,
  //   offset: 50,
  //   rtt: 100,
  //   accuracy: 50,
  //   syncedAt: 1731394800000
  // }
} catch (error) {
  console.error('Sync failed:', error);
}

// Check last sync
const lastSync = getLastSyncResult();
if (lastSync) {
  console.log(`Time offset: ${lastSync.offset}ms`);
  console.log(`Accuracy: Â±${lastSync.accuracy}ms`);
}
```

**4. íƒ€ì„ìŠ¤íƒ¬í”„ ë³€í™˜**:
```typescript
import {elapsedToUTC, utcToElapsed} from '@utils/timestamp';

// Convert elapsed time to UTC
const utc = elapsedToUTC(12345.678);

// Convert UTC to elapsed time
const elapsed = utcToElapsed(1731394800000);
```

**5. í¬ë§¤íŒ…**:
```typescript
import {formatISO, formatDuration, formatMilliseconds} from '@utils/timestamp';

const utc = Date.now();

// ISO format
formatISO(utc);
// "2023-11-12T14:20:00.000Z"

// Duration
formatDuration(5430000);
// "1h 30m 30s"

// Milliseconds
formatMilliseconds(123.456789, 3);
// "123.457ms"
```

### ì‚°ì¶œë¬¼

- âœ… src/utils/timestamp.ts (550ì¤„)
- âœ… TimestampManager í´ë˜ìŠ¤ (ì‹±ê¸€í†¤)
- âœ… UTC epoch íƒ€ì„ìŠ¤íƒ¬í”„
- âœ… ê³ ì •ë°€ elapsed time (performance.now())
- âœ… íƒ€ì„ì¡´ ì •ë³´
- âœ… ì„œë²„ ì‹œê°„ ë™ê¸°í™”
- âœ… ì„¼ì„œ íƒ€ì„ìŠ¤íƒ¬í”„ ë³€í™˜
- âœ… í¬ë§¤íŒ…/ê²€ì¦ ìœ í‹¸ë¦¬í‹°
- âœ… NTP í´ë¼ì´ì–¸íŠ¸ ì¤€ë¹„
- âœ… src/utils/index.ts ì—…ë°ì´íŠ¸

### ì£¼ìš” ì„±ê³¼

**ì •ë°€ë„**:
- âœ… ì„œë¸Œ ë°€ë¦¬ì´ˆ ì •ë°€ë„ (performance.now())
- âœ… ë‚˜ë…¸ì´ˆ ë‹¨ìœ„ ì„¼ì„œ íƒ€ì„ìŠ¤íƒ¬í”„ ì§€ì›
- âœ… ë‹¨ì¡° ì¦ê°€ íƒ€ì„ìŠ¤íƒ¬í”„

**ì‹ ë¢°ì„±**:
- âœ… ì‹œìŠ¤í…œ ì‹œê°„ ë³€ê²½ì— ì•ˆì „
- âœ… ì„œë²„ ì‹œê°„ ë™ê¸°í™” ì§€ì›
- âœ… RTT ë³´ìƒ ë° ì •í™•ë„ ì¶”ì •
- âœ… Fallback ë©”ì»¤ë‹ˆì¦˜

**í˜¸í™˜ì„±**:
- âœ… Android ì„¼ì„œ íƒ€ì„ìŠ¤íƒ¬í”„ ë³€í™˜
- âœ… ë¶€íŠ¸ íƒ€ì„ ê¸°ë°˜ ë³€í™˜
- âœ… í¬ë¡œìŠ¤ í”Œë«í¼ ì§€ì›
- âœ… íƒ€ì„ì¡´ ì²˜ë¦¬

**ê°œë°œì ê²½í—˜**:
- âœ… ê°„ë‹¨í•œ API
- âœ… TypeScript íƒ€ì… ì•ˆì „ì„±
- âœ… ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ í’ë¶€
- âœ… ëª…í™•í•œ ë¬¸ì„œ

### ë‹¤ìŒ Phase

â†’ Phase 83: @react-native-community/geolocation ì„¤ì¹˜

---

## Phase 83: @react-native-community/geolocation ì„¤ì¹˜ âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 0.3ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

GPS ìœ„ì¹˜ ìˆ˜ì§‘ì„ ìœ„í•œ @react-native-community/geolocation ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•˜ê³  Android/iOS ì„¤ì •ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.

#### 1. ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

```bash
npm install @react-native-community/geolocation --save
```

**ì„¤ì¹˜ëœ ë²„ì „**: `@react-native-community/geolocation@3.4.0`

#### 2. Android ì„¤ì •

**AndroidManifest.xml ê¶Œí•œ ì„¤ì •** (ì´ë¯¸ ì™„ë£Œ):
```xml
<!-- Location permissions -->
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
```

**ê¶Œí•œ ì„¤ëª…**:
- âœ… `ACCESS_FINE_LOCATION`: ì •ë°€í•œ ìœ„ì¹˜ (GPS)
- âœ… `ACCESS_COARSE_LOCATION`: ëŒ€ëµì ì¸ ìœ„ì¹˜ (Network)

**Google Play Services**:
- âœ… React Native 0.60+ autolinkingìœ¼ë¡œ ìë™ ì—°ê²°
- âœ… ë³„ë„ ì„¤ì • ë¶ˆí•„ìš”

**ìœ„ì¹˜ ê¶Œí•œ ì—°ë™**:
- âœ… react-native-permissionsì™€ í†µí•©
- âœ… usePermissionsStoreì—ì„œ ê´€ë¦¬

#### 3. iOS ì„¤ì •

**Info.plist ê¶Œí•œ ì„¤ëª…** (ì´ë¯¸ ì™„ë£Œ):
```xml
<key>NSLocationWhenInUseUsageDescription</key>
<string>KooDTX needs access to your location to record GPS data during data collection sessions.</string>

<key>NSLocationAlwaysAndWhenInUseUsageDescription</key>
<string>KooDTX needs access to your location to record GPS data during data collection sessions.</string>
```

**ê¶Œí•œ ì„¤ëª…**:
- âœ… `NSLocationWhenInUseUsageDescription`: ì•± ì‚¬ìš© ì¤‘ ìœ„ì¹˜ ì ‘ê·¼
- âœ… `NSLocationAlwaysAndWhenInUseUsageDescription`: í•­ìƒ ìœ„ì¹˜ ì ‘ê·¼

#### 4. ê¸°ë³¸ ì‚¬ìš©ë²•

```typescript
import Geolocation from '@react-native-community/geolocation';

// Get current position
Geolocation.getCurrentPosition(
  (position) => {
    console.log('Position:', position);
    // {
    //   coords: {
    //     latitude: 37.123456,
    //     longitude: 127.123456,
    //     altitude: 123.45,
    //     accuracy: 10.5,
    //     altitudeAccuracy: 5.2,
    //     heading: 90,
    //     speed: 5.5,
    //   },
    //   timestamp: 1731394800000,
    // }
  },
  (error) => {
    console.error('Error:', error);
  },
  {
    enableHighAccuracy: true,
    timeout: 20000,
    maximumAge: 1000,
  }
);

// Watch position (continuous tracking)
const watchId = Geolocation.watchPosition(
  (position) => {
    console.log('Position update:', position);
  },
  (error) => {
    console.error('Error:', error);
  },
  {
    enableHighAccuracy: true,
    distanceFilter: 10, // Update every 10 meters
    interval: 1000,     // Update every 1 second (Android)
    fastestInterval: 500, // Fastest update (Android)
  }
);

// Clear watch
Geolocation.clearWatch(watchId);
```

#### 5. ìœ„ì¹˜ ê¶Œí•œ ì—°ë™

```typescript
import {usePermissionsStore} from '@store';
import {PERMISSIONS} from 'react-native-permissions';
import Geolocation from '@react-native-community/geolocation';

// Request location permission
const {requestPermission} = usePermissionsStore();

const enableGPS = async () => {
  const result = await requestPermission('location');

  if (result === 'granted') {
    // Start tracking
    Geolocation.getCurrentPosition(
      (position) => console.log('Position:', position),
      (error) => console.error('Error:', error),
      {enableHighAccuracy: true}
    );
  } else {
    console.error('Location permission denied');
  }
};
```

#### 6. ë¼ì´ë¸ŒëŸ¬ë¦¬ ì˜µì…˜

**getCurrentPosition() ì˜µì…˜**:
```typescript
interface GeoOptions {
  timeout?: number;           // Default: infinity
  maximumAge?: number;        // Default: infinity
  enableHighAccuracy?: boolean; // Default: false
}
```

**watchPosition() ì˜µì…˜ (Android)**:
```typescript
interface GeoOptions {
  timeout?: number;
  maximumAge?: number;
  enableHighAccuracy?: boolean;
  distanceFilter?: number;    // Minimum distance (meters) for updates
  interval?: number;          // Update interval (ms)
  fastestInterval?: number;   // Fastest update interval (ms)
  useSignificantChanges?: boolean; // iOS only
}
```

### ì‚°ì¶œë¬¼

- âœ… @react-native-community/geolocation@3.4.0 ì„¤ì¹˜
- âœ… Android ê¶Œí•œ ì„¤ì • í™•ì¸ (ACCESS_FINE_LOCATION, ACCESS_COARSE_LOCATION)
- âœ… iOS ê¶Œí•œ ì„¤ì • í™•ì¸ (NSLocationWhenInUseUsageDescription)
- âœ… Google Play Services autolinking
- âœ… react-native-permissions í†µí•©
- âœ… package.json ì—…ë°ì´íŠ¸

### ì£¼ìš” ì„±ê³¼

**ì„¤ì • ì™„ë£Œ**:
- âœ… Android ìœ„ì¹˜ ê¶Œí•œ (FINE, COARSE)
- âœ… iOS ìœ„ì¹˜ ê¶Œí•œ (WhenInUse, Always)
- âœ… Google Play Services ì—°ê²°
- âœ… ê¶Œí•œ ê´€ë¦¬ í†µí•©

**ê¸°ëŠ¥ ì¤€ë¹„**:
- âœ… í˜„ì¬ ìœ„ì¹˜ ì¡°íšŒ (getCurrentPosition)
- âœ… ìœ„ì¹˜ ì¶”ì  (watchPosition)
- âœ… ê³ ì •ë°€ë„ ëª¨ë“œ (enableHighAccuracy)
- âœ… ë°°í„°ë¦¬ ìµœì í™” (distanceFilter)

**í†µí•© ì¤€ë¹„**:
- âœ… usePermissionsStoreì™€ ì—°ë™
- âœ… Phase 84 GPS ì„œë¹„ìŠ¤ êµ¬í˜„ ì¤€ë¹„
- âœ… Phase 85 GPS ë°ì´í„° ì €ì¥ ì¤€ë¹„

### ë‹¤ìŒ Phase

â†’ Phase 84: GPS ì„œë¹„ìŠ¤ êµ¬í˜„

---

## Phase 84: GPS ì„œë¹„ìŠ¤ êµ¬í˜„ âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 1ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

@react-native-community/geolocationì„ ê¸°ë°˜ìœ¼ë¡œ ì™„ì „í•œ GPS ìœ„ì¹˜ ì¶”ì  ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. í˜„ì¬ ìœ„ì¹˜ ì¡°íšŒ, ì—°ì† ì¶”ì , ì •í™•ë„ ì„¤ì •, ë°°í„°ë¦¬ ìµœì í™”, í†µê³„ ì¶”ì  ê¸°ëŠ¥ì„ í¬í•¨í•©ë‹ˆë‹¤.

#### êµ¬í˜„: GPSService.ts (520ì¤„)

**í•µì‹¬ ê¸°ëŠ¥**:

**1. í˜„ì¬ ìœ„ì¹˜ ì¡°íšŒ (getCurrentPosition)**
```typescript
// One-time position query
const position = await gpsService.getCurrentPosition({
  accuracyMode: GPSAccuracyMode.HIGH,
  timeout: 20000,
  maximumAge: 1000,
});

console.log(position);
// {
//   latitude: 37.123456,
//   longitude: 127.123456,
//   altitude: 123.45,
//   accuracy: 10.5,
//   altitudeAccuracy: 5.2,
//   heading: 90,
//   speed: 5.5,
//   timestamp: 1731394800000,
// }
```

**2. ì—°ì† ìœ„ì¹˜ ì¶”ì  (watchPosition)**
```typescript
// Start continuous tracking
gpsService.startTracking({
  accuracyMode: GPSAccuracyMode.BALANCED,
  distanceFilter: 10, // Update every 10 meters
  interval: 5000,     // Update every 5 seconds
  fastestInterval: 2000, // Fastest update: 2 seconds
});

// Listen to position updates
const unsubscribe = gpsService.addPositionListener((position) => {
  console.log('Position update:', position);
});

// Stop tracking
gpsService.stopTracking();

// Unsubscribe
unsubscribe();
```

**3. ì •í™•ë„ ì„¤ì • (3ê°€ì§€ ëª¨ë“œ)**
```typescript
export enum GPSAccuracyMode {
  HIGH = 'high',       // Best accuracy, high battery usage
  BALANCED = 'balanced', // Balanced accuracy and battery
  LOW = 'low',         // Lower accuracy, low battery usage
}
```

**ì •í™•ë„ ëª¨ë“œë³„ ì„¤ì •**:

| Mode | High Accuracy | Distance Filter | Interval | Fastest Interval | Battery Usage |
|------|---------------|-----------------|----------|------------------|---------------|
| **HIGH** | âœ… true | 5m | 1s | 0.5s | ë†’ìŒ |
| **BALANCED** | âœ… true | 10m | 5s | 2s | ì¤‘ê°„ |
| **LOW** | âŒ false | 50m | 30s | 10s | ë‚®ìŒ |

**4. ë°°í„°ë¦¬ ìµœì í™” (distanceFilter)**
```typescript
interface GPSTrackingOptions {
  // Minimum distance (meters) for position updates
  // Higher value = better battery life
  distanceFilter?: number;

  // Update interval (Android only)
  interval?: number;

  // Fastest update interval (Android only)
  fastestInterval?: number;
}

// Example: Update only when moved 50 meters
gpsService.startTracking({
  accuracyMode: GPSAccuracyMode.LOW,
  distanceFilter: 50,
});
```

**ë°°í„°ë¦¬ ìµœì í™” ì „ëµ**:
- âœ… **Distance Filter**: ìµœì†Œ ì´ë™ ê±°ë¦¬ ì„¤ì •
- âœ… **Interval Control**: ì—…ë°ì´íŠ¸ ê°„ê²© ì¡°ì ˆ
- âœ… **Accuracy Mode**: ì €ì •ë°€ë„ ëª¨ë“œ ì‚¬ìš©
- âœ… **Selective Tracking**: í•„ìš”ì‹œì—ë§Œ ì¶”ì 

**5. ì—ëŸ¬ ì²˜ë¦¬**
```typescript
// Add error listener
const unsubscribe = gpsService.addErrorListener((error) => {
  console.error('GPS error:', error.message);

  // Error types:
  // - Permission denied (code: 1)
  // - Position unavailable (code: 2)
  // - Timeout (code: 3)
});

// Error codes
const error = {
  code: 1, // PERMISSION_DENIED
  message: 'Location permission denied',
};
```

**ì—ëŸ¬ íƒ€ì…**:
- âœ… **Permission Denied** (code: 1): ìœ„ì¹˜ ê¶Œí•œ ê±°ë¶€
- âœ… **Position Unavailable** (code: 2): ìœ„ì¹˜ í™•ì¸ ë¶ˆê°€
- âœ… **Timeout** (code: 3): ìš”ì²­ ì‹œê°„ ì´ˆê³¼

**6. í†µê³„ ì¶”ì **
```typescript
interface GPSStatistics {
  totalPositions: number;     // ì´ ìœ„ì¹˜ ì—…ë°ì´íŠ¸ ìˆ˜
  totalErrors: number;        // ì´ ì—ëŸ¬ ìˆ˜
  lastPosition: GPSPosition | null; // ë§ˆì§€ë§‰ ìœ„ì¹˜
  lastError: Error | null;    // ë§ˆì§€ë§‰ ì—ëŸ¬
  lastUpdateTime: number | null; // ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ ì‹œê°„
  averageAccuracy: number;    // í‰ê·  ì •í™•ë„
  isTracking: boolean;        // ì¶”ì  í™œì„± ìƒíƒœ
}

// Get statistics
const stats = gpsService.getStatistics();
console.log('Total positions:', stats.totalPositions);
console.log('Average accuracy:', stats.averageAccuracy, 'meters');
console.log('Last position:', stats.lastPosition);

// Reset statistics
gpsService.resetStatistics();
```

**7. Listener íŒ¨í„´**
```typescript
// Position listener
const positionUnsubscribe = gpsService.addPositionListener((position) => {
  console.log('New position:', position);
  // Save to database, update UI, etc.
});

// Error listener
const errorUnsubscribe = gpsService.addErrorListener((error) => {
  console.error('GPS error:', error);
  // Show error to user, retry, etc.
});

// Cleanup
positionUnsubscribe();
errorUnsubscribe();

// Or remove all listeners
gpsService.removeAllListeners();
```

### ì‚¬ìš© ì˜ˆì œ

**1. í˜„ì¬ ìœ„ì¹˜ ì¡°íšŒ**:
```typescript
import {getCurrentPosition, GPSAccuracyMode} from '@services/gps';

// Get high-accuracy position
try {
  const position = await getCurrentPosition({
    accuracyMode: GPSAccuracyMode.HIGH,
    timeout: 20000,
  });

  console.log(`Location: ${position.latitude}, ${position.longitude}`);
  console.log(`Accuracy: ${position.accuracy}m`);
} catch (error) {
  console.error('Failed to get position:', error);
}
```

**2. ì—°ì† ìœ„ì¹˜ ì¶”ì **:
```typescript
import {
  startGPSTracking,
  stopGPSTracking,
  addGPSPositionListener,
  GPSAccuracyMode,
} from '@services/gps';

// Start tracking with balanced mode
startGPSTracking({
  accuracyMode: GPSAccuracyMode.BALANCED,
  distanceFilter: 10,
  interval: 5000,
});

// Listen to updates
const unsubscribe = addGPSPositionListener((position) => {
  console.log('Position update:', position);
  // Save to database
});

// Stop tracking later
setTimeout(() => {
  stopGPSTracking();
  unsubscribe();
}, 60000); // Stop after 1 minute
```

**3. ê¶Œí•œ ìš”ì²­**:
```typescript
import {requestGPSAuthorization} from '@services/gps';

// Request authorization
try {
  await requestGPSAuthorization();
  console.log('Location permission granted');
} catch (error) {
  console.error('Location permission denied:', error);
}
```

**4. í†µê³„ ëª¨ë‹ˆí„°ë§**:
```typescript
import {getGPSStatistics, addGPSPositionListener} from '@services/gps';

// Monitor statistics
const unsubscribe = addGPSPositionListener((position) => {
  const stats = getGPSStatistics();

  console.log('Stats:', {
    total: stats.totalPositions,
    avgAccuracy: stats.averageAccuracy.toFixed(2) + 'm',
    lastUpdate: new Date(stats.lastUpdateTime || 0).toISOString(),
  });
});
```

**5. ë°°í„°ë¦¬ ì ˆì•½ ëª¨ë“œ**:
```typescript
import {startGPSTracking, GPSAccuracyMode} from '@services/gps';

// Low battery mode: update only when moved 50m or every 30s
startGPSTracking({
  accuracyMode: GPSAccuracyMode.LOW,
  distanceFilter: 50,
  interval: 30000,
  fastestInterval: 10000,
});
```

### ì‚°ì¶œë¬¼

- âœ… src/services/gps/GPSService.ts (520ì¤„)
- âœ… src/services/gps/index.ts (exports)
- âœ… GPSService í´ë˜ìŠ¤ (ì‹±ê¸€í†¤)
- âœ… getCurrentPosition() ë©”ì„œë“œ
- âœ… startTracking()/stopTracking() ë©”ì„œë“œ
- âœ… 3ê°€ì§€ ì •í™•ë„ ëª¨ë“œ (HIGH, BALANCED, LOW)
- âœ… ë°°í„°ë¦¬ ìµœì í™” ì˜µì…˜
- âœ… Position/Error ë¦¬ìŠ¤ë„ˆ
- âœ… í†µê³„ ì¶”ì 
- âœ… ì—ëŸ¬ ì²˜ë¦¬
- âœ… íƒ€ì… ì •ì˜

### ì£¼ìš” ì„±ê³¼

**ì™„ì „í•œ GPS ì„œë¹„ìŠ¤**:
- âœ… í˜„ì¬ ìœ„ì¹˜ ì¡°íšŒ
- âœ… ì—°ì† ìœ„ì¹˜ ì¶”ì 
- âœ… ì„¤ì • ê°€ëŠ¥í•œ ì •í™•ë„
- âœ… ë°°í„°ë¦¬ ìµœì í™”
- âœ… í†µê³„ ì¶”ì 
- âœ… ì—ëŸ¬ í•¸ë“¤ë§

**ë°°í„°ë¦¬ íš¨ìœ¨ì„±**:
- âœ… Distance filter (ìµœì†Œ ì´ë™ ê±°ë¦¬)
- âœ… Update interval ì¡°ì ˆ
- âœ… 3ë‹¨ê³„ ì •í™•ë„ ëª¨ë“œ
- âœ… ì„ íƒì  ì¶”ì 

**ê°œë°œì ê²½í—˜**:
- âœ… ê°„ë‹¨í•œ API
- âœ… Listener íŒ¨í„´
- âœ… TypeScript íƒ€ì… ì•ˆì „ì„±
- âœ… í¸ì˜ í•¨ìˆ˜ ì œê³µ
- âœ… í†µê³„ ëª¨ë‹ˆí„°ë§

**ì‹ ë¢°ì„±**:
- âœ… ì—ëŸ¬ ì²˜ë¦¬ ë° ë³µêµ¬
- âœ… ê¶Œí•œ ê´€ë¦¬
- âœ… Timeout ì„¤ì •
- âœ… Cleanup ì§€ì›

### ë‹¤ìŒ Phase

â†’ Phase 85: GPS ë°ì´í„° ì €ì¥

---

## Phase 85: GPS ë°ì´í„° ì €ì¥ âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 0.8ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

GPS ìœ„ì¹˜ ë°ì´í„°ë¥¼ JSONL í˜•ì‹ìœ¼ë¡œ ì €ì¥í•˜ê³  WatermelonDB ë©”íƒ€ë°ì´í„°ë¥¼ ê´€ë¦¬í•˜ëŠ” ì €ì¥ ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. SensorDataPersistenceì™€ í†µí•©í•˜ì—¬ GPS ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.

#### êµ¬í˜„: GPSDataStorage.ts (380ì¤„)

**í•µì‹¬ ê¸°ëŠ¥**:

**1. GPS ë°ì´í„° í¬ë§· ì •ì˜**
```typescript
interface GPSDataSample {
  sensorType: AndroidSensorType;  // Virtual sensor type for GPS
  sensorName: string;              // "GPS"
  timestamp: number;               // Nanoseconds since boot
  systemTime: number;              // UTC milliseconds

  // Position data
  latitude: number;                // Degrees
  longitude: number;               // Degrees
  altitude: number | null;         // Meters (null if unavailable)

  // Accuracy data
  accuracy: number;                // Horizontal accuracy (meters)
  altitudeAccuracy: number | null; // Vertical accuracy (meters)

  // Movement data
  heading: number | null;          // Degrees (0-360)
  speed: number | null;            // Meters per second
}
```

**ë°ì´í„° í•„ë“œ**:
- âœ… **ìœ„ë„/ê²½ë„** (latitude/longitude): WGS84 ì¢Œí‘œê³„, ë„ ë‹¨ìœ„
- âœ… **ê³ ë„** (altitude): í•´ë°œ ê³ ë„, ë¯¸í„° ë‹¨ìœ„
- âœ… **ì •í™•ë„** (accuracy): ìˆ˜í‰ ì •í™•ë„, ë¯¸í„° ë‹¨ìœ„
- âœ… **ê³ ë„ ì •í™•ë„** (altitudeAccuracy): ìˆ˜ì§ ì •í™•ë„, ë¯¸í„° ë‹¨ìœ„
- âœ… **ë°©í–¥** (heading): ì§„í–‰ ë°©í–¥, ë„ ë‹¨ìœ„ (0-360)
- âœ… **ì†ë„** (speed): ì´ë™ ì†ë„, m/s ë‹¨ìœ„

**2. íƒ€ì„ìŠ¤íƒ¬í”„ ë™ê¸°í™”**
```typescript
private convertPositionToSample(position: GPSPosition): GPSDataSample {
  // Synchronize timestamp
  const systemTime = getUTC();

  // Convert GPS timestamp to nanoseconds
  // GPS timestamp is already in milliseconds, convert to nanoseconds
  const timestampNanos = position.timestamp * 1_000_000;

  return {
    timestamp: timestampNanos,    // Sensor timestamp (nanoseconds)
    systemTime,                   // System timestamp (UTC milliseconds)
    latitude: position.latitude,
    longitude: position.longitude,
    // ... other fields
  };
}
```

**íƒ€ì„ìŠ¤íƒ¬í”„ ì „ëµ**:
- âœ… **timestamp**: GPS íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ë‚˜ë…¸ì´ˆë¡œ ë³€í™˜ (ì„¼ì„œ ë°ì´í„° í˜¸í™˜ì„±)
- âœ… **systemTime**: ì‹œìŠ¤í…œ UTC íƒ€ì„ìŠ¤íƒ¬í”„ (ë°€ë¦¬ì´ˆ)
- âœ… **ë™ê¸°í™”**: ë‘ íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ í•¨ê»˜ ì €ì¥í•˜ì—¬ ì‹œê°„ ë³´ì • ê°€ëŠ¥
- âœ… **ì •ë°€ë„**: ë‚˜ë…¸ì´ˆ ë‹¨ìœ„ë¡œ ë†’ì€ ì •ë°€ë„ ìœ ì§€

**3. JSONL íŒŒì¼ ì €ì¥**
```typescript
async savePosition(sessionId: string, position: GPSPosition): Promise<void> {
  // Convert to data sample
  const sample = this.convertPositionToSample(position);

  // Add to buffer
  this.buffer.push(sample);

  // Auto-flush if buffer is large (50 samples)
  if (this.buffer.length >= 50) {
    await this.flush(sessionId);
  }
}

async flush(sessionId: string): Promise<void> {
  // Write to SensorDataPersistence
  const results = await sensorDataPersistence.writeSamples(
    sessionId,
    this.GPS_SENSOR_TYPE,  // Virtual sensor type: 65536
    samplesToWrite,
  );

  // Update statistics
  for (const result of results) {
    if (result.success) {
      this.stats.totalSamples += result.sampleCount;
      this.stats.totalChunks++;
      this.stats.totalBytes += result.fileSize;
    }
  }
}
```

**ì €ì¥ í”„ë¡œì„¸ìŠ¤**:
1. âœ… GPS positionì„ GPSDataSampleë¡œ ë³€í™˜
2. âœ… ë²„í¼ì— ì¶”ê°€ (ë°°ì¹˜ ì²˜ë¦¬)
3. âœ… 50ê°œ ìƒ˜í”Œ ë„ë‹¬ ì‹œ ìë™ í”ŒëŸ¬ì‹œ
4. âœ… SensorDataPersistenceë¥¼ í†µí•´ JSONL ì €ì¥
5. âœ… 1ë¶„ ë‹¨ìœ„ ì²­í¬ íŒŒì¼ ìƒì„±
6. âœ… í†µê³„ ì—…ë°ì´íŠ¸

**4. WatermelonDB ë©”íƒ€ë°ì´í„°**

SensorDataPersistence (Phase 81)ì—ì„œ ìë™ìœ¼ë¡œ ë©”íƒ€ë°ì´í„°ë¥¼ ì €ì¥í•©ë‹ˆë‹¤:

```typescript
// Chunk metadata saved to WatermelonDB
{
  chunkId: "chunk_recording-..._65536_1731394800000",
  sessionId: "recording-1731394800000-abc123",
  sensorType: "65536",  // GPS virtual sensor type
  startTime: 1731394800000,
  endTime: 1731394860000,
  sampleCount: 50,
  filePath: "/path/to/chunk_..._65536_1731394800000.jsonl",
  fileSize: 12345,
  synced: false,
  createdAt: 1731394860000,
}
```

**ë©”íƒ€ë°ì´í„° ë‚´ìš©**:
- âœ… ì²­í¬ ID (ê³ ìœ  ì‹ë³„ì)
- âœ… ì„¸ì…˜ ID (ë…¹ìŒ ì„¸ì…˜ ì—°ê²°)
- âœ… ì„¼ì„œ íƒ€ì… (GPS: 65536)
- âœ… ì‹œì‘/ì¢…ë£Œ ì‹œê°„
- âœ… ìƒ˜í”Œ ìˆ˜ ë° íŒŒì¼ í¬ê¸°
- âœ… ë™ê¸°í™” ìƒíƒœ

**5. ë°°ì¹˜ ì²˜ë¦¬ ë° ë²„í¼ë§**
```typescript
// Buffer management
private buffer: GPSDataSample[] = [];
private bufferFlushInterval: number = 5000; // 5 seconds

// Auto-flush timer
private startAutoFlush(sessionId: string): void {
  this.flushTimer = setInterval(async () => {
    if (this.buffer.length > 0) {
      await this.flush(sessionId);
    }
  }, this.bufferFlushInterval);
}
```

**ë²„í¼ë§ ì „ëµ**:
- âœ… **ë²„í¼ í¬ê¸°**: 50 ìƒ˜í”Œ ë„ë‹¬ ì‹œ ìë™ í”ŒëŸ¬ì‹œ
- âœ… **íƒ€ì´ë¨¸**: 5ì´ˆë§ˆë‹¤ ìë™ í”ŒëŸ¬ì‹œ
- âœ… **ë°°ì¹˜ ì²˜ë¦¬**: I/O ìµœì†Œí™”
- âœ… **ì‹¤íŒ¨ ë³µêµ¬**: ì‹¤íŒ¨ ì‹œ ë²„í¼ì— ë‹¤ì‹œ ì¶”ê°€

**6. í†µê³„ ì¶”ì **
```typescript
interface GPSStorageStats {
  totalSamples: number;    // ì´ ì €ì¥ëœ ìƒ˜í”Œ ìˆ˜
  totalChunks: number;     // ì´ ì²­í¬ ìˆ˜
  totalBytes: number;      // ì´ ì €ì¥ ë°”ì´íŠ¸ ìˆ˜
  lastSaveTime: number | null;  // ë§ˆì§€ë§‰ ì €ì¥ ì‹œê°„
  failedWrites: number;    // ì‹¤íŒ¨í•œ ì“°ê¸° ìˆ˜
}

// Get statistics
const stats = gpsDataStorage.getStatistics();
console.log('Total GPS samples:', stats.totalSamples);
console.log('Total chunks:', stats.totalChunks);
console.log('Storage size:', (stats.totalBytes / 1024).toFixed(2) + ' KB');
```

### ì‚¬ìš© ì˜ˆì œ

**1. GPS ì¶”ì  ë° ì €ì¥ í†µí•©**:
```typescript
import {
  startGPSTracking,
  addGPSPositionListener,
  GPSAccuracyMode,
} from '@services/gps';
import {saveGPSPosition} from '@services/gps';

const sessionId = 'recording-1731394800000-abc123';

// Start GPS tracking
startGPSTracking({
  accuracyMode: GPSAccuracyMode.BALANCED,
  distanceFilter: 10,
  interval: 5000,
});

// Save positions to storage
const unsubscribe = addGPSPositionListener(async (position) => {
  await saveGPSPosition(sessionId, position);
  console.log('GPS position saved:', position);
});

// Stop and cleanup
setTimeout(async () => {
  unsubscribe();
  await flushGPSData(sessionId);
  await cleanupGPSStorage(sessionId);
}, 60000);
```

**2. ë°°ì¹˜ ì €ì¥**:
```typescript
import {saveGPSPositions} from '@services/gps';

// Save multiple positions at once
const positions = [position1, position2, position3];
await saveGPSPositions(sessionId, positions);
```

**3. ìˆ˜ë™ í”ŒëŸ¬ì‹œ**:
```typescript
import {flushGPSData, getGPSBufferSize} from '@services/gps';

// Check buffer size
const bufferSize = getGPSBufferSize();
console.log('Buffer size:', bufferSize);

// Manually flush
if (bufferSize > 0) {
  await flushGPSData(sessionId);
  console.log('GPS data flushed');
}
```

**4. í†µê³„ ëª¨ë‹ˆí„°ë§**:
```typescript
import {getGPSStorageStatistics} from '@services/gps';

const stats = getGPSStorageStatistics();
console.log('GPS Storage Statistics:', {
  samples: stats.totalSamples,
  chunks: stats.totalChunks,
  size: (stats.totalBytes / 1024 / 1024).toFixed(2) + ' MB',
  lastSave: new Date(stats.lastSaveTime || 0).toISOString(),
  failures: stats.failedWrites,
});
```

**5. í”ŒëŸ¬ì‹œ ê°„ê²© ì¡°ì ˆ**:
```typescript
import {setGPSFlushInterval} from '@services/gps';

// Set flush interval to 10 seconds
setGPSFlushInterval(10000);
```

**6. ì™„ì „í•œ GPS ì„¸ì…˜ ê´€ë¦¬**:
```typescript
import {
  startGPSTracking,
  stopGPSTracking,
  addGPSPositionListener,
  saveGPSPosition,
  flushGPSData,
  cleanupGPSStorage,
  getGPSStorageStatistics,
} from '@services/gps';

class GPSRecordingSession {
  private sessionId: string;
  private unsubscribe: (() => void) | null = null;

  async start(sessionId: string) {
    this.sessionId = sessionId;

    // Start GPS tracking
    startGPSTracking({
      accuracyMode: GPSAccuracyMode.BALANCED,
      distanceFilter: 10,
      interval: 5000,
    });

    // Save all positions
    this.unsubscribe = addGPSPositionListener(async (position) => {
      await saveGPSPosition(this.sessionId, position);
    });

    console.log('GPS recording started');
  }

  async stop() {
    // Stop tracking
    stopGPSTracking();

    // Unsubscribe listener
    if (this.unsubscribe) {
      this.unsubscribe();
    }

    // Flush remaining data
    await flushGPSData(this.sessionId);

    // Get final statistics
    const stats = getGPSStorageStatistics();
    console.log('GPS recording stopped:', stats);

    // Cleanup
    await cleanupGPSStorage(this.sessionId);
  }
}
```

### JSONL íŒŒì¼ í˜•ì‹

**GPS ë°ì´í„° JSONL íŒŒì¼ ì˜ˆì‹œ**:
```jsonl
{"sensorType":65536,"sensorName":"GPS","timestamp":1731394800000000000,"systemTime":1731394800000,"latitude":37.123456,"longitude":127.123456,"altitude":123.45,"accuracy":10.5,"altitudeAccuracy":5.2,"heading":90,"speed":5.5}
{"sensorType":65536,"sensorName":"GPS","timestamp":1731394805000000000,"systemTime":1731394805000,"latitude":37.123457,"longitude":127.123457,"altitude":123.46,"accuracy":10.3,"altitudeAccuracy":5.1,"heading":91,"speed":5.6}
{"sensorType":65536,"sensorName":"GPS","timestamp":1731394810000000000,"systemTime":1731394810000,"latitude":37.123458,"longitude":127.123458,"altitude":123.47,"accuracy":10.1,"altitudeAccuracy":5.0,"heading":92,"speed":5.7}
```

**íŒŒì¼ ì €ì¥ ìœ„ì¹˜**:
```
/data/user/0/com.koodtx/files/sensorData/
â”œâ”€â”€ chunk_recording-1731394800000-abc123_65536_1731394800000.jsonl
â”œâ”€â”€ chunk_recording-1731394800000-abc123_65536_1731394860000.jsonl
â””â”€â”€ chunk_recording-1731394800000-abc123_65536_1731394920000.jsonl
```

### ì‚°ì¶œë¬¼

- âœ… src/services/gps/GPSDataStorage.ts (380ì¤„)
- âœ… GPS ë°ì´í„° í¬ë§· ì •ì˜ (GPSDataSample)
- âœ… íƒ€ì„ìŠ¤íƒ¬í”„ ë™ê¸°í™” (ë‚˜ë…¸ì´ˆ + UTC)
- âœ… JSONL íŒŒì¼ ì €ì¥
- âœ… WatermelonDB ë©”íƒ€ë°ì´í„° í†µí•©
- âœ… ë°°ì¹˜ ì²˜ë¦¬ ë° ë²„í¼ë§
- âœ… ìë™ í”ŒëŸ¬ì‹œ (5ì´ˆ)
- âœ… í†µê³„ ì¶”ì 
- âœ… í¸ì˜ í•¨ìˆ˜
- âœ… src/services/gps/index.ts ì—…ë°ì´íŠ¸

### ì£¼ìš” ì„±ê³¼

**ì™„ì „í•œ GPS ë°ì´í„° ì €ì¥**:
- âœ… í‘œì¤€í™”ëœ GPS ë°ì´í„° í¬ë§·
- âœ… ì •ë°€í•œ íƒ€ì„ìŠ¤íƒ¬í”„ ë™ê¸°í™”
- âœ… JSONL í˜•ì‹ ì €ì¥
- âœ… WatermelonDB ë©”íƒ€ë°ì´í„°
- âœ… SensorDataPersistence í†µí•©

**íš¨ìœ¨ì„±**:
- âœ… ë°°ì¹˜ ì²˜ë¦¬ (50 ìƒ˜í”Œ)
- âœ… ìë™ í”ŒëŸ¬ì‹œ (5ì´ˆ)
- âœ… ë²„í¼ë§ìœ¼ë¡œ I/O ìµœì†Œí™”
- âœ… 1ë¶„ ë‹¨ìœ„ ì²­í¬ íŒŒì¼

**ì‹ ë¢°ì„±**:
- âœ… ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„
- âœ… í†µê³„ ì¶”ì 
- âœ… Cleanup ì§€ì›
- âœ… ì—ëŸ¬ ì²˜ë¦¬

**í†µí•©**:
- âœ… GPSServiceì™€ ì™„ë²½ í†µí•©
- âœ… SensorDataPersistence ì¬ì‚¬ìš©
- âœ… ì„¼ì„œ ë°ì´í„°ì™€ ë™ì¼í•œ ì €ì¥ êµ¬ì¡°
- âœ… SyncQueue ìë™ í†µí•©

### ë°ì´í„° íë¦„

```
GPS Sensor â†’ GPSService â†’ GPSDataStorage â†’ SensorDataPersistence â†’ JSONL Files
                  â†“              â†“                    â†“                  â†“
            Position       GPSDataSample         Chunk Files      WatermelonDB
            Listener       Conversion            (1-minute)       Metadata
                                                                   SyncQueue
```

### ë‹¤ìŒ Phase

â†’ Phase 86: ì„¼ì„œ ìŠ¤í† ì–´ ìƒì„±

---

## í†µê³„ ì—…ë°ì´íŠ¸

**ì™„ë£Œëœ Phase: 85/300**
**ì§„í–‰ë¥ : 28.3%**

---

_ìµœì¢… ì—…ë°ì´íŠ¸: 2025-11-13 23:30_

## Phase 86: ì„¼ì„œ ìŠ¤í† ì–´ ìƒì„± âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì™„ë£Œì¼**: 2025-11-13  
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

Zustandë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ì„ ìœ„í•œ ì „ì—­ ìƒíƒœ ê´€ë¦¬ ìŠ¤í† ì–´ë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

#### êµ¬í˜„: useSensorStore.ts (490ì¤„)

**í•µì‹¬ ê¸°ëŠ¥**:

**1. ë…¹ìŒ ìƒíƒœ ê´€ë¦¬ (Recording State)**
- 9ê°€ì§€ ìƒíƒœ: IDLE, STARTING, RECORDING, PAUSING, PAUSED, RESUMING, STOPPING, STOPPED, ERROR
- `setRecordingState()`: ìƒíƒœ ë³€ê²½
- `useRecordingState()`: í˜„ì¬ ìƒíƒœ ì¡°íšŒ
- `useIsRecording()`, `useIsPaused()`: ìƒíƒœ ì²´í¬

**2. ì„¼ì„œ í™œì„±í™” ìƒíƒœ (Sensor Configuration)**
- ì„¼ì„œ ì„¤ì • ê´€ë¦¬ (íƒ€ì…, í™œì„±í™” ì—¬ë¶€, ìƒ˜í”Œë§ ë ˆì´íŠ¸)
- `setSensorConfigs()`: ì „ì²´ ì„¤ì • ì—…ë°ì´íŠ¸
- `enableSensor()`, `disableSensor()`: ê°œë³„ ì„¼ì„œ ì œì–´
- `toggleSensor()`: ì„¼ì„œ í† ê¸€
- `useSensorConfigs()`, `useEnabledSensors()`: ì„¤ì • ì¡°íšŒ

**3. ì‹¤ì‹œê°„ ì„¼ì„œ ê°’ (Real-time Data)**
- ì„¼ì„œ ë°ì´í„° ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
- GPS ë°ì´í„° ë³„ë„ ê´€ë¦¬
- `updateRealtimeData()`: ì„¼ì„œ ë°ì´í„° ì—…ë°ì´íŠ¸
- `updateGPSRealtimeData()`: GPS ë°ì´í„° ì—…ë°ì´íŠ¸
- `useRealtimeData()`, `useSensorRealtimeData()`: ë°ì´í„° ì¡°íšŒ

**4. ì„¸ì…˜ ì •ë³´ (Session Info)**
- ë…¹ìŒ ì„¸ì…˜ ìƒëª…ì£¼ê¸° ê´€ë¦¬
- ì„¸ì…˜ ID, ì‹œì‘/ì¢…ë£Œ ì‹œê°„, ì§€ì† ì‹œê°„, ìƒ˜í”Œ ìˆ˜
- `startSession()`, `endSession()`: ì„¸ì…˜ ì œì–´
- `updateSession()`: ì„¸ì…˜ ì •ë³´ ì—…ë°ì´íŠ¸
- `useCurrentSession()`, `useSessionDuration()`: ì„¸ì…˜ ì¡°íšŒ

**5. í†µê³„ (Statistics)**
- ì´ ìƒ˜í”Œ ìˆ˜, ë“œë¡­ëœ ìƒ˜í”Œ ìˆ˜
- ì„¼ì„œë³„ í†µê³„ (ìƒ˜í”Œ ìˆ˜, ë§ˆì§€ë§‰ ê°’, íƒ€ì„ìŠ¤íƒ¬í”„)
- `updateStatistics()`, `updateSensorStats()`: í†µê³„ ì—…ë°ì´íŠ¸
- `useStatistics()`, `useSensorStatistics()`: í†µê³„ ì¡°íšŒ

**6. ì—ëŸ¬ ìƒíƒœ (Error State)**
- ì—ëŸ¬ ì €ì¥ ë° ê´€ë¦¬
- `setError()`, `clearError()`: ì—ëŸ¬ ì œì–´
- `useRecordingError()`: ì—ëŸ¬ ì¡°íšŒ

**7. ì•¡ì…˜ (Actions)**
- ëª¨ë“  ìƒíƒœ ë³€ê²½ ì•¡ì…˜ ì œê³µ
- `useSensorActions()`: ì•¡ì…˜ ë²ˆë“¤ ì¡°íšŒ

### Selector Hooks (15ê°œ)

í¸ì˜ì„±ì„ ìœ„í•œ selector hooks ì œê³µ:
- `useRecordingState()` - ë…¹ìŒ ìƒíƒœ
- `useIsRecording()` - ë…¹ìŒ ì¤‘ ì—¬ë¶€
- `useIsPaused()` - ì¼ì‹œì •ì§€ ì—¬ë¶€
- `useSensorConfigs()` - ì„¼ì„œ ì„¤ì • ëª©ë¡
- `useEnabledSensors()` - í™œì„±í™”ëœ ì„¼ì„œ
- `useEnabledSensorTypes()` - í™œì„±í™”ëœ ì„¼ì„œ íƒ€ì…
- `useRealtimeData()` - ì „ì²´ ì‹¤ì‹œê°„ ë°ì´í„°
- `useSensorRealtimeData(type)` - íŠ¹ì • ì„¼ì„œ ë°ì´í„°
- `useGPSRealtimeData()` - GPS ë°ì´í„°
- `useCurrentSession()` - í˜„ì¬ ì„¸ì…˜
- `useSessionDuration()` - ì„¸ì…˜ ì§€ì† ì‹œê°„
- `useStatistics()` - ì „ì²´ í†µê³„
- `useSensorStatistics(type)` - ì„¼ì„œë³„ í†µê³„
- `useRecordingError()` - ì—ëŸ¬
- `useSensorActions()` - ì•¡ì…˜ ë²ˆë“¤

### ì‚¬ìš© ì˜ˆì œ

**1. ë…¹ìŒ ì œì–´**:
```typescript
const {setRecordingState, startSession, endSession} = useSensorActions();
const recordingState = useRecordingState();
const isRecording = useIsRecording();

// Start recording
startSession('session-123', [1, 4, 2]); // ACC, GYR, MAG
setRecordingState(RecordingState.RECORDING);

// Stop recording
setRecordingState(RecordingState.STOPPING);
endSession();
```

**2. ì„¼ì„œ ì œì–´**:
```typescript
const {enableSensor, disableSensor, toggleSensor} = useSensorActions();
const enabledSensors = useEnabledSensors();

// Enable accelerometer
enableSensor(AndroidSensorType.ACCELEROMETER);

// Toggle gyroscope
toggleSensor(AndroidSensorType.GYROSCOPE);
```

**3. ì‹¤ì‹œê°„ ë°ì´í„° ì—…ë°ì´íŠ¸**:
```typescript
const {updateRealtimeData, updateGPSRealtimeData} = useSensorActions();

// Update sensor data
updateRealtimeData({
  sensorType: AndroidSensorType.ACCELEROMETER,
  values: [0.1, 0.2, 9.8],
  timestamp: Date.now(),
  accuracy: 3,
});

// Update GPS data
updateGPSRealtimeData({
  position: {latitude: 37.123, longitude: 127.123, ...},
  timestamp: Date.now(),
});
```

**4. ì‹¤ì‹œê°„ ë°ì´í„° ì¡°íšŒ**:
```typescript
const accData = useSensorRealtimeData(AndroidSensorType.ACCELEROMETER);
const gpsData = useGPSRealtimeData();

console.log('Accelerometer:', accData?.values);
console.log('GPS:', gpsData?.position);
```

**5. ì„¸ì…˜ ì •ë³´**:
```typescript
const session = useCurrentSession();
const duration = useSessionDuration();

console.log('Session ID:', session?.sessionId);
console.log('Duration:', (duration / 1000).toFixed(1), 'seconds');
console.log('Sample count:', session?.sampleCount);
```

**6. í†µê³„ ì¡°íšŒ**:
```typescript
const stats = useStatistics();
const accStats = useSensorStatistics(AndroidSensorType.ACCELEROMETER);

console.log('Total samples:', stats.totalSamples);
console.log('ACC samples:', accStats?.sampleCount);
console.log('Last value:', accStats?.lastValue);
```

### ì‚°ì¶œë¬¼

- âœ… src/store/useSensorStore.ts (490ì¤„)
- âœ… RecordingState enum
- âœ… ìƒíƒœ ê´€ë¦¬ (9ê°€ì§€ ë…¹ìŒ ìƒíƒœ)
- âœ… ì„¼ì„œ ì„¤ì • ê´€ë¦¬
- âœ… ì‹¤ì‹œê°„ ë°ì´í„° ê´€ë¦¬
- âœ… ì„¸ì…˜ ì •ë³´ ê´€ë¦¬
- âœ… í†µê³„ ê´€ë¦¬
- âœ… ì—ëŸ¬ ê´€ë¦¬
- âœ… 15ê°œ selector hooks
- âœ… Actions bundle
- âœ… src/store/index.ts ì—…ë°ì´íŠ¸

### ì£¼ìš” ì„±ê³¼

**ì™„ì „í•œ ìƒíƒœ ê´€ë¦¬**:
- âœ… ë…¹ìŒ ìƒëª…ì£¼ê¸° ê´€ë¦¬
- âœ… ì„¼ì„œ í™œì„±í™” ì œì–´
- âœ… ì‹¤ì‹œê°„ ë°ì´í„° ì—…ë°ì´íŠ¸
- âœ… ì„¸ì…˜ ì¶”ì 
- âœ… í†µê³„ ìˆ˜ì§‘

**ê°œë°œì ê²½í—˜**:
- âœ… TypeScript íƒ€ì… ì•ˆì „ì„±
- âœ… í¸ì˜ selector hooks
- âœ… Actions bundle
- âœ… ëª…í™•í•œ API

**ì„±ëŠ¥**:
- âœ… Zustandì˜ ìµœì í™”ëœ ë¦¬ë Œë”ë§
- âœ… Selector hooksë¡œ í•„ìš”í•œ ë°ì´í„°ë§Œ êµ¬ë…
- âœ… íš¨ìœ¨ì ì¸ ìƒíƒœ ì—…ë°ì´íŠ¸

### ë‹¤ìŒ Phase

â†’ Phase 87: ì»¤ìŠ¤í…€ Hook (useSensor)

---

## Phase 87: ì»¤ìŠ¤í…€ Hook (useSensor) âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: high

### ì‘ì—… ë‚´ìš©

ì„¼ì„œ ë°ì´í„° ìˆ˜ì§‘ì„ ìœ„í•œ React Hookì„ êµ¬í˜„í•˜ê³  Phase 86ì˜ useSensorStoreì™€ í†µí•©í–ˆìŠµë‹ˆë‹¤.

#### êµ¬í˜„: hooks/useSensor.ts (370ì¤„)

**í•µì‹¬ ê¸°ëŠ¥**:

**1. ì„¼ì„œ ì‹œì‘ Hook**
- `start()`: ì„¼ì„œ ì‹œì‘ í•¨ìˆ˜
- ì„¸ì…˜ ID ê²€ì¦
- ì„¼ì„œ ê°€ìš©ì„± ì²´í¬
- ìƒ˜í”Œë§ ë ˆì´íŠ¸ ì„¤ì •
- ìë™ìœ¼ë¡œ ìŠ¤í† ì–´ ì—…ë°ì´íŠ¸

**2. ì„¼ì„œ ì¤‘ì§€ Hook**
- `stop()`: ì„¼ì„œ ì¤‘ì§€ í•¨ìˆ˜
- ì•ˆì „í•œ ì„¼ì„œ ì¢…ë£Œ
- ìƒíƒœ ì´ˆê¸°í™”
- ì—ëŸ¬ ì²˜ë¦¬

**3. ì‹¤ì‹œê°„ ì„¼ì„œ ë°ì´í„° êµ¬ë…**
- ì„¼ì„œ ë°ì´í„° ì½œë°± ì²˜ë¦¬
- ë¡œì»¬ state ì—…ë°ì´íŠ¸ (latestData)
- ìŠ¤í† ì–´ ì‹¤ì‹œê°„ ë°ì´í„° ì—…ë°ì´íŠ¸
- ìƒ˜í”Œ ì¹´ìš´íŠ¸ ìë™ ì¦ê°€
- ì»¤ìŠ¤í…€ onData ì½œë°± ì§€ì›

**4. ìƒëª…ì£¼ê¸° ê´€ë¦¬**
- enabled ì˜µì…˜ì— ë”°ë¥¸ ìë™ ì‹œì‘/ì¤‘ì§€
- recordingState ë³€ê²½ ê°ì§€ (STOPPED/ERROR ì‹œ ìë™ ì¤‘ì§€)
- ì„¼ì„œ ê°€ìš©ì„± ì²´í¬ (ë§ˆìš´íŠ¸ ì‹œ)
- ì½œë°± ref ì—…ë°ì´íŠ¸

**5. í´ë¦°ì—…**
- ì–¸ë§ˆìš´íŠ¸ ì‹œ ìë™ ì„¼ì„œ ì¤‘ì§€
- ì—ëŸ¬ ì²˜ë¦¬
- ì•ˆì „í•œ ë¦¬ì†ŒìŠ¤ í•´ì œ

**6. ìŠ¤í† ì–´ í†µí•©**
- useSensorStoreì™€ ì—°ë™
- ì‹¤ì‹œê°„ ë°ì´í„° ìë™ ì—…ë°ì´íŠ¸
- ì—ëŸ¬ ìƒíƒœ ë™ê¸°í™”
- ìƒ˜í”Œ ì¹´ìš´íŠ¸ ì¶”ì 
- updateStore í”Œë˜ê·¸ë¡œ ì„ íƒì  í†µí•©

### ì¸í„°í˜ì´ìŠ¤

**UseSensorOptions**:
```typescript
interface UseSensorOptions {
  enabled?: boolean;          // ìë™ ì‹œì‘/ì¤‘ì§€ í™œì„±í™”
  sampleRate?: number;        // ìƒ˜í”Œë§ ë ˆì´íŠ¸ (Hz)
  onData?: (data: SensorData) => void;  // ë°ì´í„° ì½œë°±
  onError?: (error: Error) => void;     // ì—ëŸ¬ ì½œë°±
  updateStore?: boolean;      // ìŠ¤í† ì–´ ì—…ë°ì´íŠ¸ (ê¸°ë³¸: true)
}
```

**UseSensorResult**:
```typescript
interface UseSensorResult {
  isAvailable: boolean;       // ì„¼ì„œ ê°€ìš©ì„±
  isRunning: boolean;         // ì„¼ì„œ ì‹¤í–‰ ìƒíƒœ
  latestData: SensorData | null;  // ìµœì‹  ë°ì´í„°
  error: Error | null;        // ì—ëŸ¬
  start: () => Promise<void>; // ì‹œì‘ í•¨ìˆ˜
  stop: () => Promise<void>;  // ì¤‘ì§€ í•¨ìˆ˜
  clearError: () => void;     // ì—ëŸ¬ í´ë¦¬ì–´
}
```

### ì‚¬ìš© ì˜ˆì œ

**1. ê¸°ë³¸ ì‚¬ìš© (ìë™ ì‹œì‘)**:
```typescript
function AccelerometerDisplay({sessionId}: {sessionId: string}) {
  const sensor = useSensor('accelerometer', sessionId, {
    enabled: true,
    sampleRate: 100,
    onData: (data) => console.log('ACC data:', data.values),
  });

  if (!sensor.isAvailable) {
    return <Text>Accelerometer not available</Text>;
  }

  return (
    <View>
      <Text>Status: {sensor.isRunning ? 'Running' : 'Stopped'}</Text>
      {sensor.latestData && (
        <Text>Values: {sensor.latestData.values.join(', ')}</Text>
      )}
      {sensor.error && <Text>Error: {sensor.error.message}</Text>}
    </View>
  );
}
```

**2. ìˆ˜ë™ ì œì–´**:
```typescript
function ManualSensorControl({sessionId}: {sessionId: string}) {
  const sensor = useSensor('gyroscope', sessionId, {
    sampleRate: 50,
  });

  const handleStart = async () => {
    try {
      await sensor.start();
      console.log('Sensor started');
    } catch (err) {
      console.error('Failed to start:', err);
    }
  };

  const handleStop = async () => {
    await sensor.stop();
    console.log('Sensor stopped');
  };

  return (
    <View>
      <Button
        title={sensor.isRunning ? 'Stop' : 'Start'}
        onPress={sensor.isRunning ? handleStop : handleStart}
      />
    </View>
  );
}
```

**3. ìŠ¤í† ì–´ í†µí•© ì—†ì´ ì‚¬ìš©**:
```typescript
const sensor = useSensor('magnetometer', sessionId, {
  enabled: true,
  updateStore: false,  // ìŠ¤í† ì–´ ì—…ë°ì´íŠ¸ ë¹„í™œì„±í™”
  onData: (data) => {
    // ì»¤ìŠ¤í…€ ë°ì´í„° ì²˜ë¦¬
    processData(data);
  },
});
```

**4. ë³µìˆ˜ ì„¼ì„œ ì‚¬ìš©**:
```typescript
function MultiSensorView({sessionId}: {sessionId: string}) {
  const acc = useSensor('accelerometer', sessionId, {enabled: true});
  const gyr = useSensor('gyroscope', sessionId, {enabled: true});
  const mag = useSensor('magnetometer', sessionId, {enabled: true});

  return (
    <View>
      <SensorCard title="Accelerometer" sensor={acc} />
      <SensorCard title="Gyroscope" sensor={gyr} />
      <SensorCard title="Magnetometer" sensor={mag} />
    </View>
  );
}
```

### í†µí•© íë¦„

**ì„¼ì„œ ì‹œì‘ ì‹œ**:
1. `sensor.start()` í˜¸ì¶œ
2. SensorServiceë¥¼ í†µí•´ ë„¤ì´í‹°ë¸Œ ì„¼ì„œ ì‹œì‘
3. ë°ì´í„° ì½œë°± ë“±ë¡
4. ë°ì´í„° ìˆ˜ì‹  ì‹œ:
   - `latestData` state ì—…ë°ì´íŠ¸ (ë¡œì»¬)
   - `sensorActions.updateRealtimeData()` í˜¸ì¶œ (ìŠ¤í† ì–´)
   - `sensorActions.incrementSampleCount()` í˜¸ì¶œ (ìŠ¤í† ì–´)
   - ì»¤ìŠ¤í…€ `onData` ì½œë°± í˜¸ì¶œ
5. ì—ëŸ¬ ë°œìƒ ì‹œ:
   - `error` state ì—…ë°ì´íŠ¸ (ë¡œì»¬)
   - `sensorActions.setError()` í˜¸ì¶œ (ìŠ¤í† ì–´)
   - ì»¤ìŠ¤í…€ `onError` ì½œë°± í˜¸ì¶œ

**ì„¼ì„œ ì¤‘ì§€ ì‹œ**:
1. `sensor.stop()` í˜¸ì¶œ
2. SensorServiceë¥¼ í†µí•´ ë„¤ì´í‹°ë¸Œ ì„¼ì„œ ì¤‘ì§€
3. ë¡œì»¬ state ì´ˆê¸°í™”
4. ì—ëŸ¬ ì²˜ë¦¬

**ìë™ ìƒëª…ì£¼ê¸°**:
- `enabled=true` + ì„¸ì…˜ í™œì„± â†’ ìë™ ì‹œì‘
- `enabled=false` â†’ ìë™ ì¤‘ì§€
- `recordingState=STOPPED/ERROR` â†’ ìë™ ì¤‘ì§€
- ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ â†’ ìë™ ì¤‘ì§€

### ì‚°ì¶œë¬¼

- âœ… src/hooks/useSensor.ts (370ì¤„)
- âœ… ì„¼ì„œ ì‹œì‘/ì¤‘ì§€ í•¨ìˆ˜
- âœ… ì‹¤ì‹œê°„ ë°ì´í„° êµ¬ë…
- âœ… useSensorStore í†µí•©
- âœ… ìë™ ìƒëª…ì£¼ê¸° ê´€ë¦¬
- âœ… í´ë¦°ì—… ë¡œì§
- âœ… clearError í•¨ìˆ˜
- âœ… TypeScript íƒ€ì… ì •ì˜
- âœ… ì‚¬ìš© ì˜ˆì œ ë¬¸ì„œí™”

### ì£¼ìš” ì„±ê³¼

**React Hook íŒ¨í„´**:
- âœ… í‘œì¤€ React Hook API
- âœ… useEffectë¥¼ í†µí•œ ìƒëª…ì£¼ê¸° ê´€ë¦¬
- âœ… useCallbackì„ í†µí•œ í•¨ìˆ˜ ë©”ëª¨ì´ì œì´ì…˜
- âœ… useRefë¥¼ í†µí•œ ì½œë°± ì•ˆì •ì„±

**ìŠ¤í† ì–´ í†µí•©**:
- âœ… useSensorStore ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
- âœ… ì—ëŸ¬ ìƒíƒœ ë™ê¸°í™”
- âœ… ìƒ˜í”Œ ì¹´ìš´íŠ¸ ì¶”ì 
- âœ… ì„ íƒì  í†µí•© (updateStore í”Œë˜ê·¸)

**ê°œë°œì ê²½í—˜**:
- âœ… ê°„ë‹¨í•œ API
- âœ… ìë™ ì‹œì‘/ì¤‘ì§€
- âœ… íƒ€ì… ì•ˆì „ì„±
- âœ… ì—ëŸ¬ ì²˜ë¦¬
- âœ… ëª…í™•í•œ ìƒíƒœ ê´€ë¦¬

**ì•ˆì •ì„±**:
- âœ… ì•ˆì „í•œ ì–¸ë§ˆìš´íŠ¸ í´ë¦°ì—…
- âœ… recordingState ë³€ê²½ ê°ì§€
- âœ… ì—ëŸ¬ ë³µêµ¬
- âœ… ì„¼ì„œ ê°€ìš©ì„± ì²´í¬

### ë‹¤ìŒ Phase

â†’ Phase 89: react-native-audio-record ì„¤ì¹˜

---

## Phase 88: ì„¼ì„œ ì„¤ì • ê´€ë¦¬ âœ…

**ìƒíƒœ**: âœ… ì™„ë£Œ
**ì™„ë£Œì¼**: 2025-11-13
**ì‹¤ì œ ì†Œìš”**: 0.5ì‹œê°„
**ìš°ì„ ìˆœìœ„**: medium

### ì‘ì—… ë‚´ìš©

ì„¼ì„œ ì„¤ì •ì„ ê´€ë¦¬í•˜ê³  AsyncStorageì— ì €ì¥í•˜ëŠ” ì‹œìŠ¤í…œì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

#### êµ¬í˜„ 1: SensorSettingsService.ts (550ì¤„)

**í•µì‹¬ ê¸°ëŠ¥**:

**1. ì„¼ì„œ ìƒ˜í”Œë§ìœ¨ ì„¤ì •**
- ê° ì„¼ì„œë³„ ìƒ˜í”Œë§ ë ˆì´íŠ¸ ì„¤ì • (Hz)
- `setSensorSampleRate()`: ìƒ˜í”Œë§ ë ˆì´íŠ¸ ë³€ê²½
- ì´ë²¤íŠ¸ ê¸°ë°˜ ì„¼ì„œëŠ” 0Hz (step detector, significant motion)
- ê¸°ë³¸ê°’: ACC/GYR 100Hz, MAG 50Hz, GPS 1Hz

**2. í™œì„±í™”í•  ì„¼ì„œ ì„ íƒ**
- 14ê°œ ì„¼ì„œ íƒ€ì… ì§€ì› (accelerometer, gyroscope, magnetometer, etc.)
- `enableSensor()`, `disableSensor()`: ê°œë³„ ì„¼ì„œ í™œì„±í™”/ë¹„í™œì„±í™”
- `toggleSensor()`: ì„¼ì„œ í† ê¸€
- `getEnabledSensors()`: í™œì„±í™”ëœ ì„¼ì„œ ëª©ë¡
- `getEnabledAndroidSensorTypes()`: Android ì„¼ì„œ íƒ€ì… ëª©ë¡

**3. GPS ì •í™•ë„ ì„¤ì •**
- GPS ì •í™•ë„ ëª¨ë“œ (HIGH/BALANCED/LOW)
- ì—…ë°ì´íŠ¸ ê°„ê²© ì„¤ì • (ì´ˆ)
- ê±°ë¦¬ í•„í„° ì„¤ì • (ë¯¸í„°)
- `setGPSAccuracyMode()`: ì •í™•ë„ ëª¨ë“œ ë³€ê²½
- `updateGPSSettings()`: GPS ì„¤ì • ì—…ë°ì´íŠ¸

**4. ë°°í„°ë¦¬ ì ˆì•½ ëª¨ë“œ**
- 3ê°€ì§€ ëª¨ë“œ: OFF, BALANCED, AGGRESSIVE
- BALANCED: ìƒ˜í”Œë§ ë ˆì´íŠ¸ 50% ê°ì†Œ
- AGGRESSIVE: ìµœì†Œ ìƒ˜í”Œë§ ë ˆì´íŠ¸ ì‚¬ìš© (25Hz)
- ë°°ê²½ GPS ë¹„í™œì„±í™” ì˜µì…˜
- `setBatterySaverMode()`: ëª¨ë“œ ë³€ê²½
- `getAdjustedSensorSettings()`: ë°°í„°ë¦¬ ì ˆì•½ ì ìš©ëœ ì„¤ì • ë°˜í™˜

**5. AsyncStorageì— ì„¤ì • ì €ì¥**
- ìë™ ì €ì¥: ì„¤ì • ë³€ê²½ ì‹œ AsyncStorageì— ì €ì¥
- ìë™ ë¡œë“œ: ì´ˆê¸°í™” ì‹œ ì €ì¥ëœ ì„¤ì • ë¡œë“œ
- ê¸°ë³¸ê°’ ë³‘í•©: ìƒˆ ì„¤ì • ì¶”ê°€ ì‹œ ê¸°ë³¸ê°’ê³¼ ë³‘í•©
- Storage key: '@koodtx:sensor_settings'

**6. ì¶”ê°€ ê¸°ëŠ¥**
- `resetToDefaults()`: ê¸°ë³¸ ì„¤ì •ìœ¼ë¡œ ë¦¬ì…‹
- `exportSettings()`: JSON í˜•ì‹ìœ¼ë¡œ ì„¤ì • ë‚´ë³´ë‚´ê¸°
- `importSettings()`: JSONì—ì„œ ì„¤ì • ê°€ì ¸ì˜¤ê¸°
- `clearSettings()`: ëª¨ë“  ì„¤ì • ì‚­ì œ

### ê¸°ë³¸ ì„¤ì •

**ì„¼ì„œ ê¸°ë³¸ê°’**:
- Accelerometer: 100Hz, enabled
- Gyroscope: 100Hz, enabled
- Magnetometer: 50Hz, enabled
- GPS: 1Hz, enabled
- ê¸°íƒ€ ì„¼ì„œ: disabled

**GPS ê¸°ë³¸ê°’**:
- ì •í™•ë„: BALANCED
- ì—…ë°ì´íŠ¸ ê°„ê²©: 5ì´ˆ
- ê±°ë¦¬ í•„í„°: 10ë¯¸í„°

**ë°°í„°ë¦¬ ì ˆì•½ ê¸°ë³¸ê°’**:
- ëª¨ë“œ: OFF
- ê°ì†Œëœ ìƒ˜í”Œë§ ë ˆì´íŠ¸: 25Hz
- ë°°ê²½ GPS: enabled
- ìµœì†Œ ì—…ë°ì´íŠ¸ ê°„ê²©: 10ì´ˆ

#### êµ¬í˜„ 2: useSensorSettings.ts (450ì¤„)

**React Hook for Settings**:

**ê¸°ëŠ¥**:
- ìë™ ì´ˆê¸°í™” (ë§ˆìš´íŠ¸ ì‹œ)
- ì„¤ì • ìƒíƒœ ê´€ë¦¬ (useState)
- ë¡œë”©/ì—ëŸ¬ ìƒíƒœ
- ëª¨ë“  ì„¤ì • CRUD í•¨ìˆ˜ ì œê³µ
- ìë™ ìƒˆë¡œê³ ì¹¨

**API**:
```typescript
interface UseSensorSettingsResult {
  settings: AppSettings | null;
  sensorSettings: SensorSettings | null;
  gpsSettings: GPSSettings | null;
  batterySaverSettings: BatterySaverSettings | null;
  isInitialized: boolean;
  isLoading: boolean;
  error: Error | null;

  // 20+ í•¨ìˆ˜
  initialize: () => Promise<void>;
  getSensorConfig: (type) => SensorConfiguration | null;
  updateSensorConfig: (type, config) => Promise<void>;
  enableSensor: (type) => Promise<void>;
  disableSensor: (type) => Promise<void>;
  toggleSensor: (type) => Promise<void>;
  setSensorSampleRate: (type, rate) => Promise<void>;
  updateGPSSettings: (settings) => Promise<void>;
  setGPSAccuracyMode: (mode) => Promise<void>;
  updateBatterySaverSettings: (settings) => Promise<void>;
  setBatterySaverMode: (mode) => Promise<void>;
  getEnabledSensors: () => string[];
  getEnabledAndroidSensorTypes: () => AndroidSensorType[];
  getAdjustedSensorSettings: () => SensorSettings | null;
  resetToDefaults: () => Promise<void>;
  exportSettings: () => string | null;
  importSettings: (json) => Promise<void>;
  refresh: () => void;
}
```

### ì‚¬ìš© ì˜ˆì œ

**1. ê¸°ë³¸ ì‚¬ìš©**:
```typescript
function SettingsScreen() {
  const settings = useSensorSettings();

  if (settings.isLoading) {
    return <Loading />;
  }

  return (
    <View>
      {settings.getEnabledSensors().map(sensor => (
        <SensorSettingItem key={sensor} sensor={sensor} />
      ))}
    </View>
  );
}
```

**2. ì„¼ì„œ í† ê¸€**:
```typescript
const settings = useSensorSettings();

const handleToggle = async () => {
  await settings.toggleSensor('accelerometer');
  console.log('Accelerometer toggled');
};
```

**3. ìƒ˜í”Œë§ ë ˆì´íŠ¸ ë³€ê²½**:
```typescript
const settings = useSensorSettings();

const handleRateChange = async (rate: number) => {
  await settings.setSensorSampleRate('gyroscope', rate);
  console.log('Sample rate updated:', rate);
};
```

**4. GPS ì •í™•ë„ ë³€ê²½**:
```typescript
const settings = useSensorSettings();

await settings.setGPSAccuracyMode(GPSAccuracyMode.HIGH);
```

**5. ë°°í„°ë¦¬ ì ˆì•½ ëª¨ë“œ**:
```typescript
const settings = useSensorSettings();

// Enable battery saver
await settings.setBatterySaverMode(BatterySaverMode.BALANCED);

// Get adjusted settings (with battery saver applied)
const adjusted = settings.getAdjustedSensorSettings();
console.log('Adjusted sample rates:', adjusted);
```

**6. ì„¤ì • ë‚´ë³´ë‚´ê¸°/ê°€ì ¸ì˜¤ê¸°**:
```typescript
const settings = useSensorSettings();

// Export
const json = settings.exportSettings();
await saveToFile(json);

// Import
const json = await loadFromFile();
await settings.importSettings(json);
```

**7. ê¸°ë³¸ê°’ìœ¼ë¡œ ë¦¬ì…‹**:
```typescript
const settings = useSensorSettings();

await settings.resetToDefaults();
```

### ì„¤ì • UI ì—°ë™

**Switch ì»´í¬ë„ŒíŠ¸**:
```typescript
function SensorSwitch({sensorType}: {sensorType: keyof SensorSettings}) {
  const settings = useSensorSettings();
  const config = settings.getSensorConfig(sensorType);

  return (
    <Switch
      value={config?.enabled ?? false}
      onValueChange={() => settings.toggleSensor(sensorType)}
    />
  );
}
```

**Slider ì»´í¬ë„ŒíŠ¸**:
```typescript
function SampleRateSlider({sensorType}: {sensorType: keyof SensorSettings}) {
  const settings = useSensorSettings();
  const config = settings.getSensorConfig(sensorType);

  return (
    <Slider
      value={config?.sampleRate ?? 50}
      minimumValue={1}
      maximumValue={200}
      step={1}
      onValueChange={(rate) => settings.setSensorSampleRate(sensorType, rate)}
    />
  );
}
```

**Picker ì»´í¬ë„ŒíŠ¸**:
```typescript
function GPSAccuracyPicker() {
  const settings = useSensorSettings();
  const gpsSettings = settings.gpsSettings;

  return (
    <Picker
      selectedValue={gpsSettings?.accuracyMode}
      onValueChange={(mode) => settings.setGPSAccuracyMode(mode)}
    >
      <Picker.Item label="High" value={GPSAccuracyMode.HIGH} />
      <Picker.Item label="Balanced" value={GPSAccuracyMode.BALANCED} />
      <Picker.Item label="Low" value={GPSAccuracyMode.LOW} />
    </Picker>
  );
}
```

### ì‚°ì¶œë¬¼

- âœ… src/services/settings/SensorSettingsService.ts (550ì¤„)
- âœ… src/services/settings/index.ts
- âœ… src/hooks/useSensorSettings.ts (450ì¤„)
- âœ… src/hooks/index.ts ì—…ë°ì´íŠ¸
- âœ… BatterySaverMode enum (OFF/BALANCED/AGGRESSIVE)
- âœ… SensorConfiguration ì¸í„°í˜ì´ìŠ¤
- âœ… GPSSettings ì¸í„°í˜ì´ìŠ¤
- âœ… BatterySaverSettings ì¸í„°í˜ì´ìŠ¤
- âœ… AppSettings ì¸í„°í˜ì´ìŠ¤
- âœ… AsyncStorage í†µí•©
- âœ… 20+ ì„¤ì • ê´€ë¦¬ í•¨ìˆ˜
- âœ… Singleton pattern (SensorSettingsService)
- âœ… React Hook (useSensorSettings)

### ì£¼ìš” ì„±ê³¼

**ì™„ì „í•œ ì„¤ì • ê´€ë¦¬**:
- âœ… 14ê°œ ì„¼ì„œ ê°œë³„ ì„¤ì •
- âœ… ì„¼ì„œ í™œì„±í™”/ë¹„í™œì„±í™”
- âœ… ìƒ˜í”Œë§ ë ˆì´íŠ¸ ì¡°ì •
- âœ… GPS ì •í™•ë„ ëª¨ë“œ
- âœ… ë°°í„°ë¦¬ ì ˆì•½ ëª¨ë“œ
- âœ… AsyncStorage ìë™ ì €ì¥/ë¡œë“œ

**ë°°í„°ë¦¬ ìµœì í™”**:
- âœ… 3ë‹¨ê³„ ë°°í„°ë¦¬ ì ˆì•½ ëª¨ë“œ
- âœ… ìƒ˜í”Œë§ ë ˆì´íŠ¸ ìë™ ì¡°ì •
- âœ… GPS ë°°ê²½ ë¹„í™œì„±í™”
- âœ… ì—…ë°ì´íŠ¸ ê°„ê²© ì¡°ì •

**ê°œë°œì ê²½í—˜**:
- âœ… ê°„ë‹¨í•œ React Hook API
- âœ… TypeScript íƒ€ì… ì•ˆì „ì„±
- âœ… ìë™ ì´ˆê¸°í™”
- âœ… ë¡œë”©/ì—ëŸ¬ ìƒíƒœ ê´€ë¦¬
- âœ… ì„¤ì • ë‚´ë³´ë‚´ê¸°/ê°€ì ¸ì˜¤ê¸°

**UI í†µí•© ì¤€ë¹„**:
- âœ… Switch, Slider, Picker ì˜ˆì œ
- âœ… ì‹¤ì‹œê°„ ì„¤ì • ë³€ê²½
- âœ… ìë™ ìƒˆë¡œê³ ì¹¨
- âœ… ì—ëŸ¬ ì²˜ë¦¬

### ë‹¤ìŒ Phase

â†’ Phase 89: react-native-audio-record ì„¤ì¹˜

---

## í†µê³„ ì—…ë°ì´íŠ¸

**ì™„ë£Œëœ Phase: 88/300**
**ì§„í–‰ë¥ : 29.3%**

---

_ìµœì¢… ì—…ë°ì´íŠ¸: 2025-11-13 23:45_
